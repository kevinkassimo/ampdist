{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/amp-apester-media-0.1.css.js","extensions/amp-apester-media/0.1/amp-apester-media.js","extensions/amp-apester-media/0.1/utils.js","node_modules/document-register-element/build/document-register-element.patched.js","node_modules/promise-pjs/promise.js","src/3p-frame-messaging.js","src/config.js","src/cookies.js","src/dom.js","src/element-service.js","src/event-helper-listen.js","src/event-helper.js","src/experiments.js","src/iframe-helper.js","src/intersection-observer-polyfill.js","src/json.js","src/layout-rect.js","src/layout.js","src/log.js","src/mode-object.js","src/mode.js","src/polyfills.js","src/polyfills/array-includes.js","src/polyfills/custom-elements.js","src/polyfills/document-contains.js","src/polyfills/domtokenlist-toggle.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/polyfills/promise.js","src/service.js","src/services.js","src/static-template.js","src/string.js","src/style.js","src/types.js","src/url-parse-query-string.js","src/url-try-decode-uri-component.js","src/url.js","src/utils/array.js","src/utils/lru-cache.js","src/utils/object.js","src/utils/promise.js","third_party/css-escape/css-escape.js"],"names":[],"mappings":"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OAAO,OAAP,CAAe,KAAf,CAAT;AACD;AACF,GALgB,CAAjB;AAMA,cAAY,IAAZ,CAAiB,QAAjB;AACD;;;AC/HD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACn6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"amp-apester-media-0.1.max.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const CSS = \".amp-apester-iframe{-webkit-transition:opacity 0.4s;transition:opacity 0.4s;opacity:0}.i-amphtml-apester-iframe-ready{-webkit-transition:opacity 1s ease-out;transition:opacity 1s ease-out;opacity:1!important}.amp-apester-loader{height:100%;width:100%;background-color:#fff}.amp-apester-container{max-width:700px;margin:0 auto;display:block;position:relative;width:100%}.amp-apester-overflow{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.amp-apester-overflow button{border:none;background:#fff;cursor:pointer;padding:25px 80px;text-transform:uppercase;letter-spacing:1px;font-weight:700;outline:none;position:relative}.amp-apester-loader-blobs{-webkit-filter:url(#amp-apester-goo);filter:url(#amp-apester-goo);position:absolute;top:0;left:0;bottom:0;right:0}.amp-apester-loader-blob{position:absolute;margin:auto;top:0;bottom:0;right:0;left:0;width:50px;height:50px;border-radius:50%;background-color:#ee2e3d}.amp-apester-loader-blob:first-child{-webkit-animation:amp-apester-blob-left-anim cubic-bezier(0.77,0,0.175,1) 2s infinite;animation:amp-apester-blob-left-anim cubic-bezier(0.77,0,0.175,1) 2s infinite}.amp-apester-loader-blob:nth-child(2){-webkit-animation:amp-apester-blob-right-anim cubic-bezier(0.77,0,0.175,1) 2s infinite;animation:amp-apester-blob-right-anim cubic-bezier(0.77,0,0.175,1) 2s infinite}@-webkit-keyframes amp-apester-blob-left-anim{0%{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}33%{-webkit-transform:scale(0.55,0.5) translate(80px);transform:scale(0.55,0.5) translate(80px)}66%{-webkit-transform:scale(0.8) translate(0);transform:scale(0.8) translate(0)}to{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}}@keyframes amp-apester-blob-left-anim{0%{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}33%{-webkit-transform:scale(0.55,0.5) translate(80px);transform:scale(0.55,0.5) translate(80px)}66%{-webkit-transform:scale(0.8) translate(0);transform:scale(0.8) translate(0)}to{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}}@-webkit-keyframes amp-apester-blob-right-anim{0%{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}33%{-webkit-transform:scale(0.55,0.5) translate(-80px);transform:scale(0.55,0.5) translate(-80px)}66%{-webkit-transform:scale(0.8) translate(0);transform:scale(0.8) translate(0)}to{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}}@keyframes amp-apester-blob-right-anim{0%{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}33%{-webkit-transform:scale(0.55,0.5) translate(-80px);transform:scale(0.55,0.5) translate(-80px)}66%{-webkit-transform:scale(0.8) translate(0);transform:scale(0.8) translate(0)}to{-webkit-transform:scale(1) translate(0);transform:scale(1) translate(0)}}@-webkit-keyframes amp-apester-loader-logo{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:scale(1);transform:scale(1);opacity:0}40%{-webkit-transform:scale(0.5);transform:scale(0.5);opacity:0}66%{-webkit-transform:scale(0.8);transform:scale(0.8);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes amp-apester-loader-logo{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}20%{-webkit-transform:scale(1);transform:scale(1);opacity:0}40%{-webkit-transform:scale(0.5);transform:scale(0.5);opacity:0}66%{-webkit-transform:scale(0.8);transform:scale(0.8);opacity:1}to{-webkit-transform:scale(1);transform:scale(1);opacity:1}}.amp-apester-loader-logo{background:url(https://app.apester.com/assets/editor/3.4.10/dist/svg/ape-loader.svg) no-repeat 50%;position:absolute;height:28px;width:28px;left:calc(50% - 14px);top:calc(50% - 14px)}.amp-apester-loader-logo svg{height:100%;width:100%}.amp-apester-fullscreen{background:rgba(34,36,38,0.97)!important;position:fixed!important;width:100vw!important;height:100vh!important;z-index:2147483646!important;top:0;zoom:1;-webkit-overflow-scrolling:touch!important}\\n/*# sourceURL=/extensions/amp-apester-media/0.1/amp-apester-media.css*/\";\n","/**\n * Copyright 2016 The AMP HTML Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {CSS} from '../../../build/amp-apester-media-0.1.css';\nimport {IntersectionObserverApi} from '../../../src/intersection-observer-polyfill';\nimport {Services} from '../../../src/services';\nimport {addParamsToUrl} from '../../../src/url';\nimport {dev, user} from '../../../src/log';\nimport {dict} from '../../../src/utils/object';\nimport {\n  extractTags,\n  getPlatform,\n  registerEvent,\n  setFullscreenOff,\n  setFullscreenOn,\n} from './utils';\nimport {getLengthNumeral, isLayoutSizeDefined} from '../../../src/layout';\nimport {removeElement} from '../../../src/dom';\n\n/** @const */\nconst TAG = 'amp-apester-media';\n/**\n * @enum {string}\n */\nconst apesterEventNames = {\n  SET_FULL_SCREEN: 'fullscreen_on',\n  REMOVE_FULL_SCREEN: 'fullscreen_off',\n  RESIZE_UNIT: 'apester_resize_unit',\n};\n\n/**\n * AMP Apester-media\n */\nclass AmpApesterMedia extends AMP.BaseElement {\n  /** @param {!AmpElement} element */\n  constructor(element) {\n    super(element);\n    /**\n     * @const @private {string}\n     */\n    this.rendererBaseUrl_ = 'https://renderer.apester.com';\n    /**\n     * @const @private {string}\n     */\n    this.displayBaseUrl_ = 'https://display.apester.com';\n    /**\n     * @const @private {string}\n     */\n    this.staticContent_ = 'https://static.qmerce.com';\n    /**\n     * @const @private {string}\n     */\n    this.loaderUrl_ = 'https://images.apester.com/images%2Floader.gif';\n    /** @private {boolean}  */\n    this.seen_ = false;\n    /** @private {?Element}  */\n    this.iframe_ = null;\n    /** @private {boolean}  */\n    this.ready_ = false;\n    /** @private {?number|undefined}  */\n    this.width_ = null;\n    /** @private {?number|undefined}  */\n    this.height_ = null;\n    /** @private {boolean}  */\n    this.random_ = false;\n    /**\n     * @private {?string}\n     */\n    this.mediaAttribute_ = null;\n    /**\n     * @private {!Object}\n     */\n    this.embedOptions_ = {};\n    /**\n     * @private {?string}\n     */\n    this.mediaId_ = null;\n    /** @private {Array<Function>} */\n    this.unlisteners_ = [];\n    /** @private {?IntersectionObserverApi} */\n    this.intersectionObserverApi_ = null;\n  }\n\n  /**\n   * @param {boolean=} onLayout\n   * @override\n   */\n  preconnectCallback(onLayout) {\n    this.preconnect.url(this.displayBaseUrl_, onLayout);\n    this.preconnect.url(this.rendererBaseUrl_, onLayout);\n    this.preconnect.url(this.staticContent_, onLayout);\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  viewportCallback(inViewport) {\n    if (this.intersectionObserverApi_) {\n      this.intersectionObserverApi_.onViewportCallback(inViewport);\n    }\n    if (inViewport && !this.seen_) {\n      if (this.iframe_ && this.iframe_.contentWindow) {\n        dev().fine(TAG, 'media seen');\n        this.seen_ = true;\n        this.iframe_.contentWindow./*OK*/ postMessage('interaction seen', '*');\n      }\n    }\n    if (this.getPlaceholder() && !this.ready_) {\n      this.togglePlaceholder(inViewport);\n    }\n  }\n\n  /** @override */\n  buildCallback() {\n    const width = this.element.getAttribute('width');\n    const height = this.element.getAttribute('height');\n    this.width_ = getLengthNumeral(width);\n    this.height_ = getLengthNumeral(height);\n    this.random_ = false;\n    this.mediaAttribute_ = user().assert(\n        this.element.getAttribute('data-apester-media-id') ||\n        (this.random_ = this.element.getAttribute(\n            'data-apester-channel-token'\n        )),\n        'Either the data-apester-media-id or the data-apester-channel-token ' +\n        'attributes must be specified for <amp-apester-media> %s',\n        this.element\n    );\n    this.embedOptions_ = {\n      playlist: this.random_,\n      idOrToken: this.mediaAttribute_,\n      inative: this.element.getAttribute('data-apester-inative') === 'true',\n      fallback: this.element.getAttribute('data-apester-fallback'),\n      distributionChannelId: this.element.getAttribute(\n          'data-apester-channel-id'\n      ),\n      renderer: true,\n      tags: extractTags(this.element),\n    };\n  }\n\n  /** @override */\n  firstLayoutCompleted() {\n    this.viewportCallback(this.isInViewport());\n    // Do not hide placeholder\n  }\n\n  /**\n   * @override\n   */\n  onLayoutMeasure() {\n    if (this.intersectionObserverApi_) {\n      this.intersectionObserverApi_.fire();\n    }\n  }\n\n  /**\n   * @return {string}\n   **/\n  buildUrl_() {\n    const {\n      idOrToken,\n      playlist,\n      inative,\n      distributionChannelId,\n      fallback,\n      tags,\n    } = this.embedOptions_;\n    const encodedMediaAttribute = encodeURIComponent(\n        dev().assertString(this.mediaAttribute_)\n    );\n    let suffix = '';\n    const queryParams = dict();\n    queryParams['renderer'] = false;\n    queryParams['platform'] = getPlatform();\n    if (inative) {\n      if (idOrToken) {\n        suffix = `/inatives/${idOrToken}`;\n      } else if (distributionChannelId) {\n        suffix = `/channels/${distributionChannelId}/inatives`;\n      }\n    } else if (playlist && tags) {\n      suffix = `/tokens/${encodedMediaAttribute}/interactions/random`;\n      queryParams['tags'] = tags;\n      queryParams['fallback'] = !!fallback;\n    } else if (playlist) {\n      suffix = `/tokens/${encodedMediaAttribute}/interactions/random`;\n    } else {\n      suffix = `/interactions/${encodedMediaAttribute}/display`;\n    }\n    return addParamsToUrl(`${this.displayBaseUrl_}${suffix}`, queryParams);\n  }\n\n  /**\n   * @return {!Promise<!JsonObject>}\n   **/\n  queryMedia_() {\n    const url = this.buildUrl_();\n    return Services.xhrFor(this.win)\n        .fetchJson(url, {\n          requireAmpResponseSourceOrigin: false,\n        })\n        .then(res => res.json());\n  }\n\n  /** @param {string} id\n   * @return {string}\n   * */\n  constructUrlFromMedia_(id) {\n    const queryParams = dict();\n    queryParams['channelId'] = this.embedOptions_.distributionChannelId;\n    queryParams['type'] = this.embedOptions_.playlist\n      ? 'playlist'\n      : 'editorial';\n    queryParams['platform'] = getPlatform();\n    queryParams['cannonicalUrl'] = Services.documentInfoForDoc(\n        this.element\n    ).canonicalUrl;\n    queryParams['sdk'] = 'amp';\n\n    return addParamsToUrl(\n        `${this.rendererBaseUrl_}/interaction/${encodeURIComponent(id)}`,\n        queryParams\n    );\n  }\n\n  /** @param {string} src\n   * @return {!Element}\n   */\n  constructIframe_(src) {\n    const iframe = this.element.ownerDocument.createElement('iframe');\n    iframe.setAttribute('frameborder', '0');\n    iframe.setAttribute('allowtransparency', 'true');\n    iframe.setAttribute('scrolling', 'no');\n    iframe.src = src;\n    iframe.name = this.win.location.href;\n    iframe.height = this.height_;\n    iframe.width = this.width_;\n    iframe.classList.add('amp-apester-iframe');\n    this.applyFillContent(iframe);\n    return iframe;\n  }\n\n  /**\n   * @return {!Element}\n   */\n  constructLoaderStructure_() {\n    const blobs = this.element.ownerDocument.createElement('div');\n    const blobLeft = this.element.ownerDocument.createElement('div');\n    const blobRight = this.element.ownerDocument.createElement('div');\n    const logo = this.element.ownerDocument.createElement('div');\n    blobs.classList.add('amp-apester-loader-blobs');\n    blobLeft.classList.add('amp-apester-loader-blob');\n    blobRight.classList.add('amp-apester-loader-blob');\n    logo.classList.add('amp-apester-loader-logo');\n    blobs.appendChild(blobLeft);\n    blobs.appendChild(blobRight);\n    blobs.appendChild(logo);\n    return blobs;\n  }\n\n  /**\n   * @return {!Element}\n   */\n  constructLoaderSVG_() {\n    const svg = this.element.ownerDocument.createElement('svg');\n    const defs = this.element.ownerDocument.createElement('defs');\n    const filter = this.element.ownerDocument.createElement('filter');\n    const feGaussianBlur = this.element.ownerDocument.createElement(\n        'feGaussianBlur'\n    );\n    const feColorMatrix = this.element.ownerDocument.createElement(\n        'feColorMatrix'\n    );\n    const feBlend = this.element.ownerDocument.createElement('feBlend');\n    svg.setAttribute('version', '1.1');\n    svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    filter.setAttribute('id', 'amp-apester-goo');\n    feGaussianBlur.setAttribute('in', 'SourceGraphic');\n    feGaussianBlur.setAttribute('results', 'blur');\n    feGaussianBlur.setAttribute('stdDeviation', '10');\n    feColorMatrix.setAttribute('in', 'blur');\n    feColorMatrix.setAttribute('mode', 'matrix');\n    feColorMatrix.setAttribute(\n        'values',\n        '1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7'\n    );\n    feColorMatrix.setAttribute('result', 'amp-apester-goo');\n    feBlend.setAttribute('in2', 'amp-apester-goo');\n    feBlend.setAttribute('in', 'SourceGraphic');\n    feBlend.setAttribute('result', 'mix');\n    svg.appendChild(defs);\n    defs.appendChild(filter);\n    filter.appendChild(feGaussianBlur);\n    filter.appendChild(feColorMatrix);\n    filter.appendChild(feBlend);\n    return svg;\n  }\n\n  /**\n   * @return {!Element}\n   */\n  constructOverflow_() {\n    const overflow = this.element.ownerDocument.createElement('div');\n    overflow.setAttribute('overflow', '');\n    overflow.className = 'amp-apester-overflow';\n    const overflowButton = this.element.ownerDocument.createElement('button');\n    overflowButton.textContent = 'Full Size';\n    overflow.appendChild(overflowButton);\n    return overflow;\n  }\n\n  /** @override */\n  layoutCallback() {\n    this.element.classList.add('amp-apester-container');\n    const vsync = Services.vsyncFor(this.win);\n    return this.queryMedia_().then(\n        response => {\n          const payload = response['payload'];\n          // If it's a playlist we choose a media randomly.\n          // The response will be an array.\n          const media = /** @type {JsonObject} */ (this.embedOptions_.playlist\n            ? payload[Math.floor(Math.random() * payload.length)]\n            : payload);\n          const src = this.constructUrlFromMedia_(media['interactionId']);\n          const iframe = this.constructIframe_(src);\n          this.intersectionObserverApi_ = new IntersectionObserverApi(\n              this,\n              iframe\n          );\n\n          this.mediaId_ = media['interactionId'];\n          this.iframe_ = iframe;\n          this.registerToApesterEvents_();\n\n          return vsync.mutatePromise(() => {\n            const overflow = this.constructOverflow_();\n            this.element.appendChild(overflow);\n            this.element.appendChild(iframe);\n          }).then(() => {\n            return this.loadPromise(iframe).then(() => {\n              return vsync.mutatePromise(() => {\n                this.iframe_.classList\n                    .add('i-amphtml-apester-iframe-ready');\n                if (media['campaignData']) {\n                  this.iframe_.contentWindow./*OK*/ postMessage(\n                      /** @type {JsonObject} */ ({type: 'campaigns',\n                        data: media['campaignData']}),\n                      '*'\n                  );\n                }\n                this.togglePlaceholder(false);\n                this.ready_ = true;\n                let height = 0;\n                if (media && media['data'] && media['data']['size']) {\n                  height = media['data']['size']['height'];\n                }\n                if (height != this.height_) {\n                  this.height_ = height;\n                  if (this.random_) {\n                    this./*OK*/ attemptChangeHeight(height);\n                  } else {\n                    this./*OK*/ changeHeight(height);\n                  }\n                }\n              });\n            });\n          }).catch(error => {\n            dev().error(TAG, 'Display', error);\n            return undefined;\n          });\n        },\n        error => {\n          dev().error(TAG, 'Display', error);\n          return undefined;\n        }\n    );\n  }\n\n  /** @override */\n  createPlaceholderCallback() {\n    const placeholder = this.element.ownerDocument.createElement('div');\n    if (this.element.hasAttribute('aria-label')) {\n      placeholder.setAttribute('aria-label', 'Loading - '\n          + this.element.getAttribute('aria-label'));\n    } else {\n      placeholder.setAttribute('aria-label', 'Loading video');\n    }\n    placeholder.setAttribute('placeholder','');\n    placeholder.setAttribute('layout', 'fill');\n    placeholder.className = 'amp-apester-loader';\n    placeholder.appendChild(this.constructLoaderStructure_());\n    placeholder.appendChild(this.constructLoaderSVG_());\n    return placeholder;\n  }\n\n  /** @override */\n  unlayoutOnPause() {\n    return true;\n  }\n\n  /** @override */\n  unlayoutCallback() {\n    if (this.iframe_) {\n      this.intersectionObserverApi_.destroy();\n      this.intersectionObserverApi_ = null;\n      this.unlisteners_.forEach(unlisten => unlisten());\n      removeElement(this.iframe_);\n      this.iframe_ = null;\n    }\n    return true; //Call layoutCallback again.\n  }\n\n  /**\n   * Registers to apester events.\n   * @private\n   */\n  registerToApesterEvents_() {\n    registerEvent(\n        apesterEventNames.SET_FULL_SCREEN,\n        data => {\n        // User clicked full screen button.\n          if (this.mediaId_ === data.id) {\n            setFullscreenOn(this.element);\n          }\n        },\n        this.win,\n        /** @type {!Element}*/ (this.iframe_),\n        this.unlisteners_\n    );\n    registerEvent(\n        apesterEventNames.REMOVE_FULL_SCREEN,\n        data => {\n        // User clicked close full screen button.\n          if (this.mediaId_ === data.id) {\n            setFullscreenOff(this.element);\n          }\n        },\n        this.win,\n        /** @type {!Element}*/ (this.iframe_),\n        this.unlisteners_\n    );\n    registerEvent(\n        apesterEventNames.RESIZE_UNIT,\n        data => {\n          if (this.mediaId_ === data.id && data.height) {\n            this.attemptChangeHeight(data.height);\n          }\n        },\n        this.win,\n        /** @type {!Element}*/ (this.iframe_),\n        this.unlisteners_\n    );\n  }\n}\n\nAMP.extension(TAG, '0.1', AMP => {\n  AMP.registerElement(TAG, AmpApesterMedia, CSS);\n});\n","/**\n * Copyright 2017 The AMP HTML Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as events from '../../../src/event-helper';\n\nconst rules = [\n  // if it says it's a webview, let's go with that\n  'WebView',\n  // iOS webview will be the same as safari but missing \"Safari\"\n  '(iPhone|iPod|iPad)(?!.*Safari)',\n  // Android Lollipop and Above: webview will be the same as native but it will\n  // contain \"wv\" Android KitKat to lollipop webview will put {version}.0.0.0\n  'Android.*(wv|.0.0.0)',\n  // old chrome android webview agent\n  'Linux; U; Android',\n];\n\nconst webviewRegExp = new RegExp('(' + rules.join('|') + ')', 'ig');\n\n/**\n * Returns if ua belongs to a webview\n *\n * @param {string} ua\n * @return {boolean}\n */\nfunction isWebview(ua) {\n  return !!ua.match(webviewRegExp);\n}\n\n/**\n * @description\n * regex for detecting mobile devices.\n * (including blackberry and other rare mobile devices).\n * @return {boolean}\n */\nfunction isMobileDevice() {\n  const userAgent = navigator.userAgent || navigator.vendor || window.opera;\n  return (\n    /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(\n        userAgent\n    ) ||\n    /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\n        userAgent.substr(0, 4)\n    )\n  );\n}\n\n/**\n * Gets the user platform.\n * @return {string}\n */\nexport function getPlatform() {\n  const webview = isWebview(navigator.userAgent);\n  const isMobile = isMobileDevice();\n  return isMobile ? `mobile${webview ? '-webview' : ''}` : 'desktop';\n}\n\n/**\n * Extracts tags from a given element .\n * @param {!Element} element\n */\nfunction extractElementTags(element) {\n  const tagsAttribute = element.getAttribute('data-apester-tags');\n  if (tagsAttribute) {\n    return tagsAttribute.split(',').map(tag => tag.trim()) || [];\n  }\n  return [];\n}\n\n/**\n * Extracts tags from a given element and document.\n * @param {!Element} element\n * @return {Array<string>}\n */\nexport function extractTags(element) {\n  const extractags = extractElementTags(element);\n  const loweredCase = extractags.map(tag => tag.toLowerCase().trim());\n  const noDuplication =\n    loweredCase.filter((item, pos, self) => self.indexOf(item) === pos);\n  return noDuplication;\n}\n\n/**\n * Adds fullscreen class to an element\n * @param {!Element} element\n */\nexport function setFullscreenOn(element) {\n  element.classList.add('amp-apester-fullscreen');\n}\n\n/**\n * removes fullscreen class from an element\n * @param {!Element} element\n */\nexport function setFullscreenOff(element) {\n  element.classList.remove('amp-apester-fullscreen');\n}\n\n/**\n * Registers to an event\n * @param {string} eventName\n * @param {!Function} callback\n * @param {!EventTarget} win\n * @param {!Element} iframe\n * @param {!Array} unlisteners\n */\nexport function registerEvent(eventName, callback, win, iframe, unlisteners) {\n  const unlisten = events.listen(win, 'message', event => {\n    const fromApesterMedia = iframe.contentWindow === event.source;\n    if (events.getData(event)['type'] === eventName && fromApesterMedia) {\n      callback(events.getData(event));\n    }\n  });\n  unlisteners.push(unlisten);\n}\n","/*!\n\nCopyright (C) 2014-2016 by Andrea Giammarchi - @WebReflection\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n// global window Object\n// optional polyfill info\n//    'auto' used by default, everything is feature detected\n//    'force' use the polyfill even if not fully needed\nfunction installCustomElements(window, polyfill) {'use strict';\n\n  // DO NOT USE THIS FILE DIRECTLY, IT WON'T WORK\n  // THIS IS A PROJECT BASED ON A BUILD SYSTEM\n  // THIS FILE IS JUST WRAPPED UP RESULTING IN\n  // build/document-register-element.node.js\n\n  var\n    document = window.document,\n    Object = window.Object\n  ;\n\n  var htmlClass = (function (info) {\n    // (C) Andrea Giammarchi - @WebReflection - MIT Style\n    var\n      catchClass = /^[A-Z]+[a-z]/,\n      filterBy = function (re) {\n        var arr = [], tag;\n        for (tag in register) {\n          if (re.test(tag)) arr.push(tag);\n        }\n        return arr;\n      },\n      add = function (Class, tag) {\n        tag = tag.toLowerCase();\n        if (!(tag in register)) {\n          register[Class] = (register[Class] || []).concat(tag);\n          register[tag] = (register[tag.toUpperCase()] = Class);\n        }\n      },\n      register = (Object.create || Object)(null),\n      htmlClass = {},\n      i, section, tags, Class\n    ;\n    for (section in info) {\n      for (Class in info[section]) {\n        tags = info[section][Class];\n        register[Class] = tags;\n        for (i = 0; i < tags.length; i++) {\n          register[tags[i].toLowerCase()] =\n          register[tags[i].toUpperCase()] = Class;\n        }\n      }\n    }\n    htmlClass.get = function get(tagOrClass) {\n      return typeof tagOrClass === 'string' ?\n        (register[tagOrClass] || (catchClass.test(tagOrClass) ? [] : '')) :\n        filterBy(tagOrClass);\n    };\n    htmlClass.set = function set(tag, Class) {\n      return (catchClass.test(tag) ?\n        add(tag, Class) :\n        add(Class, tag)\n      ), htmlClass;\n    };\n    return htmlClass;\n  }({\n    \"collections\": {\n      \"HTMLAllCollection\": [\n        \"all\"\n      ],\n      \"HTMLCollection\": [\n        \"forms\"\n      ],\n      \"HTMLFormControlsCollection\": [\n        \"elements\"\n      ],\n      \"HTMLOptionsCollection\": [\n        \"options\"\n      ]\n    },\n    \"elements\": {\n      \"Element\": [\n        \"element\"\n      ],\n      \"HTMLAnchorElement\": [\n        \"a\"\n      ],\n      \"HTMLAppletElement\": [\n        \"applet\"\n      ],\n      \"HTMLAreaElement\": [\n        \"area\"\n      ],\n      \"HTMLAttachmentElement\": [\n        \"attachment\"\n      ],\n      \"HTMLAudioElement\": [\n        \"audio\"\n      ],\n      \"HTMLBRElement\": [\n        \"br\"\n      ],\n      \"HTMLBaseElement\": [\n        \"base\"\n      ],\n      \"HTMLBodyElement\": [\n        \"body\"\n      ],\n      \"HTMLButtonElement\": [\n        \"button\"\n      ],\n      \"HTMLCanvasElement\": [\n        \"canvas\"\n      ],\n      \"HTMLContentElement\": [\n        \"content\"\n      ],\n      \"HTMLDListElement\": [\n        \"dl\"\n      ],\n      \"HTMLDataElement\": [\n        \"data\"\n      ],\n      \"HTMLDataListElement\": [\n        \"datalist\"\n      ],\n      \"HTMLDetailsElement\": [\n        \"details\"\n      ],\n      \"HTMLDialogElement\": [\n        \"dialog\"\n      ],\n      \"HTMLDirectoryElement\": [\n        \"dir\"\n      ],\n      \"HTMLDivElement\": [\n        \"div\"\n      ],\n      \"HTMLDocument\": [\n        \"document\"\n      ],\n      \"HTMLElement\": [\n        \"element\",\n        \"abbr\",\n        \"address\",\n        \"article\",\n        \"aside\",\n        \"b\",\n        \"bdi\",\n        \"bdo\",\n        \"cite\",\n        \"code\",\n        \"command\",\n        \"dd\",\n        \"dfn\",\n        \"dt\",\n        \"em\",\n        \"figcaption\",\n        \"figure\",\n        \"footer\",\n        \"header\",\n        \"i\",\n        \"kbd\",\n        \"mark\",\n        \"nav\",\n        \"noscript\",\n        \"rp\",\n        \"rt\",\n        \"ruby\",\n        \"s\",\n        \"samp\",\n        \"section\",\n        \"small\",\n        \"strong\",\n        \"sub\",\n        \"summary\",\n        \"sup\",\n        \"u\",\n        \"var\",\n        \"wbr\"\n      ],\n      \"HTMLEmbedElement\": [\n        \"embed\"\n      ],\n      \"HTMLFieldSetElement\": [\n        \"fieldset\"\n      ],\n      \"HTMLFontElement\": [\n        \"font\"\n      ],\n      \"HTMLFormElement\": [\n        \"form\"\n      ],\n      \"HTMLFrameElement\": [\n        \"frame\"\n      ],\n      \"HTMLFrameSetElement\": [\n        \"frameset\"\n      ],\n      \"HTMLHRElement\": [\n        \"hr\"\n      ],\n      \"HTMLHeadElement\": [\n        \"head\"\n      ],\n      \"HTMLHeadingElement\": [\n        \"h1\",\n        \"h2\",\n        \"h3\",\n        \"h4\",\n        \"h5\",\n        \"h6\"\n      ],\n      \"HTMLHtmlElement\": [\n        \"html\"\n      ],\n      \"HTMLIFrameElement\": [\n        \"iframe\"\n      ],\n      \"HTMLImageElement\": [\n        \"img\"\n      ],\n      \"HTMLInputElement\": [\n        \"input\"\n      ],\n      \"HTMLKeygenElement\": [\n        \"keygen\"\n      ],\n      \"HTMLLIElement\": [\n        \"li\"\n      ],\n      \"HTMLLabelElement\": [\n        \"label\"\n      ],\n      \"HTMLLegendElement\": [\n        \"legend\"\n      ],\n      \"HTMLLinkElement\": [\n        \"link\"\n      ],\n      \"HTMLMapElement\": [\n        \"map\"\n      ],\n      \"HTMLMarqueeElement\": [\n        \"marquee\"\n      ],\n      \"HTMLMediaElement\": [\n        \"media\"\n      ],\n      \"HTMLMenuElement\": [\n        \"menu\"\n      ],\n      \"HTMLMenuItemElement\": [\n        \"menuitem\"\n      ],\n      \"HTMLMetaElement\": [\n        \"meta\"\n      ],\n      \"HTMLMeterElement\": [\n        \"meter\"\n      ],\n      \"HTMLModElement\": [\n        \"del\",\n        \"ins\"\n      ],\n      \"HTMLOListElement\": [\n        \"ol\"\n      ],\n      \"HTMLObjectElement\": [\n        \"object\"\n      ],\n      \"HTMLOptGroupElement\": [\n        \"optgroup\"\n      ],\n      \"HTMLOptionElement\": [\n        \"option\"\n      ],\n      \"HTMLOutputElement\": [\n        \"output\"\n      ],\n      \"HTMLParagraphElement\": [\n        \"p\"\n      ],\n      \"HTMLParamElement\": [\n        \"param\"\n      ],\n      \"HTMLPictureElement\": [\n        \"picture\"\n      ],\n      \"HTMLPreElement\": [\n        \"pre\"\n      ],\n      \"HTMLProgressElement\": [\n        \"progress\"\n      ],\n      \"HTMLQuoteElement\": [\n        \"blockquote\",\n        \"q\",\n        \"quote\"\n      ],\n      \"HTMLScriptElement\": [\n        \"script\"\n      ],\n      \"HTMLSelectElement\": [\n        \"select\"\n      ],\n      \"HTMLShadowElement\": [\n        \"shadow\"\n      ],\n      \"HTMLSlotElement\": [\n        \"slot\"\n      ],\n      \"HTMLSourceElement\": [\n        \"source\"\n      ],\n      \"HTMLSpanElement\": [\n        \"span\"\n      ],\n      \"HTMLStyleElement\": [\n        \"style\"\n      ],\n      \"HTMLTableCaptionElement\": [\n        \"caption\"\n      ],\n      \"HTMLTableCellElement\": [\n        \"td\",\n        \"th\"\n      ],\n      \"HTMLTableColElement\": [\n        \"col\",\n        \"colgroup\"\n      ],\n      \"HTMLTableElement\": [\n        \"table\"\n      ],\n      \"HTMLTableRowElement\": [\n        \"tr\"\n      ],\n      \"HTMLTableSectionElement\": [\n        \"thead\",\n        \"tbody\",\n        \"tfoot\"\n      ],\n      \"HTMLTemplateElement\": [\n        \"template\"\n      ],\n      \"HTMLTextAreaElement\": [\n        \"textarea\"\n      ],\n      \"HTMLTimeElement\": [\n        \"time\"\n      ],\n      \"HTMLTitleElement\": [\n        \"title\"\n      ],\n      \"HTMLTrackElement\": [\n        \"track\"\n      ],\n      \"HTMLUListElement\": [\n        \"ul\"\n      ],\n      \"HTMLUnknownElement\": [\n        \"unknown\",\n        \"vhgroupv\",\n        \"vkeygen\"\n      ],\n      \"HTMLVideoElement\": [\n        \"video\"\n      ]\n    },\n    \"nodes\": {\n      \"Attr\": [\n        \"node\"\n      ],\n      \"Audio\": [\n        \"audio\"\n      ],\n      \"CDATASection\": [\n        \"node\"\n      ],\n      \"CharacterData\": [\n        \"node\"\n      ],\n      \"Comment\": [\n        \"#comment\"\n      ],\n      \"Document\": [\n        \"#document\"\n      ],\n      \"DocumentFragment\": [\n        \"#document-fragment\"\n      ],\n      \"DocumentType\": [\n        \"node\"\n      ],\n      \"HTMLDocument\": [\n        \"#document\"\n      ],\n      \"Image\": [\n        \"img\"\n      ],\n      \"Option\": [\n        \"option\"\n      ],\n      \"ProcessingInstruction\": [\n        \"node\"\n      ],\n      \"ShadowRoot\": [\n        \"#shadow-root\"\n      ],\n      \"Text\": [\n        \"#text\"\n      ],\n      \"XMLDocument\": [\n        \"xml\"\n      ]\n    }\n  }));\n  \n  \n    \n  // passed at runtime, configurable\n  // via nodejs module\n  if (!polyfill) polyfill = 'auto';\n  \n  var\n    // V0 polyfill entry\n    REGISTER_ELEMENT = 'registerElement',\n  \n    // IE < 11 only + old WebKit for attributes + feature detection\n    EXPANDO_UID = '__' + REGISTER_ELEMENT + (window.Math.random() * 10e4 >> 0),\n  \n    // shortcuts and costants\n    ADD_EVENT_LISTENER = 'addEventListener',\n    ATTACHED = 'attached',\n    CALLBACK = 'Callback',\n    DETACHED = 'detached',\n    EXTENDS = 'extends',\n  \n    ATTRIBUTE_CHANGED_CALLBACK = 'attributeChanged' + CALLBACK,\n    ATTACHED_CALLBACK = ATTACHED + CALLBACK,\n    CONNECTED_CALLBACK = 'connected' + CALLBACK,\n    DISCONNECTED_CALLBACK = 'disconnected' + CALLBACK,\n    CREATED_CALLBACK = 'created' + CALLBACK,\n    DETACHED_CALLBACK = DETACHED + CALLBACK,\n  \n    ADDITION = 'ADDITION',\n    MODIFICATION = 'MODIFICATION',\n    REMOVAL = 'REMOVAL',\n  \n    DOM_ATTR_MODIFIED = 'DOMAttrModified',\n    DOM_CONTENT_LOADED = 'DOMContentLoaded',\n    DOM_SUBTREE_MODIFIED = 'DOMSubtreeModified',\n  \n    PREFIX_TAG = '<',\n    PREFIX_IS = '=',\n  \n    // valid and invalid node names\n    validName = /^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,\n    invalidNames = [\n      'ANNOTATION-XML',\n      'COLOR-PROFILE',\n      'FONT-FACE',\n      'FONT-FACE-SRC',\n      'FONT-FACE-URI',\n      'FONT-FACE-FORMAT',\n      'FONT-FACE-NAME',\n      'MISSING-GLYPH'\n    ],\n  \n    // registered types and their prototypes\n    types = [],\n    protos = [],\n  \n    // to query subnodes\n    query = '',\n  \n    // html shortcut used to feature detect\n    documentElement = document.documentElement,\n  \n    // ES5 inline helpers || basic patches\n    indexOf = types.indexOf || function (v) {\n      for(var i = this.length; i-- && this[i] !== v;){}\n      return i;\n    },\n  \n    // other helpers / shortcuts\n    OP = Object.prototype,\n    hOP = OP.hasOwnProperty,\n    iPO = OP.isPrototypeOf,\n  \n    defineProperty = Object.defineProperty,\n    empty = [],\n    gOPD = Object.getOwnPropertyDescriptor,\n    gOPN = Object.getOwnPropertyNames,\n    gPO = Object.getPrototypeOf,\n    sPO = Object.setPrototypeOf,\n  \n    // jshint proto: true\n    hasProto = !!Object.__proto__,\n  \n    // V1 helpers\n    fixGetClass = false,\n    DRECEV1 = '__dreCEv1',\n    customElements = window.customElements,\n    usableCustomElements = polyfill !== 'force' && !!(\n      customElements &&\n      customElements.define &&\n      customElements.get &&\n      customElements.whenDefined\n    ),\n    Dict = Object.create || Object,\n    Map = window.Map || function Map() {\n      var K = [], V = [], i;\n      return {\n        get: function (k) {\n          return V[indexOf.call(K, k)];\n        },\n        set: function (k, v) {\n          i = indexOf.call(K, k);\n          if (i < 0) V[K.push(k) - 1] = v;\n          else V[i] = v;\n        }\n      };\n    },\n    Promise = window.Promise || function (fn) {\n      var\n        notify = [],\n        done = false,\n        p = {\n          'catch': function () {\n            return p;\n          },\n          'then': function (cb) {\n            notify.push(cb);\n            if (done) setTimeout(resolve, 1);\n            return p;\n          }\n        }\n      ;\n      function resolve(value) {\n        done = true;\n        while (notify.length) notify.shift()(value);\n      }\n      fn(resolve);\n      return p;\n    },\n    justCreated = false,\n    constructors = Dict(null),\n    waitingList = Dict(null),\n    nodeNames = new Map(),\n    secondArgument = function (is) {\n      return is.toLowerCase();\n    },\n  \n    // used to create unique instances\n    create = Object.create || function Bridge(proto) {\n      // silly broken polyfill probably ever used but short enough to work\n      return proto ? ((Bridge.prototype = proto), new Bridge()) : this;\n    },\n  \n    // will set the prototype if possible\n    // or copy over all properties\n    setPrototype = sPO || (\n      hasProto ?\n        function (o, p) {\n          o.__proto__ = p;\n          return o;\n        } : (\n      (gOPN && gOPD) ?\n        (function(){\n          function setProperties(o, p) {\n            for (var\n              key,\n              names = gOPN(p),\n              i = 0, length = names.length;\n              i < length; i++\n            ) {\n              key = names[i];\n              if (!hOP.call(o, key)) {\n                defineProperty(o, key, gOPD(p, key));\n              }\n            }\n          }\n          return function (o, p) {\n            do {\n              setProperties(o, p);\n            } while ((p = gPO(p)) && !iPO.call(p, o));\n            return o;\n          };\n        }()) :\n        function (o, p) {\n          for (var key in p) {\n            o[key] = p[key];\n          }\n          return o;\n        }\n    )),\n  \n    // DOM shortcuts and helpers, if any\n  \n    MutationObserver = window.MutationObserver ||\n                       window.WebKitMutationObserver,\n  \n    HTMLElementPrototype = (\n      window.HTMLElement ||\n      window.Element ||\n      window.Node\n    ).prototype,\n  \n    IE8 = !iPO.call(HTMLElementPrototype, documentElement),\n  \n    safeProperty = IE8 ? function (o, k, d) {\n      o[k] = d.value;\n      return o;\n    } : defineProperty,\n  \n    isValidNode = IE8 ?\n      function (node) {\n        return node.nodeType === 1;\n      } :\n      function (node) {\n        return iPO.call(HTMLElementPrototype, node);\n      },\n  \n    targets = IE8 && [],\n  \n    attachShadow = HTMLElementPrototype.attachShadow,\n    cloneNode = HTMLElementPrototype.cloneNode,\n    dispatchEvent = HTMLElementPrototype.dispatchEvent,\n    getAttribute = HTMLElementPrototype.getAttribute,\n    hasAttribute = HTMLElementPrototype.hasAttribute,\n    removeAttribute = HTMLElementPrototype.removeAttribute,\n    setAttribute = HTMLElementPrototype.setAttribute,\n  \n    // replaced later on\n    createElement = document.createElement,\n    patchedCreateElement = createElement,\n  \n    // shared observer for all attributes\n    attributesObserver = MutationObserver && {\n      attributes: true,\n      characterData: true,\n      attributeOldValue: true\n    },\n  \n    // useful to detect only if there's no MutationObserver\n    DOMAttrModified = MutationObserver || function(e) {\n      doesNotSupportDOMAttrModified = false;\n      documentElement.removeEventListener(\n        DOM_ATTR_MODIFIED,\n        DOMAttrModified\n      );\n    },\n  \n    // will both be used to make DOMNodeInserted asynchronous\n    asapQueue,\n    asapTimer = 0,\n  \n    // internal flags\n    V0 = REGISTER_ELEMENT in document,\n    setListener = true,\n    justSetup = false,\n    doesNotSupportDOMAttrModified = true,\n    dropDomContentLoaded = true,\n  \n    // needed for the innerHTML helper\n    notFromInnerHTMLHelper = true,\n  \n    // optionally defined later on\n    onSubtreeModified,\n    callDOMAttrModified,\n    getAttributesMirror,\n    observer,\n    observe,\n  \n    // based on setting prototype capability\n    // will check proto or the expando attribute\n    // in order to setup the node once\n    patchIfNotAlready,\n    patch\n  ;\n  \n  // only if needed\n  if (!V0) {\n  \n    if (sPO || hasProto) {\n        patchIfNotAlready = function (node, proto) {\n          if (!iPO.call(proto, node)) {\n            setupNode(node, proto);\n          }\n        };\n        patch = setupNode;\n    } else {\n        patchIfNotAlready = function (node, proto) {\n          if (!node[EXPANDO_UID]) {\n            node[EXPANDO_UID] = Object(true);\n            setupNode(node, proto);\n          }\n        };\n        patch = patchIfNotAlready;\n    }\n  \n    if (IE8) {\n      doesNotSupportDOMAttrModified = false;\n      (function (){\n        var\n          descriptor = gOPD(HTMLElementPrototype, ADD_EVENT_LISTENER),\n          addEventListener = descriptor.value,\n          patchedRemoveAttribute = function (name) {\n            var e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n            e.attrName = name;\n            e.prevValue = getAttribute.call(this, name);\n            e.newValue = null;\n            e[REMOVAL] = e.attrChange = 2;\n            removeAttribute.call(this, name);\n            dispatchEvent.call(this, e);\n          },\n          patchedSetAttribute = function (name, value) {\n            var\n              had = hasAttribute.call(this, name),\n              old = had && getAttribute.call(this, name),\n              e = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true})\n            ;\n            setAttribute.call(this, name, value);\n            e.attrName = name;\n            e.prevValue = had ? old : null;\n            e.newValue = value;\n            if (had) {\n              e[MODIFICATION] = e.attrChange = 1;\n            } else {\n              e[ADDITION] = e.attrChange = 0;\n            }\n            dispatchEvent.call(this, e);\n          },\n          onPropertyChange = function (e) {\n            // jshint eqnull:true\n            var\n              node = e.currentTarget,\n              superSecret = node[EXPANDO_UID],\n              propertyName = e.propertyName,\n              event\n            ;\n            if (superSecret.hasOwnProperty(propertyName)) {\n              superSecret = superSecret[propertyName];\n              event = new CustomEvent(DOM_ATTR_MODIFIED, {bubbles: true});\n              event.attrName = superSecret.name;\n              event.prevValue = superSecret.value || null;\n              event.newValue = (superSecret.value = node[propertyName] || null);\n              if (event.prevValue == null) {\n                event[ADDITION] = event.attrChange = 0;\n              } else {\n                event[MODIFICATION] = event.attrChange = 1;\n              }\n              dispatchEvent.call(node, event);\n            }\n          }\n        ;\n        descriptor.value = function (type, handler, capture) {\n          if (\n            type === DOM_ATTR_MODIFIED &&\n            this[ATTRIBUTE_CHANGED_CALLBACK] &&\n            this.setAttribute !== patchedSetAttribute\n          ) {\n            this[EXPANDO_UID] = {\n              className: {\n                name: 'class',\n                value: this.className\n              }\n            };\n            this.setAttribute = patchedSetAttribute;\n            this.removeAttribute = patchedRemoveAttribute;\n            addEventListener.call(this, 'propertychange', onPropertyChange);\n          }\n          addEventListener.call(this, type, handler, capture);\n        };\n        defineProperty(HTMLElementPrototype, ADD_EVENT_LISTENER, descriptor);\n      }());\n    } else if (!MutationObserver) {\n      documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, DOMAttrModified);\n      documentElement.setAttribute(EXPANDO_UID, 1);\n      documentElement.removeAttribute(EXPANDO_UID);\n      if (doesNotSupportDOMAttrModified) {\n        onSubtreeModified = function (e) {\n          var\n            node = this,\n            oldAttributes,\n            newAttributes,\n            key\n          ;\n          if (node === e.target) {\n            oldAttributes = node[EXPANDO_UID];\n            node[EXPANDO_UID] = (newAttributes = getAttributesMirror(node));\n            for (key in newAttributes) {\n              if (!(key in oldAttributes)) {\n                // attribute was added\n                return callDOMAttrModified(\n                  0,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  ADDITION\n                );\n              } else if (newAttributes[key] !== oldAttributes[key]) {\n                // attribute was changed\n                return callDOMAttrModified(\n                  1,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  MODIFICATION\n                );\n              }\n            }\n            // checking if it has been removed\n            for (key in oldAttributes) {\n              if (!(key in newAttributes)) {\n                // attribute removed\n                return callDOMAttrModified(\n                  2,\n                  node,\n                  key,\n                  oldAttributes[key],\n                  newAttributes[key],\n                  REMOVAL\n                );\n              }\n            }\n          }\n        };\n        callDOMAttrModified = function (\n          attrChange,\n          currentTarget,\n          attrName,\n          prevValue,\n          newValue,\n          action\n        ) {\n          var e = {\n            attrChange: attrChange,\n            currentTarget: currentTarget,\n            attrName: attrName,\n            prevValue: prevValue,\n            newValue: newValue\n          };\n          e[action] = attrChange;\n          onDOMAttrModified(e);\n        };\n        getAttributesMirror = function (node) {\n          for (var\n            attr, name,\n            result = {},\n            attributes = node.attributes,\n            i = 0, length = attributes.length;\n            i < length; i++\n          ) {\n            attr = attributes[i];\n            name = attr.name;\n            if (name !== 'setAttribute') {\n              result[name] = attr.value;\n            }\n          }\n          return result;\n        };\n      }\n    }\n  \n    // set as enumerable, writable and configurable\n    document[REGISTER_ELEMENT] = function registerElement(type, options) {\n      upperType = type.toUpperCase();\n      if (setListener) {\n        // only first time document.registerElement is used\n        // we need to set this listener\n        // setting it by default might slow down for no reason\n        setListener = false;\n        if (MutationObserver) {\n          observer = (function(attached, detached){\n            function checkEmAll(list, callback) {\n              for (var i = 0, length = list.length; i < length; callback(list[i++])){}\n            }\n            return new MutationObserver(function (records) {\n              for (var\n                current, node, newValue,\n                i = 0, length = records.length; i < length; i++\n              ) {\n                current = records[i];\n                if (current.type === 'childList') {\n                  checkEmAll(current.addedNodes, attached);\n                  checkEmAll(current.removedNodes, detached);\n                } else {\n                  node = current.target;\n                  if (notFromInnerHTMLHelper &&\n                      node[ATTRIBUTE_CHANGED_CALLBACK] &&\n                      current.attributeName !== 'style') {\n                    newValue = getAttribute.call(node, current.attributeName);\n                    if (newValue !== current.oldValue) {\n                      node[ATTRIBUTE_CHANGED_CALLBACK](\n                        current.attributeName,\n                        current.oldValue,\n                        newValue\n                      );\n                    }\n                  }\n                }\n              }\n            });\n          }(executeAction(ATTACHED), executeAction(DETACHED)));\n          observe = function (node) {\n            observer.observe(\n              node,\n              {\n                childList: true,\n                subtree: true\n              }\n            );\n            return node;\n          };\n          observe(document);\n          if (attachShadow) {\n            HTMLElementPrototype.attachShadow = function () {\n              return observe(attachShadow.apply(this, arguments));\n            };\n          }\n        } else {\n          asapQueue = [];\n          document[ADD_EVENT_LISTENER]('DOMNodeInserted', onDOMNode(ATTACHED));\n          document[ADD_EVENT_LISTENER]('DOMNodeRemoved', onDOMNode(DETACHED));\n        }\n  \n        document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED, onReadyStateChange);\n        document[ADD_EVENT_LISTENER]('readystatechange', onReadyStateChange);\n  \n        HTMLElementPrototype.cloneNode = function (deep) {\n          var\n            node = cloneNode.call(this, !!deep),\n            i = getTypeIndex(node)\n          ;\n          if (-1 < i) patch(node, protos[i]);\n          if (deep && query.length) loopAndSetup(node.querySelectorAll(query));\n          return node;\n        };\n      }\n  \n      if (justSetup) return (justSetup = false);\n  \n      if (-2 < (\n        indexOf.call(types, PREFIX_IS + upperType) +\n        indexOf.call(types, PREFIX_TAG + upperType)\n      )) {\n        throwTypeError(type);\n      }\n  \n      if (!validName.test(upperType) || -1 < indexOf.call(invalidNames, upperType)) {\n        throw new Error('The type ' + type + ' is invalid');\n      }\n  \n      var\n        constructor = function () {\n          return extending ?\n            document.createElement(nodeName, upperType) :\n            document.createElement(nodeName);\n        },\n        opt = options || OP,\n        extending = hOP.call(opt, EXTENDS),\n        nodeName = extending ? options[EXTENDS].toUpperCase() : upperType,\n        upperType,\n        i\n      ;\n  \n      if (extending && -1 < (\n        indexOf.call(types, PREFIX_TAG + nodeName)\n      )) {\n        throwTypeError(nodeName);\n      }\n  \n      i = types.push((extending ? PREFIX_IS : PREFIX_TAG) + upperType) - 1;\n  \n      query = query.concat(\n        query.length ? ',' : '',\n        extending ? nodeName + '[is=\"' + type.toLowerCase() + '\"]' : nodeName\n      );\n  \n      constructor.prototype = (\n        protos[i] = hOP.call(opt, 'prototype') ?\n          opt.prototype :\n          create(HTMLElementPrototype)\n      );\n  \n      if (query.length) loopAndVerify(\n        document.querySelectorAll(query),\n        ATTACHED\n      );\n  \n      return constructor;\n    };\n  \n    document.createElement = (patchedCreateElement = function (localName, typeExtension) {\n      var\n        is = getIs(typeExtension),\n        node = is ?\n          createElement.call(document, localName, secondArgument(is)) :\n          createElement.call(document, localName),\n        name = '' + localName,\n        i = indexOf.call(\n          types,\n          (is ? PREFIX_IS : PREFIX_TAG) +\n          (is || name).toUpperCase()\n        ),\n        setup = -1 < i\n      ;\n      if (is) {\n        node.setAttribute('is', is = is.toLowerCase());\n        if (setup) {\n          setup = isInQSA(name.toUpperCase(), is);\n        }\n      }\n      notFromInnerHTMLHelper = !document.createElement.innerHTMLHelper;\n      if (setup) patch(node, protos[i]);\n      return node;\n    });\n  \n  }\n  \n  function ASAP() {\n    var queue = asapQueue.splice(0, asapQueue.length);\n    asapTimer = 0;\n    while (queue.length) {\n      queue.shift().call(\n        null, queue.shift()\n      );\n    }\n  }\n  \n  function loopAndVerify(list, action) {\n    for (var i = 0, length = list.length; i < length; i++) {\n      verifyAndSetupAndAction(list[i], action);\n    }\n  }\n  \n  function loopAndSetup(list) {\n    for (var i = 0, length = list.length, node; i < length; i++) {\n      node = list[i];\n      patch(node, protos[getTypeIndex(node)]);\n    }\n  }\n  \n  function executeAction(action) {\n    return function (node) {\n      if (isValidNode(node)) {\n        verifyAndSetupAndAction(node, action);\n        if (query.length) loopAndVerify(\n          node.querySelectorAll(query),\n          action\n        );\n      }\n    };\n  }\n  \n  function getTypeIndex(target) {\n    var\n      is = getAttribute.call(target, 'is'),\n      nodeName = target.nodeName.toUpperCase(),\n      i = indexOf.call(\n        types,\n        is ?\n            PREFIX_IS + is.toUpperCase() :\n            PREFIX_TAG + nodeName\n      )\n    ;\n    return is && -1 < i && !isInQSA(nodeName, is) ? -1 : i;\n  }\n  \n  function isInQSA(name, type) {\n    return -1 < query.indexOf(name + '[is=\"' + type + '\"]');\n  }\n  \n  function onDOMAttrModified(e) {\n    var\n      node = e.currentTarget,\n      attrChange = e.attrChange,\n      attrName = e.attrName,\n      target = e.target,\n      addition = e[ADDITION] || 2,\n      removal = e[REMOVAL] || 3\n    ;\n    if (notFromInnerHTMLHelper &&\n        (!target || target === node) &&\n        node[ATTRIBUTE_CHANGED_CALLBACK] &&\n        attrName !== 'style' && (\n          e.prevValue !== e.newValue ||\n          // IE9, IE10, and Opera 12 gotcha\n          e.newValue === '' && (\n            attrChange === addition ||\n            attrChange === removal\n          )\n    )) {\n      node[ATTRIBUTE_CHANGED_CALLBACK](\n        attrName,\n        attrChange === addition ? null : e.prevValue,\n        attrChange === removal ? null : e.newValue\n      );\n    }\n  }\n  \n  function onDOMNode(action) {\n    var executor = executeAction(action);\n    return function (e) {\n      asapQueue.push(executor, e.target);\n      if (asapTimer) clearTimeout(asapTimer);\n      asapTimer = setTimeout(ASAP, 1);\n    };\n  }\n  \n  function onReadyStateChange(e) {\n    if (dropDomContentLoaded) {\n      dropDomContentLoaded = false;\n      e.currentTarget.removeEventListener(DOM_CONTENT_LOADED, onReadyStateChange);\n    }\n    if (query.length) loopAndVerify(\n      (e.target || document).querySelectorAll(query),\n      e.detail === DETACHED ? DETACHED : ATTACHED\n    );\n    if (IE8) purge();\n  }\n  \n  function patchedSetAttribute(name, value) {\n    // jshint validthis:true\n    var self = this;\n    setAttribute.call(self, name, value);\n    onSubtreeModified.call(self, {target: self});\n  }\n  \n  function setupNode(node, proto) {\n    setPrototype(node, proto);\n    if (observer) {\n      observer.observe(node, attributesObserver);\n    } else {\n      if (doesNotSupportDOMAttrModified) {\n        node.setAttribute = patchedSetAttribute;\n        node[EXPANDO_UID] = getAttributesMirror(node);\n        node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED, onSubtreeModified);\n      }\n      node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED, onDOMAttrModified);\n    }\n    if (node[CREATED_CALLBACK] && notFromInnerHTMLHelper) {\n      node.created = true;\n      node[CREATED_CALLBACK]();\n      node.created = false;\n    }\n  }\n  \n  function purge() {\n    for (var\n      node,\n      i = 0,\n      length = targets.length;\n      i < length; i++\n    ) {\n      node = targets[i];\n      if (!documentElement.contains(node)) {\n        length--;\n        targets.splice(i--, 1);\n        verifyAndSetupAndAction(node, DETACHED);\n      }\n    }\n  }\n  \n  function throwTypeError(type) {\n    throw new Error('A ' + type + ' type is already registered');\n  }\n  \n  function verifyAndSetupAndAction(node, action) {\n    var\n      fn,\n      i = getTypeIndex(node)\n    ;\n    if (-1 < i) {\n      patchIfNotAlready(node, protos[i]);\n      i = 0;\n      if (action === ATTACHED && !node[ATTACHED]) {\n        node[DETACHED] = false;\n        node[ATTACHED] = true;\n        i = 1;\n        if (IE8 && indexOf.call(targets, node) < 0) {\n          targets.push(node);\n        }\n      } else if (action === DETACHED && !node[DETACHED]) {\n        node[ATTACHED] = false;\n        node[DETACHED] = true;\n        i = 1;\n      }\n      if (i && (fn = node[action + CALLBACK])) fn.call(node);\n    }\n  }\n  \n  \n  \n  // V1 in da House!\n  function CustomElementRegistry() {}\n  \n  CustomElementRegistry.prototype = {\n    constructor: CustomElementRegistry,\n    // a workaround for the stubborn WebKit\n    define: usableCustomElements ?\n      function (name, Class, options) {\n        if (options) {\n          CERDefine(name, Class, options);\n        } else {\n          var NAME = name.toUpperCase();\n          constructors[NAME] = {\n            constructor: Class,\n            create: [NAME]\n          };\n          nodeNames.set(Class, NAME);\n          customElements.define(name, Class);\n        }\n      } :\n      CERDefine,\n    get: usableCustomElements ?\n      function (name) {\n        return customElements.get(name) || get(name);\n      } :\n      get,\n    whenDefined: usableCustomElements ?\n      function (name) {\n        return Promise.race([\n          customElements.whenDefined(name),\n          whenDefined(name)\n        ]);\n      } :\n      whenDefined\n  };\n  \n  function CERDefine(name, Class, options) {\n    var\n      is = options && options[EXTENDS] || '',\n      CProto = Class.prototype,\n      proto = create(CProto),\n      attributes = Class.observedAttributes || empty,\n      definition = {prototype: proto}\n    ;\n    // TODO: is this needed at all since it's inherited?\n    // defineProperty(proto, 'constructor', {value: Class});\n    safeProperty(proto, CREATED_CALLBACK, {\n        value: function () {\n          if (justCreated) justCreated = false;\n          else if (!this[DRECEV1]) {\n            this[DRECEV1] = true;\n            new Class(this);\n            if (CProto[CREATED_CALLBACK])\n              CProto[CREATED_CALLBACK].call(this);\n            var info = constructors[nodeNames.get(Class)];\n            if (!usableCustomElements || info.create.length > 1) {\n              notifyAttributes(this);\n            }\n          }\n      }\n    });\n    safeProperty(proto, ATTRIBUTE_CHANGED_CALLBACK, {\n      value: function (name) {\n        if (-1 < indexOf.call(attributes, name))\n          CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this, arguments);\n      }\n    });\n    if (CProto[CONNECTED_CALLBACK]) {\n      safeProperty(proto, ATTACHED_CALLBACK, {\n        value: CProto[CONNECTED_CALLBACK]\n      });\n    }\n    if (CProto[DISCONNECTED_CALLBACK]) {\n      safeProperty(proto, DETACHED_CALLBACK, {\n        value: CProto[DISCONNECTED_CALLBACK]\n      });\n    }\n    if (is) definition[EXTENDS] = is;\n    name = name.toUpperCase();\n    constructors[name] = {\n      constructor: Class,\n      create: is ? [is, secondArgument(name)] : [name]\n    };\n    nodeNames.set(Class, name);\n    document[REGISTER_ELEMENT](name.toLowerCase(), definition);\n    whenDefined(name);\n    waitingList[name].r();\n  }\n  \n  function get(name) {\n    var info = constructors[name.toUpperCase()];\n    return info && info.constructor;\n  }\n  \n  function getIs(options) {\n    return typeof options === 'string' ?\n        options : (options && options.is || '');\n  }\n  \n  function notifyAttributes(self) {\n    var\n      callback = self[ATTRIBUTE_CHANGED_CALLBACK],\n      attributes = callback ? self.attributes : empty,\n      i = attributes.length,\n      attribute\n    ;\n    while (i--) {\n      attribute =  attributes[i]; // || attributes.item(i);\n      callback.call(\n        self,\n        attribute.name || attribute.nodeName,\n        null,\n        attribute.value || attribute.nodeValue\n      );\n    }\n  }\n  \n  function whenDefined(name) {\n    name = name.toUpperCase();\n    if (!(name in waitingList)) {\n      waitingList[name] = {};\n      waitingList[name].p = new Promise(function (resolve) {\n        waitingList[name].r = resolve;\n      });\n    }\n    return waitingList[name].p;\n  }\n  \n  function polyfillV1() {\n    if (customElements) delete window.customElements;\n    defineProperty(window, 'customElements', {\n      configurable: true,\n      value: new CustomElementRegistry()\n    });\n    defineProperty(window, 'CustomElementRegistry', {\n      configurable: true,\n      value: CustomElementRegistry\n    });\n    for (var\n      patchClass = function (name) {\n        var Class = window[name];\n        if (Class) {\n          window[name] = function CustomElementsV1(self) {\n            var info, isNative;\n            if (!self) self = this;\n            if (!self[DRECEV1]) {\n              justCreated = true;\n              info = constructors[nodeNames.get(self.constructor)];\n              isNative = usableCustomElements && info.create.length === 1;\n              self = isNative ?\n                Reflect.construct(Class, empty, info.constructor) :\n                document.createElement.apply(document, info.create);\n              self[DRECEV1] = true;\n              justCreated = false;\n              if (!isNative) notifyAttributes(self);\n            }\n            return self;\n          };\n          window[name].prototype = Class.prototype;\n          try {\n            Class.prototype.constructor = window[name];\n          } catch(WebKit) {\n            fixGetClass = true;\n            defineProperty(Class, DRECEV1, {value: window[name]});\n          }\n        }\n      },\n      Classes = htmlClass.get(/^HTML[A-Z]*[a-z]/),\n      i = Classes.length;\n      i--;\n      patchClass(Classes[i])\n    ) {}\n    (document.createElement = function (name, options) {\n      var is = getIs(options);\n      return is ?\n        patchedCreateElement.call(this, name, secondArgument(is)) :\n        patchedCreateElement.call(this, name);\n    });\n    if (!V0) {\n      justSetup = true;\n      document[REGISTER_ELEMENT]('');\n    }\n  }\n  \n  // if customElements is not there at all\n  if (!customElements || polyfill === 'force') polyfillV1();\n  else {\n    // if available test extends work as expected\n    try {\n      (function (DRE, options, name) {\n        options[EXTENDS] = 'a';\n        DRE.prototype = create(HTMLAnchorElement.prototype);\n        DRE.prototype.constructor = DRE;\n        window.customElements.define(name, DRE, options);\n        if (\n          getAttribute.call(document.createElement('a', {is: name}), 'is') !== name ||\n          (usableCustomElements && getAttribute.call(new DRE(), 'is') !== name)\n        ) {\n          throw options;\n        }\n      }(\n        function DRE() {\n          return Reflect.construct(HTMLAnchorElement, [], DRE);\n        },\n        {},\n        'document-register-element-a'\n      ));\n    } catch(o_O) {\n      // or force the polyfill if not\n      // and keep internal original reference\n      polyfillV1();\n    }\n  }\n  \n  try {\n    createElement.call(document, 'a', 'a');\n  } catch(FireFox) {\n    secondArgument = function (is) {\n      return {is: is.toLowerCase()};\n    };\n  }\n  \n}\n\nexports.installCustomElements = installCustomElements;\n\n","'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid an promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid an promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nmodule.exports = Promise;\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {internalListenImplementation} from './event-helper-listen';\nimport {parseJson} from './json';\n\n\n/** @const */\nconst AMP_MESSAGE_PREFIX = 'amp-';\nexport const CONSTANTS = {\n  responseTypeSuffix: '-result',\n  messageIdFieldName: 'messageId',\n  payloadFieldName: 'payload',\n  contentFieldName: 'content',\n};\n\n/** @enum {string} */\nexport const MessageType = {\n  // For amp-ad\n  SEND_EMBED_STATE: 'send-embed-state',\n  EMBED_STATE: 'embed-state',\n  SEND_EMBED_CONTEXT: 'send-embed-context',\n  EMBED_CONTEXT: 'embed-context',\n  SEND_INTERSECTIONS: 'send-intersections',\n  INTERSECTION: 'intersection',\n  EMBED_SIZE: 'embed-size',\n  EMBED_SIZE_CHANGED: 'embed-size-changed',\n  EMBED_SIZE_DENIED: 'embed-size-denied',\n  NO_CONTENT: 'no-content',\n  GET_HTML: 'get-html',\n  GET_CONSENT_STATE: 'get-consent-state',\n\n  // For the frame to be placed in full overlay mode for lightboxes\n  FULL_OVERLAY_FRAME: 'full-overlay-frame',\n  FULL_OVERLAY_FRAME_RESPONSE: 'full-overlay-frame-response',\n  CANCEL_FULL_OVERLAY_FRAME: 'cancel-full-overlay-frame',\n  CANCEL_FULL_OVERLAY_FRAME_RESPONSE: 'cancel-full-overlay-frame-response',\n\n  // For amp-inabox\n  SEND_POSITIONS: 'send-positions',\n  POSITION: 'position',\n\n  // For amp-analytics' iframe-transport\n  SEND_IFRAME_TRANSPORT_EVENTS: 'send-iframe-transport-events',\n  IFRAME_TRANSPORT_EVENTS: 'iframe-transport-events',\n  IFRAME_TRANSPORT_RESPONSE: 'iframe-transport-response',\n\n  // For user-error-in-iframe\n  USER_ERROR_IN_IFRAME: 'user-error-in-iframe',\n};\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n\n/**\n * Serialize an AMP post message. Output looks like:\n * 'amp-011481323099490{\"type\":\"position\",\"sentinel\":\"12345\",\"foo\":\"bar\"}'\n * @param {string} type\n * @param {string} sentinel\n * @param {JsonObject=} data\n * @param {?string=} rtvVersion\n * @return {string}\n */\nexport function serializeMessage(type, sentinel, data = dict(),\n  rtvVersion = null) {\n  // TODO: consider wrap the data in a \"data\" field. { type, sentinal, data }\n  const message = data;\n  message['type'] = type;\n  message['sentinel'] = sentinel;\n  return AMP_MESSAGE_PREFIX + (rtvVersion || '') + JSON.stringify(message);\n}\n\n\n/**\n * Deserialize an AMP post message.\n * Returns null if it's not valid AMP message format.\n *\n * @param {*} message\n * @return {?JsonObject|undefined}\n */\nexport function deserializeMessage(message) {\n  if (!isAmpMessage(message)) {\n    return null;\n  }\n  const startPos = message.indexOf('{');\n  dev().assert(startPos != -1, 'JSON missing in %s', message);\n  try {\n    return parseJson(message.substr(startPos));\n  } catch (e) {\n    dev().error('MESSAGING', 'Failed to parse message: ' + message, e);\n    return null;\n  }\n}\n\n\n/**\n *  Returns true if message looks like it is an AMP postMessage\n *  @param {*} message\n *  @return {boolean}\n */\nexport function isAmpMessage(message) {\n  return (typeof message == 'string' &&\n      message.indexOf(AMP_MESSAGE_PREFIX) == 0 &&\n      message.indexOf('{') != -1);\n}\n\n/** @typedef {{creativeId: string, message: string}} */\nexport let IframeTransportEvent;\n// An event, and the transport ID of the amp-analytics tags that\n// generated it. For instance if the creative with transport\n// ID 2 sends \"hi\", then an IframeTransportEvent would look like:\n// { creativeId: \"2\", message: \"hi\" }\n// If the creative with transport ID 2 sent that, and also sent \"hello\",\n// and the creative with transport ID 3 sends \"goodbye\" then an *array* of 3\n// AmpAnalyticsIframeTransportEvent would be sent to the 3p frame like so:\n// [\n//   { creativeId: \"2\", message: \"hi\" }, // An AmpAnalyticsIframeTransportEvent\n//   { creativeId: \"2\", message: \"hello\" }, // Another\n//   { creativeId: \"3\", message: \"goodbye\" } // And another\n// ]\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex = typeof env['thirdPartyFrameRegex'] == 'string' ?\n  new RegExp(env['thirdPartyFrameRegex']) : env['thirdPartyFrameRegex'];\n\nconst cdnProxyRegex = typeof env['cdnProxyRegex'] == 'string' ?\n  new RegExp(env['cdnProxyRegex']) : env['cdnProxyRegex'];\n\n/** @type {!Object<string, string|boolean|RegExp>} */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex: thirdPartyFrameRegex || /^d-\\d+\\.ampproject\\.net$/,\n  cdn: env['cdnUrl'] || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex: cdnProxyRegex ||\n      /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting: env['errorReportingUrl'] ||\n      'https://amp-error-reporting.appspot.com/r',\n  localDev: env['localDev'] || false,\n};\n\nexport const config = {\n  urls,\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {endsWith} from './string';\nimport {\n  isProxyOrigin,\n  parseUrlDeprecated,\n  tryDecodeUriComponent,\n} from './url';\nimport {urls} from './config';\n\n\n/**\n * Returns the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * Returns the cookie's value or `null`.\n *\n * @param {!Window} win\n * @param {string} name\n * @return {?string}\n */\nexport function getCookie(win, name) {\n  const cookieString = tryGetDocumentCookieNoInline(win);\n  if (!cookieString) {\n    return null;\n  }\n  const cookies = cookieString.split(';');\n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i].trim();\n    const eq = cookie.indexOf('=');\n    if (eq == -1) {\n      continue;\n    }\n    if (tryDecodeUriComponent(cookie.substring(0, eq).trim()) == name) {\n      const value = cookie.substring(eq + 1).trim();\n      return tryDecodeUriComponent(value, value);\n    }\n  }\n  return null;\n}\n\n/**\n * This method should not be inlined to prevent TryCatch deoptimization.\n * NoInline keyword at the end of function name also prevents Closure compiler\n * from inlining the function.\n * @param {!Window} win\n * @return {string}\n */\nfunction tryGetDocumentCookieNoInline(win) {\n  try {\n    return win.document.cookie;\n  } catch (e) {\n    // Act as if no cookie is available. Exceptions can be thrown when\n    // AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n    return '';\n  }\n}\n\n/**\n * Sets the value of the cookie. The cookie access is restricted and must\n * go through the privacy review. Before using this method please file a\n * GitHub issue with \"Privacy Review\" label.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {{\n *   highestAvailableDomain:(boolean|undefined),\n *   domain:(string|undefined)\n * }=} opt_options\n *     - highestAvailableDomain: If true, set the cookie at the widest domain\n *       scope allowed by the browser. E.g. on example.com if we are currently\n *       on www.example.com.\n *     - domain: Explicit domain to set.\n *     - allowOnProxyOrigin: Allow setting a cookie on the AMP Cache.\n */\nexport function setCookie(win, name, value, expirationTime, opt_options) {\n  checkOriginForSettingCookie(win, opt_options, name);\n  if (opt_options && opt_options.highestAvailableDomain) {\n    const parts = win.location.hostname.split('.');\n    let domain = parts[parts.length - 1];\n    for (let i = parts.length - 2; i >= 0; i--) {\n      domain = parts[i] + '.' + domain;\n      trySetCookie(win, name, value, expirationTime, domain);\n      if (getCookie(win, name) == value) {\n        return;\n      }\n    }\n  }\n  let domain = undefined;\n  if (opt_options && opt_options.domain) {\n    domain = opt_options.domain;\n  }\n  trySetCookie(win, name, value, expirationTime, domain);\n}\n\n/**\n * Attempt to set a cookie with the given params.\n *\n * @param {!Window} win\n * @param {string} name\n * @param {string} value\n * @param {time} expirationTime\n * @param {string|undefined} domain\n */\nfunction trySetCookie(win, name, value, expirationTime, domain) {\n  // We do not allow setting cookies on the domain that contains both\n  // the cdn. and www. hosts.\n  if (domain == 'ampproject.org') {\n    // Actively delete them.\n    value = 'delete';\n    expirationTime = 0;\n  }\n  const cookie = encodeURIComponent(name) + '=' +\n      encodeURIComponent(value) +\n      '; path=/' +\n      (domain ? '; domain=' + domain : '') +\n      '; expires=' + new Date(expirationTime).toUTCString();\n  try {\n    win.document.cookie = cookie;\n  } catch (ignore) {\n    // Do not throw if setting the cookie failed Exceptions can be thrown\n    // when AMP docs are opened on origins that do not allow setting\n    // cookies such as null origins.\n  }\n}\n\n/**\n * Throws if a given cookie should not be set on the given origin.\n * This is a defense-in-depth. Callers should never run into this.\n *\n * @param {!Window} win\n * @param {!Object|undefined} options\n * @param {string} name For the error message.\n */\nfunction checkOriginForSettingCookie(win, options, name) {\n  if (options && options.allowOnProxyOrigin) {\n    return;\n  }\n  if (isProxyOrigin(win.location.href)) {\n    throw new Error('Should never attempt to set cookie on proxy origin: '\n        + name);\n  }\n\n  const current = parseUrlDeprecated(win.location.href).hostname.toLowerCase();\n  const proxy = parseUrlDeprecated(urls.cdn).hostname.toLowerCase();\n  if (current == proxy || endsWith(current, '.' + proxy)) {\n    throw new Error('Should never attempt to set cookie on proxy origin.'\n        + ' (in depth check): ' + name);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Deferred} from './utils/promise';\nimport {cssEscape} from '../third_party/css-escape/css-escape';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {startsWith} from './string';\nimport {toWin} from './types';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_PROMISE =\n    '__AMP_UPG_PRM';\n\n/** @const {string} */\nexport const UPGRADE_TO_CUSTOMELEMENT_RESOLVER =\n    '__AMP_UPG_RES';\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  /** @const {!Window} */\n  const win = toWin(parent.ownerDocument.defaultView);\n  if (win.MutationObserver) {\n    /** @const {MutationObserver} */\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    /** @const {number} */\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise(resolve => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available.\n * Will be deprecated soon; use {@link AmpDoc#whenBodyAvailable} or\n * @{link DocumentState#onBodyAvailable} instead.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBody(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyPromise(doc) {\n  return new Promise(resolve => {\n    waitForBody(doc, resolve);\n  });\n}\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node} after\n */\nexport function insertAfterOrAtStart(root, element, after) {\n  const before = after ? after.nextSibling : root.firstChild;\n  root.insertBefore(element, before);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  for (n = node; !!n.parentNode; n = n.parentNode) {}\n  return n;\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  if (element.closest) {\n    return element.closest(tagName);\n  }\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Finds the closest element with the specified selector from this element\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestBySelector(element, selector) {\n  if (element.closest) {\n    return element.closest(selector);\n  }\n\n  return closest(element, el => {\n    return matches(el, selector);\n  });\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher = el.matches ||\n      el.webkitMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  let elements;\n  // getElementsByTagName() is not supported on ShadowRoot.\n  if (typeof element.getElementsByTagName === 'function') {\n    elements = element.getElementsByTagName(tagName);\n  } else {\n    elements = element./*OK*/querySelectorAll(tagName);\n  }\n  return (elements && elements[0]) || null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (let child = parent.firstElementChild; child;\n    child = child.nextElementSibling) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (let child = parent.lastElementChild; child;\n    child = child.previousElementSibling) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child;\n    child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element} parent\n * @return {boolean}\n */\nfunction isScopeSelectorSupported(parent) {\n  const doc = parent.ownerDocument;\n  try {\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  return scopedQuerySelector/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  return lastChildElement(parent, el => {\n    return el.hasAttribute(attr);\n  });\n}\n\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> [${attr}]`);\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  return scopedQuerySelector/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  return scopedQuerySelectorAll/*OK*/(parent, `> ${tagName}`);\n}\n\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {?Element}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelector(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const element = root./*OK*/querySelector(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return element;\n}\n\n\n/**\n * Finds the every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (scopeSelectorSupported == null) {\n    scopeSelectorSupported = isScopeSelectorSupported(root);\n  }\n  if (scopeSelectorSupported) {\n    return root./*OK*/querySelectorAll(`:scope ${selector}`);\n  }\n\n  // Only IE.\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const elements = root./*OK*/querySelectorAll(`.${unique} ${selector}`);\n  root.classList.remove(unique);\n  return elements;\n}\n\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!Element} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(element, opt_computeParamNameFunc,\n  opt_paramPattern) {\n  const computeParamNameFunc = opt_computeParamNameFunc || (key => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern ? opt_paramPattern : /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while ((currentElement = currentElement.parentNode) &&\n            currentElement != opt_stopNode);\n  return false;\n}\n\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (let ancestor = child.parentElement; ancestor;\n    ancestor = ancestor.parentElement) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, el => {\n    return el.tagName == tagName;\n  });\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like. Some collections like NodeList are\n * lazily evaluated in some browsers, and accessing `length` forces full\n * evaluation. We can improve performance by iterating until an element is\n * `undefined` to avoid checking the `length` property.\n * Test cases: https://jsperf.com/iterating-over-collections-of-elements\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  for (let i = 0, value; (value = iterable[i]) !== undefined; i++) {\n    cb(value, i);\n  }\n}\n\n/**\n * This method wraps around window's open method. It first tries to execute\n * `open` call with the provided target and if it fails, it retries the call\n * with the `_top` target. This is necessary given that in some embedding\n * scenarios, such as iOS' WKWebView, navigation to `_blank` and other targets\n * is blocked by default.\n *\n * @param {!Window} win\n * @param {string} url\n * @param {string} target\n * @param {string=} opt_features\n * @return {?Window}\n */\nexport function openWindowDialog(win, url, target, opt_features) {\n  // Try first with the specified target. If we're inside the WKWebView or\n  // a similar environments, this method is expected to fail by default for\n  // all targets except `_top`.\n  let res;\n  try {\n    res = win.open(url, target, opt_features);\n  } catch (e) {\n    dev().error('DOM', 'Failed to open url on target: ', target, e);\n  }\n\n  // Then try with `_top` target.\n  if (!res && target != '_top') {\n    res = win.open(url, '_top');\n  }\n  return res;\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n            element.getAttribute('type').toUpperCase() == 'APPLICATION/JSON';\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return element.tagName == 'SCRIPT' &&\n      element.getAttribute('type').toUpperCase() == 'APPLICATION/LD+JSON';\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir = doc.body.getAttribute('dir')\n                 || doc.documentElement.getAttribute('dir')\n                 || 'ltr';\n  return dir == 'rtl';\n}\n\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n */\nexport function escapeCssSelectorIdent(ident) {\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  dev().assert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Determines if this element is an AMP element\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isAmpElement(element) {\n  const tag = element.tagName;\n  // Use prefix to recognize AMP element. This is necessary because stub\n  // may not be attached yet.\n  return startsWith(tag, 'AMP-') &&\n      // Some \"amp-*\" elements are not really AMP elements. :smh:\n      !(tag == 'AMP-STICKY-AD-TOP-PADDING' || tag == 'AMP-BODY');\n}\n\n/**\n * Return a promise that resolve when an AMP element upgrade from HTMLElement\n * to CustomElement\n * @param {!Element} element\n * @return {!Promise<!Element>}\n */\nexport function whenUpgradedToCustomElement(element) {\n  dev().assert(isAmpElement(element), 'element is not AmpElement');\n  if (element.createdCallback) {\n    // Element already is CustomElement;\n    return Promise.resolve(element);\n  }\n  // If Element is still HTMLElement, wait for it to upgrade to customElement\n  // Note: use pure string to avoid obfuscation between versions.\n  if (!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE]) {\n    const deferred = new Deferred();\n    element[UPGRADE_TO_CUSTOMELEMENT_PROMISE] = deferred.promise;\n    element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER] = deferred.resolve;\n\n  }\n\n  return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE];\n}\n\n/**\n * Replacement for `Element.requestFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/requestFullscreen\n * @param {!Element} element\n */\nexport function fullscreenEnter(element) {\n  const requestFs = element.requestFullscreen\n   || element.requestFullScreen\n   || element.webkitRequestFullscreen\n   || element.webkitRequestFullScreen\n   || element.webkitEnterFullscreen\n   || element.webkitEnterFullScreen\n   || element.msRequestFullscreen\n   || element.msRequestFullScreen\n   || element.mozRequestFullscreen\n   || element.mozRequestFullScreen;\n  if (requestFs) {\n    requestFs.call(element);\n  }\n}\n\n/**\n * Replacement for `Document.exitFullscreen()` method.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/exitFullscreen\n * @param {!Element} element\n */\nexport function fullscreenExit(element) {\n  let exitFs = element.cancelFullScreen\n               || element.exitFullscreen\n               || element.exitFullScreen\n               || element.webkitExitFullscreen\n               || element.webkitExitFullScreen\n               || element.webkitCancelFullScreen\n               || element.mozCancelFullScreen\n               || element.msExitFullscreen;\n  if (exitFs) {\n    exitFs.call(element);\n    return;\n  }\n  if (element.ownerDocument) {\n    exitFs = element.ownerDocument.cancelFullScreen\n             || element.ownerDocument.exitFullscreen\n             || element.ownerDocument.exitFullScreen\n             || element.ownerDocument.webkitExitFullscreen\n             || element.ownerDocument.webkitExitFullScreen\n             || element.ownerDocument.webkitCancelFullScreen\n             || element.ownerDocument.mozCancelFullScreen\n             || element.ownerDocument.msExitFullscreen;\n  }\n  if (exitFs) {\n    exitFs.call(element.ownerDocument);\n    return;\n  }\n}\n\n\n/**\n * Replacement for `Document.fullscreenElement`.\n * https://developer.mozilla.org/en-US/docs/Web/API/Document/fullscreenElement\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isFullscreenElement(element) {\n  const isFullscreen = element.webkitDisplayingFullscreen;\n  if (isFullscreen) {\n    return true;\n  }\n  if (element.ownerDocument) {\n    const fullscreenElement = element.ownerDocument.fullscreenElement\n             || element.ownerDocument.webkitFullscreenElement\n             || element.ownerDocument.mozFullScreenElement\n             || element.webkitCurrentFullScreenElement;\n    if (fullscreenElement == element) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!Element} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as dom from './dom';\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getService,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n  getTopWindow,\n} from './service';\nimport {toWin} from './types';\nimport {user} from './log';\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, extension, opt_element) {\n  return getElementServiceIfAvailable(win, id, extension, opt_element).then(\n      service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(win, id, extension, opt_element) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(win, id, extension, opt_element);\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  // Set in custom-element.js\n  if (!win.ampExtendedElements) {\n    return false;\n  }\n  return !!win.ampExtendedElements[elementName];\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(elementOrAmpDoc, id, extension,\n  opt_element) {\n  return getElementServiceIfAvailableForDoc(\n      elementOrAmpDoc, id, extension, opt_element)\n      .then(service => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  elementOrAmpDoc, id, extension, opt_element) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const s = getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n\n  return ampdoc.whenBodyAvailable()\n      .then(() => waitForExtensionIfPresent(\n          ampdoc.win, extension,\n          ampdoc.getHeadNode()))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNullForDoc(elementOrAmpDoc, id);\n        } else if (isElementScheduled(ampdoc.win, extension)) {\n          return getServicePromiseForDoc(elementOrAmpDoc, id);\n        }\n        return null;\n      });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given node, if it exists. Otherwise, falls back to ampdoc scope IFF\n * the given node is in the top-level window.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  elementOrAmpDoc, id, extension) {\n  const s = getExistingServiceForDocInEmbedScope(elementOrAmpDoc, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  // Return embed-scope element service promise if scheduled.\n  if (elementOrAmpDoc.nodeType) {\n    const win = toWin(elementOrAmpDoc.ownerDocument.defaultView);\n    const topWin = getTopWindow(win);\n    // In embeds, doc-scope services are window-scope. But make sure to\n    // only do this for embeds (not the top window), otherwise we'd grab\n    // a promise from the wrong service holder which would never resolve.\n    if (win !== topWin) {\n      return getElementServicePromiseOrNull(win, id, extension);\n    } else {\n      // Fallback to ampdoc IFF the given node is _not_ FIE.\n      return getElementServiceIfAvailableForDoc(elementOrAmpDoc, id, extension);\n    }\n  }\n  return /** @type {!Promise<?Object>} */ (Promise.resolve(null));\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (user().assert(service,\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, extension, extension, extension));\n}\n\n/**\n * Get list of all the extension JS files\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Array<string>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null\n  if (!head) {\n    return [];\n  }\n  const scripts = [];\n  const list = head.querySelectorAll('script[custom-element]');\n  for (let i = 0; i < list.length; i++) {\n    scripts.push(list[i].getAttribute('custom-element'));\n  }\n  return scripts;\n}\n\n/**\n * Waits for an extension if its script is present\n * @param {!Window} win\n * @param {string} extension\n * @param {HTMLHeadElement|Element|ShadowRoot} head\n * @return {!Promise}\n * @private\n */\nfunction waitForExtensionIfPresent(win, extension, head) {\n  /**\n   * If there is an extension script wait for it to load before trying\n   * to get the service. Prevents a race condition when everything but\n   * the extensions is in cache. If there is no script then it's either\n   * not present, or the service was defined by a test. In those cases\n   * we don't wait around for an extension that does not exist.\n   */\n\n  // TODO(jpettitt) investigate registerExtension to short circuit\n  // the dom call in extensionScriptsInNode()\n  if (!extensionScriptsInNode(head).includes(extension)) {\n    return Promise.resolve();\n  }\n\n  const extensions = getService(win, 'extensions');\n  return /** @type {!Promise<?Object>} */ (\n    extensions.waitForExtension(win, extension));\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(win, id, extension, opt_element) {\n  return dom.waitForBodyPromise(win.document)\n      .then(() => waitForExtensionIfPresent(win, extension, win.document.head))\n      .then(() => {\n        // If this service is provided by an element, then we can't depend on\n        // the service (they may not use the element).\n        if (opt_element) {\n          return getServicePromiseOrNull(win, id);\n        } else if (isElementScheduled(win, extension)) {\n          return getServicePromise(win, id);\n        }\n        return null;\n      });\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n  * Whether addEventListener supports options or only takes capture as a boolean\n  * @type {boolean|undefined}\n  * @visibleForTesting\n  */\nlet optsSupported;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n  opt_evtListenerOpts) {\n  let localElement = element;\n  let localListener = listener;\n  /**\n   * @type {?Function}\n   */\n  let wrapped;\n\n  wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  let capture = false;\n  if (opt_evtListenerOpts) {\n    capture = opt_evtListenerOpts.capture;\n  }\n  localElement.addEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(\n          eventType,\n          wrapped,\n          optsSupported ? opt_evtListenerOpts : capture\n      );\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n  * Resets the test for whether addEventListener supports options or not.\n  */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './event-helper-listen';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n        type, !!eventInit.bubbles, !!eventInit.cancelable, detail);\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_evtListenerOpts);\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(element, eventType, event => {\n    try {\n      localListener(event);\n    } finally {\n      // Ensure listener is GC'd\n      localListener = null;\n      unlisten();\n    }\n  }, opt_evtListenerOpts);\n  return unlisten;\n}\n\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(element, eventType, opt_evtListenerOpts,\n  opt_cancel) {\n  let unlisten;\n  const eventPromise = new Promise(resolve => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(eleOrWindow.complete || eleOrWindow.readyState == 'complete'\n      // If the passed in thing is a Window, infer loaded state from\n      //\n      || (eleOrWindow.document\n          && eleOrWindow.document.readyState == 'complete'));\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    const {tagName} = eleOrWindow;\n    if (tagName === 'AUDIO' || tagName === 'VIDEO') {\n      unlistenLoad = listenOnce(eleOrWindow, 'loadstart', resolve);\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // For elements, unlisten on error (don't for Windows).\n    if (tagName) {\n      unlistenError = listenOnce(eleOrWindow, 'error', reject);\n    }\n  });\n\n  return loadingPromise.then(() => {\n    if (unlistenError) {\n      unlistenError();\n    }\n    return eleOrWindow;\n  }, () => {\n    if (unlistenLoad) {\n      unlistenLoad();\n    }\n    failedToLoad(eleOrWindow);\n  });\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {getCookie, setCookie} from './cookies';\nimport {hasOwn} from './utils/object';\nimport {parseQueryString} from './url';\n\n/** @const {string} */\nconst COOKIE_NAME = 'AMP_EXP';\n\n/** @const {number} */\nconst COOKIE_MAX_AGE_DAYS = 180; // 6 month\n\n/** @const {time} */\nconst COOKIE_EXPIRATION_INTERVAL = COOKIE_MAX_AGE_DAYS * 24 * 60 * 60 * 1000;\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * @typedef {{\n *   isTrafficEligible: function(!Window):boolean,\n *   branches: !Array<string>\n * }}\n */\nexport let ExperimentInfo;\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!(win.AMP_CONFIG && win.AMP_CONFIG.canary);\n}\n\n/**\n * Returns binary type, e.g., canary, control, or production.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG && win.AMP_CONFIG.type ?\n    win.AMP_CONFIG.type : 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs to the cookie after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(win, experimentId, opt_on,\n  opt_transientExperiment) {\n  const currentlyOn = isExperimentOn(win, /*OK*/experimentId);\n  const on = !!(opt_on !== undefined ? opt_on : !currentlyOn);\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const cookieToggles = getExperimentTogglesFromCookie(win);\n      cookieToggles[experimentId] = on;\n      saveExperimentTogglesToCookie(win, cookieToggles);\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of the\n * cookieFlag or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = Object.create(null);\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read the default config of this build.\n  if (win.AMP_CONFIG) {\n    for (const experimentId in win.AMP_CONFIG) {\n      const frequency = win.AMP_CONFIG[experimentId];\n      if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n        toggles[experimentId] = Math.random() < frequency;\n      }\n    }\n  }\n  // Read document level override from meta tag.\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-doc-opt-in'])\n      && win.AMP_CONFIG['allow-doc-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-doc-opt-in'];\n    const meta =\n        win.document.head.querySelector('meta[name=\"amp-experiments-opt-in\"]');\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (let i = 0; i < optedInExperiments.length; i++) {\n        if (allowed.indexOf(optedInExperiments[i]) != -1) {\n          toggles[optedInExperiments[i]] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentTogglesFromCookie(win));\n\n  if (win.AMP_CONFIG\n      && Array.isArray(win.AMP_CONFIG['allow-url-opt-in'])\n      && win.AMP_CONFIG['allow-url-opt-in'].length > 0) {\n    const allowed = win.AMP_CONFIG['allow-url-opt-in'];\n    const hash = win.location.originalHash || win.location.hash;\n    const params = parseQueryString(hash);\n    for (let i = 0; i < allowed.length; i++) {\n      const param = params[`e-${allowed[i]}`];\n      if (param == '1') {\n        toggles[allowed[i]] = true;\n      }\n      if (param == '0') {\n        toggles[allowed[i]] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentTogglesFromCookie(win) {\n  const experimentCookie = getCookie(win, COOKIE_NAME);\n  const tokens = experimentCookie ? experimentCookie.split(/\\s*,\\s*/g) : [];\n\n  const toggles = Object.create(null);\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i].length == 0) {\n      continue;\n    }\n    if (tokens[i][0] == '-') {\n      toggles[tokens[i].substr(1)] = false;\n    } else {\n      toggles[tokens[i]] = true;\n    }\n  }\n\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentTogglesToCookie(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n\n  setCookie(win, COOKIE_NAME, experimentIds.join(','),\n      Date.now() + COOKIE_EXPIRATION_INTERVAL, {\n        // Set explicit domain, so the cookie gets send to sub domains.\n        domain: win.location.hostname,\n        allowOnProxyOrigin: true,\n      });\n}\n\n/**\n * See getExperimentTogglesFromCookie().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentToglesFromCookieForTesting(win) {\n  return getExperimentTogglesFromCookie(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  setCookie(win, COOKIE_NAME, '', 0, {\n    domain: win.location.hostname,\n  });\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return arr[Math.floor(rn * arr.length)] || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.experimentBranches[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Object<string, !ExperimentInfo>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.experimentBranches = win.experimentBranches || {};\n  const selectedExperiments = {};\n  for (const experimentName in experiments) {\n    // Skip experimentName if it is not a key of experiments object or if it\n    // has already been populated by some other property.\n    if (!hasOwn(experiments, experimentName)) {\n      continue;\n    }\n    if (hasOwn(win.experimentBranches, experimentName)) {\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n      continue;\n    }\n\n    if (!experiments[experimentName].isTrafficEligible ||\n        !experiments[experimentName].isTrafficEligible(win)) {\n      win.experimentBranches[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (!win.experimentBranches[experimentName] &&\n      isExperimentOn(win, /*OK*/experimentName)) {\n      const {branches} = experiments[experimentName];\n      win.experimentBranches[experimentName] = selectRandomItem(branches);\n      selectedExperiments[experimentName] =\n          win.experimentBranches[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.experimentBranches ? win.experimentBranches[experimentName] : null;\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.experimentBranches = win.experimentBranches || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.experimentBranches[experimentName] = branchId;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addAttributesToElement, closestBySelector} from './dom';\nimport {deserializeMessage, isAmpMessage} from './3p-frame-messaging';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {filterSplice} from './utils/array';\nimport {getData} from './event-helper';\nimport {parseUrlDeprecated} from './url';\nimport {setStyle} from './style';\nimport {tryParseJson} from './json';\n\n/**\n * Sentinel used to force unlistening after a iframe is detached.\n * @type {string}\n */\nconst UNLISTEN_SENTINEL = 'unlisten';\n\n/**\n * @typedef {{\n *   frame: !Element,\n *   events: !Object<string, !Array<function(!JsonObject)>>\n * }}\n */\nlet WindowEventsDef;\n\n/**\n * Returns a mapping from a URL's origin to an array of windows and their\n * listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {boolean=} opt_create create the mapping if it does not exist\n * @return {?Object<string, !Array<!WindowEventsDef>>}\n */\nfunction getListenFors(parentWin, opt_create) {\n  let {listeningFors} = parentWin;\n\n  if (!listeningFors && opt_create) {\n    listeningFors = parentWin.listeningFors = Object.create(null);\n  }\n  return listeningFors || null;\n}\n\n/**\n * Returns an array of WindowEventsDef that have had any listenFor listeners\n * registered for this sentinel.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {boolean=} opt_create create the array if it does not exist\n * @return {?Array<!WindowEventsDef>}\n */\nfunction getListenForSentinel(parentWin, sentinel, opt_create) {\n  const listeningFors = getListenFors(parentWin, opt_create);\n  if (!listeningFors) {\n    return listeningFors;\n  }\n\n  let listenSentinel = listeningFors[sentinel];\n  if (!listenSentinel && opt_create) {\n    listenSentinel = listeningFors[sentinel] = [];\n  }\n  return listenSentinel || null;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {!Element} iframe the iframe element who's context will trigger the\n *     event\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getOrCreateListenForEvents(parentWin, iframe, opt_is3P) {\n  const {origin} = parseUrlDeprecated(iframe.src);\n  const sentinel = getSentinel_(iframe, opt_is3P);\n  const listenSentinel = getListenForSentinel(parentWin, sentinel, true);\n\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    if (we.frame === iframe) {\n      windowEvents = we;\n      break;\n    }\n  }\n\n  if (!windowEvents) {\n    windowEvents = {\n      frame: iframe,\n      origin,\n      events: Object.create(null),\n    };\n    listenSentinel.push(windowEvents);\n  }\n\n  return windowEvents.events;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {string} origin the source window's origin\n * @param {?Window} triggerWin the window that triggered the event\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string)>>}\n */\nfunction getListenForEvents(parentWin, sentinel, origin, triggerWin) {\n  const listenSentinel = getListenForSentinel(parentWin, sentinel);\n\n  if (!listenSentinel) {\n    return listenSentinel;\n  }\n\n  // Find the entry for the frame.\n  // TODO(@nekodo): Add a WeakMap<Window, WindowEventsDef> cache to\n  //     speed up this process.\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    const {contentWindow} = we.frame;\n    if (!contentWindow) {\n      setTimeout(dropListenSentinel, 0, listenSentinel);\n    } else if (sentinel === 'amp') {\n      // A non-3P code path, origin must match.\n      if (we.origin === origin && contentWindow == triggerWin) {\n        windowEvents = we;\n        break;\n      }\n    } else if (triggerWin == contentWindow ||\n        isDescendantWindow(contentWindow, triggerWin)) {\n      // 3p code path, we may accept messages from nested frames.\n      windowEvents = we;\n      break;\n    }\n  }\n\n  return windowEvents ? windowEvents.events : null;\n}\n\n/**\n * Checks whether one window is a descendant of another by climbing\n * the parent chain.\n * @param {?Window} ancestor potential ancestor window\n * @param {?Window} descendant potential descendant window\n * @return {boolean}\n */\nfunction isDescendantWindow(ancestor, descendant) {\n  for (let win = descendant; win && win != win.parent; win = win.parent) {\n    if (win == ancestor) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Removes any listenFors registed on listenSentinel that do not have\n * a contentWindow (the frame was removed from the DOM tree).\n * @param {!Array<!WindowEventsDef>} listenSentinel\n */\nfunction dropListenSentinel(listenSentinel) {\n  const noopData = dict({'sentinel': UNLISTEN_SENTINEL});\n\n  for (let i = listenSentinel.length - 1; i >= 0; i--) {\n    const windowEvents = listenSentinel[i];\n\n    if (!windowEvents.frame.contentWindow) {\n      listenSentinel.splice(i, 1);\n\n      const {events} = windowEvents;\n      for (const name in events) {\n        // Splice here, so that each unlisten does not shift the array\n        events[name].splice(0, Infinity).forEach(event => {\n          event(noopData);\n        });\n      }\n    }\n  }\n}\n\n/**\n * Registers the global listenFor event listener if it has yet to be.\n * @param {?Window} parentWin\n */\nfunction registerGlobalListenerIfNeeded(parentWin) {\n  if (parentWin.listeningFors) {\n    return;\n  }\n  const listenForListener = function(event) {\n    if (!getData(event)) {\n      return;\n    }\n    const data = parseIfNeeded(getData(event));\n    if (!data || !data['sentinel']) {\n      return;\n    }\n\n    const listenForEvents = getListenForEvents(\n        parentWin,\n        data['sentinel'],\n        event.origin,\n        event.source\n    );\n    if (!listenForEvents) {\n      return;\n    }\n\n    let listeners = listenForEvents[data['type']];\n    if (!listeners) {\n      return;\n    }\n\n    // We slice to avoid issues with adding another listener or unlistening\n    // during iteration. We could move to a Doubly Linked List with\n    // backtracking, but that's overly complicated.\n    listeners = listeners.slice();\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i];\n      listener(data, event.source, event.origin);\n    }\n  };\n\n  parentWin.addEventListener('message', listenForListener);\n}\n\n/**\n * Allows listening for message from the iframe. Returns an unlisten\n * function to remove the listener.\n *\n * @param {?Element} iframe\n * @param {string} typeOfMessage\n * @param {?function(!JsonObject, !Window, string)} callback Called when a\n *     message of this type arrives for this iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @param {boolean=} opt_includingNestedWindows set to true if a messages from\n *     nested frames should also be accepted.\n * @return {!UnlistenDef}\n */\nexport function listenFor(\n  iframe, typeOfMessage, callback, opt_is3P, opt_includingNestedWindows) {\n  dev().assert(iframe.src, 'only iframes with src supported');\n  dev().assert(!iframe.parentNode, 'cannot register events on an attached ' +\n      'iframe. It will cause hair-pulling bugs like #2942');\n  dev().assert(callback);\n  const parentWin = iframe.ownerDocument.defaultView;\n\n  registerGlobalListenerIfNeeded(parentWin);\n\n  const listenForEvents = getOrCreateListenForEvents(\n      parentWin,\n      iframe,\n      opt_is3P\n  );\n\n\n  let events = listenForEvents[typeOfMessage] ||\n    (listenForEvents[typeOfMessage] = []);\n\n  let unlisten;\n  let listener = function(data, source, origin) {\n    // Exclude nested frames if necessary.\n    // Note that the source was already verified to be either the contentWindow\n    // of the iframe itself or a descendant window within it.\n    if (!opt_includingNestedWindows && source != iframe.contentWindow) {\n      return;\n    }\n\n    if (data.sentinel == UNLISTEN_SENTINEL) {\n      unlisten();\n      return;\n    }\n    callback(data, source, origin);\n  };\n\n  events.push(listener);\n\n  return unlisten = function() {\n    if (listener) {\n      const index = events.indexOf(listener);\n      if (index > -1) {\n        events.splice(index, 1);\n      }\n      // Make sure references to the unlisten function do not keep\n      // alive too much.\n      listener = null;\n      events = null;\n      callback = null;\n    }\n  };\n}\n\n/**\n * Returns a promise that resolves when one of given messages has been observed\n * for the first time. And remove listener for all other messages.\n * @param {!Element} iframe\n * @param {string|!Array<string>} typeOfMessages\n * @param {boolean=} opt_is3P\n * @return {!Promise<!{data: !JsonObject, source: !Window, origin: string}>}\n */\nexport function listenForOncePromise(iframe, typeOfMessages, opt_is3P) {\n  const unlistenList = [];\n  if (typeof typeOfMessages == 'string') {\n    typeOfMessages = [typeOfMessages];\n  }\n  return new Promise(resolve => {\n    for (let i = 0; i < typeOfMessages.length; i++) {\n      const message = typeOfMessages[i];\n      const unlisten = listenFor(iframe, message, (data, source, origin) => {\n        for (let i = 0; i < unlistenList.length; i++) {\n          unlistenList[i]();\n        }\n        resolve({data, source, origin});\n      }, opt_is3P);\n      unlistenList.push(unlisten);\n    }\n  });\n}\n\n/**\n * Posts a message to the iframe.\n * @param {!Element} iframe The iframe.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {string} targetOrigin origin of the target.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessage(iframe, type, object, targetOrigin, opt_is3P) {\n  postMessageToWindows(iframe,\n      [{win: iframe.contentWindow, origin: targetOrigin}], type, object,\n      opt_is3P);\n}\n\n/**\n * Posts an identical message to multiple target windows with the same\n * sentinel.\n * The message is serialized only once.\n * @param {!Element} iframe The iframe.\n * @param {!Array<{win: !Window, origin: string}>} targets to send the message\n *     to, pairs of window and its origin.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessageToWindows(iframe, targets, type, object, opt_is3P) {\n  if (!iframe.contentWindow) {\n    return;\n  }\n  object['type'] = type;\n  object['sentinel'] = getSentinel_(iframe, opt_is3P);\n  let payload = object;\n  if (opt_is3P) {\n    // Serialize ourselves because that is much faster in Chrome.\n    payload = 'amp-' + JSON.stringify(object);\n  }\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i];\n    target.win./*OK*/postMessage(payload, target.origin);\n  }\n}\n\n/**\n * Gets the sentinel string.\n * @param {!Element} iframe The iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {string} Sentinel string.\n * @private\n */\nfunction getSentinel_(iframe, opt_is3P) {\n  return opt_is3P ? iframe.getAttribute('data-amp-3p-sentinel') : 'amp';\n}\n\n/**\n * JSON parses event.data if it needs to be\n * @param {*} data\n * @return {?JsonObject} object message\n * @private\n * @visibleForTesting\n */\nexport function parseIfNeeded(data) {\n  if (typeof data == 'string') {\n    if (data.charAt(0) == '{') {\n      data = tryParseJson(data, e => {\n        dev().warn('IFRAME-HELPER',\n            'Postmessage could not be parsed. ' +\n            'Is it in a valid JSON format?', e);\n      }) || null;\n    } else if (isAmpMessage(data)) {\n      data = deserializeMessage(data);\n    } else {\n      data = null;\n    }\n  }\n  return /** @type {?JsonObject} */ (data);\n}\n\n\n\n/**\n * Manages a postMessage API for an iframe with a subscription message and\n * a way to broadcast messages to all subscribed windows, which\n * in turn must all be descendants of the contentWindow of the iframe.\n */\nexport class SubscriptionApi {\n  /**\n   * @param {!Element} iframe The iframe.\n   * @param {string} type Type of the subscription message.\n   * @param {boolean} is3p set to true if the iframe is 3p.\n   * @param {function(!JsonObject, !Window, string)} requestCallback Callback\n   *     invoked whenever a new window subscribes.\n   */\n  constructor(iframe, type, is3p, requestCallback) {\n    /** @private @const {!Element} */\n    this.iframe_ = iframe;\n    /** @private @const {boolean} */\n    this.is3p_ = is3p;\n    /** @private @const {!Array<{win: !Window, origin: string}>} */\n    this.clientWindows_ = [];\n\n    /** @private @const {!UnlistenDef} */\n    this.unlisten_ = listenFor(this.iframe_, type, (data, source, origin) => {\n      // This message might be from any window within the iframe, we need\n      // to keep track of which windows want to be sent updates.\n      if (!this.clientWindows_.some(entry => entry.win == source)) {\n        this.clientWindows_.push({win: source, origin});\n      }\n      requestCallback(data, source, origin);\n    }, this.is3p_,\n        // For 3P frames we also allow nested frames within them to subscribe..\n    this.is3p_ /* opt_includingNestedWindows */);\n  }\n\n  /**\n   * Sends a message to all subscribed windows.\n   * @param {string} type Type of the message.\n   * @param {!JsonObject} data Message payload.\n   */\n  send(type, data) {\n    // Remove clients that have been removed from the DOM.\n    filterSplice(this.clientWindows_, client => !!client.win.parent);\n    postMessageToWindows(\n        this.iframe_,\n        this.clientWindows_,\n        type,\n        data,\n        this.is3p_);\n  }\n\n  /**\n   * Destroys iframe.\n   */\n  destroy() {\n    this.unlisten_();\n    this.clientWindows_.length = 0;\n  }\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function looksLikeTrackingIframe(element) {\n  const box = element.getLayoutBox();\n  // This heuristic is subject to change.\n  if (box.width > 10 || box.height > 10) {\n    return false;\n  }\n  // Iframe is not tracking iframe if open with user interaction\n  return !closestBySelector(element, '.i-amphtml-overlay');\n}\n\n// Most common ad sizes\n// Array of [width, height] pairs.\nconst adSizes = [\n  [300, 250],\n  [320, 50],\n  [300, 50],\n  [320, 100],\n];\n\n/**\n * Guess whether this element might be an ad.\n * @param {!Element} element An amp-iframe element.\n * @return {boolean}\n * @visibleForTesting\n */\nexport function isAdLike(element) {\n  const box = element.getLayoutBox();\n  const {height, width} = box;\n  for (let i = 0; i < adSizes.length; i++) {\n    const refWidth = adSizes[i][0];\n    const refHeight = adSizes[i][1];\n    if (refHeight > height) {\n      continue;\n    }\n    if (refWidth > width) {\n      continue;\n    }\n    // Fuzzy matching to account for padding.\n    if (height - refHeight <= 20 && width - refWidth <= 20) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {!Element} iframe\n * @private\n */\nexport function disableScrollingOnIframe(iframe) {\n  addAttributesToElement(iframe, dict({'scrolling': 'no'}));\n\n  // This shouldn't work, but it does on Firefox.\n  // https://stackoverflow.com/a/15494969\n  setStyle(iframe, 'overflow', 'hidden');\n\n  return iframe;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {SubscriptionApi} from './iframe-helper';\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {isArray, isFiniteNumber} from './types';\nimport {layoutRectLtwh, moveLayoutRect, rectIntersection} from './layout-rect';\n\n/**\n * The structure that defines the rectangle used in intersection observers.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number,\n * }}\n */\nexport let DOMRect;\n\nexport const DEFAULT_THRESHOLD =\n    [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4,\n      0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1];\n\n/** @typedef {{\n *    element: !Element,\n *    currentThresholdSlot: number,\n *  }}\n */\nlet ElementIntersectionStateDef;\n\n/** @const @private */\nconst TAG = 'INTERSECTION-OBSERVER';\n\n/** @const @private */\nconst INIT_TIME = Date.now();\n\n/**\n * A function to get the element's current IntersectionObserverEntry\n * regardless of the intersetion ratio. Only available when element is not\n * nested in a container iframe.\n * TODO: support opt_iframe if there's valid use cases.\n * @param {!./layout-rect.LayoutRectDef} element element's rect\n * @param {?./layout-rect.LayoutRectDef} owner element's owner rect\n * @param {!./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n * @return {!IntersectionObserverEntry} A change entry.\n */\nexport function getIntersectionChangeEntry(\n  element, owner, hostViewport) {\n  const intersection = rectIntersection(element, owner, hostViewport) ||\n      layoutRectLtwh(0, 0, 0, 0);\n  const ratio = intersectionRatio(intersection, element);\n  return calculateChangeEntry(\n      element, hostViewport, intersection, ratio);\n}\n\n/**\n * @param {!Window} win\n * @return {boolean}\n */\nexport function nativeIntersectionObserverSupported(win) {\n  return 'IntersectionObserver' in win &&\n      'IntersectionObserverEntry' in win &&\n      'intersectionRatio' in win.IntersectionObserverEntry.prototype;\n}\n\n/**\n * A class to help amp-iframe and amp-ad nested iframe listen to intersection\n * change.\n */\nexport class IntersectionObserverApi {\n  /**\n   * @param {!AMP.BaseElement} baseElement\n   * @param {!Element} iframe\n   * @param {boolean=} opt_is3p\n   */\n  constructor(baseElement, iframe, opt_is3p) {\n    /** @private @const {!AMP.BaseElement} */\n    this.baseElement_ = baseElement;\n\n    /** @private {?IntersectionObserverPolyfill} */\n    this.intersectionObserver_ = null;\n\n    /** @private {boolean} */\n    this.shouldObserve_ = false;\n\n    /** @private {boolean} */\n    this.isInViewport_ = false;\n\n    /** @private {?function()} */\n    this.unlistenOnDestroy_ = null;\n\n    /** @private @const {!./service/viewport/viewport-impl.Viewport} */\n    this.viewport_ = baseElement.getViewport();\n\n    /** @private {?SubscriptionApi} */\n    this.subscriptionApi_ = new SubscriptionApi(\n        iframe, 'send-intersections', opt_is3p || false, () => {\n          this.startSendingIntersection_();\n        });\n\n    this.intersectionObserver_ = new IntersectionObserverPolyfill(entries => {\n      // Remove target info from cross origin iframe.\n      for (let i = 0; i < entries.length; i++) {\n        delete entries[i]['target'];\n      }\n      this.subscriptionApi_.send('intersection', dict({'changes': entries}));\n    }, {threshold: DEFAULT_THRESHOLD});\n    this.intersectionObserver_.tick(this.viewport_.getRect());\n\n    /** @const {function()} */\n    this.fire = () => {\n      if (!this.shouldObserve_ || !this.isInViewport_) {\n        return;\n      }\n      this.intersectionObserver_.tick(this.viewport_.getRect());\n    };\n  }\n\n  /**\n   * Function to start listening to viewport event. and observer intersection\n   * change on the element.\n   */\n  startSendingIntersection_() {\n    this.shouldObserve_ = true;\n    this.intersectionObserver_.observe(this.baseElement_.element);\n    this.baseElement_.getVsync().measure(() => {\n      this.isInViewport_ = this.baseElement_.isInViewport();\n      this.fire();\n    });\n\n    const unlistenViewportScroll = this.viewport_.onScroll(this.fire);\n    const unlistenViewportChange = this.viewport_.onChanged(this.fire);\n    this.unlistenOnDestroy_ = () => {\n      unlistenViewportScroll();\n      unlistenViewportChange();\n    };\n  }\n\n  /**\n   * Enable to the PositionObserver to listen to viewport events\n   * @param {boolean} inViewport\n   */\n  onViewportCallback(inViewport) {\n    this.isInViewport_ = inViewport;\n  }\n\n  /**\n   * Clean all listenrs\n   */\n  destroy() {\n    this.shouldObserve_ = false;\n    this.intersectionObserver_ = null;\n    if (this.unlistenOnDestroy_) {\n      this.unlistenOnDestroy_();\n      this.unlistenOnDestroy_ = null;\n    }\n    this.subscriptionApi_.destroy();\n    this.subscriptionApi_ = null;\n  }\n}\n\n\n/**\n * The IntersectionObserverPolyfill class lets any element receive its\n * intersection data with the viewport. It acts like native browser supported\n * IntersectionObserver.\n * The IntersectionObserver receives a callback function and an optional option\n * as params. Whenever the element intersection ratio cross a threshold value,\n * IntersectionObserverPolyfill will call the provided callback function with\n * the change entry.\n * @visibleForTesting\n */\nexport class IntersectionObserverPolyfill {\n  /**\n   * @param {function(!Array<!IntersectionObserverEntry>)} callback\n   * @param {Object=} opt_option\n   */\n  constructor(callback, opt_option) {\n    /** @private @const {function(!Array<!IntersectionObserverEntry>)} */\n    this.callback_ = callback;\n\n    // The input threshold can be a number or an array of numbers.\n    let threshold = opt_option && opt_option.threshold;\n    if (threshold) {\n      threshold = isArray(threshold) ?\n        threshold : [threshold];\n    } else {\n      threshold = [0];\n    }\n\n    for (let i = 0; i < threshold.length; i++) {\n      dev().assert(isFiniteNumber(threshold[i]), 'Threshold should be a ' +\n          'finite number or an array of finite numbers');\n    }\n\n    /**\n     * A list of threshold, sorted in increasing numeric order\n     * @private @const {!Array}\n     */\n    this.threshold_ = threshold.sort();\n    dev().assert(this.threshold_[0] >= 0 &&\n        this.threshold_[this.threshold_.length - 1] <= 1,\n    'Threshold should be in the range from \"[0, 1]\"');\n\n    /** @private {?./layout-rect.LayoutRectDef} */\n    this.lastViewportRect_ = null;\n\n    /** @private {./layout-rect.LayoutRectDef|undefined} */\n    this.lastIframeRect_ = undefined;\n\n    /**\n     * Store a list of observed elements and their current threshold slot which\n     * their intersection ratio fills, range from [0, this.threshold_.length]\n     * @private {Array<!ElementIntersectionStateDef>}\n     */\n    this.observeEntries_ = [];\n  }\n\n  /**\n   */\n  disconnect() {\n    this.observeEntries_.length = 0;\n  }\n\n  /**\n   * Provide a way to observe the intersection change for a specific element\n   * Please note IntersectionObserverPolyfill only support AMP element now\n   * TODO: Support non AMP element\n   * @param {!Element} element\n   */\n  observe(element) {\n    // Check the element is an AMP element.\n    dev().assert(element.getLayoutBox);\n\n    // If the element already exists in current observeEntries, do nothing\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      if (this.observeEntries_[i].element === element) {\n        dev().warn(TAG, 'should observe same element once');\n        return;\n      }\n    }\n\n    const newState = {\n      element,\n      currentThresholdSlot: 0,\n    };\n\n    // Get the new observed element's first changeEntry based on last viewport\n    if (this.lastViewportRect_) {\n      const change = this.getValidIntersectionChangeEntry_(\n          newState, this.lastViewportRect_, this.lastIframeRect_);\n      if (change) {\n        this.callback_([change]);\n      }\n    }\n\n    // push new observed element\n    this.observeEntries_.push(newState);\n  }\n\n  /**\n   * Provide a way to unobserve intersection change for a specified element\n   * @param {!Element} element\n   */\n  unobserve(element) {\n    // find the unobserved element in observeEntries\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      if (this.observeEntries_[i].element === element) {\n        this.observeEntries_.splice(i, 1);\n        return;\n      }\n    }\n    dev().warn(TAG, 'unobserve non-observed element');\n  }\n\n  /**\n   * Tick function that update the DOMRect of the root of observed elements.\n   * Caller needs to make sure to pass in the correct container.\n   * Note: the opt_iframe param is the iframe position relative to the host doc,\n   * The iframe must be a non-scrollable iframe.\n   * @param {!./layout-rect.LayoutRectDef} hostViewport\n   * @param {./layout-rect.LayoutRectDef=} opt_iframe\n   */\n  tick(hostViewport, opt_iframe) {\n\n    if (opt_iframe) {\n      // If element inside an iframe. Adjust origin to the iframe.left/top.\n      hostViewport =\n          moveLayoutRect(hostViewport, -opt_iframe.left, -opt_iframe.top);\n      opt_iframe =\n          moveLayoutRect(opt_iframe, -opt_iframe.left, -opt_iframe.top);\n    }\n\n    this.lastViewportRect_ = hostViewport;\n    this.lastIframeRect_ = opt_iframe;\n\n    const changes = [];\n\n    for (let i = 0; i < this.observeEntries_.length; i++) {\n      const change = this.getValidIntersectionChangeEntry_(\n          this.observeEntries_[i], hostViewport, opt_iframe);\n      if (change) {\n        changes.push(change);\n      }\n    }\n\n    if (changes.length) {\n      this.callback_(changes);\n    }\n  }\n\n  /**\n   * Return a change entry for one element that should be compatible with\n   * IntersectionObserverEntry if it's valid with current config.\n   * When the new intersection ratio doesn't cross one of a threshold value,\n   * the function will return null.\n   *\n   * @param {!ElementIntersectionStateDef} state\n   * @param {!./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n   * @param {./layout-rect.LayoutRectDef=} opt_iframe iframe container rect\n   * @return {?IntersectionObserverEntry} A valid change entry or null if ratio\n   * @private\n   */\n  getValidIntersectionChangeEntry_(state, hostViewport, opt_iframe) {\n    const {element} = state;\n\n    // Normalize container LayoutRect to be relative to page\n    let ownerRect = null;\n\n    // If opt_iframe is provided, all LayoutRect has position relative to\n    // the iframe.\n    // If opt_iframe is not provided, all LayoutRect has position relative to\n    // the host document.\n    const elementRect = element.getLayoutBox();\n    const owner = element.getOwner();\n    ownerRect = owner && owner.getLayoutBox();\n\n    // calculate intersectionRect. that the element intersects with hostViewport\n    // and intersects with owner element and container iframe if exists.\n    const intersectionRect =\n        rectIntersection(elementRect, ownerRect, hostViewport, opt_iframe) ||\n        layoutRectLtwh(0, 0, 0, 0);\n    // calculate ratio, call callback based on new ratio value.\n    const ratio = intersectionRatio(intersectionRect, elementRect);\n    const newThresholdSlot = getThresholdSlot(this.threshold_, ratio);\n\n    if (newThresholdSlot == state.currentThresholdSlot) {\n      return null;\n    }\n    state.currentThresholdSlot = newThresholdSlot;\n\n    // To get same behavior as native IntersectionObserver set hostViewport null\n    // if inside an iframe\n    const changeEntry = calculateChangeEntry(elementRect,\n        (opt_iframe ? null : hostViewport), intersectionRect, ratio);\n    changeEntry.target = element;\n    return changeEntry;\n  }\n}\n\n/**\n * Returns the ratio of the smaller box's area to the larger box's area.\n * @param {!./layout-rect.LayoutRectDef} smaller\n * @param {!./layout-rect.LayoutRectDef} larger\n * @return {number}\n */\nfunction intersectionRatio(smaller, larger) {\n  return (smaller.width * smaller.height) / (larger.width * larger.height);\n}\n\n/**\n * Returns the slot number that the current ratio fills in.\n * @param {!Array} sortedThreshold valid sorted IoB threshold\n * @param {number} ratio Range from [0, 1]\n * @return {number} Range from [0, threshold.length]\n * @visibleForTesting\n */\nexport function getThresholdSlot(sortedThreshold, ratio) {\n  let startIdx = 0;\n  let endIdx = sortedThreshold.length;\n  // 0 is a special case that does not fit into [small, large) range\n  if (ratio == 0) {\n    return 0;\n  }\n  let mid = ((startIdx + endIdx) / 2) | 0;\n  while (startIdx < mid) {\n    const midValue = sortedThreshold[mid];\n    // In the range of [small, large)\n    if (ratio < midValue) {\n      endIdx = mid;\n    } else {\n      startIdx = mid;\n    }\n    mid = ((startIdx + endIdx) / 2) | 0;\n  }\n  return endIdx;\n}\n\n/**\n * Helper function to calculate the IntersectionObserver change entry.\n * @param {!./layout-rect.LayoutRectDef} element element's rect\n * @param {?./layout-rect.LayoutRectDef} hostViewport hostViewport's rect\n * @param {!./layout-rect.LayoutRectDef} intersection\n * @param {number} ratio\n * @return {!IntersectionObserverEntry}}\n */\nfunction calculateChangeEntry(\n  element, hostViewport, intersection, ratio) {\n  // If element not in an iframe.\n  // adjust all LayoutRect to hostViewport Origin.\n  let boundingClientRect = element;\n  let rootBounds = hostViewport;\n  // If no hostViewport is provided, element is inside an non-scrollable iframe.\n  // Every Layoutrect has already adjust their origin according to iframe\n  // rect origin. LayoutRect position is relative to iframe origin,\n  // thus relative to iframe's viewport origin because the viewport is at the\n  // iframe origin. No need to adjust position here.\n\n  if (hostViewport) {\n    // If element not in an iframe.\n    // adjust all LayoutRect to hostViewport Origin.\n    rootBounds = /** @type {!./layout-rect.LayoutRectDef} */ (rootBounds);\n    intersection = moveLayoutRect(intersection, -hostViewport.left,\n        -hostViewport.top);\n    // The element is relative to (0, 0), while the viewport moves. So, we must\n    // adjust.\n    boundingClientRect = moveLayoutRect(boundingClientRect,\n        -hostViewport.left, -hostViewport.top);\n    // Now, move the viewport to (0, 0)\n    rootBounds = moveLayoutRect(rootBounds,\n        -hostViewport.left, -hostViewport.top);\n  }\n\n  return /** @type {!IntersectionObserverEntry} */ ({\n    time: (typeof performance !== 'undefined' && performance.now) ?\n      performance.now() : Date.now() - INIT_TIME,\n    rootBounds,\n    boundingClientRect,\n    intersectionRect: intersection,\n    intersectionRatio: ratio,\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (part &&\n        value &&\n        value[part] !== undefined &&\n        hasOwnProperty(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n/**\n * Recursively checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum recursion depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function recursiveEquals(a, b, depth = 3) {\n  if (!isFinite(depth)) {\n    throw new Error('depth arg must be finite: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  // Only check shallow equality for depth < 1.\n  if (depth < 1) {\n    return false;\n  }\n  if (typeof a !== typeof b) {\n    return false;\n  }\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; i++) {\n      if (!recursiveEquals(a[i], b[i], depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    const keysA = Object.keys(/** @type {!Object} */ (a));\n    const keysB = Object.keys(/** @type {!Object} */ (b));\n    if (keysA.length !== keysB.length) {\n      return false;\n    }\n    for (let i = 0; i < keysA.length; i++) {\n      const keyA = keysA[i];\n      const valueA = a[keyA];\n      const valueB = b[keyA];\n      if (!recursiveEquals(valueA, valueB, depth - 1)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * The structure that combines position and size for an element. The exact\n * interpretation of position and size depends on the use case.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number\n * }}\n */\nexport let LayoutRectDef;\n\n\n/**\n * The structure that represents the margins of an Element.\n *\n * @typedef {{\n *   top: number,\n *   right: number,\n *   bottom: number,\n *   left: number\n * }}\n */\nexport let LayoutMarginsDef;\n\n\n/**\n * The structure that represents a requested change to the margins of an\n * Element. Any new values specified will replace existing ones (rather than\n * being additive).\n *\n * @typedef {{\n *   top: (number|undefined),\n *   right: (number|undefined),\n *   bottom: (number|undefined),\n *   left: (number|undefined)\n * }}\n */\nexport let LayoutMarginsChangeDef;\n\n/**\n* RelativePositions\n*\n* Describes the relative position of an element to another (whether the\n* first is inside the second, on top of the second or on the bottom\n* @enum {string}\n*/\nexport const RelativePositions = {\n  INSIDE: 'inside',\n  TOP: 'top',\n  BOTTOM: 'bottom',\n};\n\n/**\n * Creates a layout rect based on the left, top, width and height parameters\n * in that order.\n * @param {number} left\n * @param {number} top\n * @param {number} width\n * @param {number} height\n * @return {!LayoutRectDef}\n */\nexport function layoutRectLtwh(left, top, width, height) {\n  return {\n    left,\n    top,\n    width,\n    height,\n    bottom: top + height,\n    right: left + width,\n    x: left,\n    y: top,\n  };\n}\n\n\n/**\n * Creates a layout rect based on the DOMRect, e.g. obtained from calling\n * getBoundingClientRect.\n * @param {!ClientRect} rect\n * @return {!LayoutRectDef}\n */\nexport function layoutRectFromDomRect(rect) {\n  return layoutRectLtwh(Number(rect.left), Number(rect.top),\n      Number(rect.width), Number(rect.height));\n}\n\n/**\n * Returns true if the specified two rects overlap by a single pixel.\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectsOverlap(r1, r2) {\n  return (r1.top <= r2.bottom && r2.top <= r1.bottom &&\n      r1.left <= r2.right && r2.left <= r1.right);\n}\n\n\n/**\n * Returns the intersection between a, b or null if there is none.\n * @param {...?LayoutRectDef|undefined} var_args\n * @return {?LayoutRectDef}\n */\nexport function rectIntersection(var_args) {\n  let x0 = -Infinity;\n  let x1 = Infinity;\n  let y0 = -Infinity;\n  let y1 = Infinity;\n  for (let i = 0; i < arguments.length; i++) {\n    const current = arguments[i];\n    if (!current) {\n      continue;\n    }\n    x0 = Math.max(x0, current.left);\n    x1 = Math.min(x1, current.left + current.width);\n    y0 = Math.max(y0, current.top);\n    y1 = Math.min(y1, current.top + current.height);\n    if (x1 < x0 || y1 < y0) {\n      return null;\n    }\n  }\n  if (x1 == Infinity) {\n    return null;\n  }\n  return layoutRectLtwh(x0, y0, x1 - x0, y1 - y0);\n}\n\n/**\n * Returns the position of r2 relative to r1\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {RelativePositions}\n */\nexport function layoutRectsRelativePos(r1, r2) {\n  if (r1.top < r2.top) {\n    return RelativePositions.TOP;\n  } else if (r1.bottom > r2.bottom) {\n    return RelativePositions.BOTTOM;\n  } else {\n    return RelativePositions.INSIDE;\n  }\n}\n\n/**\n * Expand the layout rect using multiples of width and height.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dw Expansion in width, specified as a multiple of width.\n * @param {number} dh Expansion in height, specified as a multiple of height.\n * @return {!LayoutRectDef}\n */\nexport function expandLayoutRect(rect, dw, dh) {\n  return layoutRectLtwh(rect.left - rect.width * dw,\n      rect.top - rect.height * dh,\n      rect.width * (1 + dw * 2),\n      rect.height * (1 + dh * 2));\n}\n\n/**\n * Moves the layout rect using dx and dy.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dx Move horizontally with this value.\n * @param {number} dy Move vertically with this value.\n * @return {!LayoutRectDef}\n */\nexport function moveLayoutRect(rect, dx, dy) {\n  if ((dx == 0 && dy == 0) ||\n      (rect.width == 0 && rect.height == 0)) {\n    return rect;\n  }\n  return layoutRectLtwh(rect.left + dx, rect.top + dy,\n      rect.width, rect.height);\n}\n\n\n/**\n * @param {!LayoutMarginsDef} margins\n * @param {!LayoutMarginsChangeDef} change\n * @return {boolean}\n */\nexport function areMarginsChanged(margins, change) {\n  return (change.top !== undefined && change.top != margins.top) ||\n      (change.right !== undefined && change.right != margins.right) ||\n      (change.bottom !== undefined && change.bottom != margins.bottom) ||\n      (change.left !== undefined && change.left != margins.left);\n}\n\n/**\n * @param {!LayoutRectDef} from\n * @param {!LayoutRectDef} to\n * @return {boolean}\n */\nexport function layoutRectSizeEquals(from, to) {\n  return from.width == to.width &&\n      from.height === to.height;\n}\n\n/**\n * @param {?LayoutRectDef} r1\n * @param {?LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectEquals(r1, r2) {\n  if (!r1 || !r2) {\n    return false;\n  }\n  return r1.left == r2.left && r1.top == r2.top &&\n      r1.width == r2.width && r1.height == r2.height;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {dev, user} from './log';\nimport {htmlFor} from './static-template';\nimport {isFiniteNumber} from './types';\nimport {setStyle, setStyles} from './style';\nimport {startsWith} from './string';\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill',\n  FLEX_ITEM: 'flex-item',\n  FLUID: 'fluid',\n  INTRINSIC: 'intrinsic',\n};\n\n\n/**\n * Layout priorities to use with BaseElement#getLayoutPriority() and\n * BaseElement#updateLayoutPriority().\n * @enum {number}\n */\nexport const LayoutPriority = {\n  CONTENT: 0,\n  METADATA: 1,\n  ADS: 2,\n  BACKGROUND: 3,\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nexport let LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '0px', height: '0px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null,\n  'AMP-SOCIAL-SHARE': {width: '60px', height: '44px'},\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-GOOGLE-DOCUMENT-EMBED': true,\n  'AMP-EMBED': true,\n  'AMP-FACEBOOK': true,\n  'AMP-FACEBOOK-COMMENTS': true,\n  'AMP-FACEBOOK-LIKE': true,\n  'AMP-FACEBOOK-PAGE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-OOYALA-PLAYER': true,\n  'AMP-PINTEREST': true,\n  'AMP-PLAYBUZZ': true,\n  'AMP-VIDEO': true,\n  'AMP-YOUTUBE': true,\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return 'i-amphtml-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL ||\n      layout == Layout.FLEX_ITEM ||\n      layout == Layout.FLUID ||\n      layout == Layout.INTRINSIC);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && startsWith(tagName.toLowerCase(), 'i-');\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined|null} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n\n/**\n * Asserts that the supplied value is a non-percent CSS Length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  user().assert(\n      /^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(length),\n      'Invalid length value: %s', length);\n  return /** @type {!LengthDef} */ (length);\n}\n\n\n\n\n/**\n * Asserts that the supplied value is a CSS Length value\n * (including percent unit).\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLengthOrPercent(length) {\n  user().assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax|%)$/.test(length),\n      'Invalid length or percent value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  dev().assertString(length);\n  const m = user().assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string|null|undefined} length\n * @return {number|undefined}\n */\nexport function getLengthNumeral(length) {\n  const res = parseFloat(length);\n  return isFiniteNumber(res) ? res : undefined;\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {!Element} element\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(element) {\n  const tagName = element.tagName.toUpperCase();\n  dev().assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const doc = element.ownerDocument;\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = doc.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    setStyles(temp, {\n      position: 'absolute',\n      visibility: 'hidden',\n    });\n    doc.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px',\n    };\n    doc.body.removeChild(temp);\n  }\n  return /** @type {DimensionsDef} */ (naturalDimensions_[tagName]);\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isLoadingAllowed(element) {\n  const tagName = element.tagName.toUpperCase();\n  if (tagName == 'AMP-AD' || tagName == 'AMP-EMBED') {\n    return true;\n  }\n  return LOADING_ELEMENTS_[tagName] || false;\n}\n\n\n/**\n * Applies layout to the element. Visible for testing only.\n *\n * \\   \\  /  \\  /   / /   \\     |   _  \\     |  \\ |  | |  | |  \\ |  |  / _____|\n *  \\   \\/    \\/   / /  ^  \\    |  |_)  |    |   \\|  | |  | |   \\|  | |  |  __\n *   \\            / /  /_\\  \\   |      /     |  . `  | |  | |  . `  | |  | |_ |\n *    \\    /\\    / /  _____  \\  |  |\\  \\----.|  |\\   | |  | |  |\\   | |  |__| |\n *     \\__/  \\__/ /__/     \\__\\ | _| `._____||__| \\__| |__| |__| \\__|  \\______|\n *\n * The equivalent of this method is used for server-side rendering (SSR) and\n * any changes made to it must be made in coordination with caches that\n * implement SSR. For more information on SSR see bit.ly/amp-ssr.\n *\n * @param {!Element} element\n * @return {!Layout}\n */\nexport function applyStaticLayout(element) {\n  // Check if the layout has already been done by server-side rendering. The\n  // document may be visible to the user if the boilerplate was removed so\n  // please take care in making changes here.\n  const completedLayoutAttr = element.getAttribute('i-amphtml-layout');\n  if (completedLayoutAttr) {\n    const layout = /** @type {!Layout} */ (dev().assert(\n        parseLayout(completedLayoutAttr)));\n    if ((layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC)\n      && element.firstElementChild) {\n      // Find sizer, but assume that it might not have been parsed yet.\n      element.sizerElement =\n          element.querySelector('i-amphtml-sizer') || undefined;\n    } else if (layout == Layout.NODISPLAY) {\n      applyNoDisplayLayout(element);\n    }\n    return layout;\n  }\n\n  // If the layout was already done by server-side rendering (SSR), then the\n  // code below will not run. Any changes below will necessitate a change to SSR\n  // and must be coordinated with caches that implement SSR. See bit.ly/amp-ssr.\n\n  // Parse layout from the element.\n  const layoutAttr = element.getAttribute('layout');\n  const widthAttr = element.getAttribute('width');\n  const heightAttr = element.getAttribute('height');\n  const sizesAttr = element.getAttribute('sizes');\n  const heightsAttr = element.getAttribute('heights');\n\n  // Input layout attributes.\n  const inputLayout = layoutAttr ? parseLayout(layoutAttr) : null;\n  user().assert(inputLayout !== undefined, 'Unknown layout: %s', layoutAttr);\n  /** @const {string|null|undefined} */\n  const inputWidth = (widthAttr && widthAttr != 'auto') ?\n    parseLength(widthAttr) : widthAttr;\n  user().assert(inputWidth !== undefined, 'Invalid width value: %s', widthAttr);\n  /** @const {string|null|undefined} */\n  const inputHeight = (heightAttr && heightAttr != 'fluid') ?\n    parseLength(heightAttr) : heightAttr;\n  user().assert(inputHeight !== undefined, 'Invalid height value: %s',\n      heightAttr);\n\n  // Effective layout attributes. These are effectively constants.\n  let width;\n  let height;\n  let layout;\n\n  // Calculate effective width and height.\n  if ((!inputLayout || inputLayout == Layout.FIXED ||\n      inputLayout == Layout.FIXED_HEIGHT) &&\n      (!inputWidth || !inputHeight) && hasNaturalDimensions(element.tagName)) {\n    // Default width and height: handle elements that do not specify a\n    // width/height and are defined to have natural browser dimensions.\n    const dimensions = getNaturalDimensions(element);\n    width = (inputWidth || inputLayout == Layout.FIXED_HEIGHT) ? inputWidth :\n      dimensions.width;\n    height = inputHeight || dimensions.height;\n  } else {\n    width = inputWidth;\n    height = inputHeight;\n  }\n\n  // Calculate effective layout.\n  if (inputLayout) {\n    layout = inputLayout;\n  } else if (!width && !height) {\n    layout = Layout.CONTAINER;\n  } else if (height == 'fluid') {\n    layout = Layout.FLUID;\n  } else if (height && (!width || width == 'auto')) {\n    layout = Layout.FIXED_HEIGHT;\n  } else if (height && width && (sizesAttr || heightsAttr)) {\n    layout = Layout.RESPONSIVE;\n  } else {\n    layout = Layout.FIXED;\n  }\n\n  // Verify layout attributes.\n  if (layout == Layout.FIXED || layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(height, 'Expected height to be available: %s', heightAttr);\n  }\n  if (layout == Layout.FIXED_HEIGHT) {\n    user().assert(!width || width == 'auto',\n        'Expected width to be either absent or equal \"auto\" ' +\n        'for fixed-height layout: %s', widthAttr);\n  }\n  if (layout == Layout.FIXED || layout == Layout.RESPONSIVE ||\n      layout == Layout.INTRINSIC) {\n    user().assert(width && width != 'auto',\n        'Expected width to be available and not equal to \"auto\": %s',\n        widthAttr);\n  }\n\n  if (layout == Layout.RESPONSIVE || layout == Layout.INTRINSIC) {\n    user().assert(getLengthUnits(width) == getLengthUnits(height),\n        'Length units should be the same for width and height: %s, %s',\n        widthAttr, heightAttr);\n  } else {\n    user().assert(heightsAttr === null,\n        'Unexpected \"heights\" attribute for none-responsive layout');\n  }\n\n  // Apply UI.\n  element.classList.add(getLayoutClass(layout));\n  if (isLayoutSizeDefined(layout)) {\n    element.classList.add('i-amphtml-layout-size-defined');\n  }\n  if (layout == Layout.NODISPLAY) {\n    // CSS defines layout=nodisplay automatically with `display:none`. Thus\n    // no additional styling is needed.\n    applyNoDisplayLayout(element);\n  } else if (layout == Layout.FIXED) {\n    setStyles(element, {\n      width: dev().assertString(width),\n      height: dev().assertString(height),\n    });\n  } else if (layout == Layout.FIXED_HEIGHT) {\n    setStyle(element, 'height', dev().assertString(height));\n  } else if (layout == Layout.RESPONSIVE) {\n    const sizer = element.ownerDocument.createElement('i-amphtml-sizer');\n    setStyles(sizer, {\n      display: 'block',\n      paddingTop:\n        ((getLengthNumeral(height) / getLengthNumeral(width)) * 100) + '%',\n    });\n    element.insertBefore(sizer, element.firstChild);\n    element.sizerElement = sizer;\n  } else if (layout == Layout.INTRINSIC) {\n    // Intrinsic uses an svg inside the sizer element rather than the padding\n    // trick Note a naked svg won't work becasue other thing expect the\n    // i-amphtml-sizer element\n    const sizer = htmlFor(element)`\n      <i-amphtml-sizer class=\"i-amphtml-sizer\">\n        <img class=\"i-amphtml-intrinsic-sizer\" />\n      </i-amphtml-sizer>`;\n    const intrinsicSizer = sizer.firstElementChild;\n    intrinsicSizer.setAttribute('src',\n        `data:image/svg+xml;charset=utf-8,<svg height=\"${height}\" width=\"${width}\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"/>`);\n    element.insertBefore(sizer, element.firstChild);\n    // TODO(jpettitt): sizer is leaked and can't be cleaned up.\n    element.sizerElement = intrinsicSizer;\n  } else if (layout == Layout.FILL) {\n    // Do nothing.\n  } else if (layout == Layout.CONTAINER) {\n    // Do nothing. Elements themselves will check whether the supplied\n    // layout value is acceptable. In particular container is only OK\n    // sometimes.\n  } else if (layout == Layout.FLEX_ITEM) {\n    // Set height and width to a flex item if they exist.\n    // The size set to a flex item could be overridden by `display: flex` later.\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    if (height) {\n      setStyle(element, 'height', height);\n    }\n  } else if (layout == Layout.FLUID) {\n    element.classList.add('i-amphtml-layout-awaiting-size');\n    if (width) {\n      setStyle(element, 'width', width);\n    }\n    setStyle(element, 'height', 0);\n  }\n  return layout;\n}\n\n\n/**\n * @param {!Element} element\n */\nfunction applyNoDisplayLayout(element) {\n  // TODO(dvoytenko, #9353): once `toggleLayoutDisplay` API has been deployed\n  // everywhere, switch all relevant elements to this API. In the meantime,\n  // simply unblock display toggling via `style=\"display: ...\"`.\n  setStyle(element, 'display', 'none');\n  element.classList.add('i-amphtml-display');\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don’t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return (levelOverride_ !== undefined) ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      if (getMode().localDev) {\n        messages.unshift('[' + tag + ']');\n      }\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.getLevel_() >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.name = tag || error.name;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 0\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    this.assert(!!shouldBeBoolean === shouldBeBoolean,\n        (opt_message || 'Boolean expected') + ': %s', shouldBeBoolean);\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a\n   * value, the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return {T}\n   * @template T\n   * eslint \"google-camelcase/google-camelcase\": 2\n   */\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const {message} = error;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log contructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log contructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL);\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.WARN;\n  }, suffix);\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when `gulp dist` is called without the\n  // --fortesting flag.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n\n  const localDevEnabled = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const runningTests = IS_DEV && !!(win.AMP_TEST || win.__karma__);\n  const isLocalDev = IS_DEV && (localDevEnabled || runningTests);\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation or enable pub level logging. Validation can be\n    // bypassed via #validate=0.\n    // Note that AMP_DEV_MODE flag is used for testing purposes.\n    development: !!(hashQuery['development'] == '1' || win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: runningTests,\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {install as installArrayIncludes} from './polyfills/array-includes';\nimport {install as installCustomElements} from './polyfills/custom-elements';\nimport {\n  install as installDOMTokenListToggle,\n} from './polyfills/domtokenlist-toggle';\nimport {install as installDocContains} from './polyfills/document-contains';\nimport {install as installMathSign} from './polyfills/math-sign';\nimport {install as installObjectAssign} from './polyfills/object-assign';\nimport {install as installPromise} from './polyfills/promise';\nimport {installCustomElements as installRegisterElement} from\n  'document-register-element/build/document-register-element.patched';\nimport {isExperimentOn} from './experiments';\n\nif (isExperimentOn(self, 'custom-elements-v1') || getMode().test) {\n  installCustomElements(self, class {});\n} else {\n  installRegisterElement(self, 'auto');\n}\ninstallDOMTokenListToggle(self);\ninstallMathSign(self);\ninstallObjectAssign(self);\ninstallPromise(self);\ninstallDocContains(self);\ninstallArrayIncludes(self);\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Returns true if the element is in the array and false otherwise.\n *\n * @param {*} value\n * @param {number=} opt_fromIndex\n * @return {boolean}\n * @this {Array}\n */\nfunction includes(value, opt_fromIndex) {\n  const fromIndex = opt_fromIndex || 0;\n  const len = this.length;\n  let i = fromIndex >= 0 ? fromIndex : Math.max(len + fromIndex, 0);\n  for (; i < len; i++) {\n    const other = this[i];\n    // If value has been found OR (value is NaN AND other is NaN)\n    /*eslint \"no-self-compare\": 0*/\n    if (other === value || (value !== value && other !== other)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n* Sets the Array.contains polyfill if it does not exist.\n* @param {!Window} win\n*/\nexport function install(win) {\n  if (!win.Array.prototype.includes) {\n    win.Object.defineProperty(Array.prototype, 'includes', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: includes,\n    });\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {{\n *   promise: !Promise<undefined>,\n *   resolve: function(),\n * }}\n */\nlet DeferredDef;\n\n/**\n * @typedef {!Function}\n */\nlet CustomElementConstructorDef;\n\n/**\n * @typedef {{\n *  name: string,\n *  ctor: !CustomElementConstructorDef,\n * }}\n */\nlet CustomElementDef;\n\n/**\n * Validates the custom element's name.\n * This intentionally ignores \"valid\" higher Unicode Code Points.\n * https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name\n */\nconst VALID_NAME = /^[a-z][a-z0-9._]*-[a-z0-9._-]*$/;\nconst INVALID_NAMES = [\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n];\n\n/**\n * Asserts that the custom element name conforms to the spec.\n *\n * @param {!Function} SyntaxError\n * @param {string} name\n */\nfunction assertValidName(SyntaxError, name) {\n  if (!VALID_NAME.test(name) || INVALID_NAMES.indexOf(name) >= 0) {\n    throw new SyntaxError(`invalid custom element name \"${name}\"`);\n  }\n}\n\n/**\n * Does win have a full Custom Elements registry?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction hasCustomElements(win) {\n  const {customElements} = win;\n\n  return !!(\n    customElements &&\n    customElements.define &&\n    customElements.get &&\n    customElements.whenDefined);\n}\n\n/**\n * Was HTMLElement already patched for this window?\n *\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isPatched(win) {\n  const tag = win.HTMLElement.toString();\n  return tag.indexOf('[native code]') === -1;\n}\n\n/**\n * The public Custom Elements API.\n */\nclass CustomElementRegistry {\n  /**\n   * @param {!Window} win\n   * @param {!Registry} registry\n   */\n  constructor(win, registry) {\n    /**\n     * @const @private\n     */\n    this.win_ = win;\n\n    /**\n     * @const @private\n     */\n    this.registry_ = registry;\n\n    /**\n     * @type {!Object<string, DeferredDef>}\n     * @private\n     * @const\n     */\n    this.pendingDefines_ = this.win_.Object.create(null);\n  }\n\n  /**\n   * Register the custom element.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object=} options\n   */\n  define(name, ctor, options) {\n    this.registry_.define(name, ctor, options);\n\n    // If anyone is waiting for this custom element to be defined, resolve\n    // their promise.\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      deferred.resolve();\n      delete pending[name];\n    }\n  }\n\n  /**\n   * Get the constructor of the (already defined) custom element.\n   *\n   * @param {string} name\n   * @return {!CustomElementConstructorDef|undefined}\n   */\n  get(name) {\n    const def = this.registry_.getByName(name);\n    if (def) {\n      return def.ctor;\n    }\n  }\n\n  /**\n   * Returns a promise that waits until the custom element is defined.\n   * If the custom element is already defined, returns a resolved promise.\n   *\n   * @param {string} name\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(name) {\n    const {Promise, SyntaxError} = this.win_;\n    assertValidName(SyntaxError, name);\n\n    if (this.registry_.getByName(name)) {\n      return Promise.resolve();\n    }\n\n    const pending = this.pendingDefines_;\n    const deferred = pending[name];\n    if (deferred) {\n      return deferred.promise;\n    }\n\n    let resolve;\n    const promise = new /*OK*/Promise(res => resolve = res);\n    pending[name] = {\n      promise,\n      resolve,\n    };\n\n    return promise;\n  }\n\n  /**\n   * Upgrade all custom elements inside root.\n   *\n   * @param {!Node} root\n   */\n  upgrade(root) {\n    this.registry_.upgrade(root);\n  }\n}\n\n/**\n * This internal APIs necessary to run the CustomElementRegistry.\n * Since Registry is never exposed externally, all methods are actually\n * available on the instance.\n */\nclass Registry {\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * @private @const\n     */\n    this.win_ = win;\n\n    /**\n     * @private @const\n     */\n    this.doc_ = win.document;\n\n    /**\n     * @type {!Object<string, !CustomElementDef>}\n     * @private\n     * @const\n     */\n    this.definitions_ = win.Object.create(null);\n\n    /**\n     * A up-to-date DOM selector for all custom elements.\n     * @type {string}\n     */\n    this.query_ = '';\n\n    /**\n     * The currently upgrading element.\n     * @private {Element}\n     */\n    this.current_ = null;\n  }\n\n  /**\n   * The currently-being-upgraded custom element.\n   *\n   * When an already created (through the DOM parsing APIs, or innerHTML)\n   * custom element node is being upgraded, we can't just create a new node\n   * (it's illegal in the spec). But we still need to run the custom element's\n   * constructor code on the node. We avoid this conundrum by running the\n   * constructor while returning this current node in the HTMLElement\n   * class constructor (the base class of all custom elements).\n   *\n   * @return {Element}\n   */\n  current() {\n    const current = this.current_;\n    this.current_ = null;\n    return current;\n  }\n\n  /**\n   * Finds the custom element definition by name.\n   *\n   * @param {string} name\n   * @return {CustomElementDef|undefined}\n   */\n  getByName(name) {\n    const definition = this.definitions_[name];\n    if (definition) {\n      return definition;\n    }\n  }\n\n  /**\n   * Finds the custom element definition by constructor instance.\n   *\n   * @param {CustomElementConstructorDef} ctor\n   * @return {CustomElementDef|undefined}\n   */\n  getByConstructor(ctor) {\n    const definitions = this.definitions_;\n\n    for (const name in definitions) {\n      const def = definitions[name];\n      if (def.ctor === ctor) {\n        return def;\n      }\n    }\n  }\n\n  /**\n   * Registers the custom element definition, and upgrades all elements by that\n   * name in the root document.\n   *\n   * @param {string} name\n   * @param {!CustomElementConstructorDef} ctor\n   * @param {!Object|undefined} options\n   */\n  define(name, ctor, options) {\n    const {Error, SyntaxError} = this.win_;\n\n    if (options) {\n      throw new Error('Extending native custom elements is not supported');\n    }\n\n    assertValidName(SyntaxError, name);\n\n    if (this.getByName(name) ||\n        this.getByConstructor(ctor)) {\n      throw new Error(`duplicate definition \"${name}\"`);\n    }\n\n    // TODO(jridgewell): Record connectedCallback, disconnectedCallback,\n    // adoptedCallback, attributeChangedCallback, and observedAttributes.\n    // TODO(jridgewell): If attributeChangedCallback, gather observedAttributes\n    this.definitions_[name] = {\n      name,\n      ctor,\n    };\n\n    this.observe_(name);\n    this.upgrade(this.doc_, name);\n  }\n\n  /**\n   * Upgrades custom elements descendants of root (but not including root).\n   *\n   * When called with an opt_query, it both upgrades and connects the custom\n   * elements (this is used during the custom element define algorithm).\n   *\n   * @param {!Node} root\n   * @param {string=} opt_query\n   */\n  upgrade(root, opt_query) {\n    // Only CustomElementRegistry.p.define provides a query (the newly defined\n    // custom element). In this case, we are both upgrading _and_ connecting\n    // the custom elements.\n    const newlyDefined = !!opt_query;\n    const query = opt_query || this.query_;\n    const upgradeCandidates = this.queryAll_(root, query);\n\n    for (let i = 0; i < upgradeCandidates.length; i++) {\n      const candidate = upgradeCandidates[i];\n      if (newlyDefined) {\n        this.connectedCallback_(candidate);\n      } else {\n        this.upgradeSelf(candidate);\n      }\n    }\n  }\n\n  /**\n   * Upgrades the custom element node, if a custom element has been registered\n   * by this name.\n   *\n   * @param {!Node} node\n   */\n  upgradeSelf(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n  }\n\n  /**\n   * @param {!Node} root\n   * @param {string} query\n   * @return {!Array|!NodeList}\n   */\n  queryAll_(root, query) {\n    if (!query || !root.querySelectorAll) {\n      // Nothing to do...\n      return [];\n    }\n\n    return root.querySelectorAll(query);\n  }\n\n  /**\n   * Upgrades the (already created via DOM parsing) custom element.\n   *\n   * @param {!Element} node\n   * @param {!CustomElementDef} def\n   */\n  upgradeSelf_(node, def) {\n    const {ctor} = def;\n    if (node instanceof ctor) {\n      return;\n    }\n\n    // Despite how it looks, this is not a useless construction.\n    // HTMLElementPolyfill (the base class of all custom elements) will return\n    // the current node, allowing the custom element's subclass constructor to\n    // run on the node. The node itself is already constructed, so the return\n    // value is just the node.\n    this.current_ = node;\n    const el = new ctor();\n\n    if (el !== node) {\n      throw new this.win_.Error(\n          'Constructor illegally returned a different instance.');\n    }\n  }\n\n  /**\n   * Fires connectedCallback on the custom element, if it has one.\n   * This also upgrades the custom element, since it may not have been\n   * accessible via the root document before (a detached DOM tree).\n   *\n   * @param {!Node} node\n   */\n  connectedCallback_(node) {\n    const def = this.getByName(node.localName);\n    if (!def) {\n      return;\n    }\n    this.upgradeSelf_(/** @type {!Element} */(node), def);\n    // TODO(jridgewell): It may be appropriate to adoptCallback, if the node\n    // used to be in another doc.\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.connectedCallback) {\n      node.connectedCallback();\n    }\n  }\n\n  /**\n   * Fires disconnectedCallback on the custom element, if it has one.\n   *\n   * @param {!Node} node\n   */\n  disconnectedCallback_(node) {\n    // TODO(jridgewell): I should be calling the definitions connectedCallback\n    // with node as the context.\n    if (node.disconnectedCallback) {\n      node.disconnectedCallback();\n    }\n  }\n\n  /**\n   * Records name as a registered custom element to observe.\n   *\n   * Starts the Mutation Observer if this is the first registered custom\n   * element. This is deferred until the first custom element is defined to\n   * speed up initial rendering of the page.\n   *\n   * Mutation Observers are conveniently available in every browser we care\n   * about. When a node is connected to the root document, all custom\n   * elements (including that node iteself) will be upgraded and call\n   * connectedCallback. When a node is disconnectedCallback from the root\n   * document, all custom elements will call disconnectedCallback.\n   *\n   * @param {string} name\n   */\n  observe_(name) {\n    if (this.query_) {\n      this.query_ += `,${name}`;\n      return;\n    }\n\n    this.query_ = name;\n\n    // The first registered name starts the mutation observer.\n    const observer = new this.win_.MutationObserver(records => {\n      if (records) {\n        this.handleRecords_(records);\n      }\n    });\n    observer.observe(this.doc_, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Handle all the Mutation Observer's Mutation Records.\n   * All added custom elements will be upgraded (if not already) and call\n   * connectedCallback. All removed custom elements will call\n   * disconnectedCallback.\n   *\n   * @param {!Array<!MutationRecord>} records\n   */\n  handleRecords_(records) {\n    for (let i = 0; i < records.length; i++) {\n      const record = records[i];\n      if (!record) {\n        continue;\n      }\n\n      const {addedNodes, removedNodes} = record;\n      for (let i = 0; i < addedNodes.length; i++) {\n        const node = addedNodes[i];\n        const connectedCandidates = this.queryAll_(node, this.query_);\n        this.connectedCallback_(node);\n        for (let i = 0; i < connectedCandidates.length; i++) {\n          this.connectedCallback_(connectedCandidates[i]);\n        }\n      }\n\n      for (let i = 0; i < removedNodes.length; i++) {\n        const node = removedNodes[i];\n        const disconnectedCandidates = this.queryAll_(node, this.query_);\n        this.disconnectedCallback_(node);\n        for (let i = 0; i < disconnectedCandidates.length; i++) {\n          this.disconnectedCallback_(disconnectedCandidates[i]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Does the polyfilling.\n * @param {!Window} win\n */\nfunction polyfill(win) {\n  const {HTMLElement, Element, Node, Document, Object, document} = win;\n  const {createElement, cloneNode, importNode} = document;\n\n  const registry = new Registry(win);\n  const customElements = new CustomElementRegistry(win, registry);\n\n  // Expose the custom element registry.\n  // Object.getOwnPropertyDescriptor(window, 'customElements')\n  // {get: ƒ, set: undefined, enumerable: true, configurable: true}\n  Object.defineProperty(win, 'customElements', {\n    enumerable: true,\n    configurable: true,\n    // writable: false,\n    value: customElements,\n  });\n\n  // Patch createElement to immediately upgrade the custom element.\n  // This has the added benefit that it avoids the \"already created but needs\n  // constructor code run\" chicken-and-egg problem.\n  Document.prototype.createElement = function createElementPolyfill(name) {\n    const def = registry.getByName(name);\n    if (def) {\n      return new def.ctor();\n    }\n    return createElement.apply(this, arguments);\n  };\n\n  // Patch importNode to immediately upgrade custom elements.\n  // TODO(jridgewell): Can fire adoptedCallback for cross doc imports.\n  Document.prototype.importNode = function importNodePolyfill() {\n    const imported = importNode.apply(this, arguments);\n    if (imported) {\n      registry.upgradeSelf(imported);\n      registry.upgrade(imported);\n    }\n    return imported;\n  };\n\n  // Patch cloneNode to immediately upgrade custom elements.\n  Node.prototype.cloneNode = function cloneNodePolyfill() {\n    const cloned = cloneNode.apply(this, arguments);\n    registry.upgradeSelf(cloned);\n    registry.upgrade(cloned);\n    return cloned;\n  };\n\n  // Patch the innerHTML setter to immediately upgrade custom elements.\n  // Note, this could technically fire connectedCallbacks if this node was\n  // connected, but we leave that to the Mutation Observer.\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype,\n      'innerHTML');\n  const innerHTMLSetter = innerHTMLDesc.set;\n  innerHTMLDesc.set = function(html) {\n    innerHTMLSetter.call(this, html);\n    registry.upgrade(this);\n  };\n  Object.defineProperty(Element.prototype, 'innerHTML', innerHTMLDesc);\n\n  /**\n   * You can't use the real HTMLElement constructor, because you can't subclass\n   * it without using native classes. So, mock its approximation using\n   * createElement.\n   */\n  function HTMLElementPolyfill() {\n    const {constructor} = this;\n\n    // If we're upgrading an already created custom element, we can't create\n    // another new node (by the spec, it must be the same node).\n    let el = registry.current();\n\n    // If there's not a already created custom element, we're being invoked via\n    // `new`ing the constructor.\n    //\n    // Technically, we could get here via createElement, but we patched that.\n    // If it the custom element was registered, the patch turned it into a\n    // `new` call.\n    // If it was not registered, the native createElement is used. And if\n    // native createElement is being used and we got to this code, we're really\n    // in an infinite loop (a native createElement call just below) so we've\n    // got bigger problems.\n    //\n    // So just take my word we got here via `new`.\n    if (!el) {\n      // The custom element definition is an invariant. If the custom element\n      // is registered, everything works. If it's not, it throws in the member\n      // property access (only defined custom elements can be directly\n      // constructed via `new`).\n      const def = registry.getByConstructor(constructor);\n      el = createElement.call(document, def.name);\n    }\n\n    // Finally, if the node was already constructed, we need to reset it's\n    // prototype to the custom element prototype. And if it wasn't already\n    // constructed, we created a new node via native createElement, and we need\n    // to reset it's prototype. Basically always reset the prototype.\n    Object.setPrototypeOf(el, constructor.prototype);\n    return el;\n  }\n  subClass(Object, HTMLElement, HTMLElementPolyfill);\n\n  // Expose the polyfilled HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementPolyfill;\n}\n\n/**\n * Wraps HTMLElement in a Reflect.construct constructor, so that transpiled\n * classes can `_this = superClass.call(this)` during their construction.\n *\n * This is only used when Custom Elements v1 is already available _and_ we're\n * using transpiled classes (which use ES5 construction idioms).\n *\n * @param {!Window} win\n */\nfunction wrapHTMLElement(win) {\n  const {HTMLElement, Reflect, Object} = win;\n  /**\n   */\n  function HTMLElementWrapper() {\n    const ctor = /** @type {function(...?):?|undefined} */(\n      /** @type {!HTMLElement} */(this).constructor);\n\n    // Reflect.construct allows us to construct a new HTMLElement without using\n    // `new` (which will always fail because native HTMLElement is a restricted\n    // constructor).\n    return Reflect.construct(HTMLElement, [], ctor);\n  }\n  subClass(Object, HTMLElement, HTMLElementWrapper);\n\n  // Expose the wrapped HTMLElement constructor for everyone to extend from.\n  win.HTMLElement = HTMLElementWrapper;\n}\n\n/**\n * Setups up prototype inheritance\n *\n * @param {!Object} Object\n * @param {!Function} superClass\n * @param {!Function} subClass\n */\nfunction subClass(Object, superClass, subClass) {\n  // Object.getOwnPropertyDescriptor(superClass.prototype, 'constructor')\n  // {value: ƒ, writable: true, enumerable: false, configurable: true}\n  subClass.prototype = Object.create(superClass.prototype, {\n    constructor: {\n      // enumerable: false,\n      configurable: true,\n      writable: true,\n      value: subClass,\n    },\n  });\n}\n\n/**\n * Polyfills Custom Elements v1 API. This has 4 modes:\n *\n * 1. Custom elements v1 already supported, using native classes\n * 2. Custom elements v1 already supported, using transpiled classes\n * 3. Custom elements v1 not supported, using native classes\n * 4. Custom elements v1 not supported, using transpiled classes\n *\n * In mode 1, nothing is done. In mode 2, a minimal polyfill is used to support\n * extending the HTMLElement base class. In mode 3 and 4, a full polyfill is\n * done.\n *\n * @param {!Window} win\n * @param {!Function} ctor\n */\nexport function install(win, ctor) {\n  if (isPatched(win)) {\n    return;\n  }\n\n  let install = true;\n  let installWrapper = false;\n\n  if (hasCustomElements(win)) {\n    // If ctor is constructable without new, it's a function. That means it was\n    // compiled down, and we need to do the minimal polyfill because all you\n    // cannot extend HTMLElement without native classes.\n    try {\n      const {Object, Reflect} = win;\n\n      // \"Construct\" ctor using ES5 idioms\n      const instance = Object.create(ctor.prototype);\n      ctor.call(instance);\n\n      // If that succeeded, we're in a transpiled environment\n      // Let's find out if we can wrap HTMLElement and avoid a full patch.\n      installWrapper = !!(Reflect && Reflect.construct);\n    } catch (e) {\n\n      // The ctor threw when we constructed is via ES5, so it's a real class.\n      // We're ok to not install the polyfill.\n      install = false;\n    }\n  }\n\n  if (installWrapper) {\n    wrapHTMLElement(win);\n  } else if (install) {\n    polyfill(win);\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `document.contains()` method. Notice that according to spec\n * `document.contains` is inclusionary.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n * @param {?Node} node\n * @return {boolean}\n * @this {Node}\n */\nfunction documentContainsPolyfill(node) {\n  // Per spec, \"contains\" method is inclusionary\n  // i.e. `node.contains(node) == true`. However, we still need to test\n  // equality to the document itself.\n  return node == this || this.documentElement.contains(node);\n}\n\n\n/**\n * Polyfills `HTMLDocument.contains` API.\n * @param {!Window} win\n */\nexport function install(win) {\n  // HTMLDocument is undefined in Internet Explorer 10, but it has Document,\n  // so we use that as a fallback.\n  const documentClass = win.HTMLDocument || win.Document;\n  if (!documentClass.prototype.contains) {\n    win.Object.defineProperty(documentClass.prototype, 'contains', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: documentContainsPolyfill,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Polyfill for `DOMTokenList.prototype.toggle(token, opt_force)` method. This\n * is specially important because IE does not support `opt_force` attribute. See\n * https://goo.gl/hgKNYY for details.\n * @param {string} token\n * @param {boolean=} opt_force\n * @this {DOMTokenList}\n * @return {boolean}\n */\nfunction domTokenListTogglePolyfill(token, opt_force) {\n  const remove = opt_force === undefined ? this.contains(token) : !opt_force;\n  if (remove) {\n    this.remove(token);\n    return false;\n  } else {\n    this.add(token);\n    return true;\n  }\n}\n\n\n/**\n * Polyfills `DOMTokenList.prototype.toggle` API in IE.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (isIe(win) && win.DOMTokenList) {\n    win.Object.defineProperty(win.DOMTokenList.prototype, 'toggle', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: domTokenListTogglePolyfill,\n    });\n  }\n}\n\n\n/**\n * Whether the current browser is a IE browser.\n * @param {!Window} win\n * @return {boolean}\n */\nfunction isIe(win) {\n  return /Trident|MSIE|IEMobile/i.test(win.navigator.userAgent);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nimport * as Promise from 'promise-pjs/promise';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = /** @type {?} */ (Promise);\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills'; // eslint-disable-line sort-imports-es6-autofix/sort-imports-es6\n\nimport {Deferred} from './utils/promise';\nimport {dev} from './log';\nimport {toWin} from './types';\n\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (?function(new:Object, !Window)|\n *          ?function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n\n/**\n * This interface provides a `adoptEmbedWindow` method that will be called by\n * runtime for a new embed window.\n * @interface\n */\nexport class EmbeddableService {\n\n  /**\n   * Instructs the service to adopt the embed window and add any necessary\n   * listeners and resources.\n   * @param {!Window} unusedEmbedWin\n   */\n  adoptEmbedWindow(unusedEmbedWin) {}\n}\n\n\n/**\n * Returns a service with the given id. Assumes that it has been registered\n * already.\n * @param {!Window} win\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceInEmbedScope(win, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n  if (local) {\n    return local;\n  }\n  if (opt_fallbackToTopWin) {\n    return getService(win, id);\n  }\n  return null;\n}\n\n/**\n * Returns a service with the given id. Assumes that it has been constructed\n * already.\n *\n * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n * services since sometimes we only have the FIE Document for context.\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {boolean=} opt_fallbackToTopWin\n * @return {Object} The service.\n */\nexport function getExistingServiceForDocInEmbedScope(\n  nodeOrDoc, id, opt_fallbackToTopWin) {\n  // First, try to resolve via local (embed) window.\n  if (nodeOrDoc.nodeType) {\n    // If a node is passed, try to resolve via this node.\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    const local = getLocalExistingServiceForEmbedWinOrNull(win, id);\n    if (local) {\n      return local;\n    }\n  }\n  // If an ampdoc is passed or fallback is allowed, continue resolving.\n  if (!nodeOrDoc.nodeType || opt_fallbackToTopWin) {\n    return getServiceForDocDeprecated(nodeOrDoc, id);\n  }\n  return null;\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedScope(embedWin, id, service) {\n  const topWin = getTopWindow(embedWin);\n  dev().assert(embedWin != topWin,\n      'Service override can only be installed in embed window: %s', id);\n  dev().assert(!getLocalExistingServiceForEmbedWinOrNull(embedWin, id),\n      'Service override has already been installed: %s', id);\n  registerServiceInternal(embedWin, embedWin, id, () => service);\n  getServiceInternal(embedWin, id); // Force service to build.\n}\n\n/**\n * @param {!Window} embedWin\n * @param {string} id\n * @return {?Object}\n */\nfunction getLocalExistingServiceForEmbedWinOrNull(embedWin, id) {\n  // Note that this method currently only resolves against the given window.\n  // It does not try to go all the way up the parent window chain. We can change\n  // this in the future, but for now this gives us a better performance.\n  const topWin = getTopWindow(embedWin);\n  if (embedWin != topWin && isServiceRegistered(embedWin, id)) {\n    return getServiceInternal(embedWin, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win,\n  id,\n  constructor,\n  opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * tl;dr -- Use getServiceForDoc() instead of this.\n *\n * Privileged variant of getServiceForDoc() that accepts non-element params,\n * e.g. window.document. This is currently necessary for doc-level services\n * used in startup, e.g. Chunks. Eventually we want to remove this function\n * and have callers find the appropriate AmpDoc and use getServiceForDoc().\n *\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDocDeprecated(nodeOrDoc, id) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n      getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || win;\n}\n\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window} topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = toWin(/** @type {!Document} */ (\n      nodeOrDoc.ownerDocument || nodeOrDoc).defaultView);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc'));\n}\n\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n * @template T\n */\nfunction getServiceInternal(holder, id) {\n  dev().assert(isServiceRegistered(holder, id),\n      `Expected service ${id} to be registered`);\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    dev().assert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    dev().assert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    dev().assert(s.obj, `Service ${id} constructed to null.`);\n    s.ctor = null;\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n */\nfunction registerServiceInternal(holder, context, id, ctor) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      context: null,\n      ctor: null,\n    };\n  }\n\n  if (s.ctor || s.obj) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const deferred = new Deferred();\n  const {promise, resolve} = deferred;\n\n  const services = getServices(holder);\n  services[id] = {\n    obj: null,\n    promise,\n    resolve,\n    context: null,\n    ctor: null,\n  };\n  return promise;\n}\n\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return s.promise = Promise.resolve(/** @type {!Object} */ (s.obj));\n    }\n  }\n  return null;\n}\n\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let {services} = holder;\n  if (!services) {\n    services = holder.services = {};\n  }\n  return services;\n}\n\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  dev().assert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  // TODO(dvoytenko): Consider marking holder as destroyed for later-arriving\n  // service to be canceled automatically.\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then(\n          instance => disposeServiceInternal(id, instance));\n    }\n  }\n}\n\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n\n/**\n * Whether the specified service implements `EmbeddableService` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isEmbeddable(service) {\n  return typeof service.adoptEmbedWindow == 'function';\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n */\nexport function adoptServiceForEmbed(embedWin, serviceId) {\n  const adopted = adoptServiceForEmbedIfEmbeddable(embedWin, serviceId);\n  dev().assert(adopted, `Service ${serviceId} not found on parent ` +\n      'or doesn\\'t implement EmbeddableService.');\n}\n\n\n/**\n * Adopts an embeddable (implements `EmbeddableService` interface) service\n * in embed scope.\n * @param {!Window} embedWin\n * @param {string} serviceId\n * @return {boolean}\n */\nexport function adoptServiceForEmbedIfEmbeddable(embedWin, serviceId) {\n  const frameElement = /** @type {!Node} */ (dev().assert(\n      embedWin.frameElement,\n      'frameElement not found for embed'));\n  const ampdoc = getAmpdoc(frameElement);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (!isServiceRegistered(holder, serviceId)) {\n    return false;\n  }\n  const service = getServiceForDocDeprecated(frameElement, serviceId);\n  if (!isEmbeddable(service)) {\n    return false;\n  }\n  service.adoptEmbedWindow(embedWin);\n  return true;\n}\n\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.services) {\n    holder.services[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.services && holder.services[id];\n  // All registered services must have an implementation or a constructor.\n  return !!(service && (service.ctor || service.obj));\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getAmpdoc,\n  getExistingServiceForDocInEmbedScope,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocDeprecated,\n  getServicePromiseForDoc,\n} from './service';\nimport {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from './element-service';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'access', 'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'access',\n          'amp-access')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc, 'subscriptions',\n          'amp-subscriptions')));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(nodeOrDoc) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'action', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!Activity>}\n   */\n  static activityForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!Activity>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'activity', 'amp-analytics'));\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc'));\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(elementOrAmpDoc) {\n    return getAmpdoc(elementOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(elementOrAmpDoc, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(elementOrAmpDoc);\n      Services.extensionsFor(ampdoc.win)./*OK*/installExtensionForDoc(\n          ampdoc, 'amp-analytics');\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(elementOrAmpDoc, 'amp-analytics-instrumentation',\n          'amp-analytics'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'amp-analytics-instrumentation', 'amp-analytics'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n          elementOrAmpDoc, 'bind', 'amp-bind'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.Cid>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.Cid>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return (/** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/document-state.DocumentState}\n   */\n  static documentStateFor(window) {\n    return getService(window, 'documentState');\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions'));\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/layers-impl.LayoutLayers}\n   */\n  static layersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/layers-impl.LayoutLayers} */ (\n      getServiceForDoc(elementOrAmpDoc, 'layers'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Resources is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/resources-impl.Resources}\n   */\n  static resourcesForDoc(nodeOrDoc) {\n    return /** @type {!./service/resources-impl.Resources} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'resources'));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?{incomingFragment: string, outgoingFragment: string}>}\n   */\n  static shareTrackingForOrNull(win) {\n    return (/** @type {!Promise<?{incomingFragment: string, outgoingFragment: string}>} */ (\n      getElementServiceIfAvailable(win, 'share-tracking',\n          'amp-share-tracking', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.StoryVariableDef>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story',\n          true)));\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService|?../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (/** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request')));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/1.0/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization', 'amp-story', true)));\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/1.0/localization.LocalizationService}\n   */\n  static localizationService(win) {\n    return getService(win, 'localization');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreServiceV01(win) {\n    return getService(win, 'story-store');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestServiceV01(win) {\n    return getService(win, 'story-request-v01');\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNullV01(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-story/0.1/localization.LocalizationService>} */\n      (getElementServiceIfAvailable(win, 'localization-v01', 'amp-story',\n          true)));\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!../extensions/amp-story/0.1/localization.LocalizationService}\n   */\n  static localizationServiceV01(win) {\n    return getService(win, 'localization-v01');\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>}\n   */\n  static viewerIntegrationVariableServiceForOrNull(win) {\n    return (\n    /** @type {!Promise<?../extensions/amp-viewer-integration/0.1/variable-service.ViewerIntegrationVariableDef>} */\n      (getElementServiceIfAvailable(win, 'viewer-integration-variable',\n          'amp-viewer-integration', true)));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(\n          elementOrAmpDoc, 'web-animation', 'amp-animation')));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesFor(window) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getService(window, 'templates'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getService(window, 'timer'));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url-replace', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(elementOrAmpDoc) {\n    return (/** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (getElementServiceForDoc(elementOrAmpDoc, 'userNotificationManager',\n          'amp-user-notification')));\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(elementOrAmpDoc) {\n    return (/** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (getElementServiceIfAvailableForDoc(elementOrAmpDoc,\n          'consentPolicyManager', 'amp-consent')));\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(elementOrAmpDoc) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(\n          elementOrAmpDoc, 'geo', 'amp-geo', true));\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(nodeOrDoc) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getExistingServiceForDocInEmbedScope(\n          nodeOrDoc, 'url', /* opt_fallbackToTopWin */ true));\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Window} win\n   * @return {!Promise<?Object<string>>}\n   */\n  static variantForOrNull(win) {\n    return /** @type {!Promise<?Object<string>>} */ (\n      getElementServiceIfAvailable(win, 'variant', 'amp-experiment', true));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-service-interface.VideoServiceInterface}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return (\n      /** @type {!./service/video-service-interface.VideoServiceInterface} */ (\n        getServiceForDoc(elementOrAmpDoc, 'video-manager')));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewer is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewer-impl.Viewer}\n   */\n  static viewerForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewer-impl.Viewer} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewer'));\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-impl.Viewer>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-impl.Viewer>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync'));\n  }\n\n  /**\n   * Uses getServiceForDocDeprecated() since Viewport is a startup service.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n   * @return {!./service/viewport/viewport-impl.Viewport}\n   */\n  static viewportForDoc(nodeOrDoc) {\n    return /** @type {!./service/viewport/viewport-impl.Viewport} */ (\n      getServiceForDocDeprecated(nodeOrDoc, 'viewport'));\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {map} from './utils/object.js';\n\nlet container;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!container || container.ownerDocument !== doc) {\n    container = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  dev().assert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  dev().assert(el, 'No elements in template');\n  dev().assert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container./*OK*/innerHTML = '';\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = dev().assert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    dev().assert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = hash * 33 ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {map} from './utils/object.js';\nimport {startsWith} from './string';\n\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (startsWith(camelCase, '--')) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  for (const k in styles) {\n    element.style.setProperty(\n        getVendorJsPropertyName(styles, k), styles[k].toString(), 'important');\n  }\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] =\n      /** @type {string} */ (opt_units ? value + opt_units : value);\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = getStyle(element, 'display') == 'none';\n  }\n  setStyle(element, 'display', opt_display ? '' : 'none');\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n      /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g, '($1,$2,$3, 1)');\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!Object<string, string>}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */(win.getComputedStyle(el));\n  return /** @type {!Object<string, string>} */(style) || map();\n}\n\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  const styleObj = {};\n  properties.forEach(prop => {\n    styleObj[prop] = null;\n  });\n  setStyles(element, styleObj);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {!Window|null} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = tryDecodeUriComponent_(match[1], match[1]);\n    const value = match[2] ? tryDecodeUriComponent_(match[2], match[2]) : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * DO NOT import the function from this file. Instead, import\n * tryDecodeUriComponent from `src/url.js`.\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent_(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './utils/lru-cache';\nimport {dict} from './utils/object';\nimport {endsWith, startsWith} from './string';\nimport {getMode} from './mode';\nimport {isArray} from './types';\nimport {parseQueryString_} from './url-parse-query-string';\nimport {tryDecodeUriComponent_} from './url-try-decode-uri-component';\nimport {urls} from './config';\nimport {user} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = self.UrlCache || (self.UrlCache = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if ((info.protocol == 'http:' && info.port == 80)\n      || (info.protocol == 'https:' && info.port == 443)) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  if (a.origin && a.origin != 'null') {\n    info.origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    info.origin = info.href;\n  } else {\n    info.origin = info.protocol + '//' + info.host;\n  }\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = (getMode().test && Object.freeze) ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(url, paramString,\n  opt_addToFront) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl = mainAndQuery[0] + (\n    mainAndQuery[1]\n      ? (opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`)\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (url.protocol == 'https:' ||\n      url.hostname == 'localhost' ||\n      endsWith(url.hostname, '.localhost'));\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString, elementContext, sourceName = 'source') {\n  user().assert(urlString != null, '%s %s must be available',\n      elementContext, sourceName);\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  user().assert(isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n      '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, sourceName, theUrlString);\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  user().assert(/^https?\\:/i.test(urlString),\n      'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n      urlString);\n  return parseUrlDeprecated(urlString).href;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * This function is implemented in a separate file to avoid a circular\n * dependency.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  return parseQueryString_(queryString);\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n      .replace(AMP_JS_PARAMS_REGEX, '')\n      .replace(AMP_GSA_PARAMS_REGEX, '')\n      .replace(AMP_R_PARAMS_REGEX, '')\n      .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n      .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  user().assert(SERVING_TYPE_PREFIX[prefix],\n      'Unknown path prefix in url %s', url.href);\n  const domainOrHttpsSignal = path[2];\n  const origin = domainOrHttpsSignal == 's'\n    ? 'https://' + decodeURIComponent(path[3])\n    : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  user().assert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return origin + path.join('/') +\n      removeAmpJsParamsFromSearch(url.search) + (url.hash || '');\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private Visible for testing.\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (startsWith(relativeUrlString.toLowerCase(), relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (startsWith(relativeUrlString, '//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (startsWith(relativeUrlString, '/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return baseUrl.origin + baseUrl.pathname.replace(/\\/[^/]*$/, '/')\n      + relativeUrlString;\n}\n\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  user().assert(!(SOURCE_ORIGIN_PARAM in query),\n      'Source origin is not allowed in %s', url);\n}\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} opt_fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, opt_fallback) {\n  return tryDecodeUriComponent_(component, opt_fallback);\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order.\n * Notice that it does NOT handle NaN case as expected\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * A bit like Array#filter, but removes elements that filter false from the\n * array. Returns the filtered items.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} filter\n * @return {!Array<T>}\n * @template T\n */\nexport function filterSplice(array, filter) {\n  const splice = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (filter(item, i, array)) {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    } else {\n      splice.push(item);\n    }\n  }\n\n  if (index < array.length) {\n    array.length = index;\n  }\n\n  return splice;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n  }\n}\n","/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../log';\n\n/** @const {string} */\nconst TAG = 'lru-cache';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = Object.create(null);\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    dev().warn(TAG, 'Trimming LRU cache');\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {t, s, d} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    Object.keys(s).forEach(key => {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          return;\n        }\n      }\n      t[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /**\n   * Creates an instance of Deferred.\n   */\n  constructor() {\n    let resolve, reject;\n\n    /**\n     * @const {!Promise<T>}\n     */\n    this.promise = new /*OK*/Promise((res, rej) => {\n      resolve = res;\n      reject = rej;\n    });\n\n    /**\n     * @const {function(T=)}\n     */\n    this.resolve = resolve;\n\n    /**\n     * @const {function(*=)}\n     */\n    this.reject = reject;\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise(resolve => {\n    resolve(fn());\n  });\n}\n\n/**\n * Returns a promise which resolves if a threshold amount of the given promises\n * resolve, and rejects otherwise.\n * @param {!Array<!Promise>} promises The array of promises to test.\n * @param {number} count The number of promises that must resolve for the\n *     returned promise to resolve.\n * @return {!Promise} A promise that resolves if any of the given promises\n *     resolve, and which rejects otherwise.\n */\nexport function some(promises, count = 1) {\n  return new Promise((resolve, reject) => {\n    count = Math.max(count, 0);\n    const extra = promises.length - count;\n    if (extra < 0) {\n      reject(new Error('not enough promises to resolve'));\n    }\n    if (promises.length == 0) {\n      resolve([]);\n    }\n    const values = [];\n    const reasons = [];\n\n    const onFulfilled = value => {\n      if (values.length < count) {\n        values.push(value);\n      }\n      if (values.length == count) {\n        resolve(values);\n      }\n    };\n    const onRejected = reason => {\n      if (reasons.length <= extra) {\n        reasons.push(reason);\n      }\n      if (reasons.length > extra) {\n        reject(reasons);\n      }\n    };\n    for (let i = 0; i < promises.length; i++) {\n      Promise.resolve(promises[i]).then(onFulfilled, onRejected);\n    }\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!Promise>=} opt_promises\n   */\n  constructor(opt_promises) {\n    let resolve_, reject_;\n    /** @private @const {!Promise} */\n    this.promise_ = new Promise((resolve, reject) => {\n      resolve_ = resolve;\n      reject_ = reject;\n    });\n\n    /** @private */\n    this.resolve_ = resolve_;\n\n    /** @private */\n    this.reject_ = reject_;\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (let i = 0; i < opt_promises.length; i++) {\n        this.add(opt_promises[i]);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!Promise} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    Promise.resolve(promise).then(result => {\n      if (this.count_ === countAtAdd) {\n        this.resolve_(result);\n      }\n    }, error => {\n      // Don't follow behavior of Promise.all and Promise.race error so that\n      // this will only reject when most recently added promise fails.\n      if (this.count_ === countAtAdd) {\n        this.reject_(error);\n      }\n    });\n    return this.promise_;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.promise_.then(opt_resolve, opt_reject);\n  }\n}\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9hbXAtYXBlc3Rlci1tZWRpYS0wLjEuY3NzLmpzIiwiZXh0ZW5zaW9ucy9hbXAtYXBlc3Rlci1tZWRpYS8wLjEvYW1wLWFwZXN0ZXItbWVkaWEuanMiLCJleHRlbnNpb25zL2FtcC1hcGVzdGVyLW1lZGlhLzAuMS91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZC5qcyIsIm5vZGVfbW9kdWxlcy9wcm9taXNlLXBqcy9wcm9taXNlLmpzIiwic3JjLzNwLWZyYW1lLW1lc3NhZ2luZy5qcyIsInNyYy9jb25maWcuanMiLCJzcmMvY29va2llcy5qcyIsInNyYy9kb20uanMiLCJzcmMvZWxlbWVudC1zZXJ2aWNlLmpzIiwic3JjL2V2ZW50LWhlbHBlci1saXN0ZW4uanMiLCJzcmMvZXZlbnQtaGVscGVyLmpzIiwic3JjL2V4cGVyaW1lbnRzLmpzIiwic3JjL2lmcmFtZS1oZWxwZXIuanMiLCJzcmMvaW50ZXJzZWN0aW9uLW9ic2VydmVyLXBvbHlmaWxsLmpzIiwic3JjL2pzb24uanMiLCJzcmMvbGF5b3V0LXJlY3QuanMiLCJzcmMvbGF5b3V0LmpzIiwic3JjL2xvZy5qcyIsInNyYy9tb2RlLW9iamVjdC5qcyIsInNyYy9tb2RlLmpzIiwic3JjL3BvbHlmaWxscy5qcyIsInNyYy9wb2x5ZmlsbHMvYXJyYXktaW5jbHVkZXMuanMiLCJzcmMvcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cy5qcyIsInNyYy9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMuanMiLCJzcmMvcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUuanMiLCJzcmMvcG9seWZpbGxzL21hdGgtc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvb2JqZWN0LWFzc2lnbi5qcyIsInNyYy9wb2x5ZmlsbHMvcHJvbWlzZS5qcyIsInNyYy9zZXJ2aWNlLmpzIiwic3JjL3NlcnZpY2VzLmpzIiwic3JjL3N0YXRpYy10ZW1wbGF0ZS5qcyIsInNyYy9zdHJpbmcuanMiLCJzcmMvc3R5bGUuanMiLCJzcmMvdHlwZXMuanMiLCJzcmMvdXJsLXBhcnNlLXF1ZXJ5LXN0cmluZy5qcyIsInNyYy91cmwtdHJ5LWRlY29kZS11cmktY29tcG9uZW50LmpzIiwic3JjL3VybC5qcyIsInNyYy91dGlscy9hcnJheS5qcyIsInNyYy91dGlscy9scnUtY2FjaGUuanMiLCJzcmMvdXRpbHMvb2JqZWN0LmpzIiwic3JjL3V0aWxzL3Byb21pc2UuanMiLCJ0aGlyZF9wYXJ0eS9jc3MtZXNjYXBlL2Nzcy1lc2NhcGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUNBTyxJQUFNLG9CQUFNLGtoSUFBWjs7Ozs7QUNlUDs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFPQTs7QUFDQTs7Ozs7OytlQTdCQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUErQkE7QUFDQSxJQUFNLE1BQU0sbUJBQVo7QUFDQTs7O0FBR0EsSUFBTSxvQkFBb0I7QUFDeEIsbUJBQWlCLGVBRE87QUFFeEIsc0JBQW9CLGdCQUZJO0FBR3hCLGVBQWE7QUFIVyxDQUExQjs7QUFNQTs7OztJQUdNLGU7OztBQUNKO0FBQ0EsMkJBQVksT0FBWixFQUFxQjtBQUFBOztBQUVuQjs7O0FBRm1CLGtJQUNiLE9BRGE7O0FBS25CLFVBQUssZ0JBQUwsR0FBd0IsOEJBQXhCO0FBQ0E7OztBQUdBLFVBQUssZUFBTCxHQUF1Qiw2QkFBdkI7QUFDQTs7O0FBR0EsVUFBSyxjQUFMLEdBQXNCLDJCQUF0QjtBQUNBOzs7QUFHQSxVQUFLLFVBQUwsR0FBa0IsZ0RBQWxCO0FBQ0E7QUFDQSxVQUFLLEtBQUwsR0FBYSxLQUFiO0FBQ0E7QUFDQSxVQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0E7QUFDQSxVQUFLLE1BQUwsR0FBYyxLQUFkO0FBQ0E7QUFDQSxVQUFLLE1BQUws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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ242Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7UUN6YmdCLE0sR0FBQSxNO1FBZUEsZ0IsR0FBQSxnQjtRQWlCQSxrQixHQUFBLGtCO1FBb0JBLFksR0FBQSxZOztBQTlHaEI7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7QUF0QkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1QkEsSUFBTSxxQkFBcUIsTUFBM0I7QUFDTyxJQUFNLGdDQUFZO0FBQ3ZCLHNCQUFvQixTQURHO0FBRXZCLHNCQUFvQixXQUZHO0FBR3ZCLG9CQUFrQixTQUhLO0FBSXZCLG9CQUFrQjtBQUpLLENBQWxCOztBQU9QO0FBQ08sSUFBTSxvQ0FBYztBQUN6QjtBQUNBLG9CQUFrQixrQkFGTztBQUd6QixlQUFhLGFBSFk7QUFJekIsc0JBQW9CLG9CQUpLO0FBS3pCLGlCQUFlLGVBTFU7QUFNekIsc0JBQW9CLG9CQU5LO0FBT3pCLGdCQUFjLGNBUFc7QUFRekIsY0FBWSxZQVJhO0FBU3pCLHNCQUFvQixvQkFUSztBQVV6QixxQkFBbUIsbUJBVk07QUFXekIsY0FBWSxZQVhhO0FBWXpCLFlBQVUsVUFaZTtBQWF6QixxQkFBbUIsbUJBYk07O0FBZXpCO0FBQ0Esc0JBQW9CLG9CQWhCSztBQWlCekIsK0JBQTZCLDZCQWpCSjtBQWtCekIsNkJBQTJCLDJCQWxCRjtBQW1CekIsc0NBQW9DLG9DQW5CWDs7QUFxQnpCO0FBQ0Esa0JBQWdCLGdCQXRCUztBQXVCekIsWUFBVSxVQXZCZTs7QUF5QnpCO0FBQ0EsZ0NBQThCLDhCQTFCTDtBQTJCekIsMkJBQXlCLHlCQTNCQTtBQTRCekIsNkJBQTJCLDJCQTVCRjs7QUE4QnpCO0FBQ0Esd0JBQXNCO0FBL0JHLENBQXBCOztBQWtDUDs7Ozs7Ozs7QUFRTyxTQUFTLE1BQVQsQ0FBZ0IsT0FBaEIsRUFBeUIsU0FBekIsRUFBb0MsUUFBcEMsRUFBOEMsbUJBQTlDLEVBQW1FO0FBQ3hFLFNBQU8scURBQ0gsT0FERyxFQUNNLFNBRE4sRUFDaUIsUUFEakIsRUFDMkIsbUJBRDNCLENBQVA7QUFFRDs7QUFHRDs7Ozs7Ozs7O0FBU08sU0FBUyxnQkFBVCxDQUEwQixJQUExQixFQUFnQyxRQUFoQyxFQUNjO0FBQUEsTUFENEIsSUFDNUIsdUVBRG1DLG1CQUNuQztBQUFBLE1BQW5CLFVBQW1CLHVFQUFOLElBQU07O0FBQ25CO0FBQ0EsTUFBTSxVQUFVLElBQWhCO0FBQ0EsVUFBUSxNQUFSLElBQWtCLElBQWxCO0FBQ0EsVUFBUSxVQUFSLElBQXNCLFFBQXRCO0FBQ0EsU0FBTyxzQkFBc0IsY0FBYyxFQUFwQyxJQUEwQyxLQUFLLFNBQUwsQ0FBZSxPQUFmLENBQWpEO0FBQ0Q7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLGtCQUFULENBQTRCLE9BQTVCLEVBQXFDO0FBQzFDLE1BQUksQ0FBQyxhQUFhLE9BQWIsQ0FBTCxFQUE0QjtBQUMxQixXQUFPLElBQVA7QUFDRDtBQUNELE1BQU0sV0FBVyxRQUFRLE9BQVIsQ0FBZ0IsR0FBaEIsQ0FBakI7QUFDQSxrQkFBTSxNQUFOLENBQWEsWUFBWSxDQUFDLENBQTFCLEVBQTZCLG9CQUE3QixFQUFtRCxPQUFuRDtBQUNBLE1BQUk7QUFDRixXQUFPLHFCQUFVLFFBQVEsTUFBUixDQUFlLFFBQWYsQ0FBVixDQUFQO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1Ysb0JBQU0sS0FBTixDQUFZLFdBQVosRUFBeUIsOEJBQThCLE9BQXZELEVBQWdFLENBQWhFO0FBQ0EsV0FBTyxJQUFQO0FBQ0Q7QUFDRjs7QUFHRDs7Ozs7QUFLTyxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0I7QUFDcEMsU0FBUSxPQUFPLE9BQVAsSUFBa0IsUUFBbEIsSUFDSixRQUFRLE9BQVIsQ0FBZ0Isa0JBQWhCLEtBQXVDLENBRG5DLElBRUosUUFBUSxPQUFSLENBQWdCLEdBQWhCLEtBQXdCLENBQUMsQ0FGN0I7QUFHRDs7QUFFRDtBQUNPLElBQUksNERBQUo7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQ2pKQTs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7OztBQU9BLElBQU0sTUFBTSxLQUFLLFVBQUwsSUFBbUIsRUFBL0I7O0FBRUEsSUFBTSx1QkFBdUIsT0FBTyxJQUFJLHNCQUFKLENBQVAsSUFBc0MsUUFBdEMsR0FDM0IsSUFBSSxNQUFKLENBQVcsSUFBSSxzQkFBSixDQUFYLENBRDJCLEdBQ2UsSUFBSSxzQkFBSixDQUQ1Qzs7QUFHQSxJQUFNLGdCQUFnQixPQUFPLElBQUksZUFBSixDQUFQLElBQStCLFFBQS9CLEdBQ3BCLElBQUksTUFBSixDQUFXLElBQUksZUFBSixDQUFYLENBRG9CLEdBQ2UsSUFBSSxlQUFKLENBRHJDOztBQUdBO0FBQ08sSUFBTSxzQkFBTztBQUNsQixjQUFZLElBQUksZUFBSixLQUF3QiwyQkFEbEI7QUFFbEIsdUJBQXFCLElBQUkscUJBQUosS0FBOEIsZ0JBRmpDO0FBR2xCLHdCQUFzQix3QkFBd0IsMEJBSDVCO0FBSWxCLE9BQUssSUFBSSxRQUFKLEtBQWlCLDRCQUpKO0FBS2xCOzs7QUFHQSxpQkFBZSxpQkFDWCxxREFUYztBQVVsQixrQkFBZ0IsK0JBVkU7QUFXbEIsa0JBQWdCLElBQUksbUJBQUosS0FDWiwyQ0FaYztBQWFsQixZQUFVLElBQUksVUFBSixLQUFtQjtBQWJYLENBQWI7O0FBZ0JBLElBQU0sMEJBQVM7QUFDcEI7QUFEb0IsQ0FBZjs7Ozs7O1FDWlMsUyxHQUFBLFM7UUF5REEsUyxHQUFBLFM7O0FBN0VoQjs7QUFDQTs7QUFLQTs7QUFHQTs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLFNBQVQsQ0FBbUIsR0FBbkIsRUFBd0IsSUFBeEIsRUFBOEI7QUFDbkMsTUFBTSxlQUFlLDZCQUE2QixHQUE3QixDQUFyQjtBQUNBLE1BQUksQ0FBQyxZQUFMLEVBQW1CO0FBQ2pCLFdBQU8sSUFBUDtBQUNEO0FBQ0QsTUFBTSxVQUFVLGFBQWEsS0FBYixDQUFtQixHQUFuQixDQUFoQjtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxRQUFRLE1BQTVCLEVBQW9DLEdBQXBDLEVBQXlDO0FBQ3ZDLFFBQU0sU0FBUyxRQUFRLENBQVIsRUFBVyxJQUFYLEVBQWY7QUFDQSxRQUFNLEtBQUssT0FBTyxPQUFQLENBQWUsR0FBZixDQUFYO0FBQ0EsUUFBSSxNQUFNLENBQUMsQ0FBWCxFQUFjO0FBQ1o7QUFDRDtBQUNELFFBQUksZ0NBQXNCLE9BQU8sU0FBUCxDQUFpQixDQUFqQixFQUFvQixFQUFwQixFQUF3QixJQUF4QixFQUF0QixLQUF5RCxJQUE3RCxFQUFtRTtBQUNqRSxVQUFNLFFBQVEsT0FBTyxTQUFQLENBQWlCLEtBQUssQ0FBdEIsRUFBeUIsSUFBekIsRUFBZDtBQUNBLGFBQU8sZ0NBQXNCLEtBQXRCLEVBQTZCLEtBQTdCLENBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUF4REE7Ozs7Ozs7Ozs7Ozs7Ozs7QUErREEsU0FBUyw0QkFBVCxDQUFzQyxHQUF0QyxFQUEyQztBQUN6QyxNQUFJO0FBQ0YsV0FBTyxJQUFJLFFBQUosQ0FBYSxNQUFwQjtBQUNELEdBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLFdBQU8sRUFBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQk8sU0FBUyxTQUFULENBQW1CLEdBQW5CLEVBQXdCLElBQXhCLEVBQThCLEtBQTlCLEVBQXFDLGNBQXJDLEVBQXFELFdBQXJELEVBQWtFO0FBQ3ZFLDhCQUE0QixHQUE1QixFQUFpQyxXQUFqQyxFQUE4QyxJQUE5QztBQUNBLE1BQUksZUFBZSxZQUFZLHNCQUEvQixFQUF1RDtBQUNyRCxRQUFNLFFBQVEsSUFBSSxRQUFKLENBQWEsUUFBYixDQUFzQixLQUF0QixDQUE0QixHQUE1QixDQUFkO0FBQ0EsUUFBSSxVQUFTLE1BQU0sTUFBTSxNQUFOLEdBQWUsQ0FBckIsQ0FBYjtBQUNBLFNBQUssSUFBSSxJQUFJLE1BQU0sTUFBTixHQUFlLENBQTVCLEVBQStCLEtBQUssQ0FBcEMsRUFBdUMsR0FBdkMsRUFBNEM7QUFDMUMsZ0JBQVMsTUFBTSxDQUFOLElBQVcsR0FBWCxHQUFpQixPQUExQjtBQUNBLG1CQUFhLEdBQWIsRUFBa0IsSUFBbEIsRUFBd0IsS0FBeEIsRUFBK0IsY0FBL0IsRUFBK0MsT0FBL0M7QUFDQSxVQUFJLFVBQVUsR0FBVixFQUFlLElBQWYsS0FBd0IsS0FBNUIsRUFBbUM7QUFDakM7QUFDRDtBQUNGO0FBQ0Y7QUFDRCxNQUFJLFNBQVMsU0FBYjtBQUNBLE1BQUksZUFBZSxZQUFZLE1BQS9CLEVBQXVDO0FBQ3JDLGFBQVMsWUFBWSxNQUFyQjtBQUNEO0FBQ0QsZUFBYSxHQUFiLEVBQWtCLElBQWxCLEVBQXdCLEtBQXhCLEVBQStCLGNBQS9CLEVBQStDLE1BQS9DO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNBLFNBQVMsWUFBVCxDQUFzQixHQUF0QixFQUEyQixJQUEzQixFQUFpQyxLQUFqQyxFQUF3QyxjQUF4QyxFQUF3RCxNQUF4RCxFQUFnRTtBQUM5RDtBQUNBO0FBQ0EsTUFBSSxVQUFVLGdCQUFkLEVBQWdDO0FBQzlCO0FBQ0EsWUFBUSxRQUFSO0FBQ0EscUJBQWlCLENBQWpCO0FBQ0Q7QUFDRCxNQUFNLFNBQVMsbUJBQW1CLElBQW5CLElBQTJCLEdBQTNCLEdBQ1gsbUJBQW1CLEtBQW5CLENBRFcsR0FFWCxVQUZXLElBR1YsU0FBUyxjQUFjLE1BQXZCLEdBQWdDLEVBSHRCLElBSVgsWUFKVyxHQUlJLElBQUksSUFBSixDQUFTLGNBQVQsRUFBeUIsV0FBekIsRUFKbkI7QUFLQSxNQUFJO0FBQ0YsUUFBSSxRQUFKLENBQWEsTUFBYixHQUFzQixNQUF0QjtBQUNELEdBRkQsQ0FFRSxPQUFPLE1BQVAsRUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUywyQkFBVCxDQUFxQyxHQUFyQyxFQUEwQyxPQUExQyxFQUFtRCxJQUFuRCxFQUF5RDtBQUN2RCxNQUFJLFdBQVcsUUFBUSxrQkFBdkIsRUFBMkM7QUFDekM7QUFDRDtBQUNELE1BQUksd0JBQWMsSUFBSSxRQUFKLENBQWEsSUFBM0IsQ0FBSixFQUFzQztBQUNwQyxVQUFNLElBQUksS0FBSixDQUFVLHlEQUNWLElBREEsQ0FBTjtBQUVEOztBQUVELE1BQU0sVUFBVSw2QkFBbUIsSUFBSSxRQUFKLENBQWEsSUFBaEMsRUFBc0MsUUFBdEMsQ0FBK0MsV0FBL0MsRUFBaEI7QUFDQSxNQUFNLFFBQVEsNkJBQW1CLGFBQUssR0FBeEIsRUFBNkIsUUFBN0IsQ0FBc0MsV0FBdEMsRUFBZDtBQUNBLE1BQUksV0FBVyxLQUFYLElBQW9CLHNCQUFTLE9BQVQsRUFBa0IsTUFBTSxLQUF4QixDQUF4QixFQUF3RDtBQUN0RCxVQUFNLElBQUksS0FBSixDQUFVLHdEQUNWLHFCQURVLEdBQ2MsSUFEeEIsQ0FBTjtBQUVEO0FBQ0Y7Ozs7Ozs7UUN2SGUsWSxHQUFBLFk7UUFrQ0EsbUIsR0FBQSxtQjtRQWFBLFcsR0FBQSxXO1FBVUEsa0IsR0FBQSxrQjtRQVdBLGEsR0FBQSxhO1FBV0EsYyxHQUFBLGM7UUFjQSxZLEdBQUEsWTtRQWVBLG9CLEdBQUEsb0I7UUFXQSxzQixHQUFBLHNCO1FBY0EsMkIsR0FBQSwyQjtRQVdBLGUsR0FBQSxlO1FBd0JBLFcsR0FBQSxXO1FBa0JBLE8sR0FBQSxPO1FBaUJBLFcsR0FBQSxXO1FBaUJBLFksR0FBQSxZO1FBZ0JBLGlCLEdBQUEsaUI7UUFnQkEsTyxHQUFBLE87UUFrQkEsWSxHQUFBLFk7UUFrQkEsWSxHQUFBLFk7UUFpQkEsYSxHQUFBLGE7UUFrQkEsZ0IsR0FBQSxnQjtRQWlCQSxVLEdBQUEsVTtRQXFCQSxtQyxHQUFBLG1DO1FBNkJBLGtCLEdBQUEsa0I7UUFXQSxzQixHQUFBLHNCO1FBYUEsbUIsR0FBQSxtQjtRQVdBLGlCLEdBQUEsaUI7UUFXQSxrQixHQUFBLGtCO1FBWUEsbUIsR0FBQSxtQjtRQXdCQSxzQixHQUFBLHNCO1FBMEJBLDJCLEdBQUEsMkI7UUF5QkEsMEIsR0FBQSwwQjtRQWtCQSxnQixHQUFBLGdCO1FBa0JBLHFCLEdBQUEscUI7UUFnQkEsb0IsR0FBQSxvQjtRQW9CQSxhLEdBQUEsYTtRQW1CQSxnQixHQUFBLGdCO1FBdUJBLGUsR0FBQSxlO1FBVUEsaUIsR0FBQSxpQjtRQVVBLEssR0FBQSxLO1FBZ0JBLHNCLEdBQUEsc0I7UUFZQSxvQixHQUFBLG9CO1FBWUEsVSxHQUFBLFU7UUFvQkEsUSxHQUFBLFE7UUFhQSxTLEdBQUEsUztRQVNBLFksR0FBQSxZO1FBZUEsMkIsR0FBQSwyQjtRQXVCQSxlLEdBQUEsZTtRQXFCQSxjLEdBQUEsYztRQW9DQSxtQixHQUFBLG1CO1FBeUJBLFMsR0FBQSxTOztBQTMzQmhCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQXJCQTs7Ozs7Ozs7Ozs7Ozs7OztBQXVCQSxJQUFNLG9CQUFvQjtBQUN4QixPQUFLLE9BRG1CO0FBRXhCLE9BQUssTUFGbUI7QUFHeEIsT0FBSyxNQUhtQjtBQUl4QixPQUFLLFFBSm1CO0FBS3hCLE9BQUssUUFMbUI7QUFNeEIsT0FBSztBQU5tQixDQUExQjtBQVFBLElBQU0sb0JBQW9CLGdCQUExQjs7QUFFQTtBQUNPLElBQU0sOEVBQ1QsZUFERzs7QUFHUDtBQUNPLElBQU0sZ0ZBQ1QsZUFERzs7QUFHUDs7Ozs7OztBQU9PLFNBQVMsWUFBVCxDQUFzQixNQUF0QixFQUE4QixTQUE5QixFQUF5QyxRQUF6QyxFQUFtRDtBQUN4RCxNQUFJLFVBQVUsTUFBVixDQUFKLEVBQXVCO0FBQ3JCO0FBQ0E7QUFDRDtBQUNEO0FBQ0EsTUFBTSxNQUFNLGtCQUFNLE9BQU8sYUFBUCxDQUFxQixXQUEzQixDQUFaO0FBQ0EsTUFBSSxJQUFJLGdCQUFSLEVBQTBCO0FBQ3hCO0FBQ0EsUUFBTSxXQUFXLElBQUksSUFBSSxnQkFBUixDQUF5QixZQUFNO0FBQzlDLFVBQUksVUFBVSxNQUFWLENBQUosRUFBdUI7QUFDckIsaUJBQVMsVUFBVDtBQUNBO0FBQ0Q7QUFDRixLQUxnQixDQUFqQjtBQU1BLGFBQVMsT0FBVCxDQUFpQixNQUFqQixFQUF5QixFQUFDLFdBQVcsSUFBWixFQUF6QjtBQUNELEdBVEQsTUFTTztBQUNMO0FBQ0EsUUFBTSxXQUFXLElBQUksV0FBSixDQUFnQixZQUFNO0FBQ3JDLFVBQUksVUFBVSxNQUFWLENBQUosRUFBdUI7QUFDckIsWUFBSSxhQUFKLENBQWtCLFFBQWxCO0FBQ0E7QUFDRDtBQUNGLEtBTGdCLEVBS2Qsa0JBQW1CLENBTEwsQ0FBakI7QUFNRDtBQUNGOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxtQkFBVCxDQUE2QixNQUE3QixFQUFxQyxTQUFyQyxFQUFnRDtBQUNyRCxTQUFPLElBQUksT0FBSixDQUFZLG1CQUFXO0FBQzVCLGlCQUFhLE1BQWIsRUFBcUIsU0FBckIsRUFBZ0MsT0FBaEM7QUFDRCxHQUZNLENBQVA7QUFHRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsV0FBVCxDQUFxQixHQUFyQixFQUEwQixRQUExQixFQUFvQztBQUN6QyxlQUFhLElBQUksZUFBakIsRUFBa0M7QUFBQSxXQUFNLENBQUMsQ0FBQyxJQUFJLElBQVo7QUFBQSxHQUFsQyxFQUFvRCxRQUFwRDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsa0JBQVQsQ0FBNEIsR0FBNUIsRUFBaUM7QUFDdEMsU0FBTyxJQUFJLE9BQUosQ0FBWSxtQkFBVztBQUM1QixnQkFBWSxHQUFaLEVBQWlCLE9BQWpCO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBR0Q7Ozs7QUFJTyxTQUFTLGFBQVQsQ0FBdUIsT0FBdkIsRUFBZ0M7QUFDckMsTUFBSSxRQUFRLGFBQVosRUFBMkI7QUFDekIsWUFBUSxhQUFSLENBQXNCLFdBQXRCLENBQWtDLE9BQWxDO0FBQ0Q7QUFDRjs7QUFHRDs7OztBQUlPLFNBQVMsY0FBVCxDQUF3QixNQUF4QixFQUFnQztBQUNyQyxTQUFPLE9BQU8sVUFBZCxFQUEwQjtBQUN4QixXQUFPLFdBQVAsQ0FBbUIsT0FBTyxVQUExQjtBQUNEO0FBQ0Y7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLFlBQVQsQ0FBc0IsSUFBdEIsRUFBNEIsRUFBNUIsRUFBZ0M7QUFDckMsTUFBTSxPQUFPLEdBQUcsYUFBSCxDQUFpQixzQkFBakIsRUFBYjtBQUNBLE9BQUssSUFBSSxJQUFJLEtBQUssVUFBbEIsRUFBOEIsQ0FBOUIsRUFBaUMsSUFBSSxFQUFFLFdBQXZDLEVBQW9EO0FBQ2xELFNBQUssV0FBTCxDQUFpQixFQUFFLFNBQUYsQ0FBWSxJQUFaLENBQWpCO0FBQ0Q7QUFDRCxLQUFHLFdBQUgsQ0FBZSxJQUFmO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLG9CQUFULENBQThCLElBQTlCLEVBQW9DLE9BQXBDLEVBQTZDLEtBQTdDLEVBQW9EO0FBQ3pELE1BQU0sU0FBUyxRQUFRLE1BQU0sV0FBZCxHQUE0QixLQUFLLFVBQWhEO0FBQ0EsT0FBSyxZQUFMLENBQWtCLE9BQWxCLEVBQTJCLE1BQTNCO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsc0JBQVQsQ0FBZ0MsT0FBaEMsRUFBeUMsVUFBekMsRUFBcUQ7QUFDMUQsT0FBSyxJQUFNLElBQVgsSUFBbUIsVUFBbkIsRUFBK0I7QUFDN0IsWUFBUSxZQUFSLENBQXFCLElBQXJCLEVBQTJCLFdBQVcsSUFBWCxDQUEzQjtBQUNEO0FBQ0QsU0FBTyxPQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLDJCQUFULENBQXFDLEdBQXJDLEVBQTBDLE9BQTFDLEVBQW1ELFVBQW5ELEVBQStEO0FBQ3BFLE1BQU0sVUFBVSxJQUFJLGFBQUosQ0FBa0IsT0FBbEIsQ0FBaEI7QUFDQSxTQUFPLHVCQUF1QixPQUF2QixFQUFnQyxVQUFoQyxDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsZUFBVCxDQUF5QixJQUF6QixFQUErQjtBQUNwQyxNQUFNLFlBQVksS0FBSyxXQUF2QjtBQUNBLE1BQUksY0FBYyxTQUFsQixFQUE2QjtBQUMzQixXQUFPLFNBQVA7QUFDRDs7QUFFRDtBQUNBLE1BQUksSUFBSSxJQUFSO0FBQ0EsS0FBRztBQUNELFFBQUksWUFBWSxDQUFaLENBQUo7QUFDQSxRQUFJLEVBQUUsSUFBTixFQUFZO0FBQ1YsVUFBSSxFQUFFLElBQU47QUFDRCxLQUZELE1BRU87QUFDTDtBQUNEO0FBQ0YsR0FQRCxRQU9TLElBUFQ7QUFRQSxTQUFPLEVBQUUsUUFBRixLQUFlLEtBQUssYUFBM0I7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFdBQVQsQ0FBcUIsSUFBckIsRUFBMkI7QUFDaEMsTUFBSSxLQUFLLFNBQUwsQ0FBZSxXQUFuQixFQUFnQztBQUM5QjtBQUNBLFdBQU8sS0FBSyxXQUFMLE1BQXNCLElBQTdCO0FBQ0Q7QUFDRCxNQUFJLFVBQUo7QUFDQSxPQUFLLElBQUksSUFBVCxFQUFlLENBQUMsQ0FBQyxFQUFFLFVBQW5CLEVBQStCLElBQUksRUFBRSxVQUFyQyxFQUFpRCxDQUFFO0FBQ25ELFNBQU8sQ0FBUDtBQUNEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsT0FBVCxDQUFpQixPQUFqQixFQUEwQixRQUExQixFQUFvQyxVQUFwQyxFQUFnRDtBQUNyRCxPQUFLLElBQUksS0FBSyxPQUFkLEVBQXVCLE1BQU0sT0FBTyxVQUFwQyxFQUFnRCxLQUFLLEdBQUcsYUFBeEQsRUFBdUU7QUFDckUsUUFBSSxTQUFTLEVBQVQsQ0FBSixFQUFrQjtBQUNoQixhQUFPLEVBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLFdBQVQsQ0FBcUIsSUFBckIsRUFBMkIsUUFBM0IsRUFBcUM7QUFDMUMsT0FBSyxJQUFJLElBQUksSUFBYixFQUFtQixDQUFuQixFQUFzQixJQUFJLEVBQUUsVUFBNUIsRUFBd0M7QUFDdEMsUUFBSSxTQUFTLENBQVQsQ0FBSixFQUFpQjtBQUNmLGFBQU8sQ0FBUDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLElBQVA7QUFDRDs7QUFHRDs7Ozs7OztBQU9PLFNBQVMsWUFBVCxDQUFzQixPQUF0QixFQUErQixPQUEvQixFQUF3QztBQUM3QyxNQUFJLFFBQVEsT0FBWixFQUFxQjtBQUNuQixXQUFPLFFBQVEsT0FBUixDQUFnQixPQUFoQixDQUFQO0FBQ0Q7QUFDRCxZQUFVLFFBQVEsV0FBUixFQUFWO0FBQ0EsU0FBTyxRQUFRLE9BQVIsRUFBaUIsY0FBTTtBQUM1QixXQUFPLEdBQUcsT0FBSCxJQUFjLE9BQXJCO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsaUJBQVQsQ0FBMkIsT0FBM0IsRUFBb0MsUUFBcEMsRUFBOEM7QUFDbkQsTUFBSSxRQUFRLE9BQVosRUFBcUI7QUFDbkIsV0FBTyxRQUFRLE9BQVIsQ0FBZ0IsUUFBaEIsQ0FBUDtBQUNEOztBQUVELFNBQU8sUUFBUSxPQUFSLEVBQWlCLGNBQU07QUFDNUIsV0FBTyxRQUFRLEVBQVIsRUFBWSxRQUFaLENBQVA7QUFDRCxHQUZNLENBQVA7QUFHRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxPQUFULENBQWlCLEVBQWpCLEVBQXFCLFFBQXJCLEVBQStCO0FBQ3BDLE1BQU0sVUFBVSxHQUFHLE9BQUgsSUFDWixHQUFHLHFCQURTLElBRVosR0FBRyxrQkFGUyxJQUdaLEdBQUcsaUJBSFMsSUFJWixHQUFHLGdCQUpQO0FBS0EsTUFBSSxPQUFKLEVBQWE7QUFDWCxXQUFPLFFBQVEsSUFBUixDQUFhLEVBQWIsRUFBaUIsUUFBakIsQ0FBUDtBQUNEO0FBQ0QsU0FBTyxLQUFQLENBVG9DLENBU3RCO0FBQ2Y7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsWUFBVCxDQUFzQixPQUF0QixFQUErQixPQUEvQixFQUF3QztBQUM3QyxNQUFJLGlCQUFKO0FBQ0E7QUFDQSxNQUFJLE9BQU8sUUFBUSxvQkFBZixLQUF3QyxVQUE1QyxFQUF3RDtBQUN0RCxlQUFXLFFBQVEsb0JBQVIsQ0FBNkIsT0FBN0IsQ0FBWDtBQUNELEdBRkQsTUFFTztBQUNMLGVBQVcsU0FBUSxNQUFNLGdCQUFkLENBQStCLE9BQS9CLENBQVg7QUFDRDtBQUNELFNBQVEsWUFBWSxTQUFTLENBQVQsQ0FBYixJQUE2QixJQUFwQztBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLFlBQVQsQ0FBc0IsTUFBdEIsRUFBOEIsUUFBOUIsRUFBd0M7QUFDN0MsT0FBSyxJQUFJLFFBQVEsT0FBTyxpQkFBeEIsRUFBMkMsS0FBM0MsRUFDRSxRQUFRLE1BQU0sa0JBRGhCLEVBQ29DO0FBQ2xDLFFBQUksU0FBUyxLQUFULENBQUosRUFBcUI7QUFDbkIsYUFBTyxLQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sSUFBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLGFBQVQsQ0FBdUIsTUFBdkIsRUFBK0IsUUFBL0IsRUFBeUM7QUFDOUMsTUFBTSxXQUFXLEVBQWpCO0FBQ0EsT0FBSyxJQUFJLFFBQVEsT0FBTyxpQkFBeEIsRUFBMkMsS0FBM0MsRUFDRSxRQUFRLE1BQU0sa0JBRGhCLEVBQ29DO0FBQ2xDLFFBQUksU0FBUyxLQUFULENBQUosRUFBcUI7QUFDbkIsZUFBUyxJQUFULENBQWMsS0FBZDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLFFBQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxnQkFBVCxDQUEwQixNQUExQixFQUFrQyxRQUFsQyxFQUE0QztBQUNqRCxPQUFLLElBQUksUUFBUSxPQUFPLGdCQUF4QixFQUEwQyxLQUExQyxFQUNFLFFBQVEsTUFBTSxzQkFEaEIsRUFDd0M7QUFDdEMsUUFBSSxTQUFTLEtBQVQsQ0FBSixFQUFxQjtBQUNuQixhQUFPLEtBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLFVBQVQsQ0FBb0IsTUFBcEIsRUFBNEIsUUFBNUIsRUFBc0M7QUFDM0MsTUFBTSxRQUFRLEVBQWQ7QUFDQSxPQUFLLElBQUksUUFBUSxPQUFPLFVBQXhCLEVBQW9DLEtBQXBDLEVBQ0UsUUFBUSxNQUFNLFdBRGhCLEVBQzZCO0FBQzNCLFFBQUksU0FBUyxLQUFULENBQUosRUFBcUI7QUFDbkIsWUFBTSxJQUFOLENBQVcsS0FBWDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLEtBQVA7QUFDRDs7QUFFRDs7OztBQUlBLElBQUksK0JBQUo7O0FBRUE7Ozs7QUFJTyxTQUFTLG1DQUFULENBQTZDLEdBQTdDLEVBQWtEO0FBQ3ZELDJCQUF5QixHQUF6QjtBQUNEOztBQUVEOzs7OztBQUtBLFNBQVMsd0JBQVQsQ0FBa0MsTUFBbEMsRUFBMEM7QUFDeEMsTUFBTSxNQUFNLE9BQU8sYUFBbkI7QUFDQSxNQUFJO0FBQ0YsUUFBTSxjQUFjLElBQUksYUFBSixDQUFrQixLQUFsQixDQUFwQjtBQUNBLFFBQU0sWUFBWSxJQUFJLGFBQUosQ0FBa0IsS0FBbEIsQ0FBbEI7QUFDQSxnQkFBWSxXQUFaLENBQXdCLFNBQXhCO0FBQ0E7QUFDQTtBQUNBLFdBQU8sYUFBWSxNQUFNLGFBQWxCLENBQWdDLFlBQWhDLE1BQWtELFNBQXpEO0FBQ0QsR0FQRCxDQU9FLE9BQU8sQ0FBUCxFQUFVO0FBQ1YsV0FBTyxLQUFQO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxrQkFBVCxDQUE0QixNQUE1QixFQUFvQyxJQUFwQyxFQUEwQztBQUMvQyxTQUFPLG9CQUFtQixNQUFuQixDQUEwQixNQUExQixVQUF3QyxJQUF4QyxPQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsc0JBQVQsQ0FBZ0MsTUFBaEMsRUFBd0MsSUFBeEMsRUFBOEM7QUFDbkQsU0FBTyxpQkFBaUIsTUFBakIsRUFBeUIsY0FBTTtBQUNwQyxXQUFPLEdBQUcsWUFBSCxDQUFnQixJQUFoQixDQUFQO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsbUJBQVQsQ0FBNkIsTUFBN0IsRUFBcUMsSUFBckMsRUFBMkM7QUFDaEQsU0FBTyx1QkFBc0IsTUFBdEIsQ0FBNkIsTUFBN0IsVUFBMkMsSUFBM0MsT0FBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLGlCQUFULENBQTJCLE1BQTNCLEVBQW1DLE9BQW5DLEVBQTRDO0FBQ2pELFNBQU8sb0JBQW1CLE1BQW5CLENBQTBCLE1BQTFCLFNBQXVDLE9BQXZDLENBQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxrQkFBVCxDQUE0QixNQUE1QixFQUFvQyxPQUFwQyxFQUE2QztBQUNsRCxTQUFPLHVCQUFzQixNQUF0QixDQUE2QixNQUE3QixTQUEwQyxPQUExQyxDQUFQO0FBQ0Q7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLG1CQUFULENBQTZCLElBQTdCLEVBQW1DLFFBQW5DLEVBQTZDO0FBQ2xELE1BQUksMEJBQTBCLElBQTlCLEVBQW9DO0FBQ2xDLDZCQUF5Qix5QkFBeUIsSUFBekIsQ0FBekI7QUFDRDtBQUNELE1BQUksc0JBQUosRUFBNEI7QUFDMUIsV0FBTyxNQUFLLE1BQU0sYUFBWCxhQUFtQyxRQUFuQyxDQUFQO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFNLFNBQVMsa0JBQWY7QUFDQSxPQUFLLFNBQUwsQ0FBZSxHQUFmLENBQW1CLE1BQW5CO0FBQ0EsTUFBTSxVQUFVLE1BQUssTUFBTSxhQUFYLE9BQTZCLE1BQTdCLFNBQXVDLFFBQXZDLENBQWhCO0FBQ0EsT0FBSyxTQUFMLENBQWUsTUFBZixDQUFzQixNQUF0QjtBQUNBLFNBQU8sT0FBUDtBQUNEOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxzQkFBVCxDQUFnQyxJQUFoQyxFQUFzQyxRQUF0QyxFQUFnRDtBQUNyRCxNQUFJLDBCQUEwQixJQUE5QixFQUFvQztBQUNsQyw2QkFBeUIseUJBQXlCLElBQXpCLENBQXpCO0FBQ0Q7QUFDRCxNQUFJLHNCQUFKLEVBQTRCO0FBQzFCLFdBQU8sTUFBSyxNQUFNLGdCQUFYLGFBQXNDLFFBQXRDLENBQVA7QUFDRDs7QUFFRDtBQUNBLE1BQU0sU0FBUyxrQkFBZjtBQUNBLE9BQUssU0FBTCxDQUFlLEdBQWYsQ0FBbUIsTUFBbkI7QUFDQSxNQUFNLFdBQVcsTUFBSyxNQUFNLGdCQUFYLE9BQWdDLE1BQWhDLFNBQTBDLFFBQTFDLENBQWpCO0FBQ0EsT0FBSyxTQUFMLENBQWUsTUFBZixDQUFzQixNQUF0QjtBQUNBLFNBQU8sUUFBUDtBQUNEOztBQUdEOzs7Ozs7Ozs7QUFTTyxTQUFTLDJCQUFULENBQXFDLE9BQXJDLEVBQThDLHdCQUE5QyxFQUNMLGdCQURLLEVBQ2E7QUFDbEIsTUFBTSx1QkFBdUIsNEJBQTZCO0FBQUEsV0FBTyxHQUFQO0FBQUEsR0FBMUQ7QUFEa0IsTUFFWCxPQUZXLEdBRUEsT0FGQSxDQUVYLE9BRlc7O0FBR2xCLE1BQU0sU0FBUyxtQkFBZjtBQUNBLE1BQU0sZUFBZSxtQkFBbUIsZ0JBQW5CLEdBQXNDLFlBQTNEO0FBQ0EsT0FBSyxJQUFNLEdBQVgsSUFBa0IsT0FBbEIsRUFBMkI7QUFDekIsUUFBTSxXQUFVLElBQUksS0FBSixDQUFVLFlBQVYsQ0FBaEI7QUFDQSxRQUFJLFFBQUosRUFBYTtBQUNYLFVBQU0sUUFBUSxTQUFRLENBQVIsRUFBVyxDQUFYLEVBQWMsV0FBZCxLQUE4QixTQUFRLENBQVIsRUFBVyxNQUFYLENBQWtCLENBQWxCLENBQTVDO0FBQ0EsYUFBTyxxQkFBcUIsS0FBckIsQ0FBUCxJQUFzQyxRQUFRLEdBQVIsQ0FBdEM7QUFDRDtBQUNGO0FBQ0QsU0FBTyxNQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsMEJBQVQsQ0FBb0MsT0FBcEMsRUFBNkMsWUFBN0MsRUFBMkQ7QUFDaEUsTUFBSSxpQkFBaUIsT0FBckI7QUFDQSxLQUFHO0FBQ0QsUUFBSSxlQUFlLFdBQW5CLEVBQWdDO0FBQzlCLGFBQU8sSUFBUDtBQUNEO0FBQ0YsR0FKRCxRQUlTLENBQUMsaUJBQWlCLGVBQWUsVUFBakMsS0FDQyxrQkFBa0IsWUFMNUI7QUFNQSxTQUFPLEtBQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxnQkFBVCxDQUEwQixLQUExQixFQUFpQyxTQUFqQyxFQUE0QztBQUNqRCxNQUFNLFlBQVksRUFBbEI7QUFDQSxPQUFLLElBQUksV0FBVyxNQUFNLGFBQTFCLEVBQXlDLFFBQXpDLEVBQ0UsV0FBVyxTQUFTLGFBRHRCLEVBQ3FDO0FBQ25DLFFBQUksVUFBVSxRQUFWLENBQUosRUFBeUI7QUFDdkIsZ0JBQVUsSUFBVixDQUFlLFFBQWY7QUFDRDtBQUNGO0FBQ0QsU0FBTyxTQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMscUJBQVQsQ0FBK0IsS0FBL0IsRUFBc0MsT0FBdEMsRUFBK0M7QUFDcEQsWUFBVSxRQUFRLFdBQVIsRUFBVjtBQUNBLFNBQU8saUJBQWlCLEtBQWpCLEVBQXdCLGNBQU07QUFDbkMsV0FBTyxHQUFHLE9BQUgsSUFBYyxPQUFyQjtBQUNELEdBRk0sQ0FBUDtBQUdEOztBQUVEOzs7Ozs7Ozs7QUFTTyxTQUFTLG9CQUFULENBQThCLFFBQTlCLEVBQXdDO0FBQzdDLE1BQUksYUFBYSxRQUFqQixFQUEyQjtBQUN6QixXQUFPLFNBQVMsT0FBVCxDQUFpQixTQUFqQixDQUEyQixJQUEzQixDQUFQO0FBQ0QsR0FGRCxNQUVPO0FBQ0wsUUFBTSxVQUFVLFNBQVMsYUFBVCxDQUF1QixzQkFBdkIsRUFBaEI7QUFDQSxpQkFBYSxRQUFiLEVBQXVCLE9BQXZCO0FBQ0EsV0FBTyxPQUFQO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7OztBQVVPLFNBQVMsYUFBVCxDQUF1QixRQUF2QixFQUFpQyxFQUFqQyxFQUFxQztBQUMxQyxPQUFLLElBQUksSUFBSSxDQUFSLEVBQVcsS0FBaEIsRUFBdUIsQ0FBQyxRQUFRLFNBQVMsQ0FBVCxDQUFULE1BQTBCLFNBQWpELEVBQTRELEdBQTVELEVBQWlFO0FBQy9ELE9BQUcsS0FBSCxFQUFVLENBQVY7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7Ozs7O0FBYU8sU0FBUyxnQkFBVCxDQUEwQixHQUExQixFQUErQixHQUEvQixFQUFvQyxNQUFwQyxFQUE0QyxZQUE1QyxFQUEwRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQSxNQUFJLFlBQUo7QUFDQSxNQUFJO0FBQ0YsVUFBTSxJQUFJLElBQUosQ0FBUyxHQUFULEVBQWMsTUFBZCxFQUFzQixZQUF0QixDQUFOO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1Ysb0JBQU0sS0FBTixDQUFZLEtBQVosRUFBbUIsZ0NBQW5CLEVBQXFELE1BQXJELEVBQTZELENBQTdEO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFJLENBQUMsR0FBRCxJQUFRLFVBQVUsTUFBdEIsRUFBOEI7QUFDNUIsVUFBTSxJQUFJLElBQUosQ0FBUyxHQUFULEVBQWMsTUFBZCxDQUFOO0FBQ0Q7QUFDRCxTQUFPLEdBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGVBQVQsQ0FBeUIsT0FBekIsRUFBa0M7QUFDdkMsU0FBTyxRQUFRLE9BQVIsSUFBbUIsUUFBbkIsSUFDRyxRQUFRLFlBQVIsQ0FBcUIsTUFBckIsRUFBNkIsV0FBN0IsTUFBOEMsa0JBRHhEO0FBRUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxpQkFBVCxDQUEyQixPQUEzQixFQUFvQztBQUN6QyxTQUFPLFFBQVEsT0FBUixJQUFtQixRQUFuQixJQUNILFFBQVEsWUFBUixDQUFxQixNQUFyQixFQUE2QixXQUE3QixNQUE4QyxxQkFEbEQ7QUFFRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLEtBQVQsQ0FBZSxHQUFmLEVBQW9CO0FBQ3pCLE1BQU0sTUFBTSxJQUFJLElBQUosQ0FBUyxZQUFULENBQXNCLEtBQXRCLEtBQ00sSUFBSSxlQUFKLENBQW9CLFlBQXBCLENBQWlDLEtBQWpDLENBRE4sSUFFTSxLQUZsQjtBQUdBLFNBQU8sT0FBTyxLQUFkO0FBQ0Q7O0FBR0Q7Ozs7Ozs7O0FBUU8sU0FBUyxzQkFBVCxDQUFnQyxLQUFoQyxFQUF1QztBQUM1QyxTQUFPLDBCQUFVLEtBQVYsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsb0JBQVQsQ0FBOEIsS0FBOUIsRUFBcUM7QUFDMUMsTUFBTSxVQUFVLE9BQU8sS0FBUCxDQUFoQjtBQUNBO0FBQ0Esa0JBQU0sTUFBTixDQUFhLFFBQVEsT0FBUixDQUFnQixHQUFoQixNQUF5QixDQUFDLENBQXZDO0FBQ0EsU0FBTyxPQUFQO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxVQUFULENBQW9CLElBQXBCLEVBQTBCO0FBQy9CLE1BQUksQ0FBQyxJQUFMLEVBQVc7QUFDVCxXQUFPLElBQVA7QUFDRDtBQUNELFNBQU8sS0FBSyxPQUFMLENBQWEsaUJBQWIsRUFBZ0MsY0FBaEMsQ0FBUDtBQUNEOztBQUVEOzs7O0FBSUEsU0FBUyxjQUFULENBQXdCLENBQXhCLEVBQTJCO0FBQ3pCLFNBQU8sa0JBQWtCLENBQWxCLENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFFBQVQsQ0FBa0IsT0FBbEIsRUFBMkI7QUFDaEMsTUFBSTtBQUNGLGFBQVEsTUFBTSxLQUFkO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1Y7QUFDRDtBQUNGOztBQUVEOzs7OztBQUtPLFNBQVMsU0FBVCxDQUFtQixHQUFuQixFQUF3QjtBQUM3QixTQUFPLElBQUksTUFBSixJQUFjLElBQUksTUFBSixJQUFjLEdBQW5DO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLE9BQXRCLEVBQStCO0FBQ3BDLE1BQU0sTUFBTSxRQUFRLE9BQXBCO0FBQ0E7QUFDQTtBQUNBLFNBQU8sd0JBQVcsR0FBWCxFQUFnQixNQUFoQjtBQUNIO0FBQ0EsSUFBRSxPQUFPLDJCQUFQLElBQXNDLE9BQU8sVUFBL0MsQ0FGSjtBQUdEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLDJCQUFULENBQXFDLE9BQXJDLEVBQThDO0FBQ25ELGtCQUFNLE1BQU4sQ0FBYSxhQUFhLE9BQWIsQ0FBYixFQUFvQywyQkFBcEM7QUFDQSxNQUFJLFFBQVEsZUFBWixFQUE2QjtBQUMzQjtBQUNBLFdBQU8sUUFBUSxPQUFSLENBQWdCLE9BQWhCLENBQVA7QUFDRDtBQUNEO0FBQ0E7QUFDQSxNQUFJLENBQUMsUUFBUSxnQ0FBUixDQUFMLEVBQWdEO0FBQzlDLFFBQU0sV0FBVyx1QkFBakI7QUFDQSxZQUFRLGdDQUFSLElBQTRDLFNBQVMsT0FBckQ7QUFDQSxZQUFRLGlDQUFSLElBQTZDLFNBQVMsT0FBdEQ7QUFFRDs7QUFFRCxTQUFPLFFBQVEsZ0NBQVIsQ0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsZUFBVCxDQUF5QixPQUF6QixFQUFrQztBQUN2QyxNQUFNLFlBQVksUUFBUSxpQkFBUixJQUNkLFFBQVEsaUJBRE0sSUFFZCxRQUFRLHVCQUZNLElBR2QsUUFBUSx1QkFITSxJQUlkLFFBQVEscUJBSk0sSUFLZCxRQUFRLHFCQUxNLElBTWQsUUFBUSxtQkFOTSxJQU9kLFFBQVEsbUJBUE0sSUFRZCxRQUFRLG9CQVJNLElBU2QsUUFBUSxvQkFUWjtBQVVBLE1BQUksU0FBSixFQUFlO0FBQ2IsY0FBVSxJQUFWLENBQWUsT0FBZjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7O0FBS08sU0FBUyxjQUFULENBQXdCLE9BQXhCLEVBQWlDO0FBQ3RDLE1BQUksU0FBUyxRQUFRLGdCQUFSLElBQ0csUUFBUSxjQURYLElBRUcsUUFBUSxjQUZYLElBR0csUUFBUSxvQkFIWCxJQUlHLFFBQVEsb0JBSlgsSUFLRyxRQUFRLHNCQUxYLElBTUcsUUFBUSxtQkFOWCxJQU9HLFFBQVEsZ0JBUHhCO0FBUUEsTUFBSSxNQUFKLEVBQVk7QUFDVixXQUFPLElBQVAsQ0FBWSxPQUFaO0FBQ0E7QUFDRDtBQUNELE1BQUksUUFBUSxhQUFaLEVBQTJCO0FBQ3pCLGFBQVMsUUFBUSxhQUFSLENBQXNCLGdCQUF0QixJQUNHLFFBQVEsYUFBUixDQUFzQixjQUR6QixJQUVHLFFBQVEsYUFBUixDQUFzQixjQUZ6QixJQUdHLFFBQVEsYUFBUixDQUFzQixvQkFIekIsSUFJRyxRQUFRLGFBQVIsQ0FBc0Isb0JBSnpCLElBS0csUUFBUSxhQUFSLENBQXNCLHNCQUx6QixJQU1HLFFBQVEsYUFBUixDQUFzQixtQkFOekIsSUFPRyxRQUFRLGFBQVIsQ0FBc0IsZ0JBUGxDO0FBUUQ7QUFDRCxNQUFJLE1BQUosRUFBWTtBQUNWLFdBQU8sSUFBUCxDQUFZLFFBQVEsYUFBcEI7QUFDQTtBQUNEO0FBQ0Y7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsbUJBQVQsQ0FBNkIsT0FBN0IsRUFBc0M7QUFDM0MsTUFBTSxlQUFlLFFBQVEsMEJBQTdCO0FBQ0EsTUFBSSxZQUFKLEVBQWtCO0FBQ2hCLFdBQU8sSUFBUDtBQUNEO0FBQ0QsTUFBSSxRQUFRLGFBQVosRUFBMkI7QUFDekIsUUFBTSxvQkFBb0IsUUFBUSxhQUFSLENBQXNCLGlCQUF0QixJQUNkLFFBQVEsYUFBUixDQUFzQix1QkFEUixJQUVkLFFBQVEsYUFBUixDQUFzQixvQkFGUixJQUdkLFFBQVEsOEJBSHBCO0FBSUEsUUFBSSxxQkFBcUIsT0FBekIsRUFBa0M7QUFDaEMsYUFBTyxJQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sS0FBUDtBQUNEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsU0FBVCxDQUFtQixPQUFuQixFQUE0QjtBQUNqQyxTQUFPLEVBQUUsUUFBUSxRQUFSLElBQW9CLFFBQVEsT0FBUixFQUFpQixXQUFqQixDQUF0QixDQUFQO0FBQ0Q7Ozs7OztRQ2oyQmUsaUIsR0FBQSxpQjtRQWdCQSw0QixHQUFBLDRCO1FBb0NBLHVCLEdBQUEsdUI7UUFrQkEsa0MsR0FBQSxrQztRQWtDQSw4QyxHQUFBLDhDO1FBNENBLHNCLEdBQUEsc0I7O0FBaExoQjs7SUFBWSxHOztBQUNaOztBQVVBOztBQUNBOzs7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O0FBOUJBOzs7Ozs7Ozs7Ozs7Ozs7O0FBNENPLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0MsRUFBaEMsRUFBb0MsU0FBcEMsRUFBK0MsV0FBL0MsRUFBNEQ7QUFDakUsU0FBTyw2QkFBNkIsR0FBN0IsRUFBa0MsRUFBbEMsRUFBc0MsU0FBdEMsRUFBaUQsV0FBakQsRUFBOEQsSUFBOUQsQ0FDSDtBQUFBLFdBQVcsY0FBYyxPQUFkLEVBQXVCLEVBQXZCLEVBQTJCLFNBQTNCLENBQVg7QUFBQSxHQURHLENBQVA7QUFFRDs7QUFFRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLDRCQUFULENBQXNDLEdBQXRDLEVBQTJDLEVBQTNDLEVBQStDLFNBQS9DLEVBQTBELFdBQTFELEVBQXVFO0FBQzVFLE1BQU0sSUFBSSxzQ0FBd0IsR0FBeEIsRUFBNkIsRUFBN0IsQ0FBVjtBQUNBLE1BQUksQ0FBSixFQUFPO0FBQ0wsV0FBTyxpQ0FBa0M7QUFBekM7QUFDRDtBQUNELFNBQU8sK0JBQStCLEdBQS9CLEVBQW9DLEVBQXBDLEVBQXdDLFNBQXhDLEVBQW1ELFdBQW5ELENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTLGtCQUFULENBQTRCLEdBQTVCLEVBQWlDLFdBQWpDLEVBQThDO0FBQzVDO0FBQ0EsTUFBSSxDQUFDLElBQUksbUJBQVQsRUFBOEI7QUFDNUIsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxTQUFPLENBQUMsQ0FBQyxJQUFJLG1CQUFKLENBQXdCLFdBQXhCLENBQVQ7QUFDRDs7QUFHRDs7Ozs7Ozs7Ozs7Ozs7QUFjTyxTQUFTLHVCQUFULENBQWlDLGVBQWpDLEVBQWtELEVBQWxELEVBQXNELFNBQXRELEVBQ0wsV0FESyxFQUNRO0FBQ2IsU0FBTyxtQ0FDSCxlQURHLEVBQ2MsRUFEZCxFQUNrQixTQURsQixFQUM2QixXQUQ3QixFQUVGLElBRkUsQ0FFRztBQUFBLFdBQVcsY0FBYyxPQUFkLEVBQXVCLEVBQXZCLEVBQTJCLFNBQTNCLENBQVg7QUFBQSxHQUZILENBQVA7QUFHRDs7QUFFRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLGtDQUFULENBQ0wsZUFESyxFQUNZLEVBRFosRUFDZ0IsU0FEaEIsRUFDMkIsV0FEM0IsRUFDd0M7QUFDN0MsTUFBTSxTQUFTLHdCQUFVLGVBQVYsQ0FBZjtBQUNBLE1BQU0sSUFBSSw0Q0FBOEIsZUFBOUIsRUFBK0MsRUFBL0MsQ0FBVjtBQUNBLE1BQUksQ0FBSixFQUFPO0FBQ0wsV0FBTyxpQ0FBa0M7QUFBekM7QUFDRDs7QUFFRCxTQUFPLE9BQU8saUJBQVAsR0FDRixJQURFLENBQ0c7QUFBQSxXQUFNLDBCQUNSLE9BQU8sR0FEQyxFQUNJLFNBREosRUFFUixPQUFPLFdBQVAsRUFGUSxDQUFOO0FBQUEsR0FESCxFQUlGLElBSkUsQ0FJRyxZQUFNO0FBQ1Y7QUFDQTtBQUNBLFFBQUksV0FBSixFQUFpQjtBQUNmLGFBQU8sNENBQThCLGVBQTlCLEVBQStDLEVBQS9DLENBQVA7QUFDRCxLQUZELE1BRU8sSUFBSSxtQkFBbUIsT0FBTyxHQUExQixFQUErQixTQUEvQixDQUFKLEVBQStDO0FBQ3BELGFBQU8sc0NBQXdCLGVBQXhCLEVBQXlDLEVBQXpDLENBQVA7QUFDRDtBQUNELFdBQU8sSUFBUDtBQUNELEdBYkUsQ0FBUDtBQWNEOztBQUVEOzs7Ozs7Ozs7O0FBVU8sU0FBUyw4Q0FBVCxDQUNMLGVBREssRUFDWSxFQURaLEVBQ2dCLFNBRGhCLEVBQzJCO0FBQ2hDLE1BQU0sSUFBSSxtREFBcUMsZUFBckMsRUFBc0QsRUFBdEQsQ0FBVjtBQUNBLE1BQUksQ0FBSixFQUFPO0FBQ0wsV0FBTyxpQ0FBa0MsUUFBUSxPQUFSLENBQWdCLENBQWhCO0FBQXpDO0FBQ0Q7QUFDRDtBQUNBLE1BQUksZ0JBQWdCLFFBQXBCLEVBQThCO0FBQzVCLFFBQU0sTUFBTSxrQkFBTSxnQkFBZ0IsYUFBaEIsQ0FBOEIsV0FBcEMsQ0FBWjtBQUNBLFFBQU0sU0FBUywyQkFBYSxHQUFiLENBQWY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFJLFFBQVEsTUFBWixFQUFvQjtBQUNsQixhQUFPLCtCQUErQixHQUEvQixFQUFvQyxFQUFwQyxFQUF3QyxTQUF4QyxDQUFQO0FBQ0QsS0FGRCxNQUVPO0FBQ0w7QUFDQSxhQUFPLG1DQUFtQyxlQUFuQyxFQUFvRCxFQUFwRCxFQUF3RCxTQUF4RCxDQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8saUNBQWtDLFFBQVEsT0FBUixDQUFnQixJQUFoQjtBQUF6QztBQUNEOztBQUVEOzs7Ozs7OztBQVFBLFNBQVMsYUFBVCxDQUF1QixPQUF2QixFQUFnQyxFQUFoQyxFQUFvQyxTQUFwQyxFQUErQztBQUM3QyxTQUFPLHVCQUF3QixpQkFBTyxNQUFQLENBQWMsT0FBZCxFQUMzQix5REFDQSx3REFEQSxHQUVBLHVEQUgyQixFQUkzQixFQUoyQixFQUl2QixTQUp1QixFQUlaLFNBSlksRUFJRCxTQUpDO0FBQS9CO0FBS0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxzQkFBVCxDQUFnQyxJQUFoQyxFQUFzQztBQUMzQztBQUNBLE1BQUksQ0FBQyxJQUFMLEVBQVc7QUFDVCxXQUFPLEVBQVA7QUFDRDtBQUNELE1BQU0sVUFBVSxFQUFoQjtBQUNBLE1BQU0sT0FBTyxLQUFLLGdCQUFMLENBQXNCLHdCQUF0QixDQUFiO0FBQ0EsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLEtBQUssTUFBekIsRUFBaUMsR0FBakMsRUFBc0M7QUFDcEMsWUFBUSxJQUFSLENBQWEsS0FBSyxDQUFMLEVBQVEsWUFBUixDQUFxQixnQkFBckIsQ0FBYjtBQUNEO0FBQ0QsU0FBTyxPQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyx5QkFBVCxDQUFtQyxHQUFuQyxFQUF3QyxTQUF4QyxFQUFtRCxJQUFuRCxFQUF5RDtBQUN2RDs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0EsTUFBSSxDQUFDLHVCQUF1QixJQUF2QixFQUE2QixRQUE3QixDQUFzQyxTQUF0QyxDQUFMLEVBQXVEO0FBQ3JELFdBQU8sUUFBUSxPQUFSLEVBQVA7QUFDRDs7QUFFRCxNQUFNLGFBQWEseUJBQVcsR0FBWCxFQUFnQixZQUFoQixDQUFuQjtBQUNBLFNBQU8saUNBQ0wsV0FBVyxnQkFBWCxDQUE0QixHQUE1QixFQUFpQyxTQUFqQztBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7Ozs7QUFVQSxTQUFTLDhCQUFULENBQXdDLEdBQXhDLEVBQTZDLEVBQTdDLEVBQWlELFNBQWpELEVBQTRELFdBQTVELEVBQXlFO0FBQ3ZFLFNBQU8sSUFBSSxrQkFBSixDQUF1QixJQUFJLFFBQTNCLEVBQ0YsSUFERSxDQUNHO0FBQUEsV0FBTSwwQkFBMEIsR0FBMUIsRUFBK0IsU0FBL0IsRUFBMEMsSUFBSSxRQUFKLENBQWEsSUFBdkQsQ0FBTjtBQUFBLEdBREgsRUFFRixJQUZFLENBRUcsWUFBTTtBQUNWO0FBQ0E7QUFDQSxRQUFJLFdBQUosRUFBaUI7QUFDZixhQUFPLHNDQUF3QixHQUF4QixFQUE2QixFQUE3QixDQUFQO0FBQ0QsS0FGRCxNQUVPLElBQUksbUJBQW1CLEdBQW5CLEVBQXdCLFNBQXhCLENBQUosRUFBd0M7QUFDN0MsYUFBTyxnQ0FBa0IsR0FBbEIsRUFBdUIsRUFBdkIsQ0FBUDtBQUNEO0FBQ0QsV0FBTyxJQUFQO0FBQ0QsR0FYRSxDQUFQO0FBWUQ7Ozs7OztRQzVOZSw0QixHQUFBLDRCO1FBaURBLDRCLEdBQUEsNEI7UUF5QkEscUMsR0FBQSxxQztBQTlHaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7O0FBS0EsSUFBSSxzQkFBSjs7QUFFQTs7Ozs7Ozs7Ozs7OztBQWFPLFNBQVMsNEJBQVQsQ0FBc0MsT0FBdEMsRUFBK0MsU0FBL0MsRUFBMEQsUUFBMUQsRUFDTCxtQkFESyxFQUNnQjtBQUNyQixNQUFJLGVBQWUsT0FBbkI7QUFDQSxNQUFJLGdCQUFnQixRQUFwQjtBQUNBOzs7QUFHQSxNQUFJLGdCQUFKOztBQUVBLFlBQVUsd0JBQVM7QUFDakIsUUFBSTtBQUNGLGFBQU8sY0FBYyxLQUFkLENBQVA7QUFDRCxLQUZELENBRUUsT0FBTyxDQUFQLEVBQVU7QUFDVjtBQUNBLFdBQUssV0FBTCxDQUFpQixDQUFqQjtBQUNBLFlBQU0sQ0FBTjtBQUNEO0FBQ0YsR0FSRDtBQVNBLE1BQU0sZ0JBQWdCLDhCQUF0QjtBQUNBLE1BQUksVUFBVSxLQUFkO0FBQ0EsTUFBSSxtQkFBSixFQUF5QjtBQUN2QixjQUFVLG9CQUFvQixPQUE5QjtBQUNEO0FBQ0QsZUFBYSxnQkFBYixDQUNJLFNBREosRUFFSSxPQUZKLEVBR0ksZ0JBQWdCLG1CQUFoQixHQUFzQyxPQUgxQztBQUtBLFNBQU8sWUFBTTtBQUNYLFFBQUksWUFBSixFQUFrQjtBQUNoQixtQkFBYSxtQkFBYixDQUNJLFNBREosRUFFSSxPQUZKLEVBR0ksZ0JBQWdCLG1CQUFoQixHQUFzQyxPQUgxQztBQUtEO0FBQ0Q7QUFDQSxvQkFBZ0IsSUFBaEI7QUFDQSxtQkFBZSxJQUFmO0FBQ0EsY0FBVSxJQUFWO0FBQ0QsR0FaRDtBQWFEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLDRCQUFULEdBQXdDO0FBQzdDO0FBQ0EsTUFBSSxrQkFBa0IsU0FBdEIsRUFBaUM7QUFDL0IsV0FBTyxhQUFQO0FBQ0Q7O0FBRUQsa0JBQWdCLEtBQWhCO0FBQ0EsTUFBSTtBQUNGO0FBQ0EsUUFBTSxVQUFVO0FBQ2QsVUFBSSxPQUFKLEdBQWM7QUFDWix3QkFBZ0IsSUFBaEI7QUFDRDtBQUhhLEtBQWhCO0FBS0EsU0FBSyxnQkFBTCxDQUFzQixjQUF0QixFQUFzQyxJQUF0QyxFQUE0QyxPQUE1QztBQUNBLFNBQUssbUJBQUwsQ0FBeUIsY0FBekIsRUFBeUMsSUFBekMsRUFBK0MsT0FBL0M7QUFDRCxHQVRELENBU0UsT0FBTyxHQUFQLEVBQVk7QUFDWjtBQUNEO0FBQ0QsU0FBTyxhQUFQO0FBQ0Q7O0FBRUQ7OztBQUdPLFNBQVMscUNBQVQsR0FBaUQ7QUFDdEQsa0JBQWdCLFNBQWhCO0FBQ0Q7Ozs7OztRQ2xGZSxpQixHQUFBLGlCO1FBd0JBLE0sR0FBQSxNO1FBVUEsTyxHQUFBLE87UUFTQSxTLEdBQUEsUztRQWFBLFUsR0FBQSxVO1FBMEJBLGlCLEdBQUEsaUI7UUFtQkEsUSxHQUFBLFE7UUFnQkEsVyxHQUFBLFc7UUFzREEsa0IsR0FBQSxrQjs7QUF6TGhCOztBQUNBOztBQUVBO0FBbkJBOzs7Ozs7Ozs7Ozs7Ozs7O0FBb0JBLElBQU0sc0JBQXNCLGlCQUE1Qjs7QUFFQTs7Ozs7Ozs7QUFRTyxTQUFTLGlCQUFULENBQTJCLEdBQTNCLEVBQWdDLElBQWhDLEVBQXNDLE1BQXRDLEVBQThDLGFBQTlDLEVBQTZEO0FBQ2xFLE1BQU0sWUFBWSwrQkFBaUMsRUFBQyxjQUFELEVBQW5EO0FBQ0EsU0FBTyxNQUFQLENBQWMsU0FBZCxFQUF5QixhQUF6QjtBQUNBO0FBQ0E7QUFDQSxNQUFJLE9BQU8sSUFBSSxXQUFYLElBQTBCLFVBQTlCLEVBQTBDO0FBQ3hDLFdBQU8sSUFBSSxJQUFJLFdBQVIsQ0FBb0IsSUFBcEIsRUFBMEIsU0FBMUIsQ0FBUDtBQUNELEdBRkQsTUFFTztBQUNMO0FBQ0EsUUFBTSxJQUFJLElBQUksUUFBSixDQUFhLFdBQWIsQ0FBeUIsYUFBekIsQ0FBVjtBQUNBLE1BQUUsZUFBRixDQUNJLElBREosRUFDVSxDQUFDLENBQUMsVUFBVSxPQUR0QixFQUMrQixDQUFDLENBQUMsVUFBVSxVQUQzQyxFQUN1RCxNQUR2RDtBQUVBLFdBQU8sQ0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxNQUFULENBQWdCLE9BQWhCLEVBQXlCLFNBQXpCLEVBQW9DLFFBQXBDLEVBQThDLG1CQUE5QyxFQUFtRTtBQUN4RSxTQUFPLHFEQUNILE9BREcsRUFDTSxTQUROLEVBQ2lCLFFBRGpCLEVBQzJCLG1CQUQzQixDQUFQO0FBRUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxPQUFULENBQWlCLEtBQWpCLEVBQXdCO0FBQzdCLFNBQU8sNENBQTZDLE1BQU07QUFBMUQ7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFNBQVQsQ0FBbUIsS0FBbkIsRUFBMEI7QUFDL0IsU0FBTyw0Q0FBNkMsTUFBTTtBQUExRDtBQUNEOztBQUVEOzs7Ozs7Ozs7QUFTTyxTQUFTLFVBQVQsQ0FBb0IsT0FBcEIsRUFBNkIsU0FBN0IsRUFBd0MsUUFBeEMsRUFBa0QsbUJBQWxELEVBQXVFO0FBQzVFLE1BQUksZ0JBQWdCLFFBQXBCO0FBQ0EsTUFBTSxXQUFXLHFEQUE2QixPQUE3QixFQUFzQyxTQUF0QyxFQUFpRCxpQkFBUztBQUN6RSxRQUFJO0FBQ0Ysb0JBQWMsS0FBZDtBQUNELEtBRkQsU0FFVTtBQUNSO0FBQ0Esc0JBQWdCLElBQWhCO0FBQ0E7QUFDRDtBQUNGLEdBUmdCLEVBUWQsbUJBUmMsQ0FBakI7QUFTQSxTQUFPLFFBQVA7QUFDRDs7QUFHRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLGlCQUFULENBQTJCLE9BQTNCLEVBQW9DLFNBQXBDLEVBQStDLG1CQUEvQyxFQUNMLFVBREssRUFDTztBQUNaLE1BQUksaUJBQUo7QUFDQSxNQUFNLGVBQWUsSUFBSSxPQUFKLENBQVksbUJBQVc7QUFDMUMsZUFBVyxXQUFXLE9BQVgsRUFBb0IsU0FBcEIsRUFBK0IsT0FBL0IsRUFBd0MsbUJBQXhDLENBQVg7QUFDRCxHQUZvQixDQUFyQjtBQUdBLGVBQWEsSUFBYixDQUFrQixRQUFsQixFQUE0QixRQUE1QjtBQUNBLE1BQUksVUFBSixFQUFnQjtBQUNkLGVBQVcsUUFBWDtBQUNEO0FBQ0QsU0FBTyxZQUFQO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxRQUFULENBQWtCLFdBQWxCLEVBQStCO0FBQ3BDLFNBQU8sQ0FBQyxFQUFFLFlBQVksUUFBWixJQUF3QixZQUFZLFVBQVosSUFBMEI7QUFDeEQ7QUFDQTtBQUZNLEtBR0YsWUFBWSxRQUFaLElBQ0csWUFBWSxRQUFaLENBQXFCLFVBQXJCLElBQW1DLFVBSnRDLENBQVI7QUFLRDs7QUFFRDs7Ozs7Ozs7QUFRTyxTQUFTLFdBQVQsQ0FBcUIsV0FBckIsRUFBa0M7QUFDdkMsTUFBSSxxQkFBSjtBQUNBLE1BQUksc0JBQUo7QUFDQSxNQUFJLFNBQVMsV0FBVCxDQUFKLEVBQTJCO0FBQ3pCLFdBQU8sUUFBUSxPQUFSLENBQWdCLFdBQWhCLENBQVA7QUFDRDtBQUNELE1BQU0saUJBQWlCLElBQUksT0FBSixDQUFZLFVBQUMsT0FBRCxFQUFVLE1BQVYsRUFBcUI7QUFDdEQ7QUFDQTtBQUZzRCxRQUcvQyxPQUgrQyxHQUdwQyxXQUhvQyxDQUcvQyxPQUgrQzs7QUFJdEQsUUFBSSxZQUFZLE9BQVosSUFBdUIsWUFBWSxPQUF2QyxFQUFnRDtBQUM5QyxxQkFBZSxXQUFXLFdBQVgsRUFBd0IsV0FBeEIsRUFBcUMsT0FBckMsQ0FBZjtBQUNELEtBRkQsTUFFTztBQUNMLHFCQUFlLFdBQVcsV0FBWCxFQUF3QixNQUF4QixFQUFnQyxPQUFoQyxDQUFmO0FBQ0Q7QUFDRDtBQUNBLFFBQUksT0FBSixFQUFhO0FBQ1gsc0JBQWdCLFdBQVcsV0FBWCxFQUF3QixPQUF4QixFQUFpQyxNQUFqQyxDQUFoQjtBQUNEO0FBQ0YsR0Fic0IsQ0FBdkI7O0FBZUEsU0FBTyxlQUFlLElBQWYsQ0FBb0IsWUFBTTtBQUMvQixRQUFJLGFBQUosRUFBbUI7QUFDakI7QUFDRDtBQUNELFdBQU8sV0FBUDtBQUNELEdBTE0sRUFLSixZQUFNO0FBQ1AsUUFBSSxZQUFKLEVBQWtCO0FBQ2hCO0FBQ0Q7QUFDRCxpQkFBYSxXQUFiO0FBQ0QsR0FWTSxDQUFQO0FBV0Q7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxZQUFULENBQXNCLFdBQXRCLEVBQW1DO0FBQ2pDO0FBQ0E7QUFDQSxNQUFJLFNBQVMsV0FBYjtBQUNBLE1BQUksVUFBVSxPQUFPLEdBQXJCLEVBQTBCO0FBQ3hCLGFBQVMsT0FBTyxHQUFoQjtBQUNEO0FBQ0QsUUFBTSxpQkFBTyxXQUFQLENBQW1CLG1CQUFuQixFQUF3QyxNQUF4QyxDQUFOO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxrQkFBVCxDQUE0QixPQUE1QixFQUFxQztBQUMxQyxTQUFPLFFBQVEsT0FBUixDQUFnQixtQkFBaEIsS0FBd0MsQ0FBQyxDQUFoRDtBQUNEOzs7Ozs7O1FDdkplLFEsR0FBQSxRO1FBU0EsYSxHQUFBLGE7UUFXQSxjLEdBQUEsYztRQWlCQSxnQixHQUFBLGdCO1FBdUJBLGlCLEdBQUEsaUI7UUE0REEsdUIsR0FBQSx1QjtRQXFEQSx1QyxHQUFBLHVDO1FBU0EsZ0MsR0FBQSxnQztRQTREQSw4QixHQUFBLDhCO1FBNENBLG1CLEdBQUEsbUI7UUFjQSxxQixHQUFBLHFCOztBQXpVaEI7O0FBQ0E7O0FBQ0E7O0FBRUE7QUFDQSxJQUFNLGNBQWMsU0FBcEI7O0FBRUE7QUE5QkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7Ozs7QUFlQSxJQUFNLHNCQUFzQixHQUE1QixDLENBQWlDOztBQUVqQztBQUNBLElBQU0sNkJBQTZCLHNCQUFzQixFQUF0QixHQUEyQixFQUEzQixHQUFnQyxFQUFoQyxHQUFxQyxJQUF4RTs7QUFFQTtBQUNBLElBQU0sMEJBQTBCLDJCQUFoQzs7QUFFQTs7Ozs7O0FBTU8sSUFBSSxnREFBSjs7QUFFUDs7Ozs7QUFLTyxTQUFTLFFBQVQsQ0FBa0IsR0FBbEIsRUFBdUI7QUFDNUIsU0FBTyxDQUFDLEVBQUUsSUFBSSxVQUFKLElBQWtCLElBQUksVUFBSixDQUFlLE1BQW5DLENBQVI7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGFBQVQsQ0FBdUIsR0FBdkIsRUFBNEI7QUFDakMsU0FBTyxJQUFJLFVBQUosSUFBa0IsSUFBSSxVQUFKLENBQWUsSUFBakMsR0FDTCxJQUFJLFVBQUosQ0FBZSxJQURWLEdBQ2lCLFNBRHhCO0FBRUQ7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsY0FBVCxDQUF3QixHQUF4QixFQUE2QixZQUE3QixFQUEyQztBQUNoRCxNQUFNLFVBQVUsa0JBQWtCLEdBQWxCLENBQWhCO0FBQ0EsU0FBTyxDQUFDLENBQUMsUUFBUSxZQUFSLENBQVQ7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7O0FBWU8sU0FBUyxnQkFBVCxDQUEwQixHQUExQixFQUErQixZQUEvQixFQUE2QyxNQUE3QyxFQUNMLHVCQURLLEVBQ29CO0FBQ3pCLE1BQU0sY0FBYyxlQUFlLEdBQWYsRUFBb0IsTUFBTSxZQUExQixDQUFwQjtBQUNBLE1BQU0sS0FBSyxDQUFDLEVBQUUsV0FBVyxTQUFYLEdBQXVCLE1BQXZCLEdBQWdDLENBQUMsV0FBbkMsQ0FBWjtBQUNBLE1BQUksTUFBTSxXQUFWLEVBQXVCO0FBQ3JCLFFBQU0sVUFBVSxrQkFBa0IsR0FBbEIsQ0FBaEI7QUFDQSxZQUFRLFlBQVIsSUFBd0IsRUFBeEI7O0FBRUEsUUFBSSxDQUFDLHVCQUFMLEVBQThCO0FBQzVCLFVBQU0sZ0JBQWdCLCtCQUErQixHQUEvQixDQUF0QjtBQUNBLG9CQUFjLFlBQWQsSUFBOEIsRUFBOUI7QUFDQSxvQ0FBOEIsR0FBOUIsRUFBbUMsYUFBbkM7QUFDRDtBQUNGO0FBQ0QsU0FBTyxFQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0M7QUFDckMsTUFBSSxJQUFJLHVCQUFKLENBQUosRUFBa0M7QUFDaEMsV0FBTyxJQUFJLHVCQUFKLENBQVA7QUFDRDtBQUNELE1BQUksdUJBQUosSUFBK0IsT0FBTyxNQUFQLENBQWMsSUFBZCxDQUEvQjtBQUNBLE1BQU0sVUFBVSxJQUFJLHVCQUFKLENBQWhCOztBQUVBO0FBQ0EsTUFBSSxJQUFJLFVBQVIsRUFBb0I7QUFDbEIsU0FBSyxJQUFNLFlBQVgsSUFBMkIsSUFBSSxVQUEvQixFQUEyQztBQUN6QyxVQUFNLFlBQVksSUFBSSxVQUFKLENBQWUsWUFBZixDQUFsQjtBQUNBLFVBQUksT0FBTyxTQUFQLEtBQXFCLFFBQXJCLElBQWlDLGFBQWEsQ0FBOUMsSUFBbUQsYUFBYSxDQUFwRSxFQUF1RTtBQUNyRSxnQkFBUSxZQUFSLElBQXdCLEtBQUssTUFBTCxLQUFnQixTQUF4QztBQUNEO0FBQ0Y7QUFDRjtBQUNEO0FBQ0EsTUFBSSxJQUFJLFVBQUosSUFDRyxNQUFNLE9BQU4sQ0FBYyxJQUFJLFVBQUosQ0FBZSxrQkFBZixDQUFkLENBREgsSUFFRyxJQUFJLFVBQUosQ0FBZSxrQkFBZixFQUFtQyxNQUFuQyxHQUE0QyxDQUZuRCxFQUVzRDtBQUNwRCxRQUFNLFVBQVUsSUFBSSxVQUFKLENBQWUsa0JBQWYsQ0FBaEI7QUFDQSxRQUFNLE9BQ0YsSUFBSSxRQUFKLENBQWEsSUFBYixDQUFrQixhQUFsQixDQUFnQyxxQ0FBaEMsQ0FESjtBQUVBLFFBQUksSUFBSixFQUFVO0FBQ1IsVUFBTSxxQkFBcUIsS0FBSyxZQUFMLENBQWtCLFNBQWxCLEVBQTZCLEtBQTdCLENBQW1DLEdBQW5DLENBQTNCO0FBQ0EsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLG1CQUFtQixNQUF2QyxFQUErQyxHQUEvQyxFQUFvRDtBQUNsRCxZQUFJLFFBQVEsT0FBUixDQUFnQixtQkFBbUIsQ0FBbkIsQ0FBaEIsS0FBMEMsQ0FBQyxDQUEvQyxFQUFrRDtBQUNoRCxrQkFBUSxtQkFBbUIsQ0FBbkIsQ0FBUixJQUFpQyxJQUFqQztBQUNEO0FBQ0Y7QUFDRjtBQUNGOztBQUVELFNBQU8sTUFBUCxDQUFjLE9BQWQsRUFBdUIsK0JBQStCLEdBQS9CLENBQXZCOztBQUVBLE1BQUksSUFBSSxVQUFKLElBQ0csTUFBTSxPQUFOLENBQWMsSUFBSSxVQUFKLENBQWUsa0JBQWYsQ0FBZCxDQURILElBRUcsSUFBSSxVQUFKLENBQWUsa0JBQWYsRUFBbUMsTUFBbkMsR0FBNEMsQ0FGbkQsRUFFc0Q7QUFDcEQsUUFBTSxXQUFVLElBQUksVUFBSixDQUFlLGtCQUFmLENBQWhCO0FBQ0EsUUFBTSxPQUFPLElBQUksUUFBSixDQUFhLFlBQWIsSUFBNkIsSUFBSSxRQUFKLENBQWEsSUFBdkQ7QUFDQSxRQUFNLFNBQVMsMkJBQWlCLElBQWpCLENBQWY7QUFDQSxTQUFLLElBQUksS0FBSSxDQUFiLEVBQWdCLEtBQUksU0FBUSxNQUE1QixFQUFvQyxJQUFwQyxFQUF5QztBQUN2QyxVQUFNLFFBQVEsY0FBWSxTQUFRLEVBQVIsQ0FBWixDQUFkO0FBQ0EsVUFBSSxTQUFTLEdBQWIsRUFBa0I7QUFDaEIsZ0JBQVEsU0FBUSxFQUFSLENBQVIsSUFBc0IsSUFBdEI7QUFDRDtBQUNELFVBQUksU0FBUyxHQUFiLEVBQWtCO0FBQ2hCLGdCQUFRLFNBQVEsRUFBUixDQUFSLElBQXNCLEtBQXRCO0FBQ0Q7QUFDRjtBQUNGO0FBQ0QsU0FBTyxPQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsdUJBQVQsQ0FBaUMsR0FBakMsRUFBc0M7QUFDM0MsU0FBTyxJQUFJLHVCQUFKLEtBQWdDLElBQXZDO0FBQ0Q7O0FBRUQ7Ozs7O0FBS0EsU0FBUyw4QkFBVCxDQUF3QyxHQUF4QyxFQUE2QztBQUMzQyxNQUFNLG1CQUFtQix3QkFBVSxHQUFWLEVBQWUsV0FBZixDQUF6QjtBQUNBLE1BQU0sU0FBUyxtQkFBbUIsaUJBQWlCLEtBQWpCLENBQXVCLFVBQXZCLENBQW5CLEdBQXdELEVBQXZFOztBQUVBLE1BQU0sVUFBVSxPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQWhCO0FBQ0EsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLE9BQU8sTUFBM0IsRUFBbUMsR0FBbkMsRUFBd0M7QUFDdEMsUUFBSSxPQUFPLENBQVAsRUFBVSxNQUFWLElBQW9CLENBQXhCLEVBQTJCO0FBQ3pCO0FBQ0Q7QUFDRCxRQUFJLE9BQU8sQ0FBUCxFQUFVLENBQVYsS0FBZ0IsR0FBcEIsRUFBeUI7QUFDdkIsY0FBUSxPQUFPLENBQVAsRUFBVSxNQUFWLENBQWlCLENBQWpCLENBQVIsSUFBK0IsS0FBL0I7QUFDRCxLQUZELE1BRU87QUFDTCxjQUFRLE9BQU8sQ0FBUCxDQUFSLElBQXFCLElBQXJCO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPLE9BQVA7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTLDZCQUFULENBQXVDLEdBQXZDLEVBQTRDLE9BQTVDLEVBQXFEO0FBQ25ELE1BQU0sZ0JBQWdCLEVBQXRCO0FBQ0EsT0FBSyxJQUFNLFVBQVgsSUFBeUIsT0FBekIsRUFBa0M7QUFDaEMsa0JBQWMsSUFBZCxDQUFtQixDQUFDLFFBQVEsVUFBUixNQUF3QixLQUF4QixHQUFnQyxHQUFoQyxHQUFzQyxFQUF2QyxJQUE2QyxVQUFoRTtBQUNEOztBQUVELDBCQUFVLEdBQVYsRUFBZSxXQUFmLEVBQTRCLGNBQWMsSUFBZCxDQUFtQixHQUFuQixDQUE1QixFQUNJLEtBQUssR0FBTCxLQUFhLDBCQURqQixFQUM2QztBQUN2QztBQUNBLFlBQVEsSUFBSSxRQUFKLENBQWEsUUFGa0I7QUFHdkMsd0JBQW9CO0FBSG1CLEdBRDdDO0FBTUQ7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsdUNBQVQsQ0FBaUQsR0FBakQsRUFBc0Q7QUFDM0QsU0FBTywrQkFBK0IsR0FBL0IsQ0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsZ0NBQVQsQ0FBMEMsR0FBMUMsRUFBK0M7QUFDcEQsMEJBQVUsR0FBVixFQUFlLFdBQWYsRUFBNEIsRUFBNUIsRUFBZ0MsQ0FBaEMsRUFBbUM7QUFDakMsWUFBUSxJQUFJLFFBQUosQ0FBYTtBQURZLEdBQW5DO0FBR0EsTUFBSSx1QkFBSixJQUErQixJQUEvQjtBQUNEOztBQUVEOzs7Ozs7Ozs7O0FBVUEsU0FBUyxtQkFBVCxHQUErQjtBQUM3QjtBQUNBLFNBQU8sS0FBSyxNQUFMLEVBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRTyxJQUFNLDhEQUEyQjtBQUN0QyxnQkFBYztBQUR3QixDQUFqQzs7QUFJUDs7Ozs7QUFLQSxTQUFTLGdCQUFULENBQTBCLEdBQTFCLEVBQStCO0FBQzdCLE1BQU0sS0FBSyx5QkFBeUIsWUFBekIsRUFBWDtBQUNBLFNBQU8sSUFBSSxLQUFLLEtBQUwsQ0FBVyxLQUFLLElBQUksTUFBcEIsQ0FBSixLQUFvQyxJQUEzQztBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JPLFNBQVMsOEJBQVQsQ0FBd0MsR0FBeEMsRUFBNkMsV0FBN0MsRUFBMEQ7QUFDL0QsTUFBSSxrQkFBSixHQUF5QixJQUFJLGtCQUFKLElBQTBCLEVBQW5EO0FBQ0EsTUFBTSxzQkFBc0IsRUFBNUI7QUFDQSxPQUFLLElBQU0sY0FBWCxJQUE2QixXQUE3QixFQUEwQztBQUN4QztBQUNBO0FBQ0EsUUFBSSxDQUFDLG9CQUFPLFdBQVAsRUFBb0IsY0FBcEIsQ0FBTCxFQUEwQztBQUN4QztBQUNEO0FBQ0QsUUFBSSxvQkFBTyxJQUFJLGtCQUFYLEVBQStCLGNBQS9CLENBQUosRUFBb0Q7QUFDbEQsMEJBQW9CLGNBQXBCLElBQ0ksSUFBSSxrQkFBSixDQUF1QixjQUF2QixDQURKO0FBRUE7QUFDRDs7QUFFRCxRQUFJLENBQUMsWUFBWSxjQUFaLEVBQTRCLGlCQUE3QixJQUNBLENBQUMsWUFBWSxjQUFaLEVBQTRCLGlCQUE1QixDQUE4QyxHQUE5QyxDQURMLEVBQ3lEO0FBQ3ZELFVBQUksa0JBQUosQ0FBdUIsY0FBdkIsSUFBeUMsSUFBekM7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTtBQUNBLFFBQUksQ0FBQyxJQUFJLGtCQUFKLENBQXVCLGNBQXZCLENBQUQsSUFDRixlQUFlLEdBQWYsRUFBb0IsTUFBTSxjQUExQixDQURGLEVBQzZDO0FBQUEsVUFDcEMsUUFEb0MsR0FDeEIsWUFBWSxjQUFaLENBRHdCLENBQ3BDLFFBRG9DOztBQUUzQyxVQUFJLGtCQUFKLENBQXVCLGNBQXZCLElBQXlDLGlCQUFpQixRQUFqQixDQUF6QztBQUNBLDBCQUFvQixjQUFwQixJQUNJLElBQUksa0JBQUosQ0FBdUIsY0FBdkIsQ0FESjtBQUVEO0FBQ0Y7QUFDRCxTQUFPLG1CQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsbUJBQVQsQ0FBNkIsR0FBN0IsRUFBa0MsY0FBbEMsRUFBa0Q7QUFDdkQsU0FBTyxJQUFJLGtCQUFKLEdBQXlCLElBQUksa0JBQUosQ0FBdUIsY0FBdkIsQ0FBekIsR0FBa0UsSUFBekU7QUFDRDs7QUFFRDs7Ozs7Ozs7OztBQVVPLFNBQVMscUJBQVQsQ0FBK0IsR0FBL0IsRUFBb0MsY0FBcEMsRUFBb0QsUUFBcEQsRUFBOEQ7QUFDbkUsTUFBSSxrQkFBSixHQUF5QixJQUFJLGtCQUFKLElBQTBCLEVBQW5EO0FBQ0EsbUJBQWlCLEdBQWpCLEVBQXNCLGNBQXRCLEVBQXNDLENBQUMsQ0FBQyxRQUF4QyxFQUFrRCxJQUFsRDtBQUNBLE1BQUksa0JBQUosQ0FBdUIsY0FBdkIsSUFBeUMsUUFBekM7QUFDRDs7Ozs7Ozs7cWpCQ3BXRDs7Ozs7Ozs7Ozs7Ozs7OztRQTJQZ0IsUyxHQUFBLFM7UUE2REEsb0IsR0FBQSxvQjtRQTJCQSxXLEdBQUEsVztRQWlCQSxvQixHQUFBLG9CO1FBbUNBLGEsR0FBQSxhO1FBa0ZBLHVCLEdBQUEsdUI7UUF5QkEsUSxHQUFBLFE7UUF3QkEsd0IsR0FBQSx3Qjs7QUExZmhCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUE7Ozs7QUFJQSxJQUFNLG9CQUFvQixVQUExQjs7QUFFQTs7Ozs7O0FBTUEsSUFBSSx3QkFBSjs7QUFFQTs7Ozs7OztBQU9BLFNBQVMsYUFBVCxDQUF1QixTQUF2QixFQUFrQyxVQUFsQyxFQUE4QztBQUFBLE1BQ3ZDLGFBRHVDLEdBQ3RCLFNBRHNCLENBQ3ZDLGFBRHVDOzs7QUFHNUMsTUFBSSxDQUFDLGFBQUQsSUFBa0IsVUFBdEIsRUFBa0M7QUFDaEMsb0JBQWdCLFVBQVUsYUFBVixHQUEwQixPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQTFDO0FBQ0Q7QUFDRCxTQUFPLGlCQUFpQixJQUF4QjtBQUNEOztBQUVEOzs7Ozs7OztBQVFBLFNBQVMsb0JBQVQsQ0FBOEIsU0FBOUIsRUFBeUMsUUFBekMsRUFBbUQsVUFBbkQsRUFBK0Q7QUFDN0QsTUFBTSxnQkFBZ0IsY0FBYyxTQUFkLEVBQXlCLFVBQXpCLENBQXRCO0FBQ0EsTUFBSSxDQUFDLGFBQUwsRUFBb0I7QUFDbEIsV0FBTyxhQUFQO0FBQ0Q7O0FBRUQsTUFBSSxpQkFBaUIsY0FBYyxRQUFkLENBQXJCO0FBQ0EsTUFBSSxDQUFDLGNBQUQsSUFBbUIsVUFBdkIsRUFBbUM7QUFDakMscUJBQWlCLGNBQWMsUUFBZCxJQUEwQixFQUEzQztBQUNEO0FBQ0QsU0FBTyxrQkFBa0IsSUFBekI7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRQSxTQUFTLDBCQUFULENBQW9DLFNBQXBDLEVBQStDLE1BQS9DLEVBQXVELFFBQXZELEVBQWlFO0FBQUEsNEJBQzlDLDZCQUFtQixPQUFPLEdBQTFCLENBRDhDO0FBQUEsTUFDeEQsTUFEd0QsdUJBQ3hELE1BRHdEOztBQUUvRCxNQUFNLFdBQVcsYUFBYSxNQUFiLEVBQXFCLFFBQXJCLENBQWpCO0FBQ0EsTUFBTSxpQkFBaUIscUJBQXFCLFNBQXJCLEVBQWdDLFFBQWhDLEVBQTBDLElBQTFDLENBQXZCOztBQUVBLE1BQUkscUJBQUo7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksZUFBZSxNQUFuQyxFQUEyQyxHQUEzQyxFQUFnRDtBQUM5QyxRQUFNLEtBQUssZUFBZSxDQUFmLENBQVg7QUFDQSxRQUFJLEdBQUcsS0FBSCxLQUFhLE1BQWpCLEVBQXlCO0FBQ3ZCLHFCQUFlLEVBQWY7QUFDQTtBQUNEO0FBQ0Y7O0FBRUQsTUFBSSxDQUFDLFlBQUwsRUFBbUI7QUFDakIsbUJBQWU7QUFDYixhQUFPLE1BRE07QUFFYixvQkFGYTtBQUdiLGNBQVEsT0FBTyxNQUFQLENBQWMsSUFBZDtBQUhLLEtBQWY7QUFLQSxtQkFBZSxJQUFmLENBQW9CLFlBQXBCO0FBQ0Q7O0FBRUQsU0FBTyxhQUFhLE1BQXBCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyxrQkFBVCxDQUE0QixTQUE1QixFQUF1QyxRQUF2QyxFQUFpRCxNQUFqRCxFQUF5RCxVQUF6RCxFQUFxRTtBQUNuRSxNQUFNLGlCQUFpQixxQkFBcUIsU0FBckIsRUFBZ0MsUUFBaEMsQ0FBdkI7O0FBRUEsTUFBSSxDQUFDLGNBQUwsRUFBcUI7QUFDbkIsV0FBTyxjQUFQO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBSSxxQkFBSjtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxlQUFlLE1BQW5DLEVBQTJDLEdBQTNDLEVBQWdEO0FBQzlDLFFBQU0sS0FBSyxlQUFlLENBQWYsQ0FBWDtBQUQ4QyxRQUV2QyxhQUZ1QyxHQUV0QixHQUFHLEtBRm1CLENBRXZDLGFBRnVDOztBQUc5QyxRQUFJLENBQUMsYUFBTCxFQUFvQjtBQUNsQixpQkFBVyxrQkFBWCxFQUErQixDQUEvQixFQUFrQyxjQUFsQztBQUNELEtBRkQsTUFFTyxJQUFJLGFBQWEsS0FBakIsRUFBd0I7QUFDN0I7QUFDQSxVQUFJLEdBQUcsTUFBSCxLQUFjLE1BQWQsSUFBd0IsaUJBQWlCLFVBQTdDLEVBQXlEO0FBQ3ZELHVCQUFlLEVBQWY7QUFDQTtBQUNEO0FBQ0YsS0FOTSxNQU1BLElBQUksY0FBYyxhQUFkLElBQ1AsbUJBQW1CLGFBQW5CLEVBQWtDLFVBQWxDLENBREcsRUFDNEM7QUFDakQ7QUFDQSxxQkFBZSxFQUFmO0FBQ0E7QUFDRDtBQUNGOztBQUVELFNBQU8sZUFBZSxhQUFhLE1BQTVCLEdBQXFDLElBQTVDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPQSxTQUFTLGtCQUFULENBQTRCLFFBQTVCLEVBQXNDLFVBQXRDLEVBQWtEO0FBQ2hELE9BQUssSUFBSSxNQUFNLFVBQWYsRUFBMkIsT0FBTyxPQUFPLElBQUksTUFBN0MsRUFBcUQsTUFBTSxJQUFJLE1BQS9ELEVBQXVFO0FBQ3JFLFFBQUksT0FBTyxRQUFYLEVBQXFCO0FBQ25CLGFBQU8sSUFBUDtBQUNEO0FBQ0Y7QUFDRCxTQUFPLEtBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLQSxTQUFTLGtCQUFULENBQTRCLGNBQTVCLEVBQTRDO0FBQzFDLE1BQU0sV0FBVyxrQkFBSyxFQUFDLFlBQVksaUJBQWIsRUFBTCxDQUFqQjs7QUFFQSxPQUFLLElBQUksSUFBSSxlQUFlLE1BQWYsR0FBd0IsQ0FBckMsRUFBd0MsS0FBSyxDQUE3QyxFQUFnRCxHQUFoRCxFQUFxRDtBQUNuRCxRQUFNLGVBQWUsZUFBZSxDQUFmLENBQXJCOztBQUVBLFFBQUksQ0FBQyxhQUFhLEtBQWIsQ0FBbUIsYUFBeEIsRUFBdUM7QUFDckMscUJBQWUsTUFBZixDQUFzQixDQUF0QixFQUF5QixDQUF6Qjs7QUFEcUMsVUFHOUIsTUFIOEIsR0FHcEIsWUFIb0IsQ0FHOUIsTUFIOEI7O0FBSXJDLFdBQUssSUFBTSxJQUFYLElBQW1CLE1BQW5CLEVBQTJCO0FBQ3pCO0FBQ0EsZUFBTyxJQUFQLEVBQWEsTUFBYixDQUFvQixDQUFwQixFQUF1QixRQUF2QixFQUFpQyxPQUFqQyxDQUF5QyxpQkFBUztBQUNoRCxnQkFBTSxRQUFOO0FBQ0QsU0FGRDtBQUdEO0FBQ0Y7QUFDRjtBQUNGOztBQUVEOzs7O0FBSUEsU0FBUyw4QkFBVCxDQUF3QyxTQUF4QyxFQUFtRDtBQUNqRCxNQUFJLFVBQVUsYUFBZCxFQUE2QjtBQUMzQjtBQUNEO0FBQ0QsTUFBTSxvQkFBb0IsU0FBcEIsaUJBQW9CLENBQVMsS0FBVCxFQUFnQjtBQUN4QyxRQUFJLENBQUMsMEJBQVEsS0FBUixDQUFMLEVBQXFCO0FBQ25CO0FBQ0Q7QUFDRCxRQUFNLE9BQU8sY0FBYywwQkFBUSxLQUFSLENBQWQsQ0FBYjtBQUNBLFFBQUksQ0FBQyxJQUFELElBQVMsQ0FBQyxLQUFLLFVBQUwsQ0FBZCxFQUFnQztBQUM5QjtBQUNEOztBQUVELFFBQU0sa0JBQWtCLG1CQUNwQixTQURvQixFQUVwQixLQUFLLFVBQUwsQ0FGb0IsRUFHcEIsTUFBTSxNQUhjLEVBSXBCLE1BQU0sTUFKYyxDQUF4QjtBQU1BLFFBQUksQ0FBQyxlQUFMLEVBQXNCO0FBQ3BCO0FBQ0Q7O0FBRUQsUUFBSSxZQUFZLGdCQUFnQixLQUFLLE1BQUwsQ0FBaEIsQ0FBaEI7QUFDQSxRQUFJLENBQUMsU0FBTCxFQUFnQjtBQUNkO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsZ0JBQVksVUFBVSxLQUFWLEVBQVo7QUFDQSxTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksVUFBVSxNQUE5QixFQUFzQyxHQUF0QyxFQUEyQztBQUN6QyxVQUFNLFdBQVcsVUFBVSxDQUFWLENBQWpCO0FBQ0EsZUFBUyxJQUFULEVBQWUsTUFBTSxNQUFyQixFQUE2QixNQUFNLE1BQW5DO0FBQ0Q7QUFDRixHQWhDRDs7QUFrQ0EsWUFBVSxnQkFBVixDQUEyQixTQUEzQixFQUFzQyxpQkFBdEM7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7OztBQWFPLFNBQVMsU0FBVCxDQUNMLE1BREssRUFDRyxhQURILEVBQ2tCLFFBRGxCLEVBQzRCLFFBRDVCLEVBQ3NDLDBCQUR0QyxFQUNrRTtBQUN2RSxrQkFBTSxNQUFOLENBQWEsT0FBTyxHQUFwQixFQUF5QixpQ0FBekI7QUFDQSxrQkFBTSxNQUFOLENBQWEsQ0FBQyxPQUFPLFVBQXJCLEVBQWlDLDJDQUM3QixvREFESjtBQUVBLGtCQUFNLE1BQU4sQ0FBYSxRQUFiO0FBQ0EsTUFBTSxZQUFZLE9BQU8sYUFBUCxDQUFxQixXQUF2Qzs7QUFFQSxpQ0FBK0IsU0FBL0I7O0FBRUEsTUFBTSxrQkFBa0IsMkJBQ3BCLFNBRG9CLEVBRXBCLE1BRm9CLEVBR3BCLFFBSG9CLENBQXhCOztBQU9BLE1BQUksU0FBUyxnQkFBZ0IsYUFBaEIsTUFDVixnQkFBZ0IsYUFBaEIsSUFBaUMsRUFEdkIsQ0FBYjs7QUFHQSxNQUFJLGlCQUFKO0FBQ0EsTUFBSSxXQUFXLGtCQUFTLElBQVQsRUFBZSxNQUFmLEVBQXVCLE1BQXZCLEVBQStCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFFBQUksQ0FBQywwQkFBRCxJQUErQixVQUFVLE9BQU8sYUFBcEQsRUFBbUU7QUFDakU7QUFDRDs7QUFFRCxRQUFJLEtBQUssUUFBTCxJQUFpQixpQkFBckIsRUFBd0M7QUFDdEM7QUFDQTtBQUNEO0FBQ0QsYUFBUyxJQUFULEVBQWUsTUFBZixFQUF1QixNQUF2QjtBQUNELEdBYkQ7O0FBZUEsU0FBTyxJQUFQLENBQVksUUFBWjs7QUFFQSxTQUFPLFdBQVcsb0JBQVc7QUFDM0IsUUFBSSxRQUFKLEVBQWM7QUFDWixVQUFNLFFBQVEsT0FBTyxPQUFQLENBQWUsUUFBZixDQUFkO0FBQ0EsVUFBSSxRQUFRLENBQUMsQ0FBYixFQUFnQjtBQUNkLGVBQU8sTUFBUCxDQUFjLEtBQWQsRUFBcUIsQ0FBckI7QUFDRDtBQUNEO0FBQ0E7QUFDQSxpQkFBVyxJQUFYO0FBQ0EsZUFBUyxJQUFUO0FBQ0EsaUJBQVcsSUFBWDtBQUNEO0FBQ0YsR0FaRDtBQWFEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsb0JBQVQsQ0FBOEIsTUFBOUIsRUFBc0MsY0FBdEMsRUFBc0QsUUFBdEQsRUFBZ0U7QUFDckUsTUFBTSxlQUFlLEVBQXJCO0FBQ0EsTUFBSSxPQUFPLGNBQVAsSUFBeUIsUUFBN0IsRUFBdUM7QUFDckMscUJBQWlCLENBQUMsY0FBRCxDQUFqQjtBQUNEO0FBQ0QsU0FBTyxJQUFJLE9BQUosQ0FBWSxtQkFBVztBQUM1QixTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksZUFBZSxNQUFuQyxFQUEyQyxHQUEzQyxFQUFnRDtBQUM5QyxVQUFNLFVBQVUsZUFBZSxDQUFmLENBQWhCO0FBQ0EsVUFBTSxXQUFXLFVBQVUsTUFBVixFQUFrQixPQUFsQixFQUEyQixVQUFDLElBQUQsRUFBTyxNQUFQLEVBQWUsTUFBZixFQUEwQjtBQUNwRSxhQUFLLElBQUksS0FBSSxDQUFiLEVBQWdCLEtBQUksYUFBYSxNQUFqQyxFQUF5QyxJQUF6QyxFQUE4QztBQUM1Qyx1QkFBYSxFQUFiO0FBQ0Q7QUFDRCxnQkFBUSxFQUFDLFVBQUQsRUFBTyxjQUFQLEVBQWUsY0FBZixFQUFSO0FBQ0QsT0FMZ0IsRUFLZCxRQUxjLENBQWpCO0FBTUEsbUJBQWEsSUFBYixDQUFrQixRQUFsQjtBQUNEO0FBQ0YsR0FYTSxDQUFQO0FBWUQ7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxXQUFULENBQXFCLE1BQXJCLEVBQTZCLElBQTdCLEVBQW1DLE1BQW5DLEVBQTJDLFlBQTNDLEVBQXlELFFBQXpELEVBQW1FO0FBQ3hFLHVCQUFxQixNQUFyQixFQUNJLENBQUMsRUFBQyxLQUFLLE9BQU8sYUFBYixFQUE0QixRQUFRLFlBQXBDLEVBQUQsQ0FESixFQUN5RCxJQUR6RCxFQUMrRCxNQUQvRCxFQUVJLFFBRko7QUFHRDs7QUFFRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLG9CQUFULENBQThCLE1BQTlCLEVBQXNDLE9BQXRDLEVBQStDLElBQS9DLEVBQXFELE1BQXJELEVBQTZELFFBQTdELEVBQXVFO0FBQzVFLE1BQUksQ0FBQyxPQUFPLGFBQVosRUFBMkI7QUFDekI7QUFDRDtBQUNELFNBQU8sTUFBUCxJQUFpQixJQUFqQjtBQUNBLFNBQU8sVUFBUCxJQUFxQixhQUFhLE1BQWIsRUFBcUIsUUFBckIsQ0FBckI7QUFDQSxNQUFJLFVBQVUsTUFBZDtBQUNBLE1BQUksUUFBSixFQUFjO0FBQ1o7QUFDQSxjQUFVLFNBQVMsS0FBSyxTQUFMLENBQWUsTUFBZixDQUFuQjtBQUNEO0FBQ0QsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFFBQVEsTUFBNUIsRUFBb0MsR0FBcEMsRUFBeUM7QUFDdkMsUUFBTSxTQUFTLFFBQVEsQ0FBUixDQUFmO0FBQ0EsV0FBTyxHQUFQLEVBQVcsTUFBTSxXQUFqQixDQUE2QixPQUE3QixFQUFzQyxPQUFPLE1BQTdDO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7OztBQU9BLFNBQVMsWUFBVCxDQUFzQixNQUF0QixFQUE4QixRQUE5QixFQUF3QztBQUN0QyxTQUFPLFdBQVcsT0FBTyxZQUFQLENBQW9CLHNCQUFwQixDQUFYLEdBQXlELEtBQWhFO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLGFBQVQsQ0FBdUIsSUFBdkIsRUFBNkI7QUFDbEMsTUFBSSxPQUFPLElBQVAsSUFBZSxRQUFuQixFQUE2QjtBQUMzQixRQUFJLEtBQUssTUFBTCxDQUFZLENBQVosS0FBa0IsR0FBdEIsRUFBMkI7QUFDekIsYUFBTyx3QkFBYSxJQUFiLEVBQW1CLGFBQUs7QUFDN0Isd0JBQU0sSUFBTixDQUFXLGVBQVgsRUFDSSxzQ0FDQSwrQkFGSixFQUVxQyxDQUZyQztBQUdELE9BSk0sS0FJRCxJQUpOO0FBS0QsS0FORCxNQU1PLElBQUksbUNBQWEsSUFBYixDQUFKLEVBQXdCO0FBQzdCLGFBQU8seUNBQW1CLElBQW5CLENBQVA7QUFDRCxLQUZNLE1BRUE7QUFDTCxhQUFPLElBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTywyQkFBNEI7QUFBbkM7QUFDRDs7QUFJRDs7Ozs7O0lBS2EsZSxXQUFBLGU7QUFDWDs7Ozs7OztBQU9BLDJCQUFZLE1BQVosRUFBb0IsSUFBcEIsRUFBMEIsSUFBMUIsRUFBZ0MsZUFBaEMsRUFBaUQ7QUFBQTs7QUFBQTs7QUFDL0M7QUFDQSxTQUFLLE9BQUwsR0FBZSxNQUFmO0FBQ0E7QUFDQSxTQUFLLEtBQUwsR0FBYSxJQUFiO0FBQ0E7QUFDQSxTQUFLLGNBQUwsR0FBc0IsRUFBdEI7O0FBRUE7QUFDQSxTQUFLLFNBQUwsR0FBaUIsVUFBVSxLQUFLLE9BQWYsRUFBd0IsSUFBeEIsRUFBOEIsVUFBQyxJQUFELEVBQU8sTUFBUCxFQUFlLE1BQWYsRUFBMEI7QUFDdkU7QUFDQTtBQUNBLFVBQUksQ0FBQyxNQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUI7QUFBQSxlQUFTLE1BQU0sR0FBTixJQUFhLE1BQXRCO0FBQUEsT0FBekIsQ0FBTCxFQUE2RDtBQUMzRCxjQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsRUFBQyxLQUFLLE1BQU4sRUFBYyxjQUFkLEVBQXpCO0FBQ0Q7QUFDRCxzQkFBZ0IsSUFBaEIsRUFBc0IsTUFBdEIsRUFBOEIsTUFBOUI7QUFDRCxLQVBnQixFQU9kLEtBQUssS0FQUztBQVFiO0FBQ0osU0FBSyxLQVRZLENBU04sZ0NBVE0sQ0FBakI7QUFVRDs7QUFFRDs7Ozs7Ozs7O3lCQUtLLEksRUFBTSxJLEVBQU07QUFDZjtBQUNBLCtCQUFhLEtBQUssY0FBbEIsRUFBa0M7QUFBQSxlQUFVLENBQUMsQ0FBQyxPQUFPLEdBQVAsQ0FBVyxNQUF2QjtBQUFBLE9BQWxDO0FBQ0EsMkJBQ0ksS0FBSyxPQURULEVBRUksS0FBSyxjQUZULEVBR0ksSUFISixFQUlJLElBSkosRUFLSSxLQUFLLEtBTFQ7QUFNRDs7QUFFRDs7Ozs7OzhCQUdVO0FBQ1IsV0FBSyxTQUFMO0FBQ0EsV0FBSyxjQUFMLENBQW9CLE1BQXBCLEdBQTZCLENBQTdCO0FBQ0Q7Ozs7OztBQUdIOzs7Ozs7QUFJTyxTQUFTLHVCQUFULENBQWlDLE9BQWpDLEVBQTBDO0FBQy9DLE1BQU0sTUFBTSxRQUFRLFlBQVIsRUFBWjtBQUNBO0FBQ0EsTUFBSSxJQUFJLEtBQUosR0FBWSxFQUFaLElBQWtCLElBQUksTUFBSixHQUFhLEVBQW5DLEVBQXVDO0FBQ3JDLFdBQU8sS0FBUDtBQUNEO0FBQ0Q7QUFDQSxTQUFPLENBQUMsNEJBQWtCLE9BQWxCLEVBQTJCLG9CQUEzQixDQUFSO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBLElBQU0sVUFBVSxDQUNkLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FEYyxFQUVkLENBQUMsR0FBRCxFQUFNLEVBQU4sQ0FGYyxFQUdkLENBQUMsR0FBRCxFQUFNLEVBQU4sQ0FIYyxFQUlkLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FKYyxDQUFoQjs7QUFPQTs7Ozs7O0FBTU8sU0FBUyxRQUFULENBQWtCLE9BQWxCLEVBQTJCO0FBQ2hDLE1BQU0sTUFBTSxRQUFRLFlBQVIsRUFBWjtBQURnQyxNQUV6QixNQUZ5QixHQUVSLEdBRlEsQ0FFekIsTUFGeUI7QUFBQSxNQUVqQixLQUZpQixHQUVSLEdBRlEsQ0FFakIsS0FGaUI7O0FBR2hDLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxRQUFRLE1BQTVCLEVBQW9DLEdBQXBDLEVBQXlDO0FBQ3ZDLFFBQU0sV0FBVyxRQUFRLENBQVIsRUFBVyxDQUFYLENBQWpCO0FBQ0EsUUFBTSxZQUFZLFFBQVEsQ0FBUixFQUFXLENBQVgsQ0FBbEI7QUFDQSxRQUFJLFlBQVksTUFBaEIsRUFBd0I7QUFDdEI7QUFDRDtBQUNELFFBQUksV0FBVyxLQUFmLEVBQXNCO0FBQ3BCO0FBQ0Q7QUFDRDtBQUNBLFFBQUksU0FBUyxTQUFULElBQXNCLEVBQXRCLElBQTRCLFFBQVEsUUFBUixJQUFvQixFQUFwRCxFQUF3RDtBQUN0RCxhQUFPLElBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7QUFJTyxTQUFTLHdCQUFULENBQWtDLE1BQWxDLEVBQTBDO0FBQy9DLG1DQUF1QixNQUF2QixFQUErQixrQkFBSyxFQUFDLGFBQWEsSUFBZCxFQUFMLENBQS9COztBQUVBO0FBQ0E7QUFDQSx1QkFBUyxNQUFULEVBQWlCLFVBQWpCLEVBQTZCLFFBQTdCOztBQUVBLFNBQU8sTUFBUDtBQUNEOzs7Ozs7OztxakJDbGhCRDs7Ozs7Ozs7Ozs7Ozs7OztRQWlFZ0IsMEIsR0FBQSwwQjtRQWFBLG1DLEdBQUEsbUM7UUE4VEEsZ0IsR0FBQSxnQjs7QUE1WGhCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O0FBY08sSUFBSSxrQ0FBSjs7QUFFQSxJQUFNLGdEQUNULENBQUMsQ0FBRCxFQUFJLElBQUosRUFBVSxHQUFWLEVBQWUsSUFBZixFQUFxQixHQUFyQixFQUEwQixJQUExQixFQUFnQyxHQUFoQyxFQUFxQyxJQUFyQyxFQUEyQyxHQUEzQyxFQUNFLElBREYsRUFDUSxHQURSLEVBQ2EsSUFEYixFQUNtQixHQURuQixFQUN3QixJQUR4QixFQUM4QixHQUQ5QixFQUNtQyxJQURuQyxFQUN5QyxHQUR6QyxFQUM4QyxJQUQ5QyxFQUNvRCxHQURwRCxFQUN5RCxJQUR6RCxFQUMrRCxDQUQvRCxDQURHOztBQUlQOzs7OztBQUtBLElBQUksb0NBQUo7O0FBRUE7QUFDQSxJQUFNLE1BQU0sdUJBQVo7O0FBRUE7QUFDQSxJQUFNLFlBQVksS0FBSyxHQUFMLEVBQWxCOztBQUVBOzs7Ozs7Ozs7O0FBVU8sU0FBUywwQkFBVCxDQUNMLE9BREssRUFDSSxLQURKLEVBQ1csWUFEWCxFQUN5QjtBQUM5QixNQUFNLGVBQWUsa0NBQWlCLE9BQWpCLEVBQTBCLEtBQTFCLEVBQWlDLFlBQWpDLEtBQ2pCLGdDQUFlLENBQWYsRUFBa0IsQ0FBbEIsRUFBcUIsQ0FBckIsRUFBd0IsQ0FBeEIsQ0FESjtBQUVBLE1BQU0sUUFBUSxrQkFBa0IsWUFBbEIsRUFBZ0MsT0FBaEMsQ0FBZDtBQUNBLFNBQU8scUJBQ0gsT0FERyxFQUNNLFlBRE4sRUFDb0IsWUFEcEIsRUFDa0MsS0FEbEMsQ0FBUDtBQUVEOztBQUVEOzs7O0FBSU8sU0FBUyxtQ0FBVCxDQUE2QyxHQUE3QyxFQUFrRDtBQUN2RCxTQUFPLDBCQUEwQixHQUExQixJQUNILCtCQUErQixHQUQ1QixJQUVILHVCQUF1QixJQUFJLHlCQUFKLENBQThCLFNBRnpEO0FBR0Q7O0FBRUQ7Ozs7O0lBSWEsdUIsV0FBQSx1QjtBQUNYOzs7OztBQUtBLG1DQUFZLFdBQVosRUFBeUIsTUFBekIsRUFBaUMsUUFBakMsRUFBMkM7QUFBQTs7QUFBQTs7QUFDekM7QUFDQSxTQUFLLFlBQUwsR0FBb0IsV0FBcEI7O0FBRUE7QUFDQSxTQUFLLHFCQUFMLEdBQTZCLElBQTdCOztBQUVBO0FBQ0EsU0FBSyxjQUFMLEdBQXNCLEtBQXRCOztBQUVBO0FBQ0EsU0FBSyxhQUFMLEdBQXFCLEtBQXJCOztBQUVBO0FBQ0EsU0FBSyxrQkFBTCxHQUEwQixJQUExQjs7QUFFQTtBQUNBLFNBQUssU0FBTCxHQUFpQixZQUFZLFdBQVosRUFBakI7O0FBRUE7QUFDQSxTQUFLLGdCQUFMLEdBQXdCLGtDQUNwQixNQURvQixFQUNaLG9CQURZLEVBQ1UsWUFBWSxLQUR0QixFQUM2QixZQUFNO0FBQ3JELFlBQUsseUJBQUw7QUFDRCxLQUhtQixDQUF4Qjs7QUFLQSxTQUFLLHFCQUFMLEdBQTZCLElBQUksNEJBQUosQ0FBaUMsbUJBQVc7QUFDdkU7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksUUFBUSxNQUE1QixFQUFvQyxHQUFwQyxFQUF5QztBQUN2QyxlQUFPLFFBQVEsQ0FBUixFQUFXLFFBQVgsQ0FBUDtBQUNEO0FBQ0QsWUFBSyxnQkFBTCxDQUFzQixJQUF0QixDQUEyQixjQUEzQixFQUEyQyxrQkFBSyxFQUFDLFdBQVcsT0FBWixFQUFMLENBQTNDO0FBQ0QsS0FONEIsRUFNMUIsRUFBQyxXQUFXLGlCQUFaLEVBTjBCLENBQTdCO0FBT0EsU0FBSyxxQkFBTCxDQUEyQixJQUEzQixDQUFnQyxLQUFLLFNBQUwsQ0FBZSxPQUFmLEVBQWhDOztBQUVBO0FBQ0EsU0FBSyxJQUFMLEdBQVksWUFBTTtBQUNoQixVQUFJLENBQUMsTUFBSyxjQUFOLElBQXdCLENBQUMsTUFBSyxhQUFsQyxFQUFpRDtBQUMvQztBQUNEO0FBQ0QsWUFBSyxxQkFBTCxDQUEyQixJQUEzQixDQUFnQyxNQUFLLFNBQUwsQ0FBZSxPQUFmLEVBQWhDO0FBQ0QsS0FMRDtBQU1EOztBQUVEOzs7Ozs7OztnREFJNEI7QUFBQTs7QUFDMUIsV0FBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0EsV0FBSyxxQkFBTCxDQUEyQixPQUEzQixDQUFtQyxLQUFLLFlBQUwsQ0FBa0IsT0FBckQ7QUFDQSxXQUFLLFlBQUwsQ0FBa0IsUUFBbEIsR0FBNkIsT0FBN0IsQ0FBcUMsWUFBTTtBQUN6QyxlQUFLLGFBQUwsR0FBcUIsT0FBSyxZQUFMLENBQWtCLFlBQWxCLEVBQXJCO0FBQ0EsZUFBSyxJQUFMO0FBQ0QsT0FIRDs7QUFLQSxVQUFNLHlCQUF5QixLQUFLLFNBQUwsQ0FBZSxRQUFmLENBQXdCLEtBQUssSUFBN0IsQ0FBL0I7QUFDQSxVQUFNLHlCQUF5QixLQUFLLFNBQUwsQ0FBZSxTQUFmLENBQXlCLEtBQUssSUFBOUIsQ0FBL0I7QUFDQSxXQUFLLGtCQUFMLEdBQTBCLFlBQU07QUFDOUI7QUFDQTtBQUNELE9BSEQ7QUFJRDs7QUFFRDs7Ozs7Ozt1Q0FJbUIsVSxFQUFZO0FBQzdCLFdBQUssYUFBTCxHQUFxQixVQUFyQjtBQUNEOztBQUVEOzs7Ozs7OEJBR1U7QUFDUixXQUFLLGNBQUwsR0FBc0IsS0FBdEI7QUFDQSxXQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0EsVUFBSSxLQUFLLGtCQUFULEVBQTZCO0FBQzNCLGFBQUssa0JBQUw7QUFDQSxhQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0Q7QUFDRCxXQUFLLGdCQUFMLENBQXNCLE9BQXRCO0FBQ0EsV0FBSyxnQkFBTCxHQUF3QixJQUF4QjtBQUNEOzs7Ozs7QUFJSDs7Ozs7Ozs7Ozs7O0lBVWEsNEIsV0FBQSw0QjtBQUNYOzs7O0FBSUEsd0NBQVksUUFBWixFQUFzQixVQUF0QixFQUFrQztBQUFBOztBQUNoQztBQUNBLFNBQUssU0FBTCxHQUFpQixRQUFqQjs7QUFFQTtBQUNBLFFBQUksWUFBWSxjQUFjLFdBQVcsU0FBekM7QUFDQSxRQUFJLFNBQUosRUFBZTtBQUNiLGtCQUFZLG9CQUFRLFNBQVIsSUFDVixTQURVLEdBQ0UsQ0FBQyxTQUFELENBRGQ7QUFFRCxLQUhELE1BR087QUFDTCxrQkFBWSxDQUFDLENBQUQsQ0FBWjtBQUNEOztBQUVELFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLHNCQUFNLE1BQU4sQ0FBYSwyQkFBZSxVQUFVLENBQVYsQ0FBZixDQUFiLEVBQTJDLDJCQUN2Qyw2Q0FESjtBQUVEOztBQUVEOzs7O0FBSUEsU0FBSyxVQUFMLEdBQWtCLFVBQVUsSUFBVixFQUFsQjtBQUNBLG9CQUFNLE1BQU4sQ0FBYSxLQUFLLFVBQUwsQ0FBZ0IsQ0FBaEIsS0FBc0IsQ0FBdEIsSUFDVCxLQUFLLFVBQUwsQ0FBZ0IsS0FBSyxVQUFMLENBQWdCLE1BQWhCLEdBQXlCLENBQXpDLEtBQStDLENBRG5ELEVBRUEsZ0RBRkE7O0FBSUE7QUFDQSxTQUFLLGlCQUFMLEdBQXlCLElBQXpCOztBQUVBO0FBQ0EsU0FBSyxlQUFMLEdBQXVCLFNBQXZCOztBQUVBOzs7OztBQUtBLFNBQUssZUFBTCxHQUF1QixFQUF2QjtBQUNEOztBQUVEOzs7Ozs7aUNBRWE7QUFDWCxXQUFLLGVBQUwsQ0FBcUIsTUFBckIsR0FBOEIsQ0FBOUI7QUFDRDs7QUFFRDs7Ozs7Ozs7OzRCQU1RLE8sRUFBUztBQUNmO0FBQ0Esc0JBQU0sTUFBTixDQUFhLFFBQVEsWUFBckI7O0FBRUE7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksS0FBSyxlQUFMLENBQXFCLE1BQXpDLEVBQWlELEdBQWpELEVBQXNEO0FBQ3BELFlBQUksS0FBSyxlQUFMLENBQXFCLENBQXJCLEVBQXdCLE9BQXhCLEtBQW9DLE9BQXhDLEVBQWlEO0FBQy9DLDBCQUFNLElBQU4sQ0FBVyxHQUFYLEVBQWdCLGtDQUFoQjtBQUNBO0FBQ0Q7QUFDRjs7QUFFRCxVQUFNLFdBQVc7QUFDZix3QkFEZTtBQUVmLDhCQUFzQjtBQUZQLE9BQWpCOztBQUtBO0FBQ0EsVUFBSSxLQUFLLGlCQUFULEVBQTRCO0FBQzFCLFlBQU0sU0FBUyxLQUFLLGdDQUFMLENBQ1gsUUFEVyxFQUNELEtBQUssaUJBREosRUFDdUIsS0FBSyxlQUQ1QixDQUFmO0FBRUEsWUFBSSxNQUFKLEVBQVk7QUFDVixlQUFLLFNBQUwsQ0FBZSxDQUFDLE1BQUQsQ0FBZjtBQUNEO0FBQ0Y7O0FBRUQ7QUFDQSxXQUFLLGVBQUwsQ0FBcUIsSUFBckIsQ0FBMEIsUUFBMUI7QUFDRDs7QUFFRDs7Ozs7Ozs4QkFJVSxPLEVBQVM7QUFDakI7QUFDQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksS0FBSyxlQUFMLENBQXFCLE1BQXpDLEVBQWlELEdBQWpELEVBQXNEO0FBQ3BELFlBQUksS0FBSyxlQUFMLENBQXFCLENBQXJCLEVBQXdCLE9BQXhCLEtBQW9DLE9BQXhDLEVBQWlEO0FBQy9DLGVBQUssZUFBTCxDQUFxQixNQUFyQixDQUE0QixDQUE1QixFQUErQixDQUEvQjtBQUNBO0FBQ0Q7QUFDRjtBQUNELHNCQUFNLElBQU4sQ0FBVyxHQUFYLEVBQWdCLGdDQUFoQjtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozt5QkFRSyxZLEVBQWMsVSxFQUFZOztBQUU3QixVQUFJLFVBQUosRUFBZ0I7QUFDZDtBQUNBLHVCQUNJLGdDQUFlLFlBQWYsRUFBNkIsQ0FBQyxXQUFXLElBQXpDLEVBQStDLENBQUMsV0FBVyxHQUEzRCxDQURKO0FBRUEscUJBQ0ksZ0NBQWUsVUFBZixFQUEyQixDQUFDLFdBQVcsSUFBdkMsRUFBNkMsQ0FBQyxXQUFXLEdBQXpELENBREo7QUFFRDs7QUFFRCxXQUFLLGlCQUFMLEdBQXlCLFlBQXpCO0FBQ0EsV0FBSyxlQUFMLEdBQXVCLFVBQXZCOztBQUVBLFVBQU0sVUFBVSxFQUFoQjs7QUFFQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksS0FBSyxlQUFMLENBQXFCLE1BQXpDLEVBQWlELEdBQWpELEVBQXNEO0FBQ3BELFlBQU0sU0FBUyxLQUFLLGdDQUFMLENBQ1gsS0FBSyxlQUFMLENBQXFCLENBQXJCLENBRFcsRUFDYyxZQURkLEVBQzRCLFVBRDVCLENBQWY7QUFFQSxZQUFJLE1BQUosRUFBWTtBQUNWLGtCQUFRLElBQVIsQ0FBYSxNQUFiO0FBQ0Q7QUFDRjs7QUFFRCxVQUFJLFFBQVEsTUFBWixFQUFvQjtBQUNsQixhQUFLLFNBQUwsQ0FBZSxPQUFmO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7Ozs7Ozs7O3FEQVlpQyxLLEVBQU8sWSxFQUFjLFUsRUFBWTtBQUFBLFVBQ3pELE9BRHlELEdBQzlDLEtBRDhDLENBQ3pELE9BRHlEOztBQUdoRTs7QUFDQSxVQUFJLFlBQVksSUFBaEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFNLGNBQWMsUUFBUSxZQUFSLEVBQXBCO0FBQ0EsVUFBTSxRQUFRLFFBQVEsUUFBUixFQUFkO0FBQ0Esa0JBQVksU0FBUyxNQUFNLFlBQU4sRUFBckI7O0FBRUE7QUFDQTtBQUNBLFVBQU0sbUJBQ0Ysa0NBQWlCLFdBQWpCLEVBQThCLFNBQTlCLEVBQXlDLFlBQXpDLEVBQXVELFVBQXZELEtBQ0EsZ0NBQWUsQ0FBZixFQUFrQixDQUFsQixFQUFxQixDQUFyQixFQUF3QixDQUF4QixDQUZKO0FBR0E7QUFDQSxVQUFNLFFBQVEsa0JBQWtCLGdCQUFsQixFQUFvQyxXQUFwQyxDQUFkO0FBQ0EsVUFBTSxtQkFBbUIsaUJBQWlCLEtBQUssVUFBdEIsRUFBa0MsS0FBbEMsQ0FBekI7O0FBRUEsVUFBSSxvQkFBb0IsTUFBTSxvQkFBOUIsRUFBb0Q7QUFDbEQsZUFBTyxJQUFQO0FBQ0Q7QUFDRCxZQUFNLG9CQUFOLEdBQTZCLGdCQUE3Qjs7QUFFQTtBQUNBO0FBQ0EsVUFBTSxjQUFjLHFCQUFxQixXQUFyQixFQUNmLGFBQWEsSUFBYixHQUFvQixZQURMLEVBQ29CLGdCQURwQixFQUNzQyxLQUR0QyxDQUFwQjtBQUVBLGtCQUFZLE1BQVosR0FBcUIsT0FBckI7QUFDQSxhQUFPLFdBQVA7QUFDRDs7Ozs7O0FBR0g7Ozs7Ozs7O0FBTUEsU0FBUyxpQkFBVCxDQUEyQixPQUEzQixFQUFvQyxNQUFwQyxFQUE0QztBQUMxQyxTQUFRLFFBQVEsS0FBUixHQUFnQixRQUFRLE1BQXpCLElBQW9DLE9BQU8sS0FBUCxHQUFlLE9BQU8sTUFBMUQsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxnQkFBVCxDQUEwQixlQUExQixFQUEyQyxLQUEzQyxFQUFrRDtBQUN2RCxNQUFJLFdBQVcsQ0FBZjtBQUNBLE1BQUksU0FBUyxnQkFBZ0IsTUFBN0I7QUFDQTtBQUNBLE1BQUksU0FBUyxDQUFiLEVBQWdCO0FBQ2QsV0FBTyxDQUFQO0FBQ0Q7QUFDRCxNQUFJLE1BQU8sQ0FBQyxXQUFXLE1BQVosSUFBc0IsQ0FBdkIsR0FBNEIsQ0FBdEM7QUFDQSxTQUFPLFdBQVcsR0FBbEIsRUFBdUI7QUFDckIsUUFBTSxXQUFXLGdCQUFnQixHQUFoQixDQUFqQjtBQUNBO0FBQ0EsUUFBSSxRQUFRLFFBQVosRUFBc0I7QUFDcEIsZUFBUyxHQUFUO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsaUJBQVcsR0FBWDtBQUNEO0FBQ0QsVUFBTyxDQUFDLFdBQVcsTUFBWixJQUFzQixDQUF2QixHQUE0QixDQUFsQztBQUNEO0FBQ0QsU0FBTyxNQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyxvQkFBVCxDQUNFLE9BREYsRUFDVyxZQURYLEVBQ3lCLFlBRHpCLEVBQ3VDLEtBRHZDLEVBQzhDO0FBQzVDO0FBQ0E7QUFDQSxNQUFJLHFCQUFxQixPQUF6QjtBQUNBLE1BQUksYUFBYSxZQUFqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBSSxZQUFKLEVBQWtCO0FBQ2hCO0FBQ0E7QUFDQSxpQkFBYSwyQ0FBNkMsVUFBMUQ7QUFDQSxtQkFBZSxnQ0FBZSxZQUFmLEVBQTZCLENBQUMsYUFBYSxJQUEzQyxFQUNYLENBQUMsYUFBYSxHQURILENBQWY7QUFFQTtBQUNBO0FBQ0EseUJBQXFCLGdDQUFlLGtCQUFmLEVBQ2pCLENBQUMsYUFBYSxJQURHLEVBQ0csQ0FBQyxhQUFhLEdBRGpCLENBQXJCO0FBRUE7QUFDQSxpQkFBYSxnQ0FBZSxVQUFmLEVBQ1QsQ0FBQyxhQUFhLElBREwsRUFDVyxDQUFDLGFBQWEsR0FEekIsQ0FBYjtBQUVEOztBQUVELFNBQU8sMENBQTJDO0FBQ2hELFlBQU8sT0FBTyxXQUFQLEtBQXVCLFdBQXZCLElBQXNDLFlBQVksR0FBbkQsR0FDSixZQUFZLEdBQVosRUFESSxHQUNnQixLQUFLLEdBQUwsS0FBYSxTQUZhO0FBR2hELDRCQUhnRDtBQUloRCw0Q0FKZ0Q7QUFLaEQsd0JBQWtCLFlBTDhCO0FBTWhELHlCQUFtQjtBQU42QjtBQUFsRDtBQVFEOzs7Ozs7OzhRQzVjRDs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7UUEyQ2dCLHNCLEdBQUEsc0I7UUFzQkEsZSxHQUFBLGU7UUErQkEsUyxHQUFBLFM7UUFhQSxZLEdBQUEsWTtRQW9CQSxlLEdBQUEsZTs7QUE1SGhCOztBQUdBO0FBQ0E7O0FBRUE7Ozs7QUFJQSxJQUFJLHNCQUFKOztBQUdBOzs7O0FBSUEsSUFBSSxzQkFBSjs7QUFHQTs7OztBQUlBLElBQUkscUJBQUo7O0FBR0E7Ozs7QUFJQSxJQUFJLHFCQUFKOztBQUVBOzs7OztBQUtPLFNBQVMsc0JBQVQsQ0FBZ0MsR0FBaEMsRUFBcUM7QUFDMUMsTUFBTSxPQUFPLE9BQU8sTUFBUCxDQUFjLElBQWQsQ0FBYjtBQUNBLE9BQUssSUFBTSxDQUFYLElBQWdCLEdBQWhCLEVBQXFCO0FBQ25CLFFBQUksQ0FBQyxlQUFlLEdBQWYsRUFBb0IsQ0FBcEIsQ0FBTCxFQUE2QjtBQUMzQjtBQUNEO0FBQ0QsUUFBTSxJQUFJLElBQUksQ0FBSixDQUFWO0FBQ0EsU0FBSyxDQUFMLElBQVUscUJBQVMsQ0FBVCxJQUFjLHVCQUF1QixDQUF2QixDQUFkLEdBQTBDLENBQXBEO0FBQ0Q7QUFDRCxTQUFPLDJCQUE0QjtBQUFuQztBQUNEOztBQUVEOzs7Ozs7Ozs7O0FBVU8sU0FBUyxlQUFULENBQXlCLEdBQXpCLEVBQThCLElBQTlCLEVBQW9DO0FBQ3pDO0FBQ0EsTUFBSSxRQUFRLEdBQVosRUFBaUI7QUFDZixXQUFPLEdBQVA7QUFDRDtBQUNEO0FBQ0EsTUFBTSxRQUFRLEtBQUssS0FBTCxDQUFXLEdBQVgsQ0FBZDtBQUNBLE1BQUksUUFBUSxHQUFaO0FBQ0EsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLE1BQU0sTUFBMUIsRUFBa0MsR0FBbEMsRUFBdUM7QUFDckMsUUFBTSxPQUFPLE1BQU0sQ0FBTixDQUFiO0FBQ0EsUUFBSSxRQUNBLEtBREEsSUFFQSxNQUFNLElBQU4sTUFBZ0IsU0FGaEIsSUFHQSxlQUFlLEtBQWYsRUFBc0IsSUFBdEIsQ0FISixFQUlFO0FBQ0EsY0FBUSxNQUFNLElBQU4sQ0FBUjtBQUNBO0FBQ0Q7QUFDRCxZQUFRLFNBQVI7QUFDQTtBQUNEO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLFNBQVQsQ0FBbUIsSUFBbkIsRUFBeUI7QUFDOUIsU0FBTywyQkFBMkIsS0FBSyxLQUFMLEVBQVcscUJBQXVCLElBQWxDO0FBQWxDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsWUFBVCxDQUFzQixJQUF0QixFQUE0QixZQUE1QixFQUEwQztBQUMvQyxNQUFJO0FBQ0YsV0FBTyxVQUFVLElBQVYsQ0FBUDtBQUNELEdBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWLFFBQUksWUFBSixFQUFrQjtBQUNoQixtQkFBYSxDQUFiO0FBQ0Q7QUFDRCxXQUFPLFNBQVA7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7QUFTTyxTQUFTLGVBQVQsQ0FBeUIsQ0FBekIsRUFBNEIsQ0FBNUIsRUFBMEM7QUFBQSxNQUFYLEtBQVcsdUVBQUgsQ0FBRzs7QUFDL0MsTUFBSSxDQUFDLFNBQVMsS0FBVCxDQUFMLEVBQXNCO0FBQ3BCLFVBQU0sSUFBSSxLQUFKLENBQVUsK0JBQStCLEtBQXpDLENBQU47QUFDRDtBQUNELE1BQUksTUFBTSxDQUFWLEVBQWE7QUFDWCxXQUFPLElBQVA7QUFDRDtBQUNEO0FBQ0EsTUFBSSxRQUFRLENBQVosRUFBZTtBQUNiLFdBQU8sS0FBUDtBQUNEO0FBQ0QsTUFBSSxRQUFPLENBQVAseUNBQU8sQ0FBUCxlQUFvQixDQUFwQix5Q0FBb0IsQ0FBcEIsRUFBSixFQUEyQjtBQUN6QixXQUFPLEtBQVA7QUFDRDtBQUNELE1BQUksTUFBTSxPQUFOLENBQWMsQ0FBZCxLQUFvQixNQUFNLE9BQU4sQ0FBYyxDQUFkLENBQXhCLEVBQTBDO0FBQ3hDLFFBQUksRUFBRSxNQUFGLEtBQWEsRUFBRSxNQUFuQixFQUEyQjtBQUN6QixhQUFPLEtBQVA7QUFDRDtBQUNELFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxFQUFFLE1BQXRCLEVBQThCLEdBQTlCLEVBQW1DO0FBQ2pDLFVBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFGLENBQWhCLEVBQXNCLEVBQUUsQ0FBRixDQUF0QixFQUE0QixRQUFRLENBQXBDLENBQUwsRUFBNkM7QUFDM0MsZUFBTyxLQUFQO0FBQ0Q7QUFDRjtBQUNELFdBQU8sSUFBUDtBQUNEO0FBQ0QsTUFBSSxLQUFLLENBQUwsSUFBVSxRQUFPLENBQVAseUNBQU8sQ0FBUCxPQUFhLFFBQXZCLElBQW1DLFFBQU8sQ0FBUCx5Q0FBTyxDQUFQLE9BQWEsUUFBcEQsRUFBOEQ7QUFDNUQsUUFBTSxRQUFRLE9BQU8sSUFBUCxFQUFZLHNCQUF3QixDQUFwQyxDQUFkO0FBQ0EsUUFBTSxRQUFRLE9BQU8sSUFBUCxFQUFZLHNCQUF3QixDQUFwQyxDQUFkO0FBQ0EsUUFBSSxNQUFNLE1BQU4sS0FBaUIsTUFBTSxNQUEzQixFQUFtQztBQUNqQyxhQUFPLEtBQVA7QUFDRDtBQUNELFNBQUssSUFBSSxLQUFJLENBQWIsRUFBZ0IsS0FBSSxNQUFNLE1BQTFCLEVBQWtDLElBQWxDLEVBQXVDO0FBQ3JDLFVBQU0sT0FBTyxNQUFNLEVBQU4sQ0FBYjtBQUNBLFVBQU0sU0FBUyxFQUFFLElBQUYsQ0FBZjtBQUNBLFVBQU0sU0FBUyxFQUFFLElBQUYsQ0FBZjtBQUNBLFVBQUksQ0FBQyxnQkFBZ0IsTUFBaEIsRUFBd0IsTUFBeEIsRUFBZ0MsUUFBUSxDQUF4QyxDQUFMLEVBQWlEO0FBQy9DLGVBQU8sS0FBUDtBQUNEO0FBQ0Y7QUFDRCxXQUFPLElBQVA7QUFDRDtBQUNELFNBQU8sS0FBUDtBQUNEOztBQUdEOzs7OztBQUtBLFNBQVMsY0FBVCxDQUF3QixHQUF4QixFQUE2QixHQUE3QixFQUFrQztBQUNoQyxNQUFJLE9BQU8sSUFBUCxJQUFlLFFBQU8sR0FBUCx5Q0FBTyxHQUFQLE1BQWMsUUFBakMsRUFBMkM7QUFDekMsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxTQUFPLE9BQU8sU0FBUCxDQUFpQixjQUFqQixDQUFnQyxJQUFoQztBQUNILHdCQUF3QixHQURyQixFQUMyQixHQUQzQixDQUFQO0FBRUQ7Ozs7OztRQ3JIZSxjLEdBQUEsYztRQW9CQSxxQixHQUFBLHFCO1FBV0Esa0IsR0FBQSxrQjtRQVdBLGdCLEdBQUEsZ0I7UUE4QkEsc0IsR0FBQSxzQjtRQWlCQSxnQixHQUFBLGdCO1FBY0EsYyxHQUFBLGM7UUFlQSxpQixHQUFBLGlCO1FBWUEsb0IsR0FBQSxvQjtRQVVBLGdCLEdBQUEsZ0I7QUFoT2hCOzs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBOzs7Ozs7Ozs7Ozs7Ozs7QUFlTyxJQUFJLDhDQUFKOztBQUdQOzs7Ozs7Ozs7O0FBVU8sSUFBSSxvREFBSjs7QUFHUDs7Ozs7Ozs7Ozs7O0FBWU8sSUFBSSxnRUFBSjs7QUFFUDs7Ozs7OztBQU9PLElBQU0sZ0RBQW9CO0FBQy9CLFVBQVEsUUFEdUI7QUFFL0IsT0FBSyxLQUYwQjtBQUcvQixVQUFRO0FBSHVCLENBQTFCOztBQU1QOzs7Ozs7Ozs7QUFTTyxTQUFTLGNBQVQsQ0FBd0IsSUFBeEIsRUFBOEIsR0FBOUIsRUFBbUMsS0FBbkMsRUFBMEMsTUFBMUMsRUFBa0Q7QUFDdkQsU0FBTztBQUNMLGNBREs7QUFFTCxZQUZLO0FBR0wsZ0JBSEs7QUFJTCxrQkFKSztBQUtMLFlBQVEsTUFBTSxNQUxUO0FBTUwsV0FBTyxPQUFPLEtBTlQ7QUFPTCxPQUFHLElBUEU7QUFRTCxPQUFHO0FBUkUsR0FBUDtBQVVEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLHFCQUFULENBQStCLElBQS9CLEVBQXFDO0FBQzFDLFNBQU8sZUFBZSxPQUFPLEtBQUssSUFBWixDQUFmLEVBQWtDLE9BQU8sS0FBSyxHQUFaLENBQWxDLEVBQ0gsT0FBTyxLQUFLLEtBQVosQ0FERyxFQUNpQixPQUFPLEtBQUssTUFBWixDQURqQixDQUFQO0FBRUQ7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsa0JBQVQsQ0FBNEIsRUFBNUIsRUFBZ0MsRUFBaEMsRUFBb0M7QUFDekMsU0FBUSxHQUFHLEdBQUgsSUFBVSxHQUFHLE1BQWIsSUFBdUIsR0FBRyxHQUFILElBQVUsR0FBRyxNQUFwQyxJQUNKLEdBQUcsSUFBSCxJQUFXLEdBQUcsS0FEVixJQUNtQixHQUFHLElBQUgsSUFBVyxHQUFHLEtBRHpDO0FBRUQ7O0FBR0Q7Ozs7O0FBS08sU0FBUyxnQkFBVCxDQUEwQixRQUExQixFQUFvQztBQUN6QyxNQUFJLEtBQUssQ0FBQyxRQUFWO0FBQ0EsTUFBSSxLQUFLLFFBQVQ7QUFDQSxNQUFJLEtBQUssQ0FBQyxRQUFWO0FBQ0EsTUFBSSxLQUFLLFFBQVQ7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksVUFBVSxNQUE5QixFQUFzQyxHQUF0QyxFQUEyQztBQUN6QyxRQUFNLFVBQVUsVUFBVSxDQUFWLENBQWhCO0FBQ0EsUUFBSSxDQUFDLE9BQUwsRUFBYztBQUNaO0FBQ0Q7QUFDRCxTQUFLLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxRQUFRLElBQXJCLENBQUw7QUFDQSxTQUFLLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxRQUFRLElBQVIsR0FBZSxRQUFRLEtBQXBDLENBQUw7QUFDQSxTQUFLLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxRQUFRLEdBQXJCLENBQUw7QUFDQSxTQUFLLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxRQUFRLEdBQVIsR0FBYyxRQUFRLE1BQW5DLENBQUw7QUFDQSxRQUFJLEtBQUssRUFBTCxJQUFXLEtBQUssRUFBcEIsRUFBd0I7QUFDdEIsYUFBTyxJQUFQO0FBQ0Q7QUFDRjtBQUNELE1BQUksTUFBTSxRQUFWLEVBQW9CO0FBQ2xCLFdBQU8sSUFBUDtBQUNEO0FBQ0QsU0FBTyxlQUFlLEVBQWYsRUFBbUIsRUFBbkIsRUFBdUIsS0FBSyxFQUE1QixFQUFnQyxLQUFLLEVBQXJDLENBQVA7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxzQkFBVCxDQUFnQyxFQUFoQyxFQUFvQyxFQUFwQyxFQUF3QztBQUM3QyxNQUFJLEdBQUcsR0FBSCxHQUFTLEdBQUcsR0FBaEIsRUFBcUI7QUFDbkIsV0FBTyxrQkFBa0IsR0FBekI7QUFDRCxHQUZELE1BRU8sSUFBSSxHQUFHLE1BQUgsR0FBWSxHQUFHLE1BQW5CLEVBQTJCO0FBQ2hDLFdBQU8sa0JBQWtCLE1BQXpCO0FBQ0QsR0FGTSxNQUVBO0FBQ0wsV0FBTyxrQkFBa0IsTUFBekI7QUFDRDtBQUNGOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxnQkFBVCxDQUEwQixJQUExQixFQUFnQyxFQUFoQyxFQUFvQyxFQUFwQyxFQUF3QztBQUM3QyxTQUFPLGVBQWUsS0FBSyxJQUFMLEdBQVksS0FBSyxLQUFMLEdBQWEsRUFBeEMsRUFDSCxLQUFLLEdBQUwsR0FBVyxLQUFLLE1BQUwsR0FBYyxFQUR0QixFQUVILEtBQUssS0FBTCxJQUFjLElBQUksS0FBSyxDQUF2QixDQUZHLEVBR0gsS0FBSyxNQUFMLElBQWUsSUFBSSxLQUFLLENBQXhCLENBSEcsQ0FBUDtBQUlEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxjQUFULENBQXdCLElBQXhCLEVBQThCLEVBQTlCLEVBQWtDLEVBQWxDLEVBQXNDO0FBQzNDLE1BQUssTUFBTSxDQUFOLElBQVcsTUFBTSxDQUFsQixJQUNDLEtBQUssS0FBTCxJQUFjLENBQWQsSUFBbUIsS0FBSyxNQUFMLElBQWUsQ0FEdkMsRUFDMkM7QUFDekMsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxTQUFPLGVBQWUsS0FBSyxJQUFMLEdBQVksRUFBM0IsRUFBK0IsS0FBSyxHQUFMLEdBQVcsRUFBMUMsRUFDSCxLQUFLLEtBREYsRUFDUyxLQUFLLE1BRGQsQ0FBUDtBQUVEOztBQUdEOzs7OztBQUtPLFNBQVMsaUJBQVQsQ0FBMkIsT0FBM0IsRUFBb0MsTUFBcEMsRUFBNEM7QUFDakQsU0FBUSxPQUFPLEdBQVAsS0FBZSxTQUFmLElBQTRCLE9BQU8sR0FBUCxJQUFjLFFBQVEsR0FBbkQsSUFDRixPQUFPLEtBQVAsS0FBaUIsU0FBakIsSUFBOEIsT0FBTyxLQUFQLElBQWdCLFFBQVEsS0FEcEQsSUFFRixPQUFPLE1BQVAsS0FBa0IsU0FBbEIsSUFBK0IsT0FBTyxNQUFQLElBQWlCLFFBQVEsTUFGdEQsSUFHRixPQUFPLElBQVAsS0FBZ0IsU0FBaEIsSUFBNkIsT0FBTyxJQUFQLElBQWUsUUFBUSxJQUh6RDtBQUlEOztBQUVEOzs7OztBQUtPLFNBQVMsb0JBQVQsQ0FBOEIsSUFBOUIsRUFBb0MsRUFBcEMsRUFBd0M7QUFDN0MsU0FBTyxLQUFLLEtBQUwsSUFBYyxHQUFHLEtBQWpCLElBQ0gsS0FBSyxNQUFMLEtBQWdCLEdBQUcsTUFEdkI7QUFFRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGdCQUFULENBQTBCLEVBQTFCLEVBQThCLEVBQTlCLEVBQWtDO0FBQ3ZDLE1BQUksQ0FBQyxFQUFELElBQU8sQ0FBQyxFQUFaLEVBQWdCO0FBQ2QsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxTQUFPLEdBQUcsSUFBSCxJQUFXLEdBQUcsSUFBZCxJQUFzQixHQUFHLEdBQUgsSUFBVSxHQUFHLEdBQW5DLElBQ0gsR0FBRyxLQUFILElBQVksR0FBRyxLQURaLElBQ3FCLEdBQUcsTUFBSCxJQUFhLEdBQUcsTUFENUM7QUFFRDs7Ozs7Ozs7OztRQzNHZSxXLEdBQUEsVztRQWNBLGMsR0FBQSxjO1FBVUEsbUIsR0FBQSxtQjtRQWdCQSxpQixHQUFBLGlCO1FBWUEsVyxHQUFBLFc7UUF1QkEsWSxHQUFBLFk7UUFnQkEscUIsR0FBQSxxQjtRQVlBLGMsR0FBQSxjO1FBY0EsZ0IsR0FBQSxnQjtRQVlBLG9CLEdBQUEsb0I7UUFjQSxvQixHQUFBLG9CO1FBK0JBLGdCLEdBQUEsZ0I7UUF5QkEsaUIsR0FBQSxpQjs7QUE3U2hCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztrSkF6QkE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7O0FBV0E7OztBQUdPLElBQU0sMEJBQVM7QUFDcEIsYUFBVyxXQURTO0FBRXBCLFNBQU8sT0FGYTtBQUdwQixnQkFBYyxjQUhNO0FBSXBCLGNBQVksWUFKUTtBQUtwQixhQUFXLFdBTFM7QUFNcEIsUUFBTSxNQU5jO0FBT3BCLGFBQVcsV0FQUztBQVFwQixTQUFPLE9BUmE7QUFTcEIsYUFBVztBQVRTLENBQWY7O0FBYVA7Ozs7O0FBS08sSUFBTSwwQ0FBaUI7QUFDNUIsV0FBUyxDQURtQjtBQUU1QixZQUFVLENBRmtCO0FBRzVCLE9BQUssQ0FIdUI7QUFJNUIsY0FBWTtBQUpnQixDQUF2Qjs7QUFRUDs7OztBQUlPLElBQUksc0NBQUo7O0FBR1A7Ozs7OztBQU1BLElBQUksc0JBQUo7O0FBR0E7Ozs7Ozs7Ozs7QUFVTyxJQUFNLGtEQUFxQjtBQUNoQyxlQUFhLEVBQUMsT0FBTyxLQUFSLEVBQWUsUUFBUSxLQUF2QixFQURtQjtBQUVoQyxtQkFBaUIsRUFBQyxPQUFPLEtBQVIsRUFBZSxRQUFRLEtBQXZCLEVBRmU7QUFHaEM7QUFDQSxlQUFhLElBSm1CO0FBS2hDLHNCQUFvQixFQUFDLE9BQU8sTUFBUixFQUFnQixRQUFRLE1BQXhCO0FBTFksQ0FBM0I7O0FBU1A7Ozs7OztBQU1PLElBQU0sZ0RBQW9CO0FBQy9CLGNBQVksSUFEbUI7QUFFL0Isb0JBQWtCLElBRmE7QUFHL0IsK0JBQTZCLElBSEU7QUFJL0IsZUFBYSxJQUprQjtBQUsvQixrQkFBZ0IsSUFMZTtBQU0vQiwyQkFBeUIsSUFOTTtBQU8vQix1QkFBcUIsSUFQVTtBQVEvQix1QkFBcUIsSUFSVTtBQVMvQixnQkFBYyxJQVRpQjtBQVUvQixhQUFXLElBVm9CO0FBVy9CLG1CQUFpQixJQVhjO0FBWS9CLGNBQVksSUFabUI7QUFhL0IsdUJBQXFCLElBYlU7QUFjL0IsbUJBQWlCLElBZGM7QUFlL0Isa0JBQWdCLElBZmU7QUFnQi9CLGVBQWEsSUFoQmtCO0FBaUIvQixpQkFBZTtBQWpCZ0IsQ0FBMUI7O0FBcUJQOzs7OztBQUtPLFNBQVMsV0FBVCxDQUFxQixDQUFyQixFQUF3QjtBQUM3QixPQUFLLElBQU0sQ0FBWCxJQUFnQixNQUFoQixFQUF3QjtBQUN0QixRQUFJLE9BQU8sQ0FBUCxLQUFhLENBQWpCLEVBQW9CO0FBQ2xCLGFBQU8sT0FBTyxDQUFQLENBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxTQUFQO0FBQ0Q7O0FBR0Q7Ozs7QUFJTyxTQUFTLGNBQVQsQ0FBd0IsTUFBeEIsRUFBZ0M7QUFDckMsU0FBTyxzQkFBc0IsTUFBN0I7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLG1CQUFULENBQTZCLE1BQTdCLEVBQXFDO0FBQzFDLFNBQVEsVUFBVSxPQUFPLEtBQWpCLElBQ0osVUFBVSxPQUFPLFlBRGIsSUFFSixVQUFVLE9BQU8sVUFGYixJQUdKLFVBQVUsT0FBTyxJQUhiLElBSUosVUFBVSxPQUFPLFNBSmIsSUFLSixVQUFVLE9BQU8sS0FMYixJQU1KLFVBQVUsT0FBTyxTQU5yQjtBQU9EOztBQUdEOzs7OztBQUtPLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0M7QUFDckMsTUFBTSxVQUFXLE9BQU8sR0FBUCxJQUFjLFFBQWYsR0FBMkIsR0FBM0IsR0FBaUMsSUFBSSxPQUFyRDtBQUNBLFNBQU8sV0FBVyx3QkFBVyxRQUFRLFdBQVIsRUFBWCxFQUFrQyxJQUFsQyxDQUFsQjtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLFdBQVQsQ0FBcUIsQ0FBckIsRUFBd0I7QUFDN0IsTUFBSSxPQUFPLENBQVAsSUFBWSxRQUFoQixFQUEwQjtBQUN4QixXQUFPLElBQUksSUFBWDtBQUNEO0FBQ0QsTUFBSSxDQUFDLENBQUwsRUFBUTtBQUNOLFdBQU8sU0FBUDtBQUNEO0FBQ0QsTUFBSSxDQUFDLDZEQUE2RCxJQUE3RCxDQUFrRSxDQUFsRSxDQUFMLEVBQTJFO0FBQ3pFLFdBQU8sU0FBUDtBQUNEO0FBQ0QsTUFBSSxnQkFBZ0IsSUFBaEIsQ0FBcUIsQ0FBckIsQ0FBSixFQUE2QjtBQUMzQixXQUFPLElBQUksSUFBWDtBQUNEO0FBQ0QsU0FBTyxDQUFQO0FBQ0Q7O0FBSUQ7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLE1BQXRCLEVBQThCO0FBQ25DLG1CQUFPLE1BQVAsQ0FDSSw0REFBNEQsSUFBNUQsQ0FBaUUsTUFBakUsQ0FESixFQUVJLDBCQUZKLEVBRWdDLE1BRmhDO0FBR0EsU0FBTywwQkFBMkI7QUFBbEM7QUFDRDs7QUFLRDs7Ozs7O0FBTU8sU0FBUyxxQkFBVCxDQUErQixNQUEvQixFQUF1QztBQUM1QyxtQkFBTyxNQUFQLENBQWMsNkNBQTZDLElBQTdDLENBQWtELE1BQWxELENBQWQsRUFDSSxxQ0FESixFQUMyQyxNQUQzQztBQUVBLFNBQU8sTUFBUDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsY0FBVCxDQUF3QixNQUF4QixFQUFnQztBQUNyQyxlQUFhLE1BQWI7QUFDQSxrQkFBTSxZQUFOLENBQW1CLE1BQW5CO0FBQ0EsTUFBTSxJQUFJLGlCQUFPLE1BQVAsQ0FBYyxPQUFPLEtBQVAsQ0FBYSxTQUFiLENBQWQsRUFDTiw4QkFETSxFQUMwQixNQUQxQixDQUFWO0FBRUEsU0FBTyxFQUFFLENBQUYsQ0FBUDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsZ0JBQVQsQ0FBMEIsTUFBMUIsRUFBa0M7QUFDdkMsTUFBTSxNQUFNLFdBQVcsTUFBWCxDQUFaO0FBQ0EsU0FBTywyQkFBZSxHQUFmLElBQXNCLEdBQXRCLEdBQTRCLFNBQW5DO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsb0JBQVQsQ0FBOEIsT0FBOUIsRUFBdUM7QUFDNUMsWUFBVSxRQUFRLFdBQVIsRUFBVjtBQUNBLFNBQU8sbUJBQW1CLE9BQW5CLE1BQWdDLFNBQXZDO0FBQ0Q7O0FBR0Q7Ozs7Ozs7O0FBUU8sU0FBUyxvQkFBVCxDQUE4QixPQUE5QixFQUF1QztBQUM1QyxNQUFNLFVBQVUsUUFBUSxPQUFSLENBQWdCLFdBQWhCLEVBQWhCO0FBQ0Esa0JBQU0sTUFBTixDQUFhLG1CQUFtQixPQUFuQixNQUFnQyxTQUE3QztBQUNBLE1BQUksQ0FBQyxtQkFBbUIsT0FBbkIsQ0FBTCxFQUFrQztBQUNoQyxRQUFNLE1BQU0sUUFBUSxhQUFwQjtBQUNBLFFBQU0saUJBQWlCLFFBQVEsT0FBUixDQUFnQixRQUFoQixFQUEwQixFQUExQixDQUF2QjtBQUNBLFFBQU0sT0FBTyxJQUFJLGFBQUosQ0FBa0IsY0FBbEIsQ0FBYjtBQUNBO0FBQ0EsU0FBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0EsMEJBQVUsSUFBVixFQUFnQjtBQUNkLGdCQUFVLFVBREk7QUFFZCxrQkFBWTtBQUZFLEtBQWhCO0FBSUEsUUFBSSxJQUFKLENBQVMsV0FBVCxDQUFxQixJQUFyQjtBQUNBLHVCQUFtQixPQUFuQixJQUE4QjtBQUM1QixhQUFPLENBQUMsTUFBSyxNQUFNLFdBQVgsSUFBMEIsQ0FBM0IsSUFBZ0MsSUFEWDtBQUU1QixjQUFRLENBQUMsTUFBSyxNQUFNLFlBQVgsSUFBMkIsQ0FBNUIsSUFBaUM7QUFGYixLQUE5QjtBQUlBLFFBQUksSUFBSixDQUFTLFdBQVQsQ0FBcUIsSUFBckI7QUFDRDtBQUNELFNBQU8sNkJBQThCLG1CQUFtQixPQUFuQjtBQUFyQztBQUNEOztBQUdEOzs7Ozs7O0FBT08sU0FBUyxnQkFBVCxDQUEwQixPQUExQixFQUFtQztBQUN4QyxNQUFNLFVBQVUsUUFBUSxPQUFSLENBQWdCLFdBQWhCLEVBQWhCO0FBQ0EsTUFBSSxXQUFXLFFBQVgsSUFBdUIsV0FBVyxXQUF0QyxFQUFtRDtBQUNqRCxXQUFPLElBQVA7QUFDRDtBQUNELFNBQU8sa0JBQWtCLE9BQWxCLEtBQThCLEtBQXJDO0FBQ0Q7O0FBR0Q7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQk8sU0FBUyxpQkFBVCxDQUEyQixPQUEzQixFQUFvQztBQUN6QztBQUNBO0FBQ0E7QUFDQSxNQUFNLHNCQUFzQixRQUFRLFlBQVIsQ0FBcUIsa0JBQXJCLENBQTVCO0FBQ0EsTUFBSSxtQkFBSixFQUF5QjtBQUN2QixRQUFNLFVBQVMsc0JBQXdCLGdCQUFNLE1BQU4sQ0FDbkMsWUFBWSxtQkFBWixDQURtQyxDQUF2QztBQUVBLFFBQUksQ0FBQyxXQUFVLE9BQU8sVUFBakIsSUFBK0IsV0FBVSxPQUFPLFNBQWpELEtBQ0MsUUFBUSxpQkFEYixFQUNnQztBQUM5QjtBQUNBLGNBQVEsWUFBUixHQUNJLFFBQVEsYUFBUixDQUFzQixpQkFBdEIsS0FBNEMsU0FEaEQ7QUFFRCxLQUxELE1BS08sSUFBSSxXQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckMsMkJBQXFCLE9BQXJCO0FBQ0Q7QUFDRCxXQUFPLE9BQVA7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNLGFBQWEsUUFBUSxZQUFSLENBQXFCLFFBQXJCLENBQW5CO0FBQ0EsTUFBTSxZQUFZLFFBQVEsWUFBUixDQUFxQixPQUFyQixDQUFsQjtBQUNBLE1BQU0sYUFBYSxRQUFRLFlBQVIsQ0FBcUIsUUFBckIsQ0FBbkI7QUFDQSxNQUFNLFlBQVksUUFBUSxZQUFSLENBQXFCLE9BQXJCLENBQWxCO0FBQ0EsTUFBTSxjQUFjLFFBQVEsWUFBUixDQUFxQixTQUFyQixDQUFwQjs7QUFFQTtBQUNBLE1BQU0sY0FBYyxhQUFhLFlBQVksVUFBWixDQUFiLEdBQXVDLElBQTNEO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLGdCQUFnQixTQUE5QixFQUF5QyxvQkFBekMsRUFBK0QsVUFBL0Q7QUFDQTtBQUNBLE1BQU0sYUFBYyxhQUFhLGFBQWEsTUFBM0IsR0FDakIsWUFBWSxTQUFaLENBRGlCLEdBQ1EsU0FEM0I7QUFFQSxtQkFBTyxNQUFQLENBQWMsZUFBZSxTQUE3QixFQUF3Qyx5QkFBeEMsRUFBbUUsU0FBbkU7QUFDQTtBQUNBLE1BQU0sY0FBZSxjQUFjLGNBQWMsT0FBN0IsR0FDbEIsWUFBWSxVQUFaLENBRGtCLEdBQ1EsVUFENUI7QUFFQSxtQkFBTyxNQUFQLENBQWMsZ0JBQWdCLFNBQTlCLEVBQXlDLDBCQUF6QyxFQUNJLFVBREo7O0FBR0E7QUFDQSxNQUFJLGNBQUo7QUFDQSxNQUFJLGVBQUo7QUFDQSxNQUFJLGVBQUo7O0FBRUE7QUFDQSxNQUFJLENBQUMsQ0FBQyxXQUFELElBQWdCLGVBQWUsT0FBTyxLQUF0QyxJQUNELGVBQWUsT0FBTyxZQUR0QixNQUVDLENBQUMsVUFBRCxJQUFlLENBQUMsV0FGakIsS0FFaUMscUJBQXFCLFFBQVEsT0FBN0IsQ0FGckMsRUFFNEU7QUFDMUU7QUFDQTtBQUNBLFFBQU0sYUFBYSxxQkFBcUIsT0FBckIsQ0FBbkI7QUFDQSxZQUFTLGNBQWMsZUFBZSxPQUFPLFlBQXJDLEdBQXFELFVBQXJELEdBQ04sV0FBVyxLQURiO0FBRUEsYUFBUyxlQUFlLFdBQVcsTUFBbkM7QUFDRCxHQVRELE1BU087QUFDTCxZQUFRLFVBQVI7QUFDQSxhQUFTLFdBQVQ7QUFDRDs7QUFFRDtBQUNBLE1BQUksV0FBSixFQUFpQjtBQUNmLGFBQVMsV0FBVDtBQUNELEdBRkQsTUFFTyxJQUFJLENBQUMsS0FBRCxJQUFVLENBQUMsTUFBZixFQUF1QjtBQUM1QixhQUFTLE9BQU8sU0FBaEI7QUFDRCxHQUZNLE1BRUEsSUFBSSxVQUFVLE9BQWQsRUFBdUI7QUFDNUIsYUFBUyxPQUFPLEtBQWhCO0FBQ0QsR0FGTSxNQUVBLElBQUksV0FBVyxDQUFDLEtBQUQsSUFBVSxTQUFTLE1BQTlCLENBQUosRUFBMkM7QUFDaEQsYUFBUyxPQUFPLFlBQWhCO0FBQ0QsR0FGTSxNQUVBLElBQUksVUFBVSxLQUFWLEtBQW9CLGFBQWEsV0FBakMsQ0FBSixFQUFtRDtBQUN4RCxhQUFTLE9BQU8sVUFBaEI7QUFDRCxHQUZNLE1BRUE7QUFDTCxhQUFTLE9BQU8sS0FBaEI7QUFDRDs7QUFFRDtBQUNBLE1BQUksVUFBVSxPQUFPLEtBQWpCLElBQTBCLFVBQVUsT0FBTyxZQUEzQyxJQUNBLFVBQVUsT0FBTyxVQURqQixJQUMrQixVQUFVLE9BQU8sU0FEcEQsRUFDK0Q7QUFDN0QscUJBQU8sTUFBUCxDQUFjLE1BQWQsRUFBc0IscUNBQXRCLEVBQTZELFVBQTdEO0FBQ0Q7QUFDRCxNQUFJLFVBQVUsT0FBTyxZQUFyQixFQUFtQztBQUNqQyxxQkFBTyxNQUFQLENBQWMsQ0FBQyxLQUFELElBQVUsU0FBUyxNQUFqQyxFQUNJLHdEQUNBLDZCQUZKLEVBRW1DLFNBRm5DO0FBR0Q7QUFDRCxNQUFJLFVBQVUsT0FBTyxLQUFqQixJQUEwQixVQUFVLE9BQU8sVUFBM0MsSUFDQSxVQUFVLE9BQU8sU0FEckIsRUFDZ0M7QUFDOUIscUJBQU8sTUFBUCxDQUFjLFNBQVMsU0FBUyxNQUFoQyxFQUNJLDREQURKLEVBRUksU0FGSjtBQUdEOztBQUVELE1BQUksVUFBVSxPQUFPLFVBQWpCLElBQStCLFVBQVUsT0FBTyxTQUFwRCxFQUErRDtBQUM3RCxxQkFBTyxNQUFQLENBQWMsZUFBZSxLQUFmLEtBQXlCLGVBQWUsTUFBZixDQUF2QyxFQUNJLDhEQURKLEVBRUksU0FGSixFQUVlLFVBRmY7QUFHRCxHQUpELE1BSU87QUFDTCxxQkFBTyxNQUFQLENBQWMsZ0JBQWdCLElBQTlCLEVBQ0ksMkRBREo7QUFFRDs7QUFFRDtBQUNBLFVBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQixlQUFlLE1BQWYsQ0FBdEI7QUFDQSxNQUFJLG9CQUFvQixNQUFwQixDQUFKLEVBQWlDO0FBQy9CLFlBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQiwrQkFBdEI7QUFDRDtBQUNELE1BQUksVUFBVSxPQUFPLFNBQXJCLEVBQWdDO0FBQzlCO0FBQ0E7QUFDQSx5QkFBcUIsT0FBckI7QUFDRCxHQUpELE1BSU8sSUFBSSxVQUFVLE9BQU8sS0FBckIsRUFBNEI7QUFDakMsMEJBQVUsT0FBVixFQUFtQjtBQUNqQixhQUFPLGdCQUFNLFlBQU4sQ0FBbUIsS0FBbkIsQ0FEVTtBQUVqQixjQUFRLGdCQUFNLFlBQU4sQ0FBbUIsTUFBbkI7QUFGUyxLQUFuQjtBQUlELEdBTE0sTUFLQSxJQUFJLFVBQVUsT0FBTyxZQUFyQixFQUFtQztBQUN4Qyx5QkFBUyxPQUFULEVBQWtCLFFBQWxCLEVBQTRCLGdCQUFNLFlBQU4sQ0FBbUIsTUFBbkIsQ0FBNUI7QUFDRCxHQUZNLE1BRUEsSUFBSSxVQUFVLE9BQU8sVUFBckIsRUFBaUM7QUFDdEMsUUFBTSxRQUFRLFFBQVEsYUFBUixDQUFzQixhQUF0QixDQUFvQyxpQkFBcEMsQ0FBZDtBQUNBLDBCQUFVLEtBQVYsRUFBaUI7QUFDZixlQUFTLE9BRE07QUFFZixrQkFDSSxpQkFBaUIsTUFBakIsSUFBMkIsaUJBQWlCLEtBQWpCLENBQTVCLEdBQXVELEdBQXhELEdBQStEO0FBSGxELEtBQWpCO0FBS0EsWUFBUSxZQUFSLENBQXFCLEtBQXJCLEVBQTRCLFFBQVEsVUFBcEM7QUFDQSxZQUFRLFlBQVIsR0FBdUIsS0FBdkI7QUFDRCxHQVRNLE1BU0EsSUFBSSxVQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckM7QUFDQTtBQUNBO0FBQ0EsUUFBTSxTQUFRLDZCQUFRLE9BQVIsQ0FBUixpQkFBTjtBQUlBLFFBQU0saUJBQWlCLE9BQU0saUJBQTdCO0FBQ0EsbUJBQWUsWUFBZixDQUE0QixLQUE1QixxREFDcUQsTUFEckQsaUJBQ3VFLEtBRHZFO0FBRUEsWUFBUSxZQUFSLENBQXFCLE1BQXJCLEVBQTRCLFFBQVEsVUFBcEM7QUFDQTtBQUNBLFlBQVEsWUFBUixHQUF1QixjQUF2QjtBQUNELEdBZE0sTUFjQSxJQUFJLFVBQVUsT0FBTyxJQUFyQixFQUEyQjtBQUNoQztBQUNELEdBRk0sTUFFQSxJQUFJLFVBQVUsT0FBTyxTQUFyQixFQUFnQztBQUNyQztBQUNBO0FBQ0E7QUFDRCxHQUpNLE1BSUEsSUFBSSxVQUFVLE9BQU8sU0FBckIsRUFBZ0M7QUFDckM7QUFDQTtBQUNBLFFBQUksS0FBSixFQUFXO0FBQ1QsMkJBQVMsT0FBVCxFQUFrQixPQUFsQixFQUEyQixLQUEzQjtBQUNEO0FBQ0QsUUFBSSxNQUFKLEVBQVk7QUFDViwyQkFBUyxPQUFULEVBQWtCLFFBQWxCLEVBQTRCLE1BQTVCO0FBQ0Q7QUFDRixHQVRNLE1BU0EsSUFBSSxVQUFVLE9BQU8sS0FBckIsRUFBNEI7QUFDakMsWUFBUSxTQUFSLENBQWtCLEdBQWxCLENBQXNCLGdDQUF0QjtBQUNBLFFBQUksS0FBSixFQUFXO0FBQ1QsMkJBQVMsT0FBVCxFQUFrQixPQUFsQixFQUEyQixLQUEzQjtBQUNEO0FBQ0QseUJBQVMsT0FBVCxFQUFrQixRQUFsQixFQUE0QixDQUE1QjtBQUNEO0FBQ0QsU0FBTyxNQUFQO0FBQ0Q7O0FBR0Q7OztBQUdBLFNBQVMsb0JBQVQsQ0FBOEIsT0FBOUIsRUFBdUM7QUFDckM7QUFDQTtBQUNBO0FBQ0EsdUJBQVMsT0FBVCxFQUFrQixTQUFsQixFQUE2QixNQUE3QjtBQUNBLFVBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQixtQkFBdEI7QUFDRDs7Ozs7Ozs7cWpCQ3BmRDs7Ozs7Ozs7Ozs7Ozs7OztRQTRDZ0Isa0IsR0FBQSxrQjtRQVFBLGdCLEdBQUEsZ0I7UUFzQkEsYyxHQUFBLGM7UUFhQSxnQixHQUFBLGdCO1FBK1lBLHlCLEdBQUEseUI7UUF5QkEsZ0IsR0FBQSxnQjtRQTZCQSxZLEdBQUEsWTtRQWtDQSxrQixHQUFBLGtCO1FBaUJBLDZCLEdBQUEsNkI7UUFnQkEsSSxHQUFBLEk7UUE0Q0EsRyxHQUFBLEc7UUF3QkEsVyxHQUFBLFc7O0FBbnBCaEI7O0FBQ0E7O0FBQ0E7Ozs7QUFFQTs7Ozs7Ozs7O0FBU08sSUFBTSxvREFBc0Isb0JBQTVCOztBQUdQOzs7OztBQUtPLElBQU0sZ0VBQTRCLDBCQUFsQzs7QUFHUDs7OztBQUlPLFNBQVMsa0JBQVQsQ0FBNEIsT0FBNUIsRUFBcUM7QUFDMUMsU0FBTyxRQUFRLE9BQVIsQ0FBZ0IsbUJBQWhCLEtBQXdDLENBQS9DO0FBQ0Q7O0FBRUQ7Ozs7QUFJTyxTQUFTLGdCQUFULENBQTBCLE9BQTFCLEVBQW1DO0FBQ3hDLFNBQU8sUUFBUSxPQUFSLENBQWdCLHlCQUFoQixLQUE4QyxDQUFyRDtBQUNEOztBQUdEOzs7O0FBSU8sSUFBTSw4QkFBVztBQUN0QixPQUFLLENBRGlCO0FBRXRCLFNBQU8sQ0FGZTtBQUd0QixRQUFNLENBSGdCO0FBSXRCLFFBQU0sQ0FKZ0I7QUFLdEIsUUFBTTtBQUxnQixDQUFqQjs7QUFRUDs7Ozs7QUFLTyxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDakMsT0FBSyxXQUFMLEdBQW1CLEVBQW5CO0FBQ0Q7O0FBRUQ7Ozs7QUFJQSxJQUFJLGlCQUFpQixTQUFyQjs7QUFFQTs7O0FBR08sU0FBUyxnQkFBVCxDQUEwQixLQUExQixFQUFpQztBQUN0QyxtQkFBaUIsS0FBakI7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7SUFVYSxHLFdBQUEsRztBQUNYOzs7Ozs7Ozs7OztBQVdBLGVBQVksR0FBWixFQUFpQixTQUFqQixFQUE0QixVQUE1QixFQUF3QztBQUFBOztBQUN0Qzs7Ozs7QUFLQSxTQUFLLEdBQUwsR0FBWSxxQkFBVSxJQUFWLElBQWtCLElBQUksZUFBdkIsR0FBMEMsSUFBSSxNQUE5QyxHQUF1RCxHQUFsRTs7QUFFQTtBQUNBLFNBQUssVUFBTCxHQUFrQixTQUFsQjs7QUFFQTtBQUNBLFNBQUssTUFBTCxHQUFjLEtBQUssYUFBTCxFQUFkOztBQUVBO0FBQ0EsU0FBSyxPQUFMLEdBQWUsY0FBYyxFQUE3QjtBQUNEOztBQUVEOzs7Ozs7OztnQ0FJWTtBQUNWLGFBQVEsbUJBQW1CLFNBQXBCLEdBQWlDLGNBQWpDLEdBQWtELEtBQUssTUFBOUQ7QUFDRDs7QUFFRDs7Ozs7OztvQ0FJZ0I7QUFDZDtBQUNBLFVBQUksQ0FBQyxLQUFLLEdBQUwsQ0FBUyxPQUFWLElBQXFCLENBQUMsS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixHQUEzQyxFQUFnRDtBQUM5QyxlQUFPLFNBQVMsR0FBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsR0FBVixJQUFpQixHQUFyQixFQUEwQjtBQUN4QixlQUFPLFNBQVMsR0FBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsSUFBVixJQUFrQixLQUFLLEdBQUwsQ0FBUyxVQUEvQixFQUEyQztBQUN6QyxlQUFPLFNBQVMsSUFBaEI7QUFDRDs7QUFFRDtBQUNBLFVBQUkscUJBQVUsUUFBVixJQUFzQixDQUFDLHFCQUFVLEdBQXJDLEVBQTBDO0FBQ3hDLGVBQU8sU0FBUyxJQUFoQjtBQUNEOztBQUVEO0FBQ0EsYUFBTyxLQUFLLFVBQUwsQ0FBZ0IsZ0NBQWhCLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7eUJBS0ssRyxFQUFLLEssRUFBTyxRLEVBQVU7QUFDekIsVUFBSSxLQUFLLFNBQUwsTUFBb0IsU0FBUyxHQUFqQyxFQUFzQztBQUNwQyxZQUFJLEtBQUssS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixHQUExQjtBQUNBLFlBQUksU0FBUyxPQUFiLEVBQXNCO0FBQ3BCLGVBQUssS0FBSyxHQUFMLENBQVMsT0FBVCxDQUFpQixLQUFqQixJQUEwQixFQUEvQjtBQUNELFNBRkQsTUFFTyxJQUFJLFNBQVMsTUFBYixFQUFxQjtBQUMxQixlQUFLLEtBQUssR0FBTCxDQUFTLE9BQVQsQ0FBaUIsSUFBakIsSUFBeUIsRUFBOUI7QUFDRCxTQUZNLE1BRUEsSUFBSSxTQUFTLE1BQWIsRUFBcUI7QUFDMUIsZUFBSyxLQUFLLEdBQUwsQ0FBUyxPQUFULENBQWlCLElBQWpCLElBQXlCLEVBQTlCO0FBQ0Q7QUFDRCxZQUFJLHFCQUFVLFFBQWQsRUFBd0I7QUFDdEIsbUJBQVMsT0FBVCxDQUFpQixNQUFNLEdBQU4sR0FBWSxHQUE3QjtBQUNEO0FBQ0QsV0FBRyxLQUFILENBQVMsS0FBSyxHQUFMLENBQVMsT0FBbEIsRUFBMkIsUUFBM0I7QUFDRDtBQUNGOztBQUVEOzs7Ozs7O2dDQUlZO0FBQ1YsYUFBTyxLQUFLLFNBQUwsTUFBb0IsU0FBUyxHQUFwQztBQUNEOztBQUVEOzs7Ozs7Ozt5QkFLSyxHLEVBQUssUSxFQUFVO0FBQ2xCLFVBQUksS0FBSyxTQUFMLE1BQW9CLFNBQVMsSUFBakMsRUFBdUM7QUFDckMsYUFBSyxJQUFMLENBQVUsR0FBVixFQUFlLE1BQWYsRUFBdUIsTUFBTSxTQUFOLENBQWdCLEtBQWhCLENBQXNCLElBQXRCLENBQTJCLFNBQTNCLEVBQXNDLENBQXRDLENBQXZCO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7eUJBS0ssRyxFQUFLLFEsRUFBVTtBQUNsQixVQUFJLEtBQUssU0FBTCxNQUFvQixTQUFTLElBQWpDLEVBQXVDO0FBQ3JDLGFBQUssSUFBTCxDQUFVLEdBQVYsRUFBZSxNQUFmLEVBQXVCLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixFQUFzQyxDQUF0QyxDQUF2QjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7O3lCQUtLLEcsRUFBSyxRLEVBQVU7QUFDbEIsVUFBSSxLQUFLLFNBQUwsTUFBb0IsU0FBUyxJQUFqQyxFQUF1QztBQUNyQyxhQUFLLElBQUwsQ0FBVSxHQUFWLEVBQWUsTUFBZixFQUF1QixNQUFNLFNBQU4sQ0FBZ0IsS0FBaEIsQ0FBc0IsSUFBdEIsQ0FBMkIsU0FBM0IsRUFBc0MsQ0FBdEMsQ0FBdkI7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7OzsyQkFRTyxHLEVBQUssUSxFQUFVO0FBQ3BCLFVBQUksS0FBSyxTQUFMLE1BQW9CLFNBQVMsS0FBakMsRUFBd0M7QUFDdEMsYUFBSyxJQUFMLENBQVUsR0FBVixFQUFlLE9BQWYsRUFBd0IsTUFBTSxTQUFOLENBQWdCLEtBQWhCLENBQXNCLElBQXRCLENBQTJCLFNBQTNCLEVBQXNDLENBQXRDLENBQXhCO0FBQ0QsT0FGRCxNQUVPO0FBQ0wsWUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUNWLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixFQUFzQyxDQUF0QyxDQURVLENBQWQ7QUFFQSxhQUFLLGFBQUwsQ0FBbUIsS0FBbkI7QUFDQSxlQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVEOzs7Ozs7OzswQkFLTSxHLEVBQUssUSxFQUFVO0FBQ25CLFVBQU0sUUFBUSxLQUFLLE1BQUwsQ0FBWSxLQUFaLENBQWtCLElBQWxCLEVBQXdCLFNBQXhCLENBQWQ7QUFDQSxVQUFJLEtBQUosRUFBVztBQUNULGNBQU0sSUFBTixHQUFhLE9BQU8sTUFBTSxJQUExQjtBQUNBO0FBQ0EsYUFBSyxXQUFMLENBQWlCLEtBQWpCO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7O2tDQU1jLFMsRUFBVyxRLEVBQVU7QUFDakMsVUFBTSxRQUFRLEtBQUssTUFBTCxDQUFZLEtBQVosQ0FBa0IsSUFBbEIsRUFBd0IsU0FBeEIsQ0FBZDtBQUNBLFVBQUksS0FBSixFQUFXO0FBQ1QsY0FBTSxRQUFOLEdBQWlCLElBQWpCO0FBQ0E7QUFDQSxhQUFLLFdBQUwsQ0FBaUIsS0FBakI7QUFDRDtBQUNGOztBQUVEOzs7Ozs7OztnQ0FLWSxRLEVBQVU7QUFDcEIsVUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUE2QixTQUE3QixDQUFkO0FBQ0EsV0FBSyxhQUFMLENBQW1CLEtBQW5CO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O3dDQUtvQixRLEVBQVU7QUFDNUIsVUFBTSxRQUFRLGlCQUFpQixLQUFqQixDQUF1QixJQUF2QixFQUE2QixTQUE3QixDQUFkO0FBQ0EsV0FBSyxhQUFMLENBQW1CLEtBQW5CO0FBQ0EsWUFBTSxRQUFOLEdBQWlCLElBQWpCO0FBQ0EsYUFBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzJCQW9CTyxlLEVBQWlCLFcsRUFBYSxRLEVBQVU7QUFDN0MsVUFBSSxxQkFBSjtBQUNBLFVBQUksQ0FBQyxlQUFMLEVBQXNCO0FBQ3BCLFlBQU0sVUFBVSxlQUFlLGtCQUEvQjtBQUNBLFlBQU0sZUFBZSxRQUFRLEtBQVIsQ0FBYyxJQUFkLENBQXJCO0FBQ0EsWUFBTSxRQUFRLGFBQWEsS0FBYixFQUFkO0FBQ0EsWUFBSSxZQUFZLEtBQWhCO0FBQ0EsWUFBTSxlQUFlLEVBQXJCO0FBQ0EsdUJBQWUsWUFBZixFQUE2QixLQUE3QjtBQUNBLGFBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLGNBQU0sTUFBTSxVQUFVLENBQVYsQ0FBWjtBQUNBLGNBQUksT0FBTyxJQUFJLE9BQWYsRUFBd0I7QUFDdEIsMkJBQWUsR0FBZjtBQUNEO0FBQ0QsY0FBTSxlQUFlLGFBQWEsS0FBYixFQUFyQjtBQUNBLHVCQUFhLElBQWIsQ0FBa0IsR0FBbEI7QUFDQSx5QkFBZSxZQUFmLEVBQTZCLGFBQWEsSUFBYixFQUE3QjtBQUNBLHVCQUFhLFNBQVMsR0FBVCxJQUFnQixZQUE3QjtBQUNEO0FBQ0QsWUFBTSxJQUFJLElBQUksS0FBSixDQUFVLFNBQVYsQ0FBVjtBQUNBLFVBQUUsVUFBRixHQUFlLElBQWY7QUFDQSxVQUFFLGlCQUFGLEdBQXNCLFlBQXRCO0FBQ0EsVUFBRSxZQUFGLEdBQWlCLFlBQWpCO0FBQ0EsYUFBSyxhQUFMLENBQW1CLENBQW5CO0FBQ0E7QUFDQSxhQUFLLFdBQUwsQ0FBaUIsQ0FBakI7QUFDQSxjQUFNLENBQU47QUFDRDtBQUNELGFBQU8sZUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztrQ0FXYyxlLEVBQWlCLFcsRUFBYTtBQUMxQyxVQUFNLGtCQUFrQixtQkFBbUIsZ0JBQWdCLFFBQWhCLElBQTRCLENBQXZFO0FBQ0EsV0FBSyxNQUFMLENBQVksZUFBWixFQUE2QixDQUFDLGVBQWUsa0JBQWhCLElBQXNDLE1BQW5FLEVBQ0ksZUFESjtBQUVBLGFBQU8sd0JBQXlCO0FBQWhDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7O2lDQVdhLGMsRUFBZ0IsVyxFQUFhO0FBQ3hDLFdBQUssTUFBTCxDQUFZLE9BQU8sY0FBUCxJQUF5QixRQUFyQyxFQUNJLENBQUMsZUFBZSxpQkFBaEIsSUFBcUMsTUFEekMsRUFDaUQsY0FEakQ7QUFFQSxhQUFPLHNCQUF1QjtBQUE5QjtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7OztpQ0FXYSxjLEVBQWdCLFcsRUFBYTtBQUN4QyxXQUFLLE1BQUwsQ0FBWSxPQUFPLGNBQVAsSUFBeUIsUUFBckMsRUFDSSxDQUFDLGVBQWUsaUJBQWhCLElBQXFDLE1BRHpDLEVBQ2lELGNBRGpEO0FBRUEsYUFBTyxzQkFBdUI7QUFBOUI7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7O2tDQVNjLGUsRUFBaUIsVyxFQUFhO0FBQzFDLFdBQUssTUFBTCxDQUFZLENBQUMsQ0FBQyxlQUFGLEtBQXNCLGVBQWxDLEVBQ0ksQ0FBQyxlQUFlLGtCQUFoQixJQUFzQyxNQUQxQyxFQUNrRCxlQURsRDtBQUVBLGFBQU8sdUJBQXdCO0FBQS9CO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7O29DQVdnQixPLEVBQVMsQyxFQUFHLFksRUFBYztBQUN4QyxVQUFJLHdCQUFZLE9BQVosRUFBcUIsQ0FBckIsQ0FBSixFQUE2QjtBQUMzQixlQUFPLENBQVA7QUFDRDtBQUNELFdBQUssTUFBTCxDQUFZLEtBQVosRUFDSSx3QkFESixFQUVJLGdCQUFnQixNQUZwQixFQUU0QixDQUY1QjtBQUdEOztBQUVEOzs7Ozs7O2tDQUljLEssRUFBTztBQUNuQixjQUFRLDBCQUEwQixLQUExQixDQUFSO0FBQ0EsVUFBSSxLQUFLLE9BQVQsRUFBa0I7QUFDaEIsWUFBSSxDQUFDLE1BQU0sT0FBWCxFQUFvQjtBQUNsQixnQkFBTSxPQUFOLEdBQWdCLEtBQUssT0FBckI7QUFDRCxTQUZELE1BRU8sSUFBSSxNQUFNLE9BQU4sQ0FBYyxPQUFkLENBQXNCLEtBQUssT0FBM0IsS0FBdUMsQ0FBQyxDQUE1QyxFQUErQztBQUNwRCxnQkFBTSxPQUFOLElBQWlCLEtBQUssT0FBdEI7QUFDRDtBQUNGLE9BTkQsTUFNTyxJQUFJLG1CQUFtQixNQUFNLE9BQXpCLENBQUosRUFBdUM7QUFDNUMsY0FBTSxPQUFOLEdBQWdCLE1BQU0sT0FBTixDQUFjLE9BQWQsQ0FBc0IsbUJBQXRCLEVBQTJDLEVBQTNDLENBQWhCO0FBQ0Q7QUFDRjs7Ozs7O0FBR0g7Ozs7OztBQUlBLFNBQVMsUUFBVCxDQUFrQixHQUFsQixFQUF1QjtBQUNyQjtBQUNBLE1BQUksT0FBTyxJQUFJLFFBQUosSUFBZ0IsQ0FBM0IsRUFBOEI7QUFDNUIsV0FBTyxJQUFJLE9BQUosQ0FBWSxXQUFaLE1BQTZCLElBQUksRUFBSixHQUFTLE1BQU0sSUFBSSxFQUFuQixHQUF3QixFQUFyRCxDQUFQO0FBQ0Q7QUFDRCxTQUFPLHNCQUF1QjtBQUE5QjtBQUNEOztBQUdEOzs7O0FBSUEsU0FBUyxjQUFULENBQXdCLEtBQXhCLEVBQStCLEdBQS9CLEVBQW9DO0FBQ2xDLE1BQUksT0FBTyxFQUFYLEVBQWU7QUFDYixVQUFNLElBQU4sQ0FBVyxHQUFYO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7QUFLTyxTQUFTLHlCQUFULENBQW1DLEtBQW5DLEVBQTBDO0FBQUEsTUFDeEMsT0FEd0MsR0FDN0IsS0FENkIsQ0FDeEMsT0FEd0M7O0FBRS9DLE1BQU0sT0FBTyxPQUFPLEtBQUssTUFBTCxFQUFQLENBQWI7QUFDQSxRQUFNLE9BQU4sR0FBZ0IsSUFBaEI7O0FBRUEsTUFBSSxNQUFNLE9BQU4sS0FBa0IsSUFBdEIsRUFBNEI7QUFDMUIsVUFBTSxPQUFOLEdBQWdCLE9BQWhCO0FBQ0EsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsTUFBTSxJQUFJLElBQUksS0FBSixDQUFVLE1BQU0sT0FBaEIsQ0FBVjtBQUNBO0FBQ0EsT0FBSyxJQUFNLElBQVgsSUFBbUIsS0FBbkIsRUFBMEI7QUFDeEIsTUFBRSxJQUFGLElBQVUsTUFBTSxJQUFOLENBQVY7QUFDRDtBQUNEO0FBQ0EsSUFBRSxLQUFGLEdBQVUsTUFBTSxLQUFoQjtBQUNBLFNBQU8sQ0FBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsZ0JBQVQsQ0FBMEIsUUFBMUIsRUFBb0M7QUFDekMsTUFBSSxRQUFRLElBQVo7QUFDQSxNQUFJLFVBQVUsRUFBZDtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLFFBQU0sTUFBTSxVQUFVLENBQVYsQ0FBWjtBQUNBLFFBQUksZUFBZSxLQUFmLElBQXdCLENBQUMsS0FBN0IsRUFBb0M7QUFDbEMsY0FBUSwwQkFBMEIsR0FBMUIsQ0FBUjtBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksT0FBSixFQUFhO0FBQ1gsbUJBQVcsR0FBWDtBQUNEO0FBQ0QsaUJBQVcsR0FBWDtBQUNEO0FBQ0Y7O0FBRUQsTUFBSSxDQUFDLEtBQUwsRUFBWTtBQUNWLFlBQVEsSUFBSSxLQUFKLENBQVUsT0FBVixDQUFSO0FBQ0QsR0FGRCxNQUVPLElBQUksT0FBSixFQUFhO0FBQ2xCLFVBQU0sT0FBTixHQUFnQixVQUFVLElBQVYsR0FBaUIsTUFBTSxPQUF2QztBQUNEO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLFFBQXRCLEVBQWdDO0FBQ3JDLE1BQU0sUUFBUSxpQkFBaUIsS0FBakIsQ0FBdUIsSUFBdkIsRUFBNkIsU0FBN0IsQ0FBZDtBQUNBLGFBQVcsWUFBTTtBQUNmO0FBQ0EsU0FBSyxXQUFMLENBQWlCLEtBQWpCO0FBQ0EsVUFBTSxLQUFOO0FBQ0QsR0FKRDtBQUtEOztBQUdEOzs7OztBQUtBLEtBQUssR0FBTCxHQUFZLEtBQUssR0FBTCxJQUFZO0FBQ3RCLFFBQU0sSUFEZ0I7QUFFdEIsT0FBSyxJQUZpQjtBQUd0QixnQkFBYztBQUhRLENBQXhCOztBQU1BLElBQU0sT0FBTyxLQUFLLEdBQWxCOztBQUVBOzs7Ozs7QUFNQSxJQUFJLGlCQUFpQixJQUFyQjs7QUFFQTs7O0FBR08sU0FBUyxrQkFBVCxHQUE4QjtBQUNuQyxtQkFBaUIsR0FBakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7QUFHTyxTQUFTLDZCQUFULEdBQXlDO0FBQzlDLG1CQUFpQixJQUFqQjtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7QUFZTyxTQUFTLElBQVQsQ0FBYyxXQUFkLEVBQTJCO0FBQ2hDLE1BQUksQ0FBQyxLQUFLLElBQVYsRUFBZ0I7QUFDZCxTQUFLLElBQUwsR0FBWSxjQUFjLG1CQUFkLENBQVo7QUFDRDtBQUNELE1BQUksQ0FBQyxZQUFZLEtBQUssSUFBTCxDQUFVLEdBQXRCLEVBQTJCLFdBQTNCLENBQUwsRUFBOEM7QUFDNUMsV0FBTyxLQUFLLElBQVo7QUFDRCxHQUZELE1BRU87QUFDTCxRQUFJLEtBQUssWUFBVCxFQUF1QjtBQUNyQixhQUFPLEtBQUssWUFBWjtBQUNEO0FBQ0QsV0FBTyxLQUFLLFlBQUwsR0FBb0IsY0FBYyx5QkFBZCxDQUEzQjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxhQUFULENBQXVCLE1BQXZCLEVBQStCO0FBQzdCLE1BQUksQ0FBQyxjQUFMLEVBQXFCO0FBQ25CLFVBQU0sSUFBSSxLQUFKLENBQVUsbUNBQVYsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxJQUFJLGNBQUosQ0FBbUIsSUFBbkIsRUFBeUIsZ0JBQVE7QUFDdEMsUUFBTSxTQUFTLFNBQVMsS0FBSyxHQUFkLEVBQW1CLEVBQW5CLENBQWY7QUFDQSxRQUFJLEtBQUssV0FBTCxJQUFvQixVQUFVLENBQWxDLEVBQXFDO0FBQ25DLGFBQU8sU0FBUyxJQUFoQjtBQUNEO0FBQ0QsV0FBTyxTQUFTLElBQWhCO0FBQ0QsR0FOTSxFQU1KLE1BTkksQ0FBUDtBQU9EOztBQUVEOzs7Ozs7Ozs7Ozs7QUFZTyxTQUFTLEdBQVQsR0FBZTtBQUNwQixNQUFJLEtBQUssR0FBVCxFQUFjO0FBQ1osV0FBTyxLQUFLLEdBQVo7QUFDRDtBQUNELE1BQUksQ0FBQyxjQUFMLEVBQXFCO0FBQ25CLFVBQU0sSUFBSSxLQUFKLENBQVUsbUNBQVYsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxLQUFLLEdBQUwsR0FBVyxJQUFJLGNBQUosQ0FBbUIsSUFBbkIsRUFBeUIsZ0JBQVE7QUFDakQsUUFBTSxTQUFTLFNBQVMsS0FBSyxHQUFkLEVBQW1CLEVBQW5CLENBQWY7QUFDQSxRQUFJLFVBQVUsQ0FBZCxFQUFpQjtBQUNmLGFBQU8sU0FBUyxJQUFoQjtBQUNEO0FBQ0QsUUFBSSxVQUFVLENBQWQsRUFBaUI7QUFDZixhQUFPLFNBQVMsSUFBaEI7QUFDRDtBQUNELFdBQU8sU0FBUyxHQUFoQjtBQUNELEdBVGlCLENBQWxCO0FBVUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxXQUFULENBQXFCLEdBQXJCLEVBQTBCLFdBQTFCLEVBQXVDO0FBQzVDLE1BQUksQ0FBQyxXQUFMLEVBQWtCO0FBQ2hCLFdBQU8sS0FBUDtBQUNEO0FBQ0QsU0FBTyxZQUFZLGFBQVosQ0FBMEIsV0FBMUIsSUFBeUMsR0FBaEQ7QUFDRDs7Ozs7O1FDaHBCZSxhLEdBQUEsYTs7QUFSaEI7O0FBRUE7Ozs7OztBQU1PLFNBQVMsYUFBVCxDQUF1QixPQUF2QixFQUFnQztBQUNyQyxTQUFPO0FBQ0wsY0FBVSxtQkFBUSxPQUFSLEVBQWlCLFFBRHRCO0FBRUwsaUJBQWEsbUJBQVEsT0FBUixFQUFpQixXQUZ6QjtBQUdMLFlBQVEsbUJBQVEsT0FBUixFQUFpQixNQUhwQjtBQUlMLGNBQVUsbUJBQVEsT0FBUixFQUFpQixRQUp0QjtBQUtMLFVBQU0sbUJBQVEsT0FBUixFQUFpQixJQUxsQjtBQU1MLFVBQU0sbUJBQVEsT0FBUixFQUFpQixJQU5sQjtBQU9MLFNBQUssbUJBQVEsT0FBUixFQUFpQixHQVBqQjtBQVFMLGFBQVMsbUJBQVEsT0FBUixFQUFpQixPQVJyQjtBQVNMLGdCQUFZLG1CQUFRLE9BQVIsRUFBaUI7QUFUeEIsR0FBUDtBQVdELEMsQ0FwQ0Q7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztRQ2dEZ0IsTyxHQUFBLE87UUFnR0EsdUIsR0FBQSx1QjtRQU1BLHlCLEdBQUEseUI7O0FBdEloQjs7QUFFQTs7Ozs7Ozs7Ozs7OztBQWFPLElBQUksa0NBQUo7O0FBRVA7QUFqQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQ0EsSUFBTSxVQUFVLDBCQUFoQjs7QUFFQTs7Ozs7QUFLQSxJQUFJLGFBQWEsRUFBakI7O0FBRUE7Ozs7O0FBS08sU0FBUyxPQUFULENBQWlCLE9BQWpCLEVBQTBCO0FBQy9CLE1BQU0sTUFBTSxXQUFXLElBQXZCO0FBQ0EsTUFBSSxJQUFJLFFBQVIsRUFBa0I7QUFDaEIsV0FBTyxJQUFJLFFBQVg7QUFDRDtBQUNELFNBQU8sSUFBSSxRQUFKLEdBQWUsU0FBUyxHQUFULENBQXRCO0FBQ0Q7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxRQUFULENBQWtCLEdBQWxCLEVBQXVCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxTQUFTLElBQWY7QUFDQSxNQUFNLGNBQWMsS0FBcEI7O0FBRUEsTUFBTSxrQkFBa0IsQ0FBQyxFQUFFLEtBQUssVUFBTCxJQUFtQixLQUFLLFVBQUwsQ0FBZ0IsUUFBckMsQ0FBekI7QUFDQSxNQUFNLGVBQWUsVUFBVSxDQUFDLEVBQUUsSUFBSSxRQUFKLElBQWdCLElBQUksU0FBdEIsQ0FBaEM7QUFDQSxNQUFNLGFBQWEsV0FBVyxtQkFBbUIsWUFBOUIsQ0FBbkI7QUFDQSxNQUFNLFlBQVk7QUFDZDtBQUNBO0FBQ0EsTUFBSSxRQUFKLENBQWEsWUFBYixJQUE2QixJQUFJLFFBQUosQ0FBYSxJQUg1QixDQUFsQjs7QUFLQSxNQUFNLGNBQWMsNENBQWtCLElBQUksUUFBSixDQUFhLE1BQS9CLENBQXBCOztBQUVBLE1BQUksQ0FBQyxVQUFMLEVBQWlCO0FBQ2YsaUJBQWEsY0FBYyxHQUFkLEVBQW1CLFVBQW5CLENBQWI7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQU87QUFDTCxjQUFVLFVBREw7QUFFTDtBQUNBO0FBQ0E7QUFDQSxpQkFBYSxDQUFDLEVBQUUsVUFBVSxhQUFWLEtBQTRCLEdBQTVCLElBQW1DLElBQUksWUFBekMsQ0FMVDtBQU1MLGNBQVUsVUFBVSxhQUFWLEtBQTRCLEdBTmpDO0FBT0w7QUFDQTtBQUNBLFlBQVEsVUFBVSxRQUFWLENBVEg7QUFVTDtBQUNBLGlCQUFhLFVBQVUsU0FBVixDQVhSO0FBWUwsY0FBVSxXQVpMO0FBYUw7QUFDQTtBQUNBLFVBQU0sWUFBWSxVQUFaLEtBQTJCLFNBZjVCO0FBZ0JMLFVBQU0sWUFoQkQ7QUFpQkwsU0FBSyxVQUFVLEtBQVYsQ0FqQkE7QUFrQkwsb0JBbEJLO0FBbUJMO0FBbkJLLEdBQVA7QUFxQkQ7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyxhQUFULENBQXVCLEdBQXZCLEVBQTRCLFVBQTVCLEVBQXdDO0FBQ3RDO0FBQ0E7QUFDQSxNQUFJLFVBQUosRUFBZ0I7QUFDZCxXQUFPLE9BQVA7QUFDRDs7QUFFRCxNQUFJLElBQUksVUFBSixJQUFrQixJQUFJLFVBQUosQ0FBZSxDQUFyQyxFQUF3QztBQUN0QyxXQUFPLElBQUksVUFBSixDQUFlLENBQXRCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFZLE9BQVo7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyx1QkFBVCxDQUFpQyxHQUFqQyxFQUFzQyxVQUF0QyxFQUFrRDtBQUN2RCxTQUFPLGNBQWMsR0FBZCxFQUFtQixVQUFuQixDQUFQO0FBQ0Q7O0FBR0Q7QUFDTyxTQUFTLHlCQUFULEdBQXFDO0FBQzFDLGVBQWEsRUFBYjtBQUNEOzs7QUN4SUQ7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7OzBKQTVCQTs7Ozs7Ozs7Ozs7Ozs7OztBQThCQSxJQUFJLGlDQUFlLElBQWYsRUFBcUIsb0JBQXJCLEtBQThDLHFCQUFVLElBQTVELEVBQWtFO0FBQ2hFLCtCQUFzQixJQUF0QjtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQ0QsQ0FGRCxNQUVPO0FBQ0wsc0RBQXVCLElBQXZCLEVBQTZCLE1BQTdCO0FBQ0Q7QUFDRCxpQ0FBMEIsSUFBMUI7QUFDQSx1QkFBZ0IsSUFBaEI7QUFDQSwyQkFBb0IsSUFBcEI7QUFDQSxzQkFBZSxJQUFmO0FBQ0EsK0JBQW1CLElBQW5CO0FBQ0EsNEJBQXFCLElBQXJCOzs7Ozs7UUNJZ0IsTyxHQUFBLE87QUE1Q2hCOzs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBOzs7Ozs7OztBQVFBLFNBQVMsUUFBVCxDQUFrQixLQUFsQixFQUF5QixhQUF6QixFQUF3QztBQUN0QyxNQUFNLFlBQVksaUJBQWlCLENBQW5DO0FBQ0EsTUFBTSxNQUFNLEtBQUssTUFBakI7QUFDQSxNQUFJLElBQUksYUFBYSxDQUFiLEdBQWlCLFNBQWpCLEdBQTZCLEtBQUssR0FBTCxDQUFTLE1BQU0sU0FBZixFQUEwQixDQUExQixDQUFyQztBQUNBLFNBQU8sSUFBSSxHQUFYLEVBQWdCLEdBQWhCLEVBQXFCO0FBQ25CLFFBQU0sUUFBUSxLQUFLLENBQUwsQ0FBZDtBQUNBO0FBQ0E7QUFDQSxRQUFJLFVBQVUsS0FBVixJQUFvQixVQUFVLEtBQVYsSUFBbUIsVUFBVSxLQUFyRCxFQUE2RDtBQUMzRCxhQUFPLElBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxLQUFQO0FBQ0Q7O0FBRUQ7Ozs7QUFJTyxTQUFTLE9BQVQsQ0FBaUIsR0FBakIsRUFBc0I7QUFDM0IsTUFBSSxDQUFDLElBQUksS0FBSixDQUFVLFNBQVYsQ0FBb0IsUUFBekIsRUFBbUM7QUFDakMsUUFBSSxNQUFKLENBQVcsY0FBWCxDQUEwQixNQUFNLFNBQWhDLEVBQTJDLFVBQTNDLEVBQXVEO0FBQ3JELGtCQUFZLEtBRHlDO0FBRXJELG9CQUFjLElBRnVDO0FBR3JELGdCQUFVLElBSDJDO0FBSXJELGFBQU87QUFKOEMsS0FBdkQ7QUFNRDtBQUNGOzs7Ozs7Ozs7UUNnbkJlLE8sR0FBQSxPOzs7O0FBcnFCaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7OztBQU1BLElBQUksb0JBQUo7O0FBRUE7OztBQUdBLElBQUksb0NBQUo7O0FBRUE7Ozs7OztBQU1BLElBQUkseUJBQUo7O0FBRUE7Ozs7O0FBS0EsSUFBTSxhQUFhLGlDQUFuQjtBQUNBLElBQU0sZ0JBQWdCLENBQ3BCLGdCQURvQixFQUVwQixlQUZvQixFQUdwQixXQUhvQixFQUlwQixlQUpvQixFQUtwQixlQUxvQixFQU1wQixrQkFOb0IsRUFPcEIsZ0JBUG9CLEVBUXBCLGVBUm9CLENBQXRCOztBQVdBOzs7Ozs7QUFNQSxTQUFTLGVBQVQsQ0FBeUIsV0FBekIsRUFBc0MsSUFBdEMsRUFBNEM7QUFDMUMsTUFBSSxDQUFDLFdBQVcsSUFBWCxDQUFnQixJQUFoQixDQUFELElBQTBCLGNBQWMsT0FBZCxDQUFzQixJQUF0QixLQUErQixDQUE3RCxFQUFnRTtBQUM5RCxVQUFNLElBQUksV0FBSixtQ0FBZ0QsSUFBaEQsT0FBTjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7OztBQU1BLFNBQVMsaUJBQVQsQ0FBMkIsR0FBM0IsRUFBZ0M7QUFBQSxNQUN2QixjQUR1QixHQUNMLEdBREssQ0FDdkIsY0FEdUI7OztBQUc5QixTQUFPLENBQUMsRUFDTixrQkFDQSxlQUFlLE1BRGYsSUFFQSxlQUFlLEdBRmYsSUFHQSxlQUFlLFdBSlQsQ0FBUjtBQUtEOztBQUVEOzs7Ozs7QUFNQSxTQUFTLFNBQVQsQ0FBbUIsR0FBbkIsRUFBd0I7QUFDdEIsTUFBTSxNQUFNLElBQUksV0FBSixDQUFnQixRQUFoQixFQUFaO0FBQ0EsU0FBTyxJQUFJLE9BQUosQ0FBWSxlQUFaLE1BQWlDLENBQUMsQ0FBekM7QUFDRDs7QUFFRDs7OztJQUdNLHFCO0FBQ0o7Ozs7QUFJQSxpQ0FBWSxHQUFaLEVBQWlCLFFBQWpCLEVBQTJCO0FBQUE7O0FBQ3pCOzs7QUFHQSxTQUFLLElBQUwsR0FBWSxHQUFaOztBQUVBOzs7QUFHQSxTQUFLLFNBQUwsR0FBaUIsUUFBakI7O0FBRUE7Ozs7O0FBS0EsU0FBSyxlQUFMLEdBQXVCLEtBQUssSUFBTCxDQUFVLE1BQVYsQ0FBaUIsTUFBakIsQ0FBd0IsSUFBeEIsQ0FBdkI7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7MkJBT08sSSxFQUFNLEksRUFBTSxPLEVBQVM7QUFDMUIsV0FBSyxTQUFMLENBQWUsTUFBZixDQUFzQixJQUF0QixFQUE0QixJQUE1QixFQUFrQyxPQUFsQzs7QUFFQTtBQUNBO0FBQ0EsVUFBTSxVQUFVLEtBQUssZUFBckI7QUFDQSxVQUFNLFdBQVcsUUFBUSxJQUFSLENBQWpCO0FBQ0EsVUFBSSxRQUFKLEVBQWM7QUFDWixpQkFBUyxPQUFUO0FBQ0EsZUFBTyxRQUFRLElBQVIsQ0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozt3QkFNSSxJLEVBQU07QUFDUixVQUFNLE1BQU0sS0FBSyxTQUFMLENBQWUsU0FBZixDQUF5QixJQUF6QixDQUFaO0FBQ0EsVUFBSSxHQUFKLEVBQVM7QUFDUCxlQUFPLElBQUksSUFBWDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozs7Z0NBT1ksSSxFQUFNO0FBQUEsa0JBQ2UsS0FBSyxJQURwQjtBQUFBLFVBQ1QsT0FEUyxTQUNULE9BRFM7QUFBQSxVQUNBLFdBREEsU0FDQSxXQURBOztBQUVoQixzQkFBZ0IsV0FBaEIsRUFBNkIsSUFBN0I7O0FBRUEsVUFBSSxLQUFLLFNBQUwsQ0FBZSxTQUFmLENBQXlCLElBQXpCLENBQUosRUFBb0M7QUFDbEMsZUFBTyxRQUFRLE9BQVIsRUFBUDtBQUNEOztBQUVELFVBQU0sVUFBVSxLQUFLLGVBQXJCO0FBQ0EsVUFBTSxXQUFXLFFBQVEsSUFBUixDQUFqQjtBQUNBLFVBQUksUUFBSixFQUFjO0FBQ1osZUFBTyxTQUFTLE9BQWhCO0FBQ0Q7O0FBRUQsVUFBSSxnQkFBSjtBQUNBLFVBQU0sVUFBVSxJQUFJLE1BQU0sT0FBVixDQUFrQjtBQUFBLGVBQU8sVUFBVSxHQUFqQjtBQUFBLE9BQWxCLENBQWhCO0FBQ0EsY0FBUSxJQUFSLElBQWdCO0FBQ2Qsd0JBRGM7QUFFZDtBQUZjLE9BQWhCOztBQUtBLGFBQU8sT0FBUDtBQUNEOztBQUVEOzs7Ozs7Ozs0QkFLUSxJLEVBQU07QUFDWixXQUFLLFNBQUwsQ0FBZSxPQUFmLENBQXVCLElBQXZCO0FBQ0Q7Ozs7OztBQUdIOzs7Ozs7O0lBS00sUTtBQUNKOzs7QUFHQSxvQkFBWSxHQUFaLEVBQWlCO0FBQUE7O0FBQ2Y7OztBQUdBLFNBQUssSUFBTCxHQUFZLEdBQVo7O0FBRUE7OztBQUdBLFNBQUssSUFBTCxHQUFZLElBQUksUUFBaEI7O0FBRUE7Ozs7O0FBS0EsU0FBSyxZQUFMLEdBQW9CLElBQUksTUFBSixDQUFXLE1BQVgsQ0FBa0IsSUFBbEIsQ0FBcEI7O0FBRUE7Ozs7QUFJQSxTQUFLLE1BQUwsR0FBYyxFQUFkOztBQUVBOzs7O0FBSUEsU0FBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7OEJBWVU7QUFDUixVQUFNLFVBQVUsS0FBSyxRQUFyQjtBQUNBLFdBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNBLGFBQU8sT0FBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7OEJBTVUsSSxFQUFNO0FBQ2QsVUFBTSxhQUFhLEtBQUssWUFBTCxDQUFrQixJQUFsQixDQUFuQjtBQUNBLFVBQUksVUFBSixFQUFnQjtBQUNkLGVBQU8sVUFBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7OztxQ0FNaUIsSSxFQUFNO0FBQ3JCLFVBQU0sY0FBYyxLQUFLLFlBQXpCOztBQUVBLFdBQUssSUFBTSxJQUFYLElBQW1CLFdBQW5CLEVBQWdDO0FBQzlCLFlBQU0sTUFBTSxZQUFZLElBQVosQ0FBWjtBQUNBLFlBQUksSUFBSSxJQUFKLEtBQWEsSUFBakIsRUFBdUI7QUFDckIsaUJBQU8sR0FBUDtBQUNEO0FBQ0Y7QUFDRjs7QUFFRDs7Ozs7Ozs7Ozs7MkJBUU8sSSxFQUFNLEksRUFBTSxPLEVBQVM7QUFBQSxtQkFDRyxLQUFLLElBRFI7QUFBQSxVQUNuQixLQURtQixVQUNuQixLQURtQjtBQUFBLFVBQ1osV0FEWSxVQUNaLFdBRFk7OztBQUcxQixVQUFJLE9BQUosRUFBYTtBQUNYLGNBQU0sSUFBSSxLQUFKLENBQVUsbURBQVYsQ0FBTjtBQUNEOztBQUVELHNCQUFnQixXQUFoQixFQUE2QixJQUE3Qjs7QUFFQSxVQUFJLEtBQUssU0FBTCxDQUFlLElBQWYsS0FDQSxLQUFLLGdCQUFMLENBQXNCLElBQXRCLENBREosRUFDaUM7QUFDL0IsY0FBTSxJQUFJLEtBQUosNEJBQW1DLElBQW5DLE9BQU47QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxXQUFLLFlBQUwsQ0FBa0IsSUFBbEIsSUFBMEI7QUFDeEIsa0JBRHdCO0FBRXhCO0FBRndCLE9BQTFCOztBQUtBLFdBQUssUUFBTCxDQUFjLElBQWQ7QUFDQSxXQUFLLE9BQUwsQ0FBYSxLQUFLLElBQWxCLEVBQXdCLElBQXhCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7Ozs7Ozs0QkFTUSxJLEVBQU0sUyxFQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLFVBQU0sZUFBZSxDQUFDLENBQUMsU0FBdkI7QUFDQSxVQUFNLFFBQVEsYUFBYSxLQUFLLE1BQWhDO0FBQ0EsVUFBTSxvQkFBb0IsS0FBSyxTQUFMLENBQWUsSUFBZixFQUFxQixLQUFyQixDQUExQjs7QUFFQSxXQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksa0JBQWtCLE1BQXRDLEVBQThDLEdBQTlDLEVBQW1EO0FBQ2pELFlBQU0sWUFBWSxrQkFBa0IsQ0FBbEIsQ0FBbEI7QUFDQSxZQUFJLFlBQUosRUFBa0I7QUFDaEIsZUFBSyxrQkFBTCxDQUF3QixTQUF4QjtBQUNELFNBRkQsTUFFTztBQUNMLGVBQUssV0FBTCxDQUFpQixTQUFqQjtBQUNEO0FBQ0Y7QUFDRjs7QUFFRDs7Ozs7Ozs7O2dDQU1ZLEksRUFBTTtBQUNoQixVQUFNLE1BQU0sS0FBSyxTQUFMLENBQWUsS0FBSyxTQUFwQixDQUFaO0FBQ0EsVUFBSSxDQUFDLEdBQUwsRUFBVTtBQUNSO0FBQ0Q7O0FBRUQsV0FBSyxZQUFMLEVBQWtCLHVCQUF3QixJQUExQyxFQUFpRCxHQUFqRDtBQUNEOztBQUVEOzs7Ozs7Ozs4QkFLVSxJLEVBQU0sSyxFQUFPO0FBQ3JCLFVBQUksQ0FBQyxLQUFELElBQVUsQ0FBQyxLQUFLLGdCQUFwQixFQUFzQztBQUNwQztBQUNBLGVBQU8sRUFBUDtBQUNEOztBQUVELGFBQU8sS0FBSyxnQkFBTCxDQUFzQixLQUF0QixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztpQ0FNYSxJLEVBQU0sRyxFQUFLO0FBQUEsVUFDZixJQURlLEdBQ1AsR0FETyxDQUNmLElBRGU7O0FBRXRCLFVBQUksZ0JBQWdCLElBQXBCLEVBQTBCO0FBQ3hCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNBLFVBQU0sS0FBSyxJQUFJLElBQUosRUFBWDs7QUFFQSxVQUFJLE9BQU8sSUFBWCxFQUFpQjtBQUNmLGNBQU0sSUFBSSxLQUFLLElBQUwsQ0FBVSxLQUFkLENBQ0Ysc0RBREUsQ0FBTjtBQUVEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozs7dUNBT21CLEksRUFBTTtBQUN2QixVQUFNLE1BQU0sS0FBSyxTQUFMLENBQWUsS0FBSyxTQUFwQixDQUFaO0FBQ0EsVUFBSSxDQUFDLEdBQUwsRUFBVTtBQUNSO0FBQ0Q7QUFDRCxXQUFLLFlBQUwsRUFBa0IsdUJBQXdCLElBQTFDLEVBQWlELEdBQWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFJLEtBQUssaUJBQVQsRUFBNEI7QUFDMUIsYUFBSyxpQkFBTDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7OzBDQUtzQixJLEVBQU07QUFDMUI7QUFDQTtBQUNBLFVBQUksS0FBSyxvQkFBVCxFQUErQjtBQUM3QixhQUFLLG9CQUFMO0FBQ0Q7QUFDRjs7QUFFRDs7Ozs7Ozs7Ozs7Ozs7Ozs7OzZCQWVTLEksRUFBTTtBQUFBOztBQUNiLFVBQUksS0FBSyxNQUFULEVBQWlCO0FBQ2YsYUFBSyxNQUFMLFVBQW1CLElBQW5CO0FBQ0E7QUFDRDs7QUFFRCxXQUFLLE1BQUwsR0FBYyxJQUFkOztBQUVBO0FBQ0EsVUFBTSxXQUFXLElBQUksS0FBSyxJQUFMLENBQVUsZ0JBQWQsQ0FBK0IsbUJBQVc7QUFDekQsWUFBSSxPQUFKLEVBQWE7QUFDWCxnQkFBSyxjQUFMLENBQW9CLE9BQXBCO0FBQ0Q7QUFDRixPQUpnQixDQUFqQjtBQUtBLGVBQVMsT0FBVCxDQUFpQixLQUFLLElBQXRCLEVBQTRCO0FBQzFCLG1CQUFXLElBRGU7QUFFMUIsaUJBQVM7QUFGaUIsT0FBNUI7QUFJRDs7QUFFRDs7Ozs7Ozs7Ozs7bUNBUWUsTyxFQUFTO0FBQ3RCLFdBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxRQUFRLE1BQTVCLEVBQW9DLEdBQXBDLEVBQXlDO0FBQ3ZDLFlBQU0sU0FBUyxRQUFRLENBQVIsQ0FBZjtBQUNBLFlBQUksQ0FBQyxNQUFMLEVBQWE7QUFDWDtBQUNEOztBQUpzQyxZQU1oQyxVQU5nQyxHQU1KLE1BTkksQ0FNaEMsVUFOZ0M7QUFBQSxZQU1wQixZQU5vQixHQU1KLE1BTkksQ0FNcEIsWUFOb0I7O0FBT3ZDLGFBQUssSUFBSSxLQUFJLENBQWIsRUFBZ0IsS0FBSSxXQUFXLE1BQS9CLEVBQXVDLElBQXZDLEVBQTRDO0FBQzFDLGNBQU0sT0FBTyxXQUFXLEVBQVgsQ0FBYjtBQUNBLGNBQU0sc0JBQXNCLEtBQUssU0FBTCxDQUFlLElBQWYsRUFBcUIsS0FBSyxNQUExQixDQUE1QjtBQUNBLGVBQUssa0JBQUwsQ0FBd0IsSUFBeEI7QUFDQSxlQUFLLElBQUksTUFBSSxDQUFiLEVBQWdCLE1BQUksb0JBQW9CLE1BQXhDLEVBQWdELEtBQWhELEVBQXFEO0FBQ25ELGlCQUFLLGtCQUFMLENBQXdCLG9CQUFvQixHQUFwQixDQUF4QjtBQUNEO0FBQ0Y7O0FBRUQsYUFBSyxJQUFJLE1BQUksQ0FBYixFQUFnQixNQUFJLGFBQWEsTUFBakMsRUFBeUMsS0FBekMsRUFBOEM7QUFDNUMsY0FBTSxRQUFPLGFBQWEsR0FBYixDQUFiO0FBQ0EsY0FBTSx5QkFBeUIsS0FBSyxTQUFMLENBQWUsS0FBZixFQUFxQixLQUFLLE1BQTFCLENBQS9CO0FBQ0EsZUFBSyxxQkFBTCxDQUEyQixLQUEzQjtBQUNBLGVBQUssSUFBSSxNQUFJLENBQWIsRUFBZ0IsTUFBSSx1QkFBdUIsTUFBM0MsRUFBbUQsS0FBbkQsRUFBd0Q7QUFDdEQsaUJBQUsscUJBQUwsQ0FBMkIsdUJBQXVCLEdBQXZCLENBQTNCO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Y7Ozs7OztBQUdIOzs7Ozs7QUFJQSxTQUFTLFFBQVQsQ0FBa0IsR0FBbEIsRUFBdUI7QUFBQSxNQUNkLFdBRGMsR0FDNEMsR0FENUMsQ0FDZCxXQURjO0FBQUEsTUFDRCxPQURDLEdBQzRDLEdBRDVDLENBQ0QsT0FEQztBQUFBLE1BQ1EsSUFEUixHQUM0QyxHQUQ1QyxDQUNRLElBRFI7QUFBQSxNQUNjLFFBRGQsR0FDNEMsR0FENUMsQ0FDYyxRQURkO0FBQUEsTUFDd0IsTUFEeEIsR0FDNEMsR0FENUMsQ0FDd0IsTUFEeEI7QUFBQSxNQUNnQyxRQURoQyxHQUM0QyxHQUQ1QyxDQUNnQyxRQURoQztBQUFBLE1BRWQsYUFGYyxHQUUwQixRQUYxQixDQUVkLGFBRmM7QUFBQSxNQUVDLFNBRkQsR0FFMEIsUUFGMUIsQ0FFQyxTQUZEO0FBQUEsTUFFWSxVQUZaLEdBRTBCLFFBRjFCLENBRVksVUFGWjs7O0FBSXJCLE1BQU0sV0FBVyxJQUFJLFFBQUosQ0FBYSxHQUFiLENBQWpCO0FBQ0EsTUFBTSxpQkFBaUIsSUFBSSxxQkFBSixDQUEwQixHQUExQixFQUErQixRQUEvQixDQUF2Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFPLGNBQVAsQ0FBc0IsR0FBdEIsRUFBMkIsZ0JBQTNCLEVBQTZDO0FBQzNDLGdCQUFZLElBRCtCO0FBRTNDLGtCQUFjLElBRjZCO0FBRzNDO0FBQ0EsV0FBTztBQUpvQyxHQUE3Qzs7QUFPQTtBQUNBO0FBQ0E7QUFDQSxXQUFTLFNBQVQsQ0FBbUIsYUFBbkIsR0FBbUMsU0FBUyxxQkFBVCxDQUErQixJQUEvQixFQUFxQztBQUN0RSxRQUFNLE1BQU0sU0FBUyxTQUFULENBQW1CLElBQW5CLENBQVo7QUFDQSxRQUFJLEdBQUosRUFBUztBQUNQLGFBQU8sSUFBSSxJQUFJLElBQVIsRUFBUDtBQUNEO0FBQ0QsV0FBTyxjQUFjLEtBQWQsQ0FBb0IsSUFBcEIsRUFBMEIsU0FBMUIsQ0FBUDtBQUNELEdBTkQ7O0FBUUE7QUFDQTtBQUNBLFdBQVMsU0FBVCxDQUFtQixVQUFuQixHQUFnQyxTQUFTLGtCQUFULEdBQThCO0FBQzVELFFBQU0sV0FBVyxXQUFXLEtBQVgsQ0FBaUIsSUFBakIsRUFBdUIsU0FBdkIsQ0FBakI7QUFDQSxRQUFJLFFBQUosRUFBYztBQUNaLGVBQVMsV0FBVCxDQUFxQixRQUFyQjtBQUNBLGVBQVMsT0FBVCxDQUFpQixRQUFqQjtBQUNEO0FBQ0QsV0FBTyxRQUFQO0FBQ0QsR0FQRDs7QUFTQTtBQUNBLE9BQUssU0FBTCxDQUFlLFNBQWYsR0FBMkIsU0FBUyxpQkFBVCxHQUE2QjtBQUN0RCxRQUFNLFNBQVMsVUFBVSxLQUFWLENBQWdCLElBQWhCLEVBQXNCLFNBQXRCLENBQWY7QUFDQSxhQUFTLFdBQVQsQ0FBcUIsTUFBckI7QUFDQSxhQUFTLE9BQVQsQ0FBaUIsTUFBakI7QUFDQSxXQUFPLE1BQVA7QUFDRCxHQUxEOztBQU9BO0FBQ0E7QUFDQTtBQUNBLE1BQU0sZ0JBQWdCLE9BQU8sd0JBQVAsQ0FBZ0MsUUFBUSxTQUF4QyxFQUNsQixXQURrQixDQUF0QjtBQUVBLE1BQU0sa0JBQWtCLGNBQWMsR0FBdEM7QUFDQSxnQkFBYyxHQUFkLEdBQW9CLFVBQVMsSUFBVCxFQUFlO0FBQ2pDLG9CQUFnQixJQUFoQixDQUFxQixJQUFyQixFQUEyQixJQUEzQjtBQUNBLGFBQVMsT0FBVCxDQUFpQixJQUFqQjtBQUNELEdBSEQ7QUFJQSxTQUFPLGNBQVAsQ0FBc0IsUUFBUSxTQUE5QixFQUF5QyxXQUF6QyxFQUFzRCxhQUF0RDs7QUFFQTs7Ozs7QUFLQSxXQUFTLG1CQUFULEdBQStCO0FBQUEsUUFDdEIsV0FEc0IsR0FDUCxJQURPLENBQ3RCLFdBRHNCOztBQUc3QjtBQUNBOztBQUNBLFFBQUksS0FBSyxTQUFTLE9BQVQsRUFBVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFJLENBQUMsRUFBTCxFQUFTO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFNLE1BQU0sU0FBUyxnQkFBVCxDQUEwQixXQUExQixDQUFaO0FBQ0EsV0FBSyxjQUFjLElBQWQsQ0FBbUIsUUFBbkIsRUFBNkIsSUFBSSxJQUFqQyxDQUFMO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFPLGNBQVAsQ0FBc0IsRUFBdEIsRUFBMEIsWUFBWSxTQUF0QztBQUNBLFdBQU8sRUFBUDtBQUNEO0FBQ0QsV0FBUyxNQUFULEVBQWlCLFdBQWpCLEVBQThCLG1CQUE5Qjs7QUFFQTtBQUNBLE1BQUksV0FBSixHQUFrQixtQkFBbEI7QUFDRDs7QUFFRDs7Ozs7Ozs7O0FBU0EsU0FBUyxlQUFULENBQXlCLEdBQXpCLEVBQThCO0FBQUEsTUFDckIsV0FEcUIsR0FDVyxHQURYLENBQ3JCLFdBRHFCO0FBQUEsTUFDUixPQURRLEdBQ1csR0FEWCxDQUNSLE9BRFE7QUFBQSxNQUNDLE1BREQsR0FDVyxHQURYLENBQ0MsTUFERDtBQUU1Qjs7O0FBRUEsV0FBUyxrQkFBVCxHQUE4QjtBQUM1QixRQUFNLE9BQU87QUFDWCwrQkFBNEIsSUFBRCxDQUFPLFdBRHBDOztBQUdBO0FBQ0E7QUFDQTtBQUNBLFdBQU8sUUFBUSxTQUFSLENBQWtCLFdBQWxCLEVBQStCLEVBQS9CLEVBQW1DLElBQW5DLENBQVA7QUFDRDtBQUNELFdBQVMsTUFBVCxFQUFpQixXQUFqQixFQUE4QixrQkFBOUI7O0FBRUE7QUFDQSxNQUFJLFdBQUosR0FBa0Isa0JBQWxCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPQSxTQUFTLFFBQVQsQ0FBa0IsTUFBbEIsRUFBMEIsVUFBMUIsRUFBc0MsUUFBdEMsRUFBZ0Q7QUFDOUM7QUFDQTtBQUNBLFdBQVMsU0FBVCxHQUFxQixPQUFPLE1BQVAsQ0FBYyxXQUFXLFNBQXpCLEVBQW9DO0FBQ3ZELGlCQUFhO0FBQ1g7QUFDQSxvQkFBYyxJQUZIO0FBR1gsZ0JBQVUsSUFIQztBQUlYLGFBQU87QUFKSTtBQUQwQyxHQUFwQyxDQUFyQjtBQVFEOztBQUVEOzs7Ozs7Ozs7Ozs7Ozs7QUFlTyxTQUFTLE9BQVQsQ0FBaUIsR0FBakIsRUFBc0IsSUFBdEIsRUFBNEI7QUFDakMsTUFBSSxVQUFVLEdBQVYsQ0FBSixFQUFvQjtBQUNsQjtBQUNEOztBQUVELE1BQUksVUFBVSxJQUFkO0FBQ0EsTUFBSSxpQkFBaUIsS0FBckI7O0FBRUEsTUFBSSxrQkFBa0IsR0FBbEIsQ0FBSixFQUE0QjtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxRQUFJO0FBQUEsVUFDSyxPQURMLEdBQ3dCLEdBRHhCLENBQ0ssTUFETDtBQUFBLFVBQ2EsUUFEYixHQUN3QixHQUR4QixDQUNhLE9BRGI7O0FBR0Y7O0FBQ0EsVUFBTSxXQUFXLFFBQU8sTUFBUCxDQUFjLEtBQUssU0FBbkIsQ0FBakI7QUFDQSxXQUFLLElBQUwsQ0FBVSxRQUFWOztBQUVBO0FBQ0E7QUFDQSx1QkFBaUIsQ0FBQyxFQUFFLFlBQVcsU0FBUSxTQUFyQixDQUFsQjtBQUNELEtBVkQsQ0FVRSxPQUFPLENBQVAsRUFBVTs7QUFFVjtBQUNBO0FBQ0EsZ0JBQVUsS0FBVjtBQUNEO0FBQ0Y7O0FBRUQsTUFBSSxjQUFKLEVBQW9CO0FBQ2xCLG9CQUFnQixHQUFoQjtBQUNELEdBRkQsTUFFTyxJQUFJLE9BQUosRUFBYTtBQUNsQixhQUFTLEdBQVQ7QUFDRDtBQUNGOzs7Ozs7UUNucUJlLE8sR0FBQSxPO0FBckNoQjs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQTs7Ozs7Ozs7QUFRQSxTQUFTLHdCQUFULENBQWtDLElBQWxDLEVBQXdDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLFNBQU8sUUFBUSxJQUFSLElBQWdCLEtBQUssZUFBTCxDQUFxQixRQUFyQixDQUE4QixJQUE5QixDQUF2QjtBQUNEOztBQUdEOzs7O0FBSU8sU0FBUyxPQUFULENBQWlCLEdBQWpCLEVBQXNCO0FBQzNCO0FBQ0E7QUFDQSxNQUFNLGdCQUFnQixJQUFJLFlBQUosSUFBb0IsSUFBSSxRQUE5QztBQUNBLE1BQUksQ0FBQyxjQUFjLFNBQWQsQ0FBd0IsUUFBN0IsRUFBdUM7QUFDckMsUUFBSSxNQUFKLENBQVcsY0FBWCxDQUEwQixjQUFjLFNBQXhDLEVBQW1ELFVBQW5ELEVBQStEO0FBQzdELGtCQUFZLEtBRGlEO0FBRTdELG9CQUFjLElBRitDO0FBRzdELGdCQUFVLElBSG1EO0FBSTdELGFBQU87QUFKc0QsS0FBL0Q7QUFNRDtBQUNGOzs7Ozs7UUNQZSxPLEdBQUEsTztBQTFDaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkE7Ozs7Ozs7OztBQVNBLFNBQVMsMEJBQVQsQ0FBb0MsS0FBcEMsRUFBMkMsU0FBM0MsRUFBc0Q7QUFDcEQsTUFBTSxTQUFTLGNBQWMsU0FBZCxHQUEwQixLQUFLLFFBQUwsQ0FBYyxLQUFkLENBQTFCLEdBQWlELENBQUMsU0FBakU7QUFDQSxNQUFJLE1BQUosRUFBWTtBQUNWLFNBQUssTUFBTCxDQUFZLEtBQVo7QUFDQSxXQUFPLEtBQVA7QUFDRCxHQUhELE1BR087QUFDTCxTQUFLLEdBQUwsQ0FBUyxLQUFUO0FBQ0EsV0FBTyxJQUFQO0FBQ0Q7QUFDRjs7QUFHRDs7OztBQUlPLFNBQVMsT0FBVCxDQUFpQixHQUFqQixFQUFzQjtBQUMzQixNQUFJLEtBQUssR0FBTCxLQUFhLElBQUksWUFBckIsRUFBbUM7QUFDakMsUUFBSSxNQUFKLENBQVcsY0FBWCxDQUEwQixJQUFJLFlBQUosQ0FBaUIsU0FBM0MsRUFBc0QsUUFBdEQsRUFBZ0U7QUFDOUQsa0JBQVksS0FEa0Q7QUFFOUQsb0JBQWMsSUFGZ0Q7QUFHOUQsZ0JBQVUsSUFIb0Q7QUFJOUQsYUFBTztBQUp1RCxLQUFoRTtBQU1EO0FBQ0Y7O0FBR0Q7Ozs7O0FBS0EsU0FBUyxJQUFULENBQWMsR0FBZCxFQUFtQjtBQUNqQixTQUFPLDBCQUF5QixJQUF6QixDQUE4QixJQUFJLFNBQUosQ0FBYyxTQUE1QztBQUFQO0FBQ0Q7Ozs7OztRQ3JDZSxJLEdBQUEsSTtRQWdCQSxPLEdBQUEsTztBQXhDaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7Ozs7O0FBUU8sU0FBUyxJQUFULENBQWMsQ0FBZCxFQUFpQjtBQUN0QixNQUFJLE9BQU8sQ0FBUCxDQUFKOztBQUVBO0FBQ0EsTUFBSSxDQUFDLENBQUwsRUFBUTtBQUNOLFdBQU8sQ0FBUDtBQUNEOztBQUVELFNBQU8sSUFBSSxDQUFKLEdBQVEsQ0FBUixHQUFZLENBQUMsQ0FBcEI7QUFDRDs7QUFHRDs7OztBQUlPLFNBQVMsT0FBVCxDQUFpQixHQUFqQixFQUFzQjtBQUMzQixNQUFJLENBQUMsSUFBSSxJQUFKLENBQVMsSUFBZCxFQUFvQjtBQUNsQixRQUFJLE1BQUosQ0FBVyxjQUFYLENBQTBCLElBQUksSUFBOUIsRUFBb0MsTUFBcEMsRUFBNEM7QUFDMUMsa0JBQVksS0FEOEI7QUFFMUMsb0JBQWMsSUFGNEI7QUFHMUMsZ0JBQVUsSUFIZ0M7QUFJMUMsYUFBTztBQUptQyxLQUE1QztBQU1EO0FBQ0Y7Ozs7OztRQ3ZCZSxNLEdBQUEsTTtRQXdCQSxPLEdBQUEsTztBQWxEaEI7Ozs7Ozs7Ozs7Ozs7Ozs7SUFnQk8sYyxHQUFrQixPQUFPLFMsQ0FBekIsYzs7QUFFUDs7Ozs7Ozs7O0FBUU8sU0FBUyxNQUFULENBQWdCLE1BQWhCLEVBQXdCLFFBQXhCLEVBQWtDO0FBQ3ZDLE1BQUksVUFBVSxJQUFkLEVBQW9CO0FBQ2xCLFVBQU0sSUFBSSxTQUFKLENBQWMsNENBQWQsQ0FBTjtBQUNEOztBQUVELE1BQU0sU0FBUyxPQUFPLE1BQVAsQ0FBZjtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLFFBQU0sU0FBUyxVQUFVLENBQVYsQ0FBZjtBQUNBLFFBQUksVUFBVSxJQUFkLEVBQW9CO0FBQ2xCLFdBQUssSUFBTSxHQUFYLElBQWtCLE1BQWxCLEVBQTBCO0FBQ3hCLFlBQUksZUFBZSxJQUFmLENBQW9CLE1BQXBCLEVBQTRCLEdBQTVCLENBQUosRUFBc0M7QUFDcEMsaUJBQU8sR0FBUCxJQUFjLE9BQU8sR0FBUCxDQUFkO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Y7QUFDRCxTQUFPLE1BQVA7QUFDRDs7QUFHRDs7OztBQUlPLFNBQVMsT0FBVCxDQUFpQixHQUFqQixFQUFzQjtBQUMzQixNQUFJLENBQUMsSUFBSSxNQUFKLENBQVcsTUFBaEIsRUFBd0I7QUFDdEIsUUFBSSxNQUFKLENBQVcsY0FBWCxDQUEwQixJQUFJLE1BQTlCLEVBQXNDLFFBQXRDLEVBQWdEO0FBQzlDLGtCQUFZLEtBRGtDO0FBRTlDLG9CQUFjLElBRmdDO0FBRzlDLGdCQUFVLElBSG9DO0FBSTlDLGFBQU87QUFKdUMsS0FBaEQ7QUFNRDtBQUNGOzs7Ozs7UUNwQ2UsTyxHQUFBLE87O0FBTmhCOztJQUFZLE87Ozs7QUFFWjs7OztBQUlPLFNBQVMsT0FBVCxDQUFpQixHQUFqQixFQUFzQjtBQUMzQixNQUFJLENBQUMsSUFBSSxPQUFULEVBQWtCO0FBQ2hCLFFBQUksT0FBSixHQUFjLGdCQUFrQixPQUFoQztBQUNBO0FBQ0E7QUFDQSxRQUFJLFFBQVEsT0FBWixFQUFxQjtBQUNuQixVQUFJLE9BQUosR0FBYyxRQUFRLE9BQXRCO0FBQ0Q7QUFDRDtBQUNBO0FBQ0EsUUFBSSxPQUFKLENBQVksT0FBWixHQUFzQixRQUFRLE9BQTlCO0FBQ0EsUUFBSSxPQUFKLENBQVksTUFBWixHQUFxQixRQUFRLE1BQTdCO0FBQ0EsUUFBSSxPQUFKLENBQVksR0FBWixHQUFrQixRQUFRLEdBQTFCO0FBQ0EsUUFBSSxPQUFKLENBQVksSUFBWixHQUFtQixRQUFRLElBQTNCO0FBQ0Q7QUFDRixDLENBdENEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O3FqQkNBQTs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7Ozs7O0FBTUE7QUFDc0I7O1FBaUVOLDhCLEdBQUEsOEI7UUF3QkEsb0MsR0FBQSxvQztRQXlCQSwwQixHQUFBLDBCO1FBa0NBLHNCLEdBQUEsc0I7UUFvQkEsNEIsR0FBQSw0QjtRQXVCQSxVLEdBQUEsVTtRQWdCQSxpQixHQUFBLGlCO1FBV0Esd0IsR0FBQSx3QjtRQWdCQSx1QixHQUFBLHVCO1FBYUEsZ0IsR0FBQSxnQjtRQW9CQSwwQixHQUFBLDBCO1FBZUEsdUIsR0FBQSx1QjtRQWFBLDZCLEdBQUEsNkI7UUFVQSxlLEdBQUEsZTtRQVdBLGUsR0FBQSxlO1FBV0EsWSxHQUFBLFk7UUFXQSwyQixHQUFBLDJCO1FBaUJBLFMsR0FBQSxTO1FBd0tBLFksR0FBQSxZO1FBV0EsZ0IsR0FBQSxnQjtRQVdBLHFCLEdBQUEscUI7UUFVQSx1QixHQUFBLHVCO1FBa0RBLFksR0FBQSxZO1FBV0Esb0IsR0FBQSxvQjtRQWNBLGdDLEdBQUEsZ0M7UUF1QkEsc0IsR0FBQSxzQjs7QUE3b0JoQjs7QUFFQTs7QUFDQTs7QUFDQTs7OztBQUdBOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBLElBQUkseUJBQUo7O0FBR0E7Ozs7OztJQUthLFUsV0FBQSxVOzs7Ozs7Ozs7QUFFWDs7Ozs4QkFJVSxDQUFFOzs7Ozs7QUFJZDs7Ozs7OztJQUthLGlCLFdBQUEsaUI7Ozs7Ozs7OztBQUVYOzs7OztxQ0FLaUIsYyxFQUFnQixDQUFFOzs7Ozs7QUFJckM7Ozs7Ozs7Ozs7QUFRTyxTQUFTLDhCQUFULENBQXdDLEdBQXhDLEVBQTZDLEVBQTdDLEVBQWlELG9CQUFqRCxFQUF1RTtBQUM1RTtBQUNBLE1BQU0sUUFBUSx5Q0FBeUMsR0FBekMsRUFBOEMsRUFBOUMsQ0FBZDtBQUNBLE1BQUksS0FBSixFQUFXO0FBQ1QsV0FBTyxLQUFQO0FBQ0Q7QUFDRCxNQUFJLG9CQUFKLEVBQTBCO0FBQ3hCLFdBQU8sV0FBVyxHQUFYLEVBQWdCLEVBQWhCLENBQVA7QUFDRDtBQUNELFNBQU8sSUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7Ozs7QUFZTyxTQUFTLG9DQUFULENBQ0wsU0FESyxFQUNNLEVBRE4sRUFDVSxvQkFEVixFQUNnQztBQUNyQztBQUNBLE1BQUksVUFBVSxRQUFkLEVBQXdCO0FBQ3RCO0FBQ0EsUUFBTSxNQUFNLG1CQUFNLHdCQUF5QixDQUN6QyxVQUFVLGFBQVYsSUFBMkIsU0FEYyxFQUNILFdBRDVCLENBQVo7QUFFQSxRQUFNLFFBQVEseUNBQXlDLEdBQXpDLEVBQThDLEVBQTlDLENBQWQ7QUFDQSxRQUFJLEtBQUosRUFBVztBQUNULGFBQU8sS0FBUDtBQUNEO0FBQ0Y7QUFDRDtBQUNBLE1BQUksQ0FBQyxVQUFVLFFBQVgsSUFBdUIsb0JBQTNCLEVBQWlEO0FBQy9DLFdBQU8sMkJBQTJCLFNBQTNCLEVBQXNDLEVBQXRDLENBQVA7QUFDRDtBQUNELFNBQU8sSUFBUDtBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLDBCQUFULENBQW9DLFFBQXBDLEVBQThDLEVBQTlDLEVBQWtELE9BQWxELEVBQTJEO0FBQ2hFLE1BQU0sU0FBUyxhQUFhLFFBQWIsQ0FBZjtBQUNBLGtCQUFNLE1BQU4sQ0FBYSxZQUFZLE1BQXpCLEVBQ0ksNERBREosRUFDa0UsRUFEbEU7QUFFQSxrQkFBTSxNQUFOLENBQWEsQ0FBQyx5Q0FBeUMsUUFBekMsRUFBbUQsRUFBbkQsQ0FBZCxFQUNJLGlEQURKLEVBQ3VELEVBRHZEO0FBRUEsMEJBQXdCLFFBQXhCLEVBQWtDLFFBQWxDLEVBQTRDLEVBQTVDLEVBQWdEO0FBQUEsV0FBTSxPQUFOO0FBQUEsR0FBaEQ7QUFDQSxxQkFBbUIsUUFBbkIsRUFBNkIsRUFBN0IsRUFQZ0UsQ0FPOUI7QUFDbkM7O0FBRUQ7Ozs7O0FBS0EsU0FBUyx3Q0FBVCxDQUFrRCxRQUFsRCxFQUE0RCxFQUE1RCxFQUFnRTtBQUM5RDtBQUNBO0FBQ0E7QUFDQSxNQUFNLFNBQVMsYUFBYSxRQUFiLENBQWY7QUFDQSxNQUFJLFlBQVksTUFBWixJQUFzQixvQkFBb0IsUUFBcEIsRUFBOEIsRUFBOUIsQ0FBMUIsRUFBNkQ7QUFDM0QsV0FBTyxtQkFBbUIsUUFBbkIsRUFBNkIsRUFBN0IsQ0FBUDtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU8sSUFBUDtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLHNCQUFULENBQWdDLEdBQWhDLEVBQ0wsRUFESyxFQUVMLFdBRkssRUFHTCxlQUhLLEVBR1k7QUFDakIsUUFBTSxhQUFhLEdBQWIsQ0FBTjtBQUNBLDBCQUF3QixHQUF4QixFQUE2QixHQUE3QixFQUFrQyxFQUFsQyxFQUFzQyxXQUF0QztBQUNBLE1BQUksZUFBSixFQUFxQjtBQUNuQix1QkFBbUIsR0FBbkIsRUFBd0IsRUFBeEI7QUFDRDtBQUNGOztBQUdEOzs7Ozs7OztBQVFPLFNBQVMsNEJBQVQsQ0FBc0MsU0FBdEMsRUFDTCxFQURLLEVBRUwsV0FGSyxFQUdMLGVBSEssRUFHWTtBQUNqQixNQUFNLFNBQVMsVUFBVSxTQUFWLENBQWY7QUFDQSxNQUFNLFNBQVMsdUJBQXVCLE1BQXZCLENBQWY7QUFDQSwwQkFBd0IsTUFBeEIsRUFBZ0MsTUFBaEMsRUFBd0MsRUFBeEMsRUFBNEMsV0FBNUM7QUFDQSxNQUFJLGVBQUosRUFBcUI7QUFDbkIsdUJBQW1CLE1BQW5CLEVBQTJCLEVBQTNCO0FBQ0Q7QUFDRjs7QUFHRDs7Ozs7Ozs7OztBQVVPLFNBQVMsVUFBVCxDQUFvQixHQUFwQixFQUF5QixFQUF6QixFQUE2QjtBQUNsQyxRQUFNLGFBQWEsR0FBYixDQUFOO0FBQ0EsU0FBTyxtQkFBbUIsR0FBbkIsRUFBd0IsRUFBeEIsQ0FBUDtBQUNEOztBQUdEOzs7Ozs7Ozs7O0FBVU8sU0FBUyxpQkFBVCxDQUEyQixHQUEzQixFQUFnQyxFQUFoQyxFQUFvQztBQUN6QyxTQUFPLDBCQUEwQixHQUExQixFQUErQixFQUEvQixDQUFQO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsd0JBQVQsQ0FBa0MsR0FBbEMsRUFBdUMsRUFBdkMsRUFBMkM7QUFDaEQsUUFBTSxhQUFhLEdBQWIsQ0FBTjtBQUNBLE1BQUksb0JBQW9CLEdBQXBCLEVBQXlCLEVBQXpCLENBQUosRUFBa0M7QUFDaEMsV0FBTyxtQkFBbUIsR0FBbkIsRUFBd0IsRUFBeEIsQ0FBUDtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU8sSUFBUDtBQUNEO0FBQ0Y7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsdUJBQVQsQ0FBaUMsR0FBakMsRUFBc0MsRUFBdEMsRUFBMEM7QUFDL0MsU0FBTyxnQ0FBZ0MsR0FBaEMsRUFBcUMsRUFBckMsQ0FBUDtBQUNEOztBQUdEOzs7Ozs7OztBQVFPLFNBQVMsZ0JBQVQsQ0FBMEIsZUFBMUIsRUFBMkMsRUFBM0MsRUFBK0M7QUFDcEQsTUFBTSxTQUFTLFVBQVUsZUFBVixDQUFmO0FBQ0EsTUFBTSxTQUFTLHVCQUF1QixNQUF2QixDQUFmO0FBQ0EsU0FBTyxtQkFBbUIsTUFBbkIsRUFBMkIsRUFBM0IsQ0FBUDtBQUNEOztBQUdEOzs7Ozs7Ozs7Ozs7O0FBYU8sU0FBUywwQkFBVCxDQUFvQyxTQUFwQyxFQUErQyxFQUEvQyxFQUFtRDtBQUN4RCxNQUFNLFNBQVMsVUFBVSxTQUFWLENBQWY7QUFDQSxNQUFNLFNBQVMsdUJBQXVCLE1BQXZCLENBQWY7QUFDQSxTQUFPLG1CQUFtQixNQUFuQixFQUEyQixFQUEzQixDQUFQO0FBQ0Q7O0FBR0Q7Ozs7Ozs7O0FBUU8sU0FBUyx1QkFBVCxDQUFpQyxlQUFqQyxFQUFrRCxFQUFsRCxFQUFzRDtBQUMzRCxTQUFPLDBCQUNILHVCQUF1QixlQUF2QixDQURHLEVBQ3NDLEVBRHRDLENBQVA7QUFFRDs7QUFHRDs7Ozs7OztBQU9PLFNBQVMsNkJBQVQsQ0FBdUMsZUFBdkMsRUFBd0QsRUFBeEQsRUFBNEQ7QUFDakUsU0FBTyxnQ0FDSCx1QkFBdUIsZUFBdkIsQ0FERyxFQUNzQyxFQUR0QyxDQUFQO0FBRUQ7O0FBRUQ7Ozs7O0FBS08sU0FBUyxlQUFULENBQXlCLEdBQXpCLEVBQThCLFNBQTlCLEVBQXlDO0FBQzlDLE1BQUksWUFBSixHQUFtQixTQUFuQjtBQUNBLE1BQUksU0FBSixHQUFnQixhQUFhLFNBQWIsQ0FBaEI7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLGVBQVQsQ0FBeUIsR0FBekIsRUFBOEI7QUFDbkMsU0FBTyxJQUFJLFlBQUosSUFBb0IsR0FBM0I7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxZQUFULENBQXNCLEdBQXRCLEVBQTJCO0FBQ2hDLFNBQU8sSUFBSSxTQUFKLElBQWlCLEdBQXhCO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsMkJBQVQsQ0FBcUMsSUFBckMsRUFBMkMsTUFBM0MsRUFBbUQ7QUFDeEQsTUFBTSxXQUFXLENBQUMsS0FBSyxhQUFMLElBQXNCLElBQXZCLEVBQTZCLFdBQTlDO0FBQ0EsTUFBSSxZQUFZLFlBQVksTUFBeEIsSUFBa0MsYUFBYSxRQUFiLEtBQTBCLE1BQWhFLEVBQXdFO0FBQ3RFLFFBQUk7QUFDRixhQUFPLGtDQUFtQyxTQUFTO0FBQW5EO0FBQ0QsS0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1Y7QUFDRDtBQUNGO0FBQ0QsU0FBTyxJQUFQO0FBQ0Q7O0FBR0Q7Ozs7QUFJTyxTQUFTLFNBQVQsQ0FBbUIsU0FBbkIsRUFBOEI7QUFDbkMsTUFBSSxVQUFVLFFBQWQsRUFBd0I7QUFDdEIsUUFBTSxNQUFNLG1CQUFNLHdCQUF5QixDQUN6QyxVQUFVLGFBQVYsSUFBMkIsU0FEYyxFQUNILFdBRDVCLENBQVo7QUFFQSxXQUFPLGlCQUFpQixHQUFqQixFQUFzQixTQUF0QixFQUFnQyxvQkFBc0IsU0FBdEQsQ0FBUDtBQUNEO0FBQ0QsU0FBTyw2Q0FBOEM7QUFBckQ7QUFDRDs7QUFHRDs7OztBQUlBLFNBQVMsc0JBQVQsQ0FBZ0MsU0FBaEMsRUFBMkM7QUFDekMsTUFBTSxTQUFTLFVBQVUsU0FBVixDQUFmO0FBQ0EsU0FBTyxPQUFPLFdBQVAsS0FBdUIsT0FBTyxHQUE5QixHQUFvQyxNQUEzQztBQUNEOztBQUdEOzs7Ozs7QUFNQSxTQUFTLGdCQUFULENBQTBCLEdBQTFCLEVBQStCO0FBQzdCLFNBQU8sb0RBQ0wsV0FBVyxHQUFYLEVBQWdCLFFBQWhCO0FBREY7QUFFRDs7QUFHRDs7Ozs7Ozs7QUFRQSxTQUFTLGtCQUFULENBQTRCLE1BQTVCLEVBQW9DLEVBQXBDLEVBQXdDO0FBQ3RDLGtCQUFNLE1BQU4sQ0FBYSxvQkFBb0IsTUFBcEIsRUFBNEIsRUFBNUIsQ0FBYix3QkFDd0IsRUFEeEI7QUFFQSxNQUFNLFdBQVcsWUFBWSxNQUFaLENBQWpCO0FBQ0EsTUFBTSxJQUFJLFNBQVMsRUFBVCxDQUFWO0FBQ0EsTUFBSSxDQUFDLEVBQUUsR0FBUCxFQUFZO0FBQ1Ysb0JBQU0sTUFBTixDQUFhLEVBQUUsSUFBZixlQUFnQyxFQUFoQztBQUNBLG9CQUFNLE1BQU4sQ0FBYSxFQUFFLE9BQWYsZUFBbUMsRUFBbkM7QUFDQSxNQUFFLEdBQUYsR0FBUSxJQUFJLEVBQUUsSUFBTixDQUFXLEVBQUUsT0FBYixDQUFSO0FBQ0Esb0JBQU0sTUFBTixDQUFhLEVBQUUsR0FBZixlQUErQixFQUEvQjtBQUNBLE1BQUUsSUFBRixHQUFTLElBQVQ7QUFDQSxNQUFFLE9BQUYsR0FBWSxJQUFaO0FBQ0E7QUFDQTtBQUNBLFFBQUksRUFBRSxPQUFOLEVBQWU7QUFDYixRQUFFLE9BQUYsQ0FBVSxFQUFFLEdBQVo7QUFDRDtBQUNGO0FBQ0QsU0FBTyxFQUFFLEdBQVQ7QUFDRDs7QUFFRDs7Ozs7O0FBTUEsU0FBUyx1QkFBVCxDQUFpQyxNQUFqQyxFQUF5QyxPQUF6QyxFQUFrRCxFQUFsRCxFQUFzRCxJQUF0RCxFQUE0RDtBQUMxRCxNQUFNLFdBQVcsWUFBWSxNQUFaLENBQWpCO0FBQ0EsTUFBSSxJQUFJLFNBQVMsRUFBVCxDQUFSOztBQUVBLE1BQUksQ0FBQyxDQUFMLEVBQVE7QUFDTixRQUFJLFNBQVMsRUFBVCxJQUFlO0FBQ2pCLFdBQUssSUFEWTtBQUVqQixlQUFTLElBRlE7QUFHakIsZUFBUyxJQUhRO0FBSWpCLGVBQVMsSUFKUTtBQUtqQixZQUFNO0FBTFcsS0FBbkI7QUFPRDs7QUFFRCxNQUFJLEVBQUUsSUFBRixJQUFVLEVBQUUsR0FBaEIsRUFBcUI7QUFDbkI7QUFDQTtBQUNEOztBQUVELElBQUUsSUFBRixHQUFTLElBQVQ7QUFDQSxJQUFFLE9BQUYsR0FBWSxPQUFaOztBQUVBO0FBQ0E7QUFDQSxNQUFJLEVBQUUsT0FBTixFQUFlO0FBQ2I7QUFDQSx1QkFBbUIsTUFBbkIsRUFBMkIsRUFBM0I7QUFDRDtBQUNGOztBQUVEOzs7OztBQUtBLFNBQVMseUJBQVQsQ0FBbUMsTUFBbkMsRUFBMkMsRUFBM0MsRUFBK0M7QUFDN0MsTUFBTSxTQUFTLGdDQUFnQyxNQUFoQyxFQUF3QyxFQUF4QyxDQUFmO0FBQ0EsTUFBSSxNQUFKLEVBQVk7QUFDVixXQUFPLE1BQVA7QUFDRDtBQUNEOztBQUVBO0FBQ0E7QUFDQSxNQUFNLFdBQVcsdUJBQWpCO0FBVDZDLE1BVXRDLE9BVnNDLEdBVWxCLFFBVmtCLENBVXRDLE9BVnNDO0FBQUEsTUFVN0IsT0FWNkIsR0FVbEIsUUFWa0IsQ0FVN0IsT0FWNkI7OztBQVk3QyxNQUFNLFdBQVcsWUFBWSxNQUFaLENBQWpCO0FBQ0EsV0FBUyxFQUFULElBQWU7QUFDYixTQUFLLElBRFE7QUFFYixvQkFGYTtBQUdiLG9CQUhhO0FBSWIsYUFBUyxJQUpJO0FBS2IsVUFBTTtBQUxPLEdBQWY7QUFPQSxTQUFPLE9BQVA7QUFDRDs7QUFHRDs7Ozs7OztBQU9BLFNBQVMsK0JBQVQsQ0FBeUMsTUFBekMsRUFBaUQsRUFBakQsRUFBcUQ7QUFDbkQsTUFBTSxXQUFXLFlBQVksTUFBWixDQUFqQjtBQUNBLE1BQU0sSUFBSSxTQUFTLEVBQVQsQ0FBVjtBQUNBLE1BQUksQ0FBSixFQUFPO0FBQ0wsUUFBSSxFQUFFLE9BQU4sRUFBZTtBQUNiLGFBQU8sRUFBRSxPQUFUO0FBQ0QsS0FGRCxNQUVPO0FBQ0w7QUFDQSx5QkFBbUIsTUFBbkIsRUFBMkIsRUFBM0I7QUFDQSxhQUFPLEVBQUUsT0FBRixHQUFZLFFBQVEsT0FBUixFQUFnQixzQkFBd0IsRUFBRSxHQUExQyxDQUFuQjtBQUNEO0FBQ0Y7QUFDRCxTQUFPLElBQVA7QUFDRDs7QUFHRDs7Ozs7QUFLQSxTQUFTLFdBQVQsQ0FBcUIsTUFBckIsRUFBNkI7QUFBQSxNQUN0QixRQURzQixHQUNWLE1BRFUsQ0FDdEIsUUFEc0I7O0FBRTNCLE1BQUksQ0FBQyxRQUFMLEVBQWU7QUFDYixlQUFXLE9BQU8sUUFBUCxHQUFrQixFQUE3QjtBQUNEO0FBQ0QsU0FBTyxRQUFQO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLE9BQXRCLEVBQStCO0FBQ3BDLFNBQU8sT0FBTyxRQUFRLE9BQWYsSUFBMEIsVUFBakM7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxnQkFBVCxDQUEwQixPQUExQixFQUFtQztBQUN4QyxrQkFBTSxNQUFOLENBQWEsYUFBYSxPQUFiLENBQWIsRUFBb0Msa0NBQXBDO0FBQ0EsU0FBTywyQkFBNEI7QUFBbkM7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLHFCQUFULENBQStCLE1BQS9CLEVBQXVDO0FBQzVDLDBCQUF3QixNQUF4QjtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsdUJBQVQsQ0FBaUMsUUFBakMsRUFBMkM7QUFDaEQsMEJBQXdCLFFBQXhCO0FBQ0Q7O0FBR0Q7OztBQUdBLFNBQVMsdUJBQVQsQ0FBaUMsTUFBakMsRUFBeUM7QUFDdkM7QUFDQTtBQUNBLE1BQU0sV0FBVyxZQUFZLE1BQVosQ0FBakI7O0FBSHVDLDZCQUk1QixFQUo0QjtBQUtyQyxRQUFJLENBQUMsT0FBTyxTQUFQLENBQWlCLGNBQWpCLENBQWdDLElBQWhDLENBQXFDLFFBQXJDLEVBQStDLEVBQS9DLENBQUwsRUFBeUQ7QUFDdkQ7QUFDRDtBQUNELFFBQU0sZ0JBQWdCLFNBQVMsRUFBVCxDQUF0QjtBQUNBLFFBQUksY0FBYyxHQUFsQixFQUF1QjtBQUNyQiw2QkFBdUIsRUFBdkIsRUFBMkIsY0FBYyxHQUF6QztBQUNELEtBRkQsTUFFTyxJQUFJLGNBQWMsT0FBbEIsRUFBMkI7QUFDaEMsb0JBQWMsT0FBZCxDQUFzQixJQUF0QixDQUNJO0FBQUEsZUFBWSx1QkFBdUIsRUFBdkIsRUFBMkIsUUFBM0IsQ0FBWjtBQUFBLE9BREo7QUFFRDtBQWRvQzs7QUFJdkMsT0FBSyxJQUFNLEVBQVgsSUFBaUIsUUFBakIsRUFBMkI7QUFBQSxxQkFBaEIsRUFBZ0I7O0FBQUEsNkJBRXZCO0FBU0g7QUFDRjs7QUFHRDs7OztBQUlBLFNBQVMsc0JBQVQsQ0FBZ0MsRUFBaEMsRUFBb0MsT0FBcEMsRUFBNkM7QUFDM0MsTUFBSSxDQUFDLGFBQWEsT0FBYixDQUFMLEVBQTRCO0FBQzFCO0FBQ0Q7QUFDRCxNQUFJO0FBQ0YscUJBQWlCLE9BQWpCLEVBQTBCLE9BQTFCO0FBQ0QsR0FGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1Y7QUFDQTtBQUNBLG9CQUFNLEtBQU4sQ0FBWSxTQUFaLEVBQXVCLDJCQUF2QixFQUFvRCxFQUFwRCxFQUF3RCxDQUF4RDtBQUNEO0FBQ0Y7O0FBR0Q7Ozs7O0FBS08sU0FBUyxZQUFULENBQXNCLE9BQXRCLEVBQStCO0FBQ3BDLFNBQU8sT0FBTyxRQUFRLGdCQUFmLElBQW1DLFVBQTFDO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsb0JBQVQsQ0FBOEIsUUFBOUIsRUFBd0MsU0FBeEMsRUFBbUQ7QUFDeEQsTUFBTSxVQUFVLGlDQUFpQyxRQUFqQyxFQUEyQyxTQUEzQyxDQUFoQjtBQUNBLGtCQUFNLE1BQU4sQ0FBYSxPQUFiLEVBQXNCLGFBQVcsU0FBWCw2QkFDbEIsMENBREo7QUFFRDs7QUFHRDs7Ozs7OztBQU9PLFNBQVMsZ0NBQVQsQ0FBMEMsUUFBMUMsRUFBb0QsU0FBcEQsRUFBK0Q7QUFDcEUsTUFBTSxlQUFlLG9CQUFzQixnQkFBTSxNQUFOLENBQ3ZDLFNBQVMsWUFEOEIsRUFFdkMsa0NBRnVDLENBQTNDO0FBR0EsTUFBTSxTQUFTLFVBQVUsWUFBVixDQUFmO0FBQ0EsTUFBTSxTQUFTLHVCQUF1QixNQUF2QixDQUFmO0FBQ0EsTUFBSSxDQUFDLG9CQUFvQixNQUFwQixFQUE0QixTQUE1QixDQUFMLEVBQTZDO0FBQzNDLFdBQU8sS0FBUDtBQUNEO0FBQ0QsTUFBTSxVQUFVLDJCQUEyQixZQUEzQixFQUF5QyxTQUF6QyxDQUFoQjtBQUNBLE1BQUksQ0FBQyxhQUFhLE9BQWIsQ0FBTCxFQUE0QjtBQUMxQixXQUFPLEtBQVA7QUFDRDtBQUNELFVBQVEsZ0JBQVIsQ0FBeUIsUUFBekI7QUFDQSxTQUFPLElBQVA7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLHNCQUFULENBQWdDLE1BQWhDLEVBQXdDLEVBQXhDLEVBQTRDO0FBQ2pELE1BQUksT0FBTyxRQUFYLEVBQXFCO0FBQ25CLFdBQU8sUUFBUCxDQUFnQixFQUFoQixJQUFzQixJQUF0QjtBQUNEO0FBQ0Y7O0FBRUQ7Ozs7O0FBS0EsU0FBUyxtQkFBVCxDQUE2QixNQUE3QixFQUFxQyxFQUFyQyxFQUF5QztBQUN2QyxNQUFNLFVBQVUsT0FBTyxRQUFQLElBQW1CLE9BQU8sUUFBUCxDQUFnQixFQUFoQixDQUFuQztBQUNBO0FBQ0EsU0FBTyxDQUFDLEVBQUUsWUFBWSxRQUFRLElBQVIsSUFBZ0IsUUFBUSxHQUFwQyxDQUFGLENBQVI7QUFDRDs7Ozs7Ozs7cWpCQ25yQkQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7O0FBU0E7Ozs7QUFPQTtBQUNPLElBQUksMERBQUo7O0lBRU0sUSxXQUFBLFE7Ozs7Ozs7O0FBQ1g7Ozs7O0FBS0E7Ozs7O3dDQUsyQixlLEVBQWlCO0FBQzFDLGFBQVEsZ0ZBQ04sNkNBQXdCLGVBQXhCLEVBQXlDLFFBQXpDLEVBQW1ELFlBQW5EO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozs7OzhDQU1pQyxlLEVBQWlCO0FBQ2hELGFBQVEsZ0ZBQ04sd0RBQW1DLGVBQW5DLEVBQW9ELFFBQXBELEVBQ0ksWUFESjtBQURGO0FBR0Q7O0FBRUQ7Ozs7Ozs7OytDQUtrQyxlLEVBQWlCO0FBQ2pELGFBQVEsOENBQ04sNkNBQXdCLGVBQXhCLEVBQXlDLGVBQXpDLEVBQ0ksbUJBREo7QUFERjtBQUdEOztBQUVEOzs7Ozs7OztxREFLd0MsZSxFQUFpQjtBQUN2RCxhQUFRLDhDQUNOLHdEQUFtQyxlQUFuQyxFQUFvRCxlQUFwRCxFQUNJLG1CQURKO0FBREY7QUFHRDs7QUFFRDs7Ozs7Ozs7O3dDQU0yQixTLEVBQVc7QUFDcEMsYUFBTyxvREFDTCxtREFDSSxTQURKLEVBQ2UsUUFEZixFQUN5QiwwQkFBMkIsSUFEcEQ7QUFERjtBQUdEOztBQUVEOzs7Ozs7O21DQUlzQixlLEVBQWlCO0FBQ3JDLGFBQU8sbUNBQ0wsNkNBQXdCLGVBQXhCLEVBQXlDLFVBQXpDLEVBQXFELGVBQXJEO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozs7OztxQ0FPd0IsTSxFQUFRO0FBQzlCLGFBQU8sb0RBQ0wseUJBQVcsTUFBWCxFQUFtQixRQUFuQjtBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7OzJCQUtjLGUsRUFBaUI7QUFDN0IsYUFBTyx3QkFBVSxlQUFWLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7b0NBS3VCLGUsRUFBd0M7QUFBQSxVQUF2QixhQUF1Qix1RUFBUCxLQUFPOztBQUM3RCxVQUFJLGFBQUosRUFBbUI7QUFDakI7QUFDQSxZQUFNLFNBQVMsd0JBQVUsZUFBVixDQUFmO0FBQ0EsaUJBQVMsYUFBVCxDQUF1QixPQUFPLEdBQTlCLEdBQW1DLE1BQU0sc0JBQXpDLENBQ0ksTUFESixFQUNZLGVBRFo7QUFFRDtBQUNELGFBQU8saUdBQ0wsNkNBQXdCLGVBQXhCLEVBQXlDLCtCQUF6QyxFQUNJLGVBREo7QUFERjtBQUdEOztBQUVEOzs7Ozs7OzBDQUk2QixlLEVBQWlCO0FBQzVDLGFBQU8saUdBQ0wsd0RBQW1DLGVBQW5DLEVBQ0ksK0JBREosRUFDcUMsZUFEckM7QUFERjtBQUdEOztBQUVEOzs7Ozs7O2tDQUlxQixNLEVBQVE7QUFDM0IsYUFBTyxzREFDTCx5QkFBVyxNQUFYLEVBQW1CLGFBQW5CO0FBREY7QUFFRDs7QUFFRDs7Ozs7OztxQ0FJd0IsZSxFQUFpQjtBQUN2QyxhQUFPLG9FQUNMLG9FQUNJLGVBREosRUFDcUIsTUFEckIsRUFDNkIsVUFEN0I7QUFERjtBQUdEOztBQUVEOzs7Ozs7OzhCQUlpQixlLEVBQWlCO0FBQ2hDLGFBQU8saURBQ0wsc0NBQXdCLGVBQXhCLEVBQXlDLEtBQXpDO0FBREY7QUFFRDs7QUFFRDs7Ozs7OztxQ0FJd0IsZSxFQUFpQjtBQUN2QyxhQUFPLGdEQUNMLCtCQUFpQixlQUFqQixFQUFrQyxZQUFsQztBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7OEJBSWlCLE0sRUFBUTtBQUN2QixhQUFRLDZDQUNOLHlCQUFXLE1BQVgsRUFBbUIsUUFBbkI7QUFERjtBQUVEOztBQUVEOzs7Ozs7O3VDQUkwQixlLEVBQWlCO0FBQ3pDLGFBQU8scURBQ0wsK0JBQWlCLGVBQWpCLEVBQWtDLGNBQWxDLENBRDBELENBQ1AsR0FETztBQUE1RDtBQUVEOztBQUVEOzs7Ozs7O3FDQUl3QixNLEVBQVE7QUFDOUIsYUFBTyx5QkFBVyxNQUFYLEVBQW1CLGVBQW5CLENBQVA7QUFDRDs7QUFFRDs7Ozs7OztrQ0FJcUIsTSxFQUFRO0FBQzNCLGFBQU8scURBQ0wseUJBQVcsTUFBWCxFQUFtQixZQUFuQjtBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7O2tDQUtxQixlLEVBQWlCO0FBQ3BDLGFBQU8sK0NBQ0wsK0JBQWlCLGVBQWpCLEVBQWtDLFNBQWxDO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozs2QkFJZ0IsRyxFQUFLO0FBQ25CLGFBQU8seUJBQVcsR0FBWCxFQUFnQixPQUFoQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7aUNBSW9CLGUsRUFBaUI7QUFDbkMsYUFBTyxtREFDTCwrQkFBaUIsZUFBakIsRUFBa0MsUUFBbEM7QUFERjtBQUVEOztBQUVEOzs7Ozs7O21DQUlzQixNLEVBQVE7QUFDNUIsYUFBTyxzREFDTCx5QkFBVyxNQUFYLEVBQW1CLGFBQW5CO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozt5Q0FJNEIsTSxFQUFRO0FBQ2xDLGFBQU8sc0RBQ0wsdUNBQXlCLE1BQXpCLEVBQWlDLGFBQWpDO0FBREY7QUFFRDs7QUFFRDs7Ozs7OztnQ0FJbUIsTSxFQUFRO0FBQ3pCLGFBQU8saURBQ0wseUJBQVcsTUFBWCxFQUFtQixVQUFuQjtBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7O29DQUt1QixTLEVBQVc7QUFDaEMsYUFBTyxtREFDTCx5Q0FBMkIsU0FBM0IsRUFBc0MsV0FBdEM7QUFERjtBQUVEOztBQUVEOzs7Ozs7OzJDQUk4QixHLEVBQUs7QUFDakMsYUFBUSwrRUFDTixrREFBNkIsR0FBN0IsRUFBa0MsZ0JBQWxDLEVBQ0ksb0JBREosRUFDMEIsSUFEMUI7QUFERjtBQUdEOztBQUVEOzs7Ozs7O2tEQUlxQyxHLEVBQUs7QUFDeEM7QUFDQTtBQUNHLDBEQUE2QixHQUE3QixFQUFrQyxnQkFBbEMsRUFBb0QsV0FBcEQsRUFDRyxJQURIO0FBRkg7QUFJRDs7QUFFRDs7Ozs7Ozs7OytDQU1rQyxHLEVBQUs7QUFDckM7QUFDQTtBQUNHLDBEQUE2QixHQUE3QixFQUFrQyxhQUFsQyxFQUFpRCxXQUFqRDtBQUZIO0FBR0Q7O0FBRUQ7Ozs7Ozs7c0NBSXlCLEcsRUFBSztBQUM1QixhQUFRO0FBQ0wsK0NBQXlCLEdBQXpCLEVBQThCLGFBQTlCO0FBREg7QUFFRDs7QUFFRDs7Ozs7Ozt3Q0FJMkIsRyxFQUFLO0FBQzlCLGFBQVE7QUFDTCwrQ0FBeUIsR0FBekIsRUFBOEIsZUFBOUI7QUFESDtBQUVEOztBQUVEOzs7Ozs7O2lEQUlvQyxHLEVBQUs7QUFDdkM7QUFDQTtBQUNHLDBEQUE2QixHQUE3QixFQUFrQyxjQUFsQyxFQUFrRCxXQUFsRCxFQUErRCxJQUEvRDtBQUZIO0FBR0Q7O0FBRUQ7Ozs7Ozs7d0NBSTJCLEcsRUFBSztBQUM5QixhQUFPLHlCQUFXLEdBQVgsRUFBZ0IsY0FBaEIsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7Ozt5Q0FLNEIsRyxFQUFLO0FBQy9CLGFBQU8seUJBQVcsR0FBWCxFQUFnQixhQUFoQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OzJDQUs4QixHLEVBQUs7QUFDakMsYUFBTyx5QkFBVyxHQUFYLEVBQWdCLG1CQUFoQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O29EQUt1QyxHLEVBQUs7QUFDMUM7QUFDQTtBQUNHLDBEQUE2QixHQUE3QixFQUFrQyxrQkFBbEMsRUFBc0QsV0FBdEQsRUFDRyxJQURIO0FBRkg7QUFJRDs7QUFFRDs7Ozs7Ozs7MkNBSzhCLEcsRUFBSztBQUNqQyxhQUFPLHlCQUFXLEdBQVgsRUFBZ0Isa0JBQWhCLENBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs4REFJaUQsRyxFQUFLO0FBQ3BEO0FBQ0E7QUFDRywwREFBNkIsR0FBN0IsRUFBa0MsNkJBQWxDLEVBQ0csd0JBREgsRUFDNkIsSUFEN0I7QUFGSDtBQUlEOztBQUVEOzs7Ozs7OzJDQUk4QixlLEVBQWlCO0FBQzdDLGFBQVE7QUFDTCxxREFDRyxlQURILEVBQ29CLGVBRHBCLEVBQ3FDLGVBRHJDO0FBREg7QUFHRDs7QUFFRDs7Ozs7OztrQ0FJcUIsZSxFQUFpQjtBQUNwQyxhQUFPLHlEQUNMLHNDQUF3QixlQUF4QixFQUF5QyxTQUF6QztBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7aUNBSW9CLE0sRUFBUTtBQUMxQixhQUFPLGtEQUNMLHlCQUFXLE1BQVgsRUFBbUIsV0FBbkI7QUFERjtBQUVEOztBQUVEOzs7Ozs7OzZCQUlnQixNLEVBQVE7QUFDdEIsYUFBTywyQ0FDTCx5QkFBVyxNQUFYLEVBQW1CLE9BQW5CO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozs7OzBDQU02QixTLEVBQVc7QUFDdEMsYUFBTyxnRUFDTCxtREFDSSxTQURKLEVBQ2UsYUFEZixFQUM4QiwwQkFBMkIsSUFEekQ7QUFERjtBQUdEOztBQUVEOzs7Ozs7O2tEQUlxQyxlLEVBQWlCO0FBQ3BELGFBQVE7QUFDTCxxREFBd0IsZUFBeEIsRUFBeUMseUJBQXpDLEVBQ0csdUJBREg7QUFESDtBQUdEOztBQUVEOzs7Ozs7Ozs7cURBTXdDLGUsRUFBaUI7QUFDdkQsYUFBUTtBQUNMLGdFQUFtQyxlQUFuQyxFQUNHLHNCQURILEVBQzJCLGFBRDNCO0FBREg7QUFHRDs7QUFFRDs7Ozs7Ozs7O29DQU11QixlLEVBQWlCO0FBQ3RDLGFBQU8sbUVBQ0wsd0RBQ0ksZUFESixFQUNxQixLQURyQixFQUM0QixTQUQ1QixFQUN1QyxJQUR2QztBQURGO0FBR0Q7O0FBRUQ7Ozs7Ozs7Ozs4QkFNaUIsUyxFQUFXO0FBQzFCLGFBQU8sdUNBQ0wsbURBQ0ksU0FESixFQUNlLEtBRGYsRUFDc0IsMEJBQTJCLElBRGpEO0FBREY7QUFHRDs7QUFFRDs7Ozs7Ozs7O3FDQU13QixHLEVBQUs7QUFDM0IsYUFBTyx5Q0FDTCxrREFBNkIsR0FBN0IsRUFBa0MsU0FBbEMsRUFBNkMsZ0JBQTdDLEVBQStELElBQS9EO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozt1Q0FJMEIsZSxFQUFpQjtBQUN6QztBQUNFLCtFQUNFLCtCQUFpQixlQUFqQixFQUFrQyxlQUFsQztBQUZKO0FBR0Q7O0FBRUQ7Ozs7Ozs7O2lDQUtvQixTLEVBQVc7QUFDN0IsYUFBTyw2Q0FDTCx5Q0FBMkIsU0FBM0IsRUFBc0MsUUFBdEM7QUFERjtBQUVEOztBQUVEOzs7Ozs7Ozs7O3dDQU8yQixlLEVBQWlCO0FBQzFDLGFBQU8sdURBQ0wsc0NBQXdCLGVBQXhCLEVBQXlDLFFBQXpDO0FBREY7QUFFRDs7QUFFRDs7Ozs7Ozs2QkFJZ0IsTSxFQUFRO0FBQ3RCLGFBQU8sMkNBQ0wseUJBQVcsTUFBWCxFQUFtQixPQUFuQjtBQURGO0FBRUQ7O0FBRUQ7Ozs7Ozs7O21DQUtzQixTLEVBQVc7QUFDL0IsYUFBTywwREFDTCx5Q0FBMkIsU0FBM0IsRUFBc0MsVUFBdEM7QUFERjtBQUVEOztBQUVEOzs7Ozs7OzJCQUljLE0sRUFBUTtBQUNwQixhQUFPLHVDQUF3Qyx5QkFBVyxNQUFYLEVBQW1CLEtBQW5CO0FBQS9DO0FBQ0Q7Ozs7Ozs7Ozs7UUNqaUJhLE8sR0FBQSxPO1FBNkNBLFEsR0FBQSxROztBQXhEaEI7O0FBQ0E7O0FBakJBOzs7Ozs7Ozs7Ozs7Ozs7O0FBbUJBLElBQUksa0JBQUo7O0FBRUE7Ozs7OztBQU1PLFNBQVMsT0FBVCxDQUFpQixTQUFqQixFQUE0QjtBQUNqQyxNQUFNLE1BQU0sVUFBVSxhQUFWLElBQTJCLFNBQXZDO0FBQ0EsTUFBSSxDQUFDLFNBQUQsSUFBYyxVQUFVLGFBQVYsS0FBNEIsR0FBOUMsRUFBbUQ7QUFDakQsZ0JBQVksSUFBSSxhQUFKLENBQWtCLEtBQWxCLENBQVo7QUFDRDs7QUFFRCxTQUFPLElBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7Ozs7QUFjQSxTQUFTLElBQVQsQ0FBYyxPQUFkLEVBQXVCO0FBQ3JCLGtCQUFNLE1BQU4sQ0FBYSxRQUFRLE1BQVIsS0FBbUIsQ0FBaEMsRUFBbUMsbUNBQW5DO0FBQ0EsYUFBVSxNQUFNLFNBQWhCLEdBQTRCLFFBQVEsQ0FBUixDQUE1Qjs7QUFFQSxNQUFNLEtBQUssVUFBVSxpQkFBckI7QUFDQSxrQkFBTSxNQUFOLENBQWEsRUFBYixFQUFpQix5QkFBakI7QUFDQSxrQkFBTSxNQUFOLENBQWEsQ0FBQyxHQUFHLGtCQUFqQixFQUFxQyxvQ0FBckM7O0FBRUE7QUFDQSxhQUFVLE1BQU0sU0FBaEIsR0FBNEIsRUFBNUI7O0FBRUEsU0FBTyxFQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxRQUFULENBQWtCLElBQWxCLEVBQXdCO0FBQzdCLE1BQU0sV0FBVyxLQUFLLGdCQUFMLENBQXNCLE9BQXRCLENBQWpCO0FBQ0EsTUFBTSxPQUFPLGtCQUFiOztBQUVBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxTQUFTLE1BQTdCLEVBQXFDLEdBQXJDLEVBQTBDO0FBQ3hDLFFBQU0sVUFBVSxTQUFTLENBQVQsQ0FBaEI7QUFDQSxRQUFNLE1BQU0sZ0JBQU0sTUFBTixDQUFhLFFBQVEsWUFBUixDQUFxQixLQUFyQixDQUFiLEVBQTBDLGdCQUExQyxDQUFaO0FBQ0EsWUFBUSxlQUFSLENBQXdCLEtBQXhCO0FBQ0Esb0JBQU0sTUFBTixDQUFhLEtBQUssR0FBTCxNQUFjLFNBQTNCLEVBQXNDLGVBQXRDO0FBQ0EsU0FBSyxHQUFMLElBQVksT0FBWjtBQUNEOztBQUVELFNBQU8sSUFBUDtBQUNEOzs7Ozs7UUMvQ2UsZSxHQUFBLGU7UUFVQSxlLEdBQUEsZTtRQVFBLGUsR0FBQSxlO1FBVUEsUSxHQUFBLFE7UUFXQSxVLEdBQUEsVTtRQXFCQSxjLEdBQUEsYztRQXNCQSxZLEdBQUEsWTtBQXhIaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7O0FBS0EsU0FBUyxXQUFULENBQXFCLE1BQXJCLEVBQTZCLFNBQTdCLEVBQXdDO0FBQ3RDLFNBQU8sVUFBVSxXQUFWLEVBQVA7QUFDRDs7QUFFRDs7OztBQUlBLFNBQVMseUJBQVQsQ0FBbUMsS0FBbkMsRUFBMEM7QUFDeEMsU0FBTyxNQUFNLE1BQU0sV0FBTixFQUFiO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxlQUFULENBQXlCLElBQXpCLEVBQStCO0FBQ3BDLFNBQU8sS0FBSyxPQUFMLENBQWEsV0FBYixFQUEwQixXQUExQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsZUFBVCxDQUF5QixNQUF6QixFQUFpQztBQUN0QyxTQUFPLE9BQU8sT0FBUCxDQUFlLGFBQWYsRUFBOEIseUJBQTlCLENBQVA7QUFDRDs7QUFFRDs7OztBQUlPLFNBQVMsZUFBVCxDQUF5QixJQUF6QixFQUErQjtBQUNwQyxTQUFPLEtBQUssT0FBTCxDQUFhLEdBQWIsRUFBa0IsR0FBbEIsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLFFBQVQsQ0FBa0IsTUFBbEIsRUFBMEIsTUFBMUIsRUFBa0M7QUFDdkMsTUFBTSxRQUFRLE9BQU8sTUFBUCxHQUFnQixPQUFPLE1BQXJDO0FBQ0EsU0FBTyxTQUFTLENBQVQsSUFBYyxPQUFPLE9BQVAsQ0FBZSxNQUFmLEVBQXVCLEtBQXZCLEtBQWlDLEtBQXREO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsVUFBVCxDQUFvQixNQUFwQixFQUE0QixNQUE1QixFQUFvQztBQUN6QyxNQUFJLE9BQU8sTUFBUCxHQUFnQixPQUFPLE1BQTNCLEVBQW1DO0FBQ2pDLFdBQU8sS0FBUDtBQUNEO0FBQ0QsU0FBTyxPQUFPLFdBQVAsQ0FBbUIsTUFBbkIsRUFBMkIsQ0FBM0IsS0FBaUMsQ0FBeEM7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7Ozs7QUFjTyxTQUFTLGNBQVQsQ0FBd0IsUUFBeEIsRUFBa0MsTUFBbEMsRUFBMEMsaUJBQTFDLEVBQTZEO0FBQ2xFLE1BQU0sZ0JBQWdCLHFCQUFxQixDQUEzQzs7QUFEa0UsNkJBRXpELENBRnlEO0FBR2hFLFFBQUksVUFBVSxDQUFkO0FBQ0EsZUFBVyxTQUFTLE9BQVQsQ0FBaUIsY0FBakIsRUFBaUMsVUFBQyxFQUFELEVBQUssQ0FBTCxFQUFXO0FBQ3JEO0FBQ0EsYUFBTyxPQUFPLENBQVAsQ0FBUDtBQUNELEtBSFUsQ0FBWDtBQUlBLFFBQUksQ0FBQyxPQUFMLEVBQWM7QUFDWjtBQUNEO0FBVitEOztBQUVsRSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksYUFBcEIsRUFBbUMsR0FBbkMsRUFBd0M7QUFBQSxxQkFBL0IsQ0FBK0I7O0FBQUEsMEJBT3BDO0FBRUg7QUFDRCxTQUFPLFFBQVA7QUFDRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsWUFBVCxDQUFzQixHQUF0QixFQUEyQjtBQUFBLE1BQ3pCLE1BRHlCLEdBQ2YsR0FEZSxDQUN6QixNQUR5Qjs7QUFFaEMsTUFBSSxPQUFPLElBQVg7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksTUFBcEIsRUFBNEIsR0FBNUIsRUFBaUM7QUFDL0IsV0FBTyxPQUFPLEVBQVAsR0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFmLENBQW5CO0FBQ0Q7QUFDRDtBQUNBLFNBQU8sT0FBTyxTQUFTLENBQWhCLENBQVA7QUFDRDs7Ozs7O1FDL0ZlLG9CLEdBQUEsb0I7UUFpQ0EsdUIsR0FBQSx1QjtRQWlDQSxrQixHQUFBLGtCO1FBZ0JBLFEsR0FBQSxRO1FBaUJBLFEsR0FBQSxRO1FBZ0JBLFMsR0FBQSxTO1FBWUEsTSxHQUFBLE07UUFhQSxFLEdBQUEsRTtRQVNBLEcsR0FBQSxHO1FBU0EsVSxHQUFBLFU7UUFjQSxTLEdBQUEsUztRQW1CQSxLLEdBQUEsSztRQVNBLE0sR0FBQSxNO1FBY0Esb0IsR0FBQSxvQjtRQWFBLGEsR0FBQSxhO1FBV0EsVyxHQUFBLFc7O0FBOVBoQjs7QUFDQTs7QUFHQTtBQXJCQTs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTtBQU1BLElBQUksMEJBQUo7O0FBRUE7QUFDQSxJQUFNLGlCQUFpQixDQUFDLFFBQUQsRUFBVyxRQUFYLEVBQXFCLEtBQXJCLEVBQTRCLEtBQTVCLEVBQW1DLElBQW5DLEVBQXlDLEdBQXpDLEVBQThDLEdBQTlDLENBQXZCOztBQUdBOzs7OztBQUtPLFNBQVMsb0JBQVQsQ0FBOEIsU0FBOUIsRUFBeUM7QUFDOUMsU0FBTyxVQUFVLE1BQVYsQ0FBaUIsQ0FBakIsRUFBb0IsV0FBcEIsS0FBb0MsVUFBVSxLQUFWLENBQWdCLENBQWhCLENBQTNDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUEsU0FBUyx3QkFBVCxDQUFrQyxLQUFsQyxFQUF5QyxTQUF6QyxFQUFvRDtBQUNsRCxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksZUFBZSxNQUFuQyxFQUEyQyxHQUEzQyxFQUFnRDtBQUM5QyxRQUFNLGVBQWUsZUFBZSxDQUFmLElBQW9CLFNBQXpDO0FBQ0EsUUFBSSxNQUFNLFlBQU4sTUFBd0IsU0FBNUIsRUFBdUM7QUFDckMsYUFBTyxZQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sRUFBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7OztBQVdPLFNBQVMsdUJBQVQsQ0FBaUMsS0FBakMsRUFBd0MsU0FBeEMsRUFBbUQsZUFBbkQsRUFBb0U7QUFDekUsTUFBSSx3QkFBVyxTQUFYLEVBQXNCLElBQXRCLENBQUosRUFBaUM7QUFDL0I7QUFDQSxXQUFPLFNBQVA7QUFDRDtBQUNELE1BQUksQ0FBQyxpQkFBTCxFQUF3QjtBQUN0Qix3QkFBb0Isa0JBQXBCO0FBQ0Q7QUFDRCxNQUFJLGVBQWUsa0JBQWtCLFNBQWxCLENBQW5CO0FBQ0EsTUFBSSxDQUFDLFlBQUQsSUFBaUIsZUFBckIsRUFBc0M7QUFDcEMsbUJBQWUsU0FBZjtBQUNBLFFBQUksTUFBTSxTQUFOLE1BQXFCLFNBQXpCLEVBQW9DO0FBQ2xDLFVBQU0sWUFBWSxxQkFBcUIsU0FBckIsQ0FBbEI7QUFDQSxVQUFNLHVCQUF1Qix5QkFBeUIsS0FBekIsRUFBZ0MsU0FBaEMsQ0FBN0I7O0FBRUEsVUFBSSxNQUFNLG9CQUFOLE1BQWdDLFNBQXBDLEVBQStDO0FBQzdDLHVCQUFlLG9CQUFmO0FBQ0Q7QUFDRjtBQUNELFFBQUksQ0FBQyxlQUFMLEVBQXNCO0FBQ3BCLHdCQUFrQixTQUFsQixJQUErQixZQUEvQjtBQUNEO0FBQ0Y7QUFDRCxTQUFPLFlBQVA7QUFDRDs7QUFHRDs7Ozs7O0FBTU8sU0FBUyxrQkFBVCxDQUE0QixPQUE1QixFQUFxQyxNQUFyQyxFQUE2QztBQUNsRCxPQUFLLElBQU0sQ0FBWCxJQUFnQixNQUFoQixFQUF3QjtBQUN0QixZQUFRLEtBQVIsQ0FBYyxXQUFkLENBQ0ksd0JBQXdCLE1BQXhCLEVBQWdDLENBQWhDLENBREosRUFDd0MsT0FBTyxDQUFQLEVBQVUsUUFBVixFQUR4QyxFQUM4RCxXQUQ5RDtBQUVEO0FBQ0Y7O0FBR0Q7Ozs7Ozs7O0FBUU8sU0FBUyxRQUFULENBQWtCLE9BQWxCLEVBQTJCLFFBQTNCLEVBQXFDLEtBQXJDLEVBQTRDLFNBQTVDLEVBQXVELGVBQXZELEVBQXdFO0FBQzdFLE1BQU0sZUFBZSx3QkFBd0IsUUFBUSxLQUFoQyxFQUF1QyxRQUF2QyxFQUNqQixlQURpQixDQUFyQjtBQUVBLE1BQUksWUFBSixFQUFrQjtBQUNoQixZQUFRLEtBQVIsQ0FBYyxZQUFkO0FBQ0UseUJBQXVCLFlBQVksUUFBUSxTQUFwQixHQUFnQyxLQUR6RDtBQUVEO0FBQ0Y7O0FBR0Q7Ozs7Ozs7QUFPTyxTQUFTLFFBQVQsQ0FBa0IsT0FBbEIsRUFBMkIsUUFBM0IsRUFBcUMsZUFBckMsRUFBc0Q7QUFDM0QsTUFBTSxlQUFlLHdCQUF3QixRQUFRLEtBQWhDLEVBQXVDLFFBQXZDLEVBQ2pCLGVBRGlCLENBQXJCO0FBRUEsTUFBSSxDQUFDLFlBQUwsRUFBbUI7QUFDakIsV0FBTyxTQUFQO0FBQ0Q7QUFDRCxTQUFPLFFBQVEsS0FBUixDQUFjLFlBQWQsQ0FBUDtBQUNEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLFNBQVQsQ0FBbUIsT0FBbkIsRUFBNEIsTUFBNUIsRUFBb0M7QUFDekMsT0FBSyxJQUFNLENBQVgsSUFBZ0IsTUFBaEIsRUFBd0I7QUFDdEIsYUFBUyxPQUFULEVBQWtCLENBQWxCLEVBQXFCLE9BQU8sQ0FBUCxDQUFyQjtBQUNEO0FBQ0Y7O0FBR0Q7Ozs7O0FBS08sU0FBUyxNQUFULENBQWdCLE9BQWhCLEVBQXlCLFdBQXpCLEVBQXNDO0FBQzNDLE1BQUksZ0JBQWdCLFNBQXBCLEVBQStCO0FBQzdCLGtCQUFjLFNBQVMsT0FBVCxFQUFrQixTQUFsQixLQUFnQyxNQUE5QztBQUNEO0FBQ0QsV0FBUyxPQUFULEVBQWtCLFNBQWxCLEVBQTZCLGNBQWMsRUFBZCxHQUFtQixNQUFoRDtBQUNEOztBQUdEOzs7OztBQUtPLFNBQVMsRUFBVCxDQUFZLEtBQVosRUFBbUI7QUFDeEIsU0FBVSxLQUFWO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxHQUFULENBQWEsS0FBYixFQUFvQjtBQUN6QixTQUFVLEtBQVY7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFVBQVQsQ0FBb0IsS0FBcEIsRUFBMkI7QUFDaEMsTUFBSSxPQUFPLEtBQVAsSUFBZ0IsUUFBcEIsRUFBOEI7QUFDNUIsMkJBQXFCLEtBQXJCO0FBQ0Q7QUFDRCx5QkFBcUIsR0FBRyxLQUFILENBQXJCO0FBQ0Q7O0FBR0Q7Ozs7OztBQU1PLFNBQVMsU0FBVCxDQUFtQixDQUFuQixFQUFzQixLQUF0QixFQUE2QjtBQUNsQyxNQUFJLE9BQU8sQ0FBUCxJQUFZLFFBQWhCLEVBQTBCO0FBQ3hCLFFBQUksR0FBRyxDQUFILENBQUo7QUFDRDtBQUNELE1BQUksVUFBVSxTQUFkLEVBQXlCO0FBQ3ZCLDBCQUFvQixDQUFwQjtBQUNEO0FBQ0QsTUFBSSxPQUFPLEtBQVAsSUFBZ0IsUUFBcEIsRUFBOEI7QUFDNUIsWUFBUSxHQUFHLEtBQUgsQ0FBUjtBQUNEO0FBQ0Qsd0JBQW9CLENBQXBCLFVBQTBCLEtBQTFCO0FBQ0Q7O0FBR0Q7Ozs7O0FBS08sU0FBUyxLQUFULENBQWUsS0FBZixFQUFzQjtBQUMzQixvQkFBZ0IsS0FBaEI7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLE1BQVQsQ0FBZ0IsS0FBaEIsRUFBdUI7QUFDNUIsTUFBSSxPQUFPLEtBQVAsSUFBZ0IsUUFBcEIsRUFBOEI7QUFDNUIsWUFBUSxJQUFJLEtBQUosQ0FBUjtBQUNEO0FBQ0QscUJBQWlCLEtBQWpCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLG9CQUFULENBQThCLFNBQTlCLEVBQXlDO0FBQzlDLFNBQU8sVUFBVSxPQUFWLENBQ0gscUNBREcsRUFDb0MsZUFEcEMsQ0FBUDtBQUVEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMsYUFBVCxDQUF1QixHQUF2QixFQUE0QixFQUE1QixFQUFnQztBQUNyQyxNQUFNLFFBQVEsbUNBQW9DLElBQUksZ0JBQUosQ0FBcUIsRUFBckIsQ0FBbEQ7QUFDQSxTQUFPLHVDQUF1QyxLQUFELElBQVc7QUFBeEQ7QUFDRDs7QUFHRDs7Ozs7QUFLTyxTQUFTLFdBQVQsQ0FBcUIsT0FBckIsRUFBOEIsVUFBOUIsRUFBMEM7QUFDL0MsTUFBTSxXQUFXLEVBQWpCO0FBQ0EsYUFBVyxPQUFYLENBQW1CLGdCQUFRO0FBQ3pCLGFBQVMsSUFBVCxJQUFpQixJQUFqQjtBQUNELEdBRkQ7QUFHQSxZQUFVLE9BQVYsRUFBbUIsUUFBbkI7QUFDRDs7Ozs7O1FDcFBlLE8sR0FBQSxPO1FBVUEsTyxHQUFBLE87UUFnQkEsUSxHQUFBLFE7UUFXQSxjLEdBQUEsYztRQVlBLFcsR0FBQSxXO1FBbUJBLEssR0FBQSxLO0FBckdoQjs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTtBQUNBLElBQU0sWUFBWSxPQUFPLFNBQVAsQ0FBaUIsUUFBbkM7O0FBRUE7Ozs7O0FBS0EsU0FBUyxRQUFULENBQWtCLEtBQWxCLEVBQXlCO0FBQ3ZCLFNBQU8sVUFBVSxJQUFWLENBQWUsS0FBZixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxPQUFULENBQWlCLEtBQWpCLEVBQXdCO0FBQzdCLFNBQU8sTUFBTSxPQUFOLENBQWMsS0FBZCxDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsT0FBVCxDQUFpQixTQUFqQixFQUE0QjtBQUNqQyxNQUFJLENBQUMsU0FBTCxFQUFnQjtBQUNkLFdBQU8sRUFBUDtBQUNEO0FBQ0QsTUFBTSxRQUFRLElBQUksS0FBSixDQUFVLFVBQVUsTUFBcEIsQ0FBZDtBQUNBLE9BQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxVQUFVLE1BQTlCLEVBQXNDLEdBQXRDLEVBQTJDO0FBQ3pDLFVBQU0sQ0FBTixJQUFXLFVBQVUsQ0FBVixDQUFYO0FBQ0Q7QUFDRCxTQUFPLEtBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLFFBQVQsQ0FBa0IsS0FBbEIsRUFBeUI7QUFDOUIsU0FBTyxTQUFTLEtBQVQsTUFBb0IsaUJBQTNCO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsRUFBK0I7QUFDcEMsU0FBUSxPQUFPLEtBQVAsS0FBaUIsUUFBakIsSUFBNkIsU0FBUyxLQUFULENBQXJDO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxXQUFULENBQXFCLE9BQXJCLEVBQThCLENBQTlCLEVBQWlDO0FBQ3RDLE9BQUssSUFBTSxDQUFYLElBQWdCLE9BQWhCLEVBQXlCO0FBQ3ZCLFFBQUksUUFBUSxDQUFSLE1BQWUsQ0FBbkIsRUFBc0I7QUFDcEIsYUFBTyxJQUFQO0FBQ0Q7QUFDRjtBQUNELFNBQU8sS0FBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7O0FBVU8sU0FBUyxLQUFULENBQWUsU0FBZixFQUEwQjtBQUMvQixTQUFPLHVCQUF3QjtBQUEvQjtBQUNEOzs7Ozs7UUN6RWUsaUIsR0FBQSxpQjs7QUFkaEI7O0FBRUEsSUFBTSxRQUFRLG9DQUFkOztBQUVBOzs7Ozs7Ozs7O0FBcEJBOzs7Ozs7Ozs7Ozs7Ozs7O0FBOEJPLFNBQVMsaUJBQVQsQ0FBMkIsV0FBM0IsRUFBd0M7QUFDN0MsTUFBTSxTQUFTLDBCQUE0QixPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQTNDO0FBQ0EsTUFBSSxDQUFDLFdBQUwsRUFBa0I7QUFDaEIsV0FBTyxNQUFQO0FBQ0Q7O0FBRUQsTUFBSSxjQUFKO0FBQ0EsU0FBUSxRQUFRLE1BQU0sSUFBTixDQUFXLFdBQVgsQ0FBaEIsRUFBMEM7QUFDeEMsUUFBTSxPQUFPLHNEQUF1QixNQUFNLENBQU4sQ0FBdkIsRUFBaUMsTUFBTSxDQUFOLENBQWpDLENBQWI7QUFDQSxRQUFNLFFBQVEsTUFBTSxDQUFOLElBQVcsc0RBQXVCLE1BQU0sQ0FBTixDQUF2QixFQUFpQyxNQUFNLENBQU4sQ0FBakMsQ0FBWCxHQUF3RCxFQUF0RTtBQUNBLFdBQU8sSUFBUCxJQUFlLEtBQWY7QUFDRDtBQUNELFNBQU8sTUFBUDtBQUNEOzs7Ozs7UUNoQmUsc0IsR0FBQSxzQjtBQTNCaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7Ozs7Ozs7O0FBV08sU0FBUyxzQkFBVCxDQUFnQyxTQUFoQyxFQUEwRDtBQUFBLE1BQWYsUUFBZSx1RUFBSixFQUFJOztBQUMvRCxNQUFJO0FBQ0YsV0FBTyxtQkFBbUIsU0FBbkIsQ0FBUDtBQUNELEdBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNWLFdBQU8sUUFBUDtBQUNEO0FBQ0Y7Ozs7Ozs7UUMrQ2UsWSxHQUFBLFk7UUFhQSxrQixHQUFBLGtCO1FBb0JBLGEsR0FBQSxhO1FBbUVBLDZCLEdBQUEsNkI7UUEwQkEsYSxHQUFBLGE7UUFZQSxjLEdBQUEsYztRQVVBLG9CLEdBQUEsb0I7UUF3QkEscUIsR0FBQSxxQjtRQW9CQSxjLEdBQUEsYztRQW1CQSw0QixHQUFBLDRCO1FBa0JBLGdCLEdBQUEsZ0I7UUFVQSxjLEdBQUEsYztRQWNBLFcsR0FBQSxXO1FBYUEsYSxHQUFBLGE7UUFjQSxtQixHQUFBLG1CO1FBZ0JBLGlCLEdBQUEsaUI7UUFhQSxlLEdBQUEsZTtRQWVBLHdCLEdBQUEsd0I7UUFZQSxZLEdBQUEsWTtRQWtDQSxZLEdBQUEsWTtRQW1DQSxlLEdBQUEsZTtRQVVBLGtCLEdBQUEsa0I7UUFpQkEsMkIsR0FBQSwyQjtRQWtDQSxVLEdBQUEsVTtRQVdBLFksR0FBQSxZO1FBZUEscUIsR0FBQSxxQjs7QUE1aUJoQjs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7O0FBR0EsSUFBTSxzQkFBc0Isa0JBQUs7QUFDL0I7QUFDQSxPQUFLLElBRjBCO0FBRy9CO0FBQ0EsT0FBSyxJQUowQjtBQUsvQjtBQUNBLE9BQUssSUFOMEI7QUFPL0I7QUFDQSxRQUFNO0FBUnlCLENBQUwsQ0FBNUI7O0FBV0E7Ozs7QUF4Q0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUE0Q0EsSUFBSSxVQUFKOztBQUVBOzs7Ozs7QUFNQSxJQUFJLGNBQUo7O0FBRUE7QUFDQSxJQUFNLHNCQUFzQixpQkFBNUI7O0FBRUE7QUFDQSxJQUFNLHVCQUF1QixrQkFBN0I7O0FBRUE7QUFDQSxJQUFNLHFCQUFxQixnQkFBM0I7O0FBRUE7QUFDQSxJQUFNLGlDQUFpQyxlQUF2Qzs7QUFFQSxJQUFNLG9CQUFvQjtBQUN4QiwyQkFBNEIsYUFESjtBQUV4QiwyQkFBNEIsT0FGSjtBQUd4QiwyQkFBNEIsV0FISixDQUExQjs7QUFNQTtBQUNPLElBQU0sb0RBQXNCLHFCQUE1Qjs7QUFFUDs7Ozs7QUFLTyxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMkI7QUFDaEMsU0FBTyxJQUFJLE1BQUosSUFBYyxtQkFBbUIsSUFBSSxRQUFKLENBQWEsSUFBaEMsRUFBc0MsTUFBM0Q7QUFDRDs7QUFFRDs7Ozs7Ozs7O0FBU08sU0FBUyxrQkFBVCxDQUE0QixHQUE1QixFQUFpQyxXQUFqQyxFQUE4QztBQUNuRCxNQUFJLENBQUMsQ0FBTCxFQUFRO0FBQ04sUUFBSSxpQ0FBbUMsS0FBSyxRQUFMLENBQWMsYUFBZCxDQUE0QixHQUE1QixDQUF2QztBQUNBLFlBQVEsS0FBSyxRQUFMLEtBQWtCLEtBQUssUUFBTCxHQUFnQix1QkFBYSxHQUFiLENBQWxDLENBQVI7QUFDRDs7QUFFRCxTQUFPLGNBQWMsQ0FBZCxFQUFpQixHQUFqQixFQUFzQixjQUFjLElBQWQsR0FBcUIsS0FBM0MsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7Ozs7OztBQVdPLFNBQVMsYUFBVCxDQUF1QixDQUF2QixFQUEwQixHQUExQixFQUErQixTQUEvQixFQUEwQztBQUMvQyxNQUFJLGFBQWEsVUFBVSxHQUFWLENBQWMsR0FBZCxDQUFqQixFQUFxQztBQUNuQyxXQUFPLFVBQVUsR0FBVixDQUFjLEdBQWQsQ0FBUDtBQUNEOztBQUVELElBQUUsSUFBRixHQUFTLEdBQVQ7O0FBRUE7QUFDQTtBQUNBLE1BQUksQ0FBQyxFQUFFLFFBQVAsRUFBaUI7QUFDZixNQUFFLElBQUYsR0FBUyxFQUFFLElBQVg7QUFDRDs7QUFFRCxNQUFNLE9BQU8sd0JBQXlCO0FBQ3BDLFVBQU0sRUFBRSxJQUQ0QjtBQUVwQyxjQUFVLEVBQUUsUUFGd0I7QUFHcEMsVUFBTSxFQUFFLElBSDRCO0FBSXBDLGNBQVUsRUFBRSxRQUp3QjtBQUtwQyxVQUFNLEVBQUUsSUFBRixJQUFVLEdBQVYsR0FBZ0IsRUFBaEIsR0FBcUIsRUFBRSxJQUxPO0FBTXBDLGNBQVUsRUFBRSxRQU53QjtBQU9wQyxZQUFRLEVBQUUsTUFQMEI7QUFRcEMsVUFBTSxFQUFFLElBUjRCO0FBU3BDLFlBQVEsSUFUNEIsQ0FTdEI7QUFUc0IsR0FBdEM7O0FBWUE7QUFDQTtBQUNBLE1BQUksS0FBSyxRQUFMLENBQWMsQ0FBZCxNQUFxQixHQUF6QixFQUE4QjtBQUM1QixTQUFLLFFBQUwsR0FBZ0IsTUFBTSxLQUFLLFFBQTNCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBLE1BQUssS0FBSyxRQUFMLElBQWlCLE9BQWpCLElBQTRCLEtBQUssSUFBTCxJQUFhLEVBQTFDLElBQ0ksS0FBSyxRQUFMLElBQWlCLFFBQWpCLElBQTZCLEtBQUssSUFBTCxJQUFhLEdBRGxELEVBQ3dEO0FBQ3RELFNBQUssSUFBTCxHQUFZLEVBQVo7QUFDQSxTQUFLLElBQUwsR0FBWSxLQUFLLFFBQWpCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBLE1BQUksRUFBRSxNQUFGLElBQVksRUFBRSxNQUFGLElBQVksTUFBNUIsRUFBb0M7QUFDbEMsU0FBSyxNQUFMLEdBQWMsRUFBRSxNQUFoQjtBQUNELEdBRkQsTUFFTyxJQUFJLEtBQUssUUFBTCxJQUFpQixPQUFqQixJQUE0QixDQUFDLEtBQUssSUFBdEMsRUFBNEM7QUFDakQsU0FBSyxNQUFMLEdBQWMsS0FBSyxJQUFuQjtBQUNELEdBRk0sTUFFQTtBQUNMLFNBQUssTUFBTCxHQUFjLEtBQUssUUFBTCxHQUFnQixJQUFoQixHQUF1QixLQUFLLElBQTFDO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFNLFNBQVUscUJBQVUsSUFBVixJQUFrQixPQUFPLE1BQTFCLEdBQW9DLE9BQU8sTUFBUCxDQUFjLElBQWQsQ0FBcEMsR0FBMEQsSUFBekU7O0FBRUEsTUFBSSxTQUFKLEVBQWU7QUFDYixjQUFVLEdBQVYsQ0FBYyxHQUFkLEVBQW1CLE1BQW5CO0FBQ0Q7O0FBRUQsU0FBTyxNQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyw2QkFBVCxDQUF1QyxHQUF2QyxFQUE0QyxXQUE1QyxFQUNMLGNBREssRUFDVztBQUNoQixNQUFJLENBQUMsV0FBTCxFQUFrQjtBQUNoQixXQUFPLEdBQVA7QUFDRDtBQUNELE1BQU0sa0JBQWtCLElBQUksS0FBSixDQUFVLEdBQVYsRUFBZSxDQUFmLENBQXhCO0FBQ0EsTUFBTSxlQUFlLGdCQUFnQixDQUFoQixFQUFtQixLQUFuQixDQUF5QixHQUF6QixFQUE4QixDQUE5QixDQUFyQjs7QUFFQSxNQUFJLFNBQVMsYUFBYSxDQUFiLEtBQ1gsYUFBYSxDQUFiLElBQ0ssdUJBQ0ssV0FETCxTQUNvQixhQUFhLENBQWIsQ0FEcEIsU0FFSyxhQUFhLENBQWIsQ0FGTCxTQUV3QixXQUg3QixTQUlRLFdBTEcsQ0FBYjtBQU1BLFlBQVUsZ0JBQWdCLENBQWhCLFVBQXlCLGdCQUFnQixDQUFoQixDQUF6QixHQUFnRCxFQUExRDtBQUNBLFNBQU8sTUFBUDtBQUNEO0FBQ0Q7Ozs7Ozs7OztBQVNPLFNBQVMsYUFBVCxDQUF1QixHQUF2QixFQUE0QixHQUE1QixFQUFpQyxLQUFqQyxFQUF3QyxjQUF4QyxFQUF3RDtBQUM3RCxNQUFNLFFBQVcsbUJBQW1CLEdBQW5CLENBQVgsU0FBc0MsbUJBQW1CLEtBQW5CLENBQTVDO0FBQ0EsU0FBTyw4QkFBOEIsR0FBOUIsRUFBbUMsS0FBbkMsRUFBMEMsY0FBMUMsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxjQUFULENBQXdCLEdBQXhCLEVBQTZCLE1BQTdCLEVBQXFDO0FBQzFDLFNBQU8sOEJBQThCLEdBQTlCLEVBQW1DLHFCQUFxQixNQUFyQixDQUFuQyxDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsb0JBQVQsQ0FBOEIsTUFBOUIsRUFBc0M7QUFDM0MsTUFBTSxJQUFJLEVBQVY7QUFDQSxPQUFLLElBQU0sQ0FBWCxJQUFnQixNQUFoQixFQUF3QjtBQUN0QixRQUFNLElBQUksT0FBTyxDQUFQLENBQVY7QUFDQSxRQUFJLEtBQUssSUFBVCxFQUFlO0FBQ2I7QUFDRCxLQUZELE1BRU8sSUFBSSxvQkFBUSxDQUFSLENBQUosRUFBZ0I7QUFDckIsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLEVBQUUsTUFBdEIsRUFBOEIsR0FBOUIsRUFBbUM7QUFDakMsWUFBTSxLQUFLLHFCQUF1QixFQUFFLENBQUYsQ0FBbEM7QUFDQSxVQUFFLElBQUYsQ0FBVSxtQkFBbUIsQ0FBbkIsQ0FBVixTQUFtQyxtQkFBbUIsRUFBbkIsQ0FBbkM7QUFDRDtBQUNGLEtBTE0sTUFLQTtBQUNMLFVBQU0sTUFBSyxxQkFBdUIsQ0FBbEM7QUFDQSxRQUFFLElBQUYsQ0FBVSxtQkFBbUIsQ0FBbkIsQ0FBVixTQUFtQyxtQkFBbUIsR0FBbkIsQ0FBbkM7QUFDRDtBQUNGO0FBQ0QsU0FBTyxFQUFFLElBQUYsQ0FBTyxHQUFQLENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLHFCQUFULENBQStCLEdBQS9CLEVBQW9DO0FBQ3pDLE1BQUksT0FBTyxHQUFQLElBQWMsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxtQkFBbUIsR0FBbkIsQ0FBTjtBQUNEO0FBQ0QsU0FBUSxJQUFJLFFBQUosSUFBZ0IsUUFBaEIsSUFDSixJQUFJLFFBQUosSUFBZ0IsV0FEWixJQUVKLHNCQUFTLElBQUksUUFBYixFQUF1QixZQUF2QixDQUZKO0FBR0Q7O0FBRUQ7Ozs7Ozs7Ozs7O0FBV08sU0FBUyxjQUFULENBQ0wsU0FESyxFQUNNLGNBRE4sRUFDNkM7QUFBQSxNQUF2QixVQUF1Qix1RUFBVixRQUFVOztBQUNsRCxtQkFBTyxNQUFQLENBQWMsYUFBYSxJQUEzQixFQUFpQyx5QkFBakMsRUFDSSxjQURKLEVBQ29CLFVBRHBCO0FBRUE7QUFDQSxNQUFNLGVBQWUscUJBQXVCLFNBQTVDO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLHNCQUFzQixZQUF0QixLQUF1QyxVQUFVLElBQVYsQ0FBZSxZQUFmLENBQXJELEVBQ0ksMkJBQ0Esb0RBREEsR0FFQSxtREFISixFQUlJLGNBSkosRUFJb0IsVUFKcEIsRUFJZ0MsWUFKaEM7QUFLQSxTQUFPLFlBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLDRCQUFULENBQXNDLFNBQXRDLEVBQWlEO0FBQ3RELG1CQUFPLE1BQVAsQ0FBYyxhQUFhLElBQWIsQ0FBa0IsU0FBbEIsQ0FBZCxFQUNJLGdFQURKLEVBRUksU0FGSjtBQUdBLFNBQU8sbUJBQW1CLFNBQW5CLEVBQThCLElBQXJDO0FBQ0Q7O0FBR0Q7Ozs7Ozs7Ozs7QUFVTyxTQUFTLGdCQUFULENBQTBCLFdBQTFCLEVBQXVDO0FBQzVDLFNBQU8sNENBQWtCLFdBQWxCLENBQVA7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxjQUFULENBQXdCLEdBQXhCLEVBQTZCO0FBQ2xDLE1BQU0sUUFBUSxJQUFJLE9BQUosQ0FBWSxHQUFaLENBQWQ7QUFDQSxNQUFJLFNBQVMsQ0FBQyxDQUFkLEVBQWlCO0FBQ2YsV0FBTyxHQUFQO0FBQ0Q7QUFDRCxTQUFPLElBQUksU0FBSixDQUFjLENBQWQsRUFBaUIsS0FBakIsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLFdBQVQsQ0FBcUIsR0FBckIsRUFBMEI7QUFDL0IsTUFBTSxRQUFRLElBQUksT0FBSixDQUFZLEdBQVosQ0FBZDtBQUNBLE1BQUksU0FBUyxDQUFDLENBQWQsRUFBaUI7QUFDZixXQUFPLEVBQVA7QUFDRDtBQUNELFNBQU8sSUFBSSxTQUFKLENBQWMsS0FBZCxDQUFQO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxhQUFULENBQXVCLEdBQXZCLEVBQTRCO0FBQ2pDLE1BQUksT0FBTyxHQUFQLElBQWMsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxtQkFBbUIsR0FBbkIsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxhQUFLLGFBQUwsQ0FBbUIsSUFBbkIsQ0FBd0IsSUFBSSxNQUE1QixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPTyxTQUFTLG1CQUFULENBQTZCLEdBQTdCLEVBQWtDO0FBQ3ZDLE1BQUksT0FBTyxHQUFQLElBQWMsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxtQkFBbUIsR0FBbkIsQ0FBTjtBQUNEO0FBQ0QsTUFBSSxDQUFDLGNBQWMsR0FBZCxDQUFMLEVBQXlCO0FBQ3ZCLFdBQU8sSUFBUDtBQUNEO0FBQ0QsTUFBTSxPQUFPLElBQUksUUFBSixDQUFhLEtBQWIsQ0FBbUIsR0FBbkIsRUFBd0IsQ0FBeEIsQ0FBYjtBQUNBLFNBQU8sS0FBSyxDQUFMLENBQVA7QUFDRDs7QUFFRDs7Ozs7QUFLTyxTQUFTLGlCQUFULENBQTJCLEdBQTNCLEVBQWdDO0FBQ3JDLE1BQUksT0FBTyxHQUFQLElBQWMsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxtQkFBbUIsR0FBbkIsQ0FBTjtBQUNEO0FBQ0QsU0FBTyxhQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBSSxNQUE3QixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1PLFNBQVMsZUFBVCxDQUF5QixHQUF6QixFQUE4QjtBQUNuQyxNQUFJLENBQUMsR0FBTCxFQUFVO0FBQ1IsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxNQUFJLE9BQU8sR0FBUCxJQUFjLFFBQWxCLEVBQTRCO0FBQzFCLFVBQU0sbUJBQW1CLEdBQW5CLENBQU47QUFDRDtBQUNELFNBQU8sQ0FBQyxrQkFBa0IsUUFBbEIsQ0FBMkIsSUFBSSxRQUEvQixDQUFSO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyx3QkFBVCxDQUFrQyxHQUFsQyxFQUF1QztBQUM1QyxNQUFNLFNBQVMsbUJBQW1CLEdBQW5CLENBQWY7QUFDQSxNQUFNLFNBQVMsNEJBQTRCLE9BQU8sTUFBbkMsQ0FBZjtBQUNBLFNBQU8sT0FBTyxNQUFQLEdBQWdCLE9BQU8sUUFBdkIsR0FBa0MsTUFBbEMsR0FBMkMsT0FBTyxJQUF6RDtBQUVEOztBQUVEOzs7OztBQUtPLFNBQVMsWUFBVCxDQUFzQixHQUF0QixFQUEyQjtBQUNoQyxNQUFNLFFBQVEsSUFBSSxPQUFKLENBQVksR0FBWixDQUFkO0FBQ0EsTUFBSSxTQUFTLENBQUMsQ0FBZCxFQUFpQjtBQUNmLFdBQU8sR0FBUDtBQUNEO0FBQ0QsTUFBTSxXQUFXLFlBQVksR0FBWixDQUFqQjtBQUNBLFNBQU8sSUFBSSxTQUFKLENBQWMsQ0FBZCxFQUFpQixLQUFqQixJQUEwQixRQUFqQztBQUNEOztBQUVEOzs7Ozs7QUFNQSxTQUFTLDJCQUFULENBQXFDLFNBQXJDLEVBQWdEO0FBQzlDLE1BQUksQ0FBQyxTQUFELElBQWMsYUFBYSxHQUEvQixFQUFvQztBQUNsQyxXQUFPLEVBQVA7QUFDRDtBQUNELE1BQU0sU0FBUyxVQUNWLE9BRFUsQ0FDRixtQkFERSxFQUNtQixFQURuQixFQUVWLE9BRlUsQ0FFRixvQkFGRSxFQUVvQixFQUZwQixFQUdWLE9BSFUsQ0FHRixrQkFIRSxFQUdrQixFQUhsQixFQUlWLE9BSlUsQ0FJRiw4QkFKRSxFQUk4QixFQUo5QixFQUtWLE9BTFUsQ0FLRixPQUxFLEVBS08sRUFMUCxDQUFmLENBSjhDLENBU25CO0FBQzNCLFNBQU8sU0FBUyxNQUFNLE1BQWYsR0FBd0IsRUFBL0I7QUFDRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxZQUFULENBQXNCLEdBQXRCLEVBQTJCO0FBQ2hDLE1BQUksT0FBTyxHQUFQLElBQWMsUUFBbEIsRUFBNEI7QUFDMUIsVUFBTSxtQkFBbUIsR0FBbkIsQ0FBTjtBQUNEOztBQUVEO0FBQ0EsTUFBSSxDQUFDLGNBQWMsR0FBZCxDQUFMLEVBQXlCO0FBQ3ZCLFdBQU8sSUFBSSxJQUFYO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLE9BQU8sSUFBSSxRQUFKLENBQWEsS0FBYixDQUFtQixHQUFuQixDQUFiO0FBQ0EsTUFBTSxTQUFTLEtBQUssQ0FBTCxDQUFmO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLG9CQUFvQixNQUFwQixDQUFkLEVBQ0ksK0JBREosRUFDcUMsSUFBSSxJQUR6QztBQUVBLE1BQU0sc0JBQXNCLEtBQUssQ0FBTCxDQUE1QjtBQUNBLE1BQU0sU0FBUyx1QkFBdUIsR0FBdkIsR0FDWCxhQUFhLG1CQUFtQixLQUFLLENBQUwsQ0FBbkIsQ0FERixHQUVYLFlBQVksbUJBQW1CLG1CQUFuQixDQUZoQjtBQUdBO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLE9BQU8sT0FBUCxDQUFlLEdBQWYsSUFBc0IsQ0FBcEMsRUFBdUMsMkJBQXZDLEVBQW9FLE1BQXBFO0FBQ0EsT0FBSyxNQUFMLENBQVksQ0FBWixFQUFlLHVCQUF1QixHQUF2QixHQUE2QixDQUE3QixHQUFpQyxDQUFoRDtBQUNBLFNBQU8sU0FBUyxLQUFLLElBQUwsQ0FBVSxHQUFWLENBQVQsR0FDSCw0QkFBNEIsSUFBSSxNQUFoQyxDQURHLElBQ3dDLElBQUksSUFBSixJQUFZLEVBRHBELENBQVA7QUFFRDs7QUFFRDs7Ozs7O0FBTU8sU0FBUyxlQUFULENBQXlCLEdBQXpCLEVBQThCO0FBQ25DLFNBQU8sbUJBQW1CLGFBQWEsR0FBYixDQUFuQixFQUFzQyxNQUE3QztBQUNEOztBQUVEOzs7Ozs7QUFNTyxTQUFTLGtCQUFULENBQTRCLGlCQUE1QixFQUErQyxPQUEvQyxFQUF3RDtBQUM3RCxNQUFJLE9BQU8sT0FBUCxJQUFrQixRQUF0QixFQUFnQztBQUM5QixjQUFVLG1CQUFtQixPQUFuQixDQUFWO0FBQ0Q7QUFDRCxNQUFJLE9BQU8sR0FBUCxJQUFjLFVBQWxCLEVBQThCO0FBQzVCLFdBQU8sSUFBSSxHQUFKLENBQVEsaUJBQVIsRUFBMkIsUUFBUSxJQUFuQyxFQUF5QyxRQUF6QyxFQUFQO0FBQ0Q7QUFDRCxTQUFPLDRCQUE0QixpQkFBNUIsRUFBK0MsT0FBL0MsQ0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUywyQkFBVCxDQUFxQyxpQkFBckMsRUFBd0QsT0FBeEQsRUFBaUU7QUFDdEUsTUFBSSxPQUFPLE9BQVAsSUFBa0IsUUFBdEIsRUFBZ0M7QUFDOUIsY0FBVSxtQkFBbUIsT0FBbkIsQ0FBVjtBQUNEO0FBQ0Qsc0JBQW9CLGtCQUFrQixPQUFsQixDQUEwQixLQUExQixFQUFpQyxHQUFqQyxDQUFwQjtBQUNBLE1BQU0sY0FBYyxtQkFBbUIsaUJBQW5CLENBQXBCOztBQUVBO0FBQ0EsTUFBSSx3QkFBVyxrQkFBa0IsV0FBbEIsRUFBWCxFQUE0QyxZQUFZLFFBQXhELENBQUosRUFBdUU7QUFDckUsV0FBTyxZQUFZLElBQW5CO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFJLHdCQUFXLGlCQUFYLEVBQThCLElBQTlCLENBQUosRUFBeUM7QUFDdkMsV0FBTyxRQUFRLFFBQVIsR0FBbUIsaUJBQTFCO0FBQ0Q7O0FBRUQ7QUFDQSxNQUFJLHdCQUFXLGlCQUFYLEVBQThCLEdBQTlCLENBQUosRUFBd0M7QUFDdEMsV0FBTyxRQUFRLE1BQVIsR0FBaUIsaUJBQXhCO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFPLFFBQVEsTUFBUixHQUFpQixRQUFRLFFBQVIsQ0FBaUIsT0FBakIsQ0FBeUIsVUFBekIsRUFBcUMsR0FBckMsQ0FBakIsR0FDRCxpQkFETjtBQUVEOztBQUdEOzs7Ozs7QUFNTyxTQUFTLFVBQVQsQ0FBb0IsR0FBcEIsRUFBeUIsR0FBekIsRUFBOEI7QUFDbkMsZUFBYSxHQUFiO0FBQ0EsTUFBTSxlQUFlLGdCQUFnQixJQUFJLFFBQUosQ0FBYSxJQUE3QixDQUFyQjtBQUNBLFNBQU8sY0FBYyxHQUFkLEVBQW1CLG1CQUFuQixFQUF3QyxZQUF4QyxDQUFQO0FBQ0Q7O0FBR0Q7Ozs7QUFJTyxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMkI7QUFDaEMsTUFBTSxZQUFZLG1CQUFtQixHQUFuQixDQUFsQjtBQUNBLE1BQU0sUUFBUSxpQkFBaUIsVUFBVSxNQUEzQixDQUFkO0FBQ0EsbUJBQU8sTUFBUCxDQUFjLEVBQUUsdUJBQXVCLEtBQXpCLENBQWQsRUFDSSxvQ0FESixFQUMwQyxHQUQxQztBQUVEOztBQUVEOzs7Ozs7OztBQVFPLFNBQVMscUJBQVQsQ0FBK0IsU0FBL0IsRUFBMEMsWUFBMUMsRUFBd0Q7QUFDN0QsU0FBTyxzREFBdUIsU0FBdkIsRUFBa0MsWUFBbEMsQ0FBUDtBQUNEOzs7Ozs7UUNuaUJlLGUsR0FBQSxlO1FBdUJBLFksR0FBQSxZO1FBK0JBLFMsR0FBQSxTO1FBZ0JBLFksR0FBQSxZO1FBZUEsYyxHQUFBLGM7QUFoSGhCOzs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBOzs7Ozs7Ozs7O0FBVU8sU0FBUyxlQUFULENBQXlCLElBQXpCLEVBQStCLElBQS9CLEVBQXFDO0FBQzFDLE1BQUksS0FBSyxNQUFMLEtBQWdCLEtBQUssTUFBekIsRUFBaUM7QUFDL0IsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsT0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLEtBQUssTUFBekIsRUFBaUMsR0FBakMsRUFBc0M7QUFDcEMsUUFBSSxLQUFLLENBQUwsTUFBWSxLQUFLLENBQUwsQ0FBaEIsRUFBeUI7QUFDdkIsYUFBTyxLQUFQO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPLElBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7O0FBU08sU0FBUyxZQUFULENBQXNCLEtBQXRCLEVBQTZCLE1BQTdCLEVBQXFDO0FBQzFDLE1BQU0sU0FBUyxFQUFmO0FBQ0EsTUFBSSxRQUFRLENBQVo7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksTUFBTSxNQUExQixFQUFrQyxHQUFsQyxFQUF1QztBQUNyQyxRQUFNLE9BQU8sTUFBTSxDQUFOLENBQWI7QUFDQSxRQUFJLE9BQU8sSUFBUCxFQUFhLENBQWIsRUFBZ0IsS0FBaEIsQ0FBSixFQUE0QjtBQUMxQixVQUFJLFFBQVEsQ0FBWixFQUFlO0FBQ2IsY0FBTSxLQUFOLElBQWUsSUFBZjtBQUNEO0FBQ0Q7QUFDRCxLQUxELE1BS087QUFDTCxhQUFPLElBQVAsQ0FBWSxJQUFaO0FBQ0Q7QUFDRjs7QUFFRCxNQUFJLFFBQVEsTUFBTSxNQUFsQixFQUEwQjtBQUN4QixVQUFNLE1BQU4sR0FBZSxLQUFmO0FBQ0Q7O0FBRUQsU0FBTyxNQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsU0FBVCxDQUFtQixLQUFuQixFQUEwQixTQUExQixFQUFxQztBQUMxQyxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksTUFBTSxNQUExQixFQUFrQyxHQUFsQyxFQUF1QztBQUNyQyxRQUFJLFVBQVUsTUFBTSxDQUFOLENBQVYsRUFBb0IsQ0FBcEIsRUFBdUIsS0FBdkIsQ0FBSixFQUFtQztBQUNqQyxhQUFPLENBQVA7QUFDRDtBQUNGO0FBQ0QsU0FBTyxDQUFDLENBQVI7QUFDRDs7QUFFRDs7Ozs7OztBQU9PLFNBQVMsWUFBVCxDQUFzQixRQUF0QixFQUFnQztBQUNyQyxNQUFNLFFBQVEsRUFBZDtBQUNBLE9BQUssSUFBSSxJQUFJLFNBQVMsSUFBVCxFQUFiLEVBQThCLENBQUMsRUFBRSxJQUFqQyxFQUF1QyxJQUFJLFNBQVMsSUFBVCxFQUEzQyxFQUE0RDtBQUMxRCxVQUFNLElBQU4sQ0FBVyxFQUFFLEtBQWI7QUFDRDtBQUNELFNBQU8sS0FBUDtBQUNEOztBQUVEOzs7Ozs7O0FBT08sU0FBUyxjQUFULENBQXdCLEtBQXhCLEVBQStCLElBQS9CLEVBQXFDO0FBQzFDLE1BQUksTUFBTSxPQUFOLENBQWMsSUFBZCxJQUFzQixDQUExQixFQUE2QjtBQUMzQixVQUFNLElBQU4sQ0FBVyxJQUFYO0FBQ0Q7QUFDRjs7Ozs7Ozs7cWpCQ3BIRDs7Ozs7Ozs7Ozs7Ozs7OztBQWdCQTs7OztBQUVBO0FBQ0EsSUFBTSxNQUFNLFdBQVo7O0FBRUE7Ozs7SUFHYSxRLFdBQUEsUTtBQUNYOzs7QUFHQSxvQkFBWSxRQUFaLEVBQXNCO0FBQUE7O0FBQ3BCO0FBQ0EsU0FBSyxTQUFMLEdBQWlCLFFBQWpCOztBQUVBO0FBQ0EsU0FBSyxLQUFMLEdBQWEsQ0FBYjs7QUFFQTs7OztBQUlBLFNBQUssT0FBTCxHQUFlLENBQWY7O0FBRUE7QUFDQSxTQUFLLE1BQUwsR0FBYyxPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQWQ7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozt3QkFNSSxHLEVBQUs7QUFDUCxhQUFPLENBQUMsQ0FBQyxLQUFLLE1BQUwsQ0FBWSxHQUFaLENBQVQ7QUFDRDs7QUFFRDs7Ozs7Ozt3QkFJSSxHLEVBQUs7QUFDUCxVQUFNLFlBQVksS0FBSyxNQUFMLENBQVksR0FBWixDQUFsQjtBQUNBLFVBQUksU0FBSixFQUFlO0FBQ2Isa0JBQVUsTUFBVixHQUFtQixFQUFFLEtBQUssT0FBMUI7QUFDQSxlQUFPLFVBQVUsT0FBakI7QUFDRDtBQUNELGFBQU8sU0FBUDtBQUNEOztBQUVEOzs7Ozs7O3dCQUlJLEcsRUFBSyxPLEVBQVM7QUFDaEIsVUFBSSxDQUFDLEtBQUssR0FBTCxDQUFTLEdBQVQsQ0FBTCxFQUFvQjtBQUNsQixhQUFLLEtBQUw7QUFDRDtBQUNELFdBQUssTUFBTCxDQUFZLEdBQVosSUFBbUIsRUFBQyxnQkFBRCxFQUFVLFFBQVEsS0FBSyxPQUF2QixFQUFuQjtBQUNBLFdBQUssTUFBTDtBQUNEOztBQUVEOzs7Ozs7NkJBR1M7QUFDUCxVQUFJLEtBQUssS0FBTCxJQUFjLEtBQUssU0FBdkIsRUFBa0M7QUFDaEM7QUFDRDs7QUFFRCxzQkFBTSxJQUFOLENBQVcsR0FBWCxFQUFnQixvQkFBaEI7QUFDQSxVQUFNLFFBQVEsS0FBSyxNQUFuQjtBQUNBLFVBQUksU0FBUyxLQUFLLE9BQUwsR0FBZSxDQUE1QjtBQUNBLFVBQUksa0JBQUo7QUFDQSxXQUFLLElBQU0sR0FBWCxJQUFrQixLQUFsQixFQUF5QjtBQUFBLFlBQ2hCLE1BRGdCLEdBQ04sTUFBTSxHQUFOLENBRE0sQ0FDaEIsTUFEZ0I7O0FBRXZCLFlBQUksU0FBUyxNQUFiLEVBQXFCO0FBQ25CLG1CQUFTLE1BQVQ7QUFDQSxzQkFBWSxHQUFaO0FBQ0Q7QUFDRjs7QUFFRCxVQUFJLGNBQWMsU0FBbEIsRUFBNkI7QUFDM0IsZUFBTyxNQUFNLFNBQU4sQ0FBUDtBQUNBLGFBQUssS0FBTDtBQUNEO0FBQ0Y7Ozs7Ozs7Ozs7UUMzRWEsRyxHQUFBLEc7UUFtQkEsSSxHQUFBLEk7UUFjQSxNLEdBQUEsTTtRQVlBLFcsR0FBQSxXO1FBbUJBLFMsR0FBQSxTO1FBNENBLEksR0FBQSxJOztBQXpIaEI7O0FBRUE7QUFDQSxJQUFNLFVBQVUsT0FBTyxTQUFQLENBQWlCLGNBQWpDOztBQUVBOzs7Ozs7OztBQXJCQTs7Ozs7Ozs7Ozs7Ozs7OztBQTZCTyxTQUFTLEdBQVQsQ0FBYSxXQUFiLEVBQTBCO0FBQy9CLE1BQU0sTUFBTSxPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQVo7QUFDQSxNQUFJLFdBQUosRUFBaUI7QUFDZixXQUFPLE1BQVAsQ0FBYyxHQUFkLEVBQW1CLFdBQW5CO0FBQ0Q7QUFDRCxTQUFPLEdBQVA7QUFDRDs7QUFFRDs7Ozs7Ozs7Ozs7QUFXTyxTQUFTLElBQVQsQ0FBYyxXQUFkLEVBQTJCO0FBQ2hDO0FBQ0E7QUFDQSxTQUFPLDJCQUE0QixlQUFlO0FBQWxEO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxNQUFULENBQWdCLEdBQWhCLEVBQXFCLEdBQXJCLEVBQTBCO0FBQy9CLFNBQU8sUUFBUSxJQUFSLENBQWEsR0FBYixFQUFrQixHQUFsQixDQUFQO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUU8sU0FBUyxXQUFULENBQXFCLEdBQXJCLEVBQTBCLEdBQTFCLEVBQStCO0FBQ3BDLE1BQUksT0FBTyxHQUFQLEVBQVksR0FBWixDQUFKLEVBQXNCO0FBQ3BCLFdBQU8sSUFBSSxHQUFKLENBQVA7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPLFNBQVA7QUFDRDtBQUNGOztBQUVEOzs7Ozs7Ozs7OztBQVdPLFNBQVMsU0FBVCxDQUFtQixNQUFuQixFQUEyQixNQUEzQixFQUErQztBQUFBLE1BQVosS0FBWSx1RUFBSixFQUFJOztBQUNwRDtBQUNBLE1BQU0sT0FBTyxFQUFiOztBQUVBO0FBQ0EsTUFBTSxRQUFRLEVBQWQ7QUFDQSxRQUFNLElBQU4sQ0FBVyxFQUFDLEdBQUcsTUFBSixFQUFZLEdBQUcsTUFBZixFQUF1QixHQUFHLENBQTFCLEVBQVg7O0FBRUE7O0FBUm9EO0FBQUEsdUJBVWhDLE1BQU0sS0FBTixFQVZnQztBQUFBLFFBVTNDLENBVjJDLGdCQVUzQyxDQVYyQztBQUFBLFFBVXhDLENBVndDLGdCQVV4QyxDQVZ3QztBQUFBLFFBVXJDLENBVnFDLGdCQVVyQyxDQVZxQzs7QUFXbEQsUUFBSSxLQUFLLFFBQUwsQ0FBYyxDQUFkLENBQUosRUFBc0I7QUFDcEIsWUFBTSxJQUFJLEtBQUosQ0FBVSx5Q0FBVixDQUFOO0FBQ0Q7QUFDRCxTQUFLLElBQUwsQ0FBVSxDQUFWO0FBQ0EsUUFBSSxNQUFNLENBQVYsRUFBYTtBQUNYO0FBQ0Q7QUFDRCxRQUFJLElBQUksS0FBUixFQUFlO0FBQ2IsYUFBTyxNQUFQLENBQWMsQ0FBZCxFQUFpQixDQUFqQjtBQUNBO0FBQ0Q7QUFDRCxXQUFPLElBQVAsQ0FBWSxDQUFaLEVBQWUsT0FBZixDQUF1QixlQUFPO0FBQzVCLFVBQU0sV0FBVyxFQUFFLEdBQUYsQ0FBakI7QUFDQTtBQUNBO0FBQ0EsVUFBSSxPQUFPLENBQVAsRUFBVSxHQUFWLENBQUosRUFBb0I7QUFDbEIsWUFBTSxXQUFXLEVBQUUsR0FBRixDQUFqQjtBQUNBLFlBQUkscUJBQVMsUUFBVCxLQUFzQixxQkFBUyxRQUFULENBQTFCLEVBQThDO0FBQzVDLGdCQUFNLElBQU4sQ0FBVyxFQUFDLEdBQUcsUUFBSixFQUFjLEdBQUcsUUFBakIsRUFBMkIsR0FBRyxJQUFJLENBQWxDLEVBQVg7QUFDQTtBQUNEO0FBQ0Y7QUFDRCxRQUFFLEdBQUYsSUFBUyxRQUFUO0FBQ0QsS0FaRDtBQXRCa0Q7O0FBU3BELFNBQU8sTUFBTSxNQUFOLEdBQWUsQ0FBdEIsRUFBeUI7QUFBQTs7QUFBQSw2QkFXckI7QUFlSDtBQUNELFNBQU8sTUFBUDtBQUNEOztBQUVEOzs7OztBQUtPLFNBQVMsSUFBVCxDQUFjLENBQWQsRUFBaUIsS0FBakIsRUFBd0I7QUFDN0IsU0FBTyxPQUFPLElBQVAsQ0FBWSxDQUFaLEVBQWUsTUFBZixDQUFzQixVQUFDLEdBQUQsRUFBTSxHQUFOLEVBQWM7QUFDekMsUUFBSSxDQUFDLE1BQU0sUUFBTixDQUFlLEdBQWYsQ0FBTCxFQUEwQjtBQUN4QixVQUFJLEdBQUosSUFBVyxFQUFFLEdBQUYsQ0FBWDtBQUNEO0FBQ0QsV0FBTyxHQUFQO0FBQ0QsR0FMTSxFQUtKLEVBTEksQ0FBUDtBQU1EOzs7Ozs7Ozs7UUN4RWUsVSxHQUFBLFU7UUFlQSxJLEdBQUEsSTs7OztBQXZGaEI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQXFCYSxRO0FBQ1g7OztRQURXLFEsR0FJWCxvQkFBYztBQUFBOztBQUNaLE1BQUksZ0JBQUo7QUFBQSxNQUFhLGVBQWI7O0FBRUE7OztBQUdBLE9BQUssT0FBTCxHQUFlLElBQUksTUFBTSxPQUFWLENBQWtCLFVBQUMsR0FBRCxFQUFNLEdBQU4sRUFBYztBQUM3QyxjQUFVLEdBQVY7QUFDQSxhQUFTLEdBQVQ7QUFDRCxHQUhjLENBQWY7O0FBS0E7OztBQUdBLE9BQUssT0FBTCxHQUFlLE9BQWY7O0FBRUE7OztBQUdBLE9BQUssTUFBTCxHQUFjLE1BQWQ7QUFDRCxDOztBQUdIOzs7Ozs7Ozs7O0FBUU8sU0FBUyxVQUFULENBQW9CLEVBQXBCLEVBQXdCO0FBQzdCLFNBQU8sSUFBSSxPQUFKLENBQVksbUJBQVc7QUFDNUIsWUFBUSxJQUFSO0FBQ0QsR0FGTSxDQUFQO0FBR0Q7O0FBRUQ7Ozs7Ozs7OztBQVNPLFNBQVMsSUFBVCxDQUFjLFFBQWQsRUFBbUM7QUFBQSxNQUFYLEtBQVcsdUVBQUgsQ0FBRzs7QUFDeEMsU0FBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3RDLFlBQVEsS0FBSyxHQUFMLENBQVMsS0FBVCxFQUFnQixDQUFoQixDQUFSO0FBQ0EsUUFBTSxRQUFRLFNBQVMsTUFBVCxHQUFrQixLQUFoQztBQUNBLFFBQUksUUFBUSxDQUFaLEVBQWU7QUFDYixhQUFPLElBQUksS0FBSixDQUFVLGdDQUFWLENBQVA7QUFDRDtBQUNELFFBQUksU0FBUyxNQUFULElBQW1CLENBQXZCLEVBQTBCO0FBQ3hCLGNBQVEsRUFBUjtBQUNEO0FBQ0QsUUFBTSxTQUFTLEVBQWY7QUFDQSxRQUFNLFVBQVUsRUFBaEI7O0FBRUEsUUFBTSxjQUFjLFNBQWQsV0FBYyxRQUFTO0FBQzNCLFVBQUksT0FBTyxNQUFQLEdBQWdCLEtBQXBCLEVBQTJCO0FBQ3pCLGVBQU8sSUFBUCxDQUFZLEtBQVo7QUFDRDtBQUNELFVBQUksT0FBTyxNQUFQLElBQWlCLEtBQXJCLEVBQTRCO0FBQzFCLGdCQUFRLE1BQVI7QUFDRDtBQUNGLEtBUEQ7QUFRQSxRQUFNLGFBQWEsU0FBYixVQUFhLFNBQVU7QUFDM0IsVUFBSSxRQUFRLE1BQVIsSUFBa0IsS0FBdEIsRUFBNkI7QUFDM0IsZ0JBQVEsSUFBUixDQUFhLE1BQWI7QUFDRDtBQUNELFVBQUksUUFBUSxNQUFSLEdBQWlCLEtBQXJCLEVBQTRCO0FBQzFCLGVBQU8sT0FBUDtBQUNEO0FBQ0YsS0FQRDtBQVFBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxTQUFTLE1BQTdCLEVBQXFDLEdBQXJDLEVBQTBDO0FBQ3hDLGNBQVEsT0FBUixDQUFnQixTQUFTLENBQVQsQ0FBaEIsRUFBNkIsSUFBN0IsQ0FBa0MsV0FBbEMsRUFBK0MsVUFBL0M7QUFDRDtBQUNGLEdBL0JNLENBQVA7QUFnQ0Q7O0FBRUQ7Ozs7O0lBSWEsaUIsV0FBQSxpQjtBQUNYOzs7QUFHQSw2QkFBWSxZQUFaLEVBQTBCO0FBQUE7O0FBQ3hCLFFBQUksaUJBQUo7QUFBQSxRQUFjLGdCQUFkO0FBQ0E7QUFDQSxTQUFLLFFBQUwsR0FBZ0IsSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUMvQyxpQkFBVyxPQUFYO0FBQ0EsZ0JBQVUsTUFBVjtBQUNELEtBSGUsQ0FBaEI7O0FBS0E7QUFDQSxTQUFLLFFBQUwsR0FBZ0IsUUFBaEI7O0FBRUE7QUFDQSxTQUFLLE9BQUwsR0FBZSxPQUFmOztBQUVBO0FBQ0EsU0FBSyxNQUFMLEdBQWMsQ0FBZDs7QUFFQSxRQUFJLFlBQUosRUFBa0I7QUFDaEIsV0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLGFBQWEsTUFBakMsRUFBeUMsR0FBekMsRUFBOEM7QUFDNUMsYUFBSyxHQUFMLENBQVMsYUFBYSxDQUFiLENBQVQ7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQ7Ozs7Ozs7Ozt3QkFLSSxPLEVBQVM7QUFBQTs7QUFDWCxVQUFNLGFBQWEsRUFBRSxLQUFLLE1BQTFCO0FBQ0EsY0FBUSxPQUFSLENBQWdCLE9BQWhCLEVBQXlCLElBQXpCLENBQThCLGtCQUFVO0FBQ3RDLFlBQUksTUFBSyxNQUFMLEtBQWdCLFVBQXBCLEVBQWdDO0FBQzlCLGdCQUFLLFFBQUwsQ0FBYyxNQUFkO0FBQ0Q7QUFDRixPQUpELEVBSUcsaUJBQVM7QUFDVjtBQUNBO0FBQ0EsWUFBSSxNQUFLLE1BQUwsS0FBZ0IsVUFBcEIsRUFBZ0M7QUFDOUIsZ0JBQUssT0FBTCxDQUFhLEtBQWI7QUFDRDtBQUNGLE9BVkQ7QUFXQSxhQUFPLEtBQUssUUFBWjtBQUNEOztBQUVEOzs7O3lCQUNLLFcsRUFBYSxVLEVBQVk7QUFDNUIsYUFBTyxLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLENBQVA7QUFDRDs7Ozs7Ozs7OztRQ25JYSxTLEdBQUEsUztBQS9DaEI7O0FBR0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLElBQUksUUFBUSx3RUFBWjs7QUFFQSxTQUFTLE9BQVQsQ0FBaUIsS0FBakIsRUFBd0IsR0FBeEIsRUFBNkIsSUFBN0IsRUFBbUMsU0FBbkMsRUFBOEMsS0FBOUMsRUFBcUQ7QUFDbkQ7QUFDQSxNQUFJLEtBQUosRUFBVztBQUNULFdBQU8sS0FBUDtBQUNEO0FBQ0Q7QUFDQSxNQUFJLEdBQUosRUFBUztBQUNQLFdBQU8sUUFBUDtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsTUFBSSxTQUFKLEVBQWU7QUFDYixXQUFPLE1BQU0sS0FBTixDQUFZLENBQVosRUFBZSxDQUFDLENBQWhCLElBQXFCLElBQXJCLEdBQTRCLE1BQU0sS0FBTixDQUFZLENBQUMsQ0FBYixFQUFnQixVQUFoQixDQUEyQixDQUEzQixFQUE4QixRQUE5QixDQUF1QyxFQUF2QyxDQUE1QixHQUF5RSxHQUFoRjtBQUNEO0FBQ0Q7QUFDQTtBQUNBLFNBQU8sT0FBTyxLQUFkO0FBQ0Q7O0FBRUQ7Ozs7O0FBS08sU0FBUyxTQUFULENBQW1CLEtBQW5CLEVBQTBCO0FBQy9CLFNBQU8sT0FBTyxLQUFQLEVBQWMsT0FBZCxDQUFzQixLQUF0QixFQUE2QixPQUE3QixDQUFQO0FBQ0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiZXhwb3J0IGNvbnN0IENTUyA9IFwiLmFtcC1hcGVzdGVyLWlmcmFtZXstd2Via2l0LXRyYW5zaXRpb246b3BhY2l0eSAwLjRzO3RyYW5zaXRpb246b3BhY2l0eSAwLjRzO29wYWNpdHk6MH0uaS1hbXBodG1sLWFwZXN0ZXItaWZyYW1lLXJlYWR5ey13ZWJraXQtdHJhbnNpdGlvbjpvcGFjaXR5IDFzIGVhc2Utb3V0O3RyYW5zaXRpb246b3BhY2l0eSAxcyBlYXNlLW91dDtvcGFjaXR5OjEhaW1wb3J0YW50fS5hbXAtYXBlc3Rlci1sb2FkZXJ7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9LmFtcC1hcGVzdGVyLWNvbnRhaW5lcnttYXgtd2lkdGg6NzAwcHg7bWFyZ2luOjAgYXV0bztkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCV9LmFtcC1hcGVzdGVyLW92ZXJmbG93e3Bvc2l0aW9uOmFic29sdXRlO21hcmdpbjphdXRvO3RvcDo1MCU7bGVmdDo1MCU7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSk7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpfS5hbXAtYXBlc3Rlci1vdmVyZmxvdyBidXR0b257Ym9yZGVyOm5vbmU7YmFja2dyb3VuZDojZmZmO2N1cnNvcjpwb2ludGVyO3BhZGRpbmc6MjVweCA4MHB4O3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzoxcHg7Zm9udC13ZWlnaHQ6NzAwO291dGxpbmU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZX0uYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2Jzey13ZWJraXQtZmlsdGVyOnVybCgjYW1wLWFwZXN0ZXItZ29vKTtmaWx0ZXI6dXJsKCNhbXAtYXBlc3Rlci1nb28pO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDtib3R0b206MDtyaWdodDowfS5hbXAtYXBlc3Rlci1sb2FkZXItYmxvYntwb3NpdGlvbjphYnNvbHV0ZTttYXJnaW46YXV0bzt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt3aWR0aDo1MHB4O2hlaWdodDo1MHB4O2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQtY29sb3I6I2VlMmUzZH0uYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2I6Zmlyc3QtY2hpbGR7LXdlYmtpdC1hbmltYXRpb246YW1wLWFwZXN0ZXItYmxvYi1sZWZ0LWFuaW0gY3ViaWMtYmV6aWVyKDAuNzcsMCwwLjE3NSwxKSAycyBpbmZpbml0ZTthbmltYXRpb246YW1wLWFwZXN0ZXItYmxvYi1sZWZ0LWFuaW0gY3ViaWMtYmV6aWVyKDAuNzcsMCwwLjE3NSwxKSAycyBpbmZpbml0ZX0uYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2I6bnRoLWNoaWxkKDIpey13ZWJraXQtYW5pbWF0aW9uOmFtcC1hcGVzdGVyLWJsb2ItcmlnaHQtYW5pbSBjdWJpYy1iZXppZXIoMC43NywwLDAuMTc1LDEpIDJzIGluZmluaXRlO2FuaW1hdGlvbjphbXAtYXBlc3Rlci1ibG9iLXJpZ2h0LWFuaW0gY3ViaWMtYmV6aWVyKDAuNzcsMCwwLjE3NSwxKSAycyBpbmZpbml0ZX1ALXdlYmtpdC1rZXlmcmFtZXMgYW1wLWFwZXN0ZXItYmxvYi1sZWZ0LWFuaW17MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKDApO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoMCl9MzMley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuNTUsMC41KSB0cmFuc2xhdGUoODBweCk7dHJhbnNmb3JtOnNjYWxlKDAuNTUsMC41KSB0cmFuc2xhdGUoODBweCl9NjYley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuOCkgdHJhbnNsYXRlKDApO3RyYW5zZm9ybTpzY2FsZSgwLjgpIHRyYW5zbGF0ZSgwKX10b3std2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoMCk7dHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKX19QGtleWZyYW1lcyBhbXAtYXBlc3Rlci1ibG9iLWxlZnQtYW5pbXswJXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoMCk7dHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKX0zMyV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMC41NSwwLjUpIHRyYW5zbGF0ZSg4MHB4KTt0cmFuc2Zvcm06c2NhbGUoMC41NSwwLjUpIHRyYW5zbGF0ZSg4MHB4KX02NiV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMC44KSB0cmFuc2xhdGUoMCk7dHJhbnNmb3JtOnNjYWxlKDAuOCkgdHJhbnNsYXRlKDApfXRvey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKDApfX1ALXdlYmtpdC1rZXlmcmFtZXMgYW1wLWFwZXN0ZXItYmxvYi1yaWdodC1hbmltezAley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKDApfTMzJXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgwLjU1LDAuNSkgdHJhbnNsYXRlKC04MHB4KTt0cmFuc2Zvcm06c2NhbGUoMC41NSwwLjUpIHRyYW5zbGF0ZSgtODBweCl9NjYley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuOCkgdHJhbnNsYXRlKDApO3RyYW5zZm9ybTpzY2FsZSgwLjgpIHRyYW5zbGF0ZSgwKX10b3std2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoMCk7dHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKX19QGtleWZyYW1lcyBhbXAtYXBlc3Rlci1ibG9iLXJpZ2h0LWFuaW17MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKDApO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoMCl9MzMley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuNTUsMC41KSB0cmFuc2xhdGUoLTgwcHgpO3RyYW5zZm9ybTpzY2FsZSgwLjU1LDAuNSkgdHJhbnNsYXRlKC04MHB4KX02NiV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMC44KSB0cmFuc2xhdGUoMCk7dHJhbnNmb3JtOnNjYWxlKDAuOCkgdHJhbnNsYXRlKDApfXRvey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgwKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKDApfX1ALXdlYmtpdC1rZXlmcmFtZXMgYW1wLWFwZXN0ZXItbG9hZGVyLWxvZ297MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSk7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0yMCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSk7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MH00MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMC41KTt0cmFuc2Zvcm06c2NhbGUoMC41KTtvcGFjaXR5OjB9NjYley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuOCk7dHJhbnNmb3JtOnNjYWxlKDAuOCk7b3BhY2l0eToxfXRvey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpO3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgYW1wLWFwZXN0ZXItbG9hZGVyLWxvZ297MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSk7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0yMCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSk7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MH00MCV7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMC41KTt0cmFuc2Zvcm06c2NhbGUoMC41KTtvcGFjaXR5OjB9NjYley13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDAuOCk7dHJhbnNmb3JtOnNjYWxlKDAuOCk7b3BhY2l0eToxfXRvey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpO3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9fS5hbXAtYXBlc3Rlci1sb2FkZXItbG9nb3tiYWNrZ3JvdW5kOnVybChodHRwczovL2FwcC5hcGVzdGVyLmNvbS9hc3NldHMvZWRpdG9yLzMuNC4xMC9kaXN0L3N2Zy9hcGUtbG9hZGVyLnN2Zykgbm8tcmVwZWF0IDUwJTtwb3NpdGlvbjphYnNvbHV0ZTtoZWlnaHQ6MjhweDt3aWR0aDoyOHB4O2xlZnQ6Y2FsYyg1MCUgLSAxNHB4KTt0b3A6Y2FsYyg1MCUgLSAxNHB4KX0uYW1wLWFwZXN0ZXItbG9hZGVyLWxvZ28gc3Zne2hlaWdodDoxMDAlO3dpZHRoOjEwMCV9LmFtcC1hcGVzdGVyLWZ1bGxzY3JlZW57YmFja2dyb3VuZDpyZ2JhKDM0LDM2LDM4LDAuOTcpIWltcG9ydGFudDtwb3NpdGlvbjpmaXhlZCFpbXBvcnRhbnQ7d2lkdGg6MTAwdnchaW1wb3J0YW50O2hlaWdodDoxMDB2aCFpbXBvcnRhbnQ7ei1pbmRleDoyMTQ3NDgzNjQ2IWltcG9ydGFudDt0b3A6MDt6b29tOjE7LXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6dG91Y2ghaW1wb3J0YW50fVxcbi8qIyBzb3VyY2VVUkw9L2V4dGVuc2lvbnMvYW1wLWFwZXN0ZXItbWVkaWEvMC4xL2FtcC1hcGVzdGVyLW1lZGlhLmNzcyovXCI7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7Q1NTfSBmcm9tICcuLi8uLi8uLi9idWlsZC9hbXAtYXBlc3Rlci1tZWRpYS0wLjEuY3NzJztcbmltcG9ydCB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJBcGl9IGZyb20gJy4uLy4uLy4uL3NyYy9pbnRlcnNlY3Rpb24tb2JzZXJ2ZXItcG9seWZpbGwnO1xuaW1wb3J0IHtTZXJ2aWNlc30gZnJvbSAnLi4vLi4vLi4vc3JjL3NlcnZpY2VzJztcbmltcG9ydCB7YWRkUGFyYW1zVG9Vcmx9IGZyb20gJy4uLy4uLy4uL3NyYy91cmwnO1xuaW1wb3J0IHtkZXYsIHVzZXJ9IGZyb20gJy4uLy4uLy4uL3NyYy9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuLi8uLi8uLi9zcmMvdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7XG4gIGV4dHJhY3RUYWdzLFxuICBnZXRQbGF0Zm9ybSxcbiAgcmVnaXN0ZXJFdmVudCxcbiAgc2V0RnVsbHNjcmVlbk9mZixcbiAgc2V0RnVsbHNjcmVlbk9uLFxufSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7Z2V0TGVuZ3RoTnVtZXJhbCwgaXNMYXlvdXRTaXplRGVmaW5lZH0gZnJvbSAnLi4vLi4vLi4vc3JjL2xheW91dCc7XG5pbXBvcnQge3JlbW92ZUVsZW1lbnR9IGZyb20gJy4uLy4uLy4uL3NyYy9kb20nO1xuXG4vKiogQGNvbnN0ICovXG5jb25zdCBUQUcgPSAnYW1wLWFwZXN0ZXItbWVkaWEnO1xuLyoqXG4gKiBAZW51bSB7c3RyaW5nfVxuICovXG5jb25zdCBhcGVzdGVyRXZlbnROYW1lcyA9IHtcbiAgU0VUX0ZVTExfU0NSRUVOOiAnZnVsbHNjcmVlbl9vbicsXG4gIFJFTU9WRV9GVUxMX1NDUkVFTjogJ2Z1bGxzY3JlZW5fb2ZmJyxcbiAgUkVTSVpFX1VOSVQ6ICdhcGVzdGVyX3Jlc2l6ZV91bml0Jyxcbn07XG5cbi8qKlxuICogQU1QIEFwZXN0ZXItbWVkaWFcbiAqL1xuY2xhc3MgQW1wQXBlc3Rlck1lZGlhIGV4dGVuZHMgQU1QLkJhc2VFbGVtZW50IHtcbiAgLyoqIEBwYXJhbSB7IUFtcEVsZW1lbnR9IGVsZW1lbnQgKi9cbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHN1cGVyKGVsZW1lbnQpO1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMucmVuZGVyZXJCYXNlVXJsXyA9ICdodHRwczovL3JlbmRlcmVyLmFwZXN0ZXIuY29tJztcbiAgICAvKipcbiAgICAgKiBAY29uc3QgQHByaXZhdGUge3N0cmluZ31cbiAgICAgKi9cbiAgICB0aGlzLmRpc3BsYXlCYXNlVXJsXyA9ICdodHRwczovL2Rpc3BsYXkuYXBlc3Rlci5jb20nO1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMuc3RhdGljQ29udGVudF8gPSAnaHR0cHM6Ly9zdGF0aWMucW1lcmNlLmNvbSc7XG4gICAgLyoqXG4gICAgICogQGNvbnN0IEBwcml2YXRlIHtzdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5sb2FkZXJVcmxfID0gJ2h0dHBzOi8vaW1hZ2VzLmFwZXN0ZXIuY29tL2ltYWdlcyUyRmxvYWRlci5naWYnO1xuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gICovXG4gICAgdGhpcy5zZWVuXyA9IGZhbHNlO1xuICAgIC8qKiBAcHJpdmF0ZSB7P0VsZW1lbnR9ICAqL1xuICAgIHRoaXMuaWZyYW1lXyA9IG51bGw7XG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAgKi9cbiAgICB0aGlzLnJlYWR5XyA9IGZhbHNlO1xuICAgIC8qKiBAcHJpdmF0ZSB7P251bWJlcnx1bmRlZmluZWR9ICAqL1xuICAgIHRoaXMud2lkdGhfID0gbnVsbDtcbiAgICAvKiogQHByaXZhdGUgez9udW1iZXJ8dW5kZWZpbmVkfSAgKi9cbiAgICB0aGlzLmhlaWdodF8gPSBudWxsO1xuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gICovXG4gICAgdGhpcy5yYW5kb21fID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgez9zdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5tZWRpYUF0dHJpYnV0ZV8gPSBudWxsO1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIHshT2JqZWN0fVxuICAgICAqL1xuICAgIHRoaXMuZW1iZWRPcHRpb25zXyA9IHt9O1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlIHs/c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMubWVkaWFJZF8gPSBudWxsO1xuICAgIC8qKiBAcHJpdmF0ZSB7QXJyYXk8RnVuY3Rpb24+fSAqL1xuICAgIHRoaXMudW5saXN0ZW5lcnNfID0gW107XG4gICAgLyoqIEBwcml2YXRlIHs/SW50ZXJzZWN0aW9uT2JzZXJ2ZXJBcGl9ICovXG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlckFwaV8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9uTGF5b3V0XG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgcHJlY29ubmVjdENhbGxiYWNrKG9uTGF5b3V0KSB7XG4gICAgdGhpcy5wcmVjb25uZWN0LnVybCh0aGlzLmRpc3BsYXlCYXNlVXJsXywgb25MYXlvdXQpO1xuICAgIHRoaXMucHJlY29ubmVjdC51cmwodGhpcy5yZW5kZXJlckJhc2VVcmxfLCBvbkxheW91dCk7XG4gICAgdGhpcy5wcmVjb25uZWN0LnVybCh0aGlzLnN0YXRpY0NvbnRlbnRfLCBvbkxheW91dCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGlzTGF5b3V0U3VwcG9ydGVkKGxheW91dCkge1xuICAgIHJldHVybiBpc0xheW91dFNpemVEZWZpbmVkKGxheW91dCk7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIHZpZXdwb3J0Q2FsbGJhY2soaW5WaWV3cG9ydCkge1xuICAgIGlmICh0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyQXBpXykge1xuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlckFwaV8ub25WaWV3cG9ydENhbGxiYWNrKGluVmlld3BvcnQpO1xuICAgIH1cbiAgICBpZiAoaW5WaWV3cG9ydCAmJiAhdGhpcy5zZWVuXykge1xuICAgICAgaWYgKHRoaXMuaWZyYW1lXyAmJiB0aGlzLmlmcmFtZV8uY29udGVudFdpbmRvdykge1xuICAgICAgICBkZXYoKS5maW5lKFRBRywgJ21lZGlhIHNlZW4nKTtcbiAgICAgICAgdGhpcy5zZWVuXyA9IHRydWU7XG4gICAgICAgIHRoaXMuaWZyYW1lXy5jb250ZW50V2luZG93Li8qT0sqLyBwb3N0TWVzc2FnZSgnaW50ZXJhY3Rpb24gc2VlbicsICcqJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLmdldFBsYWNlaG9sZGVyKCkgJiYgIXRoaXMucmVhZHlfKSB7XG4gICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKGluVmlld3BvcnQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgYnVpbGRDYWxsYmFjaygpIHtcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3dpZHRoJyk7XG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0Jyk7XG4gICAgdGhpcy53aWR0aF8gPSBnZXRMZW5ndGhOdW1lcmFsKHdpZHRoKTtcbiAgICB0aGlzLmhlaWdodF8gPSBnZXRMZW5ndGhOdW1lcmFsKGhlaWdodCk7XG4gICAgdGhpcy5yYW5kb21fID0gZmFsc2U7XG4gICAgdGhpcy5tZWRpYUF0dHJpYnV0ZV8gPSB1c2VyKCkuYXNzZXJ0KFxuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFwZXN0ZXItbWVkaWEtaWQnKSB8fFxuICAgICAgICAodGhpcy5yYW5kb21fID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShcbiAgICAgICAgICAgICdkYXRhLWFwZXN0ZXItY2hhbm5lbC10b2tlbidcbiAgICAgICAgKSksXG4gICAgICAgICdFaXRoZXIgdGhlIGRhdGEtYXBlc3Rlci1tZWRpYS1pZCBvciB0aGUgZGF0YS1hcGVzdGVyLWNoYW5uZWwtdG9rZW4gJyArXG4gICAgICAgICdhdHRyaWJ1dGVzIG11c3QgYmUgc3BlY2lmaWVkIGZvciA8YW1wLWFwZXN0ZXItbWVkaWE+ICVzJyxcbiAgICAgICAgdGhpcy5lbGVtZW50XG4gICAgKTtcbiAgICB0aGlzLmVtYmVkT3B0aW9uc18gPSB7XG4gICAgICBwbGF5bGlzdDogdGhpcy5yYW5kb21fLFxuICAgICAgaWRPclRva2VuOiB0aGlzLm1lZGlhQXR0cmlidXRlXyxcbiAgICAgIGluYXRpdmU6IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYXBlc3Rlci1pbmF0aXZlJykgPT09ICd0cnVlJyxcbiAgICAgIGZhbGxiYWNrOiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWFwZXN0ZXItZmFsbGJhY2snKSxcbiAgICAgIGRpc3RyaWJ1dGlvbkNoYW5uZWxJZDogdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShcbiAgICAgICAgICAnZGF0YS1hcGVzdGVyLWNoYW5uZWwtaWQnXG4gICAgICApLFxuICAgICAgcmVuZGVyZXI6IHRydWUsXG4gICAgICB0YWdzOiBleHRyYWN0VGFncyh0aGlzLmVsZW1lbnQpLFxuICAgIH07XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGZpcnN0TGF5b3V0Q29tcGxldGVkKCkge1xuICAgIHRoaXMudmlld3BvcnRDYWxsYmFjayh0aGlzLmlzSW5WaWV3cG9ydCgpKTtcbiAgICAvLyBEbyBub3QgaGlkZSBwbGFjZWhvbGRlclxuICB9XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgb25MYXlvdXRNZWFzdXJlKCkge1xuICAgIGlmICh0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyQXBpXykge1xuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlckFwaV8uZmlyZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqKi9cbiAgYnVpbGRVcmxfKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGlkT3JUb2tlbixcbiAgICAgIHBsYXlsaXN0LFxuICAgICAgaW5hdGl2ZSxcbiAgICAgIGRpc3RyaWJ1dGlvbkNoYW5uZWxJZCxcbiAgICAgIGZhbGxiYWNrLFxuICAgICAgdGFncyxcbiAgICB9ID0gdGhpcy5lbWJlZE9wdGlvbnNfO1xuICAgIGNvbnN0IGVuY29kZWRNZWRpYUF0dHJpYnV0ZSA9IGVuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgZGV2KCkuYXNzZXJ0U3RyaW5nKHRoaXMubWVkaWFBdHRyaWJ1dGVfKVxuICAgICk7XG4gICAgbGV0IHN1ZmZpeCA9ICcnO1xuICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0gZGljdCgpO1xuICAgIHF1ZXJ5UGFyYW1zWydyZW5kZXJlciddID0gZmFsc2U7XG4gICAgcXVlcnlQYXJhbXNbJ3BsYXRmb3JtJ10gPSBnZXRQbGF0Zm9ybSgpO1xuICAgIGlmIChpbmF0aXZlKSB7XG4gICAgICBpZiAoaWRPclRva2VuKSB7XG4gICAgICAgIHN1ZmZpeCA9IGAvaW5hdGl2ZXMvJHtpZE9yVG9rZW59YDtcbiAgICAgIH0gZWxzZSBpZiAoZGlzdHJpYnV0aW9uQ2hhbm5lbElkKSB7XG4gICAgICAgIHN1ZmZpeCA9IGAvY2hhbm5lbHMvJHtkaXN0cmlidXRpb25DaGFubmVsSWR9L2luYXRpdmVzYDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHBsYXlsaXN0ICYmIHRhZ3MpIHtcbiAgICAgIHN1ZmZpeCA9IGAvdG9rZW5zLyR7ZW5jb2RlZE1lZGlhQXR0cmlidXRlfS9pbnRlcmFjdGlvbnMvcmFuZG9tYDtcbiAgICAgIHF1ZXJ5UGFyYW1zWyd0YWdzJ10gPSB0YWdzO1xuICAgICAgcXVlcnlQYXJhbXNbJ2ZhbGxiYWNrJ10gPSAhIWZhbGxiYWNrO1xuICAgIH0gZWxzZSBpZiAocGxheWxpc3QpIHtcbiAgICAgIHN1ZmZpeCA9IGAvdG9rZW5zLyR7ZW5jb2RlZE1lZGlhQXR0cmlidXRlfS9pbnRlcmFjdGlvbnMvcmFuZG9tYDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VmZml4ID0gYC9pbnRlcmFjdGlvbnMvJHtlbmNvZGVkTWVkaWFBdHRyaWJ1dGV9L2Rpc3BsYXlgO1xuICAgIH1cbiAgICByZXR1cm4gYWRkUGFyYW1zVG9VcmwoYCR7dGhpcy5kaXNwbGF5QmFzZVVybF99JHtzdWZmaXh9YCwgcXVlcnlQYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCFKc29uT2JqZWN0Pn1cbiAgICoqL1xuICBxdWVyeU1lZGlhXygpIHtcbiAgICBjb25zdCB1cmwgPSB0aGlzLmJ1aWxkVXJsXygpO1xuICAgIHJldHVybiBTZXJ2aWNlcy54aHJGb3IodGhpcy53aW4pXG4gICAgICAgIC5mZXRjaEpzb24odXJsLCB7XG4gICAgICAgICAgcmVxdWlyZUFtcFJlc3BvbnNlU291cmNlT3JpZ2luOiBmYWxzZSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpO1xuICB9XG5cbiAgLyoqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqICovXG4gIGNvbnN0cnVjdFVybEZyb21NZWRpYV8oaWQpIHtcbiAgICBjb25zdCBxdWVyeVBhcmFtcyA9IGRpY3QoKTtcbiAgICBxdWVyeVBhcmFtc1snY2hhbm5lbElkJ10gPSB0aGlzLmVtYmVkT3B0aW9uc18uZGlzdHJpYnV0aW9uQ2hhbm5lbElkO1xuICAgIHF1ZXJ5UGFyYW1zWyd0eXBlJ10gPSB0aGlzLmVtYmVkT3B0aW9uc18ucGxheWxpc3RcbiAgICAgID8gJ3BsYXlsaXN0J1xuICAgICAgOiAnZWRpdG9yaWFsJztcbiAgICBxdWVyeVBhcmFtc1sncGxhdGZvcm0nXSA9IGdldFBsYXRmb3JtKCk7XG4gICAgcXVlcnlQYXJhbXNbJ2Nhbm5vbmljYWxVcmwnXSA9IFNlcnZpY2VzLmRvY3VtZW50SW5mb0ZvckRvYyhcbiAgICAgICAgdGhpcy5lbGVtZW50XG4gICAgKS5jYW5vbmljYWxVcmw7XG4gICAgcXVlcnlQYXJhbXNbJ3NkayddID0gJ2FtcCc7XG5cbiAgICByZXR1cm4gYWRkUGFyYW1zVG9VcmwoXG4gICAgICAgIGAke3RoaXMucmVuZGVyZXJCYXNlVXJsX30vaW50ZXJhY3Rpb24vJHtlbmNvZGVVUklDb21wb25lbnQoaWQpfWAsXG4gICAgICAgIHF1ZXJ5UGFyYW1zXG4gICAgKTtcbiAgfVxuXG4gIC8qKiBAcGFyYW0ge3N0cmluZ30gc3JjXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKi9cbiAgY29uc3RydWN0SWZyYW1lXyhzcmMpIHtcbiAgICBjb25zdCBpZnJhbWUgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdmcmFtZWJvcmRlcicsICcwJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3d0cmFuc3BhcmVuY3knLCAndHJ1ZScpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3Njcm9sbGluZycsICdubycpO1xuICAgIGlmcmFtZS5zcmMgPSBzcmM7XG4gICAgaWZyYW1lLm5hbWUgPSB0aGlzLndpbi5sb2NhdGlvbi5ocmVmO1xuICAgIGlmcmFtZS5oZWlnaHQgPSB0aGlzLmhlaWdodF87XG4gICAgaWZyYW1lLndpZHRoID0gdGhpcy53aWR0aF87XG4gICAgaWZyYW1lLmNsYXNzTGlzdC5hZGQoJ2FtcC1hcGVzdGVyLWlmcmFtZScpO1xuICAgIHRoaXMuYXBwbHlGaWxsQ29udGVudChpZnJhbWUpO1xuICAgIHJldHVybiBpZnJhbWU7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUVsZW1lbnR9XG4gICAqL1xuICBjb25zdHJ1Y3RMb2FkZXJTdHJ1Y3R1cmVfKCkge1xuICAgIGNvbnN0IGJsb2JzID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgYmxvYkxlZnQgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBibG9iUmlnaHQgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBsb2dvID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYmxvYnMuY2xhc3NMaXN0LmFkZCgnYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2JzJyk7XG4gICAgYmxvYkxlZnQuY2xhc3NMaXN0LmFkZCgnYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2InKTtcbiAgICBibG9iUmlnaHQuY2xhc3NMaXN0LmFkZCgnYW1wLWFwZXN0ZXItbG9hZGVyLWJsb2InKTtcbiAgICBsb2dvLmNsYXNzTGlzdC5hZGQoJ2FtcC1hcGVzdGVyLWxvYWRlci1sb2dvJyk7XG4gICAgYmxvYnMuYXBwZW5kQ2hpbGQoYmxvYkxlZnQpO1xuICAgIGJsb2JzLmFwcGVuZENoaWxkKGJsb2JSaWdodCk7XG4gICAgYmxvYnMuYXBwZW5kQ2hpbGQobG9nbyk7XG4gICAgcmV0dXJuIGJsb2JzO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFFbGVtZW50fVxuICAgKi9cbiAgY29uc3RydWN0TG9hZGVyU1ZHXygpIHtcbiAgICBjb25zdCBzdmcgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdmcnKTtcbiAgICBjb25zdCBkZWZzID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGVmcycpO1xuICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ZpbHRlcicpO1xuICAgIGNvbnN0IGZlR2F1c3NpYW5CbHVyID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgJ2ZlR2F1c3NpYW5CbHVyJ1xuICAgICk7XG4gICAgY29uc3QgZmVDb2xvck1hdHJpeCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICdmZUNvbG9yTWF0cml4J1xuICAgICk7XG4gICAgY29uc3QgZmVCbGVuZCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ZlQmxlbmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2ZXJzaW9uJywgJzEuMScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3htbG5zJywgJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyk7XG4gICAgZmlsdGVyLnNldEF0dHJpYnV0ZSgnaWQnLCAnYW1wLWFwZXN0ZXItZ29vJyk7XG4gICAgZmVHYXVzc2lhbkJsdXIuc2V0QXR0cmlidXRlKCdpbicsICdTb3VyY2VHcmFwaGljJyk7XG4gICAgZmVHYXVzc2lhbkJsdXIuc2V0QXR0cmlidXRlKCdyZXN1bHRzJywgJ2JsdXInKTtcbiAgICBmZUdhdXNzaWFuQmx1ci5zZXRBdHRyaWJ1dGUoJ3N0ZERldmlhdGlvbicsICcxMCcpO1xuICAgIGZlQ29sb3JNYXRyaXguc2V0QXR0cmlidXRlKCdpbicsICdibHVyJyk7XG4gICAgZmVDb2xvck1hdHJpeC5zZXRBdHRyaWJ1dGUoJ21vZGUnLCAnbWF0cml4Jyk7XG4gICAgZmVDb2xvck1hdHJpeC5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICd2YWx1ZXMnLFxuICAgICAgICAnMSAwIDAgMCAwICAwIDEgMCAwIDAgIDAgMCAxIDAgMCAgMCAwIDAgMTggLTcnXG4gICAgKTtcbiAgICBmZUNvbG9yTWF0cml4LnNldEF0dHJpYnV0ZSgncmVzdWx0JywgJ2FtcC1hcGVzdGVyLWdvbycpO1xuICAgIGZlQmxlbmQuc2V0QXR0cmlidXRlKCdpbjInLCAnYW1wLWFwZXN0ZXItZ29vJyk7XG4gICAgZmVCbGVuZC5zZXRBdHRyaWJ1dGUoJ2luJywgJ1NvdXJjZUdyYXBoaWMnKTtcbiAgICBmZUJsZW5kLnNldEF0dHJpYnV0ZSgncmVzdWx0JywgJ21peCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChkZWZzKTtcbiAgICBkZWZzLmFwcGVuZENoaWxkKGZpbHRlcik7XG4gICAgZmlsdGVyLmFwcGVuZENoaWxkKGZlR2F1c3NpYW5CbHVyKTtcbiAgICBmaWx0ZXIuYXBwZW5kQ2hpbGQoZmVDb2xvck1hdHJpeCk7XG4gICAgZmlsdGVyLmFwcGVuZENoaWxkKGZlQmxlbmQpO1xuICAgIHJldHVybiBzdmc7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUVsZW1lbnR9XG4gICAqL1xuICBjb25zdHJ1Y3RPdmVyZmxvd18oKSB7XG4gICAgY29uc3Qgb3ZlcmZsb3cgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBvdmVyZmxvdy5zZXRBdHRyaWJ1dGUoJ292ZXJmbG93JywgJycpO1xuICAgIG92ZXJmbG93LmNsYXNzTmFtZSA9ICdhbXAtYXBlc3Rlci1vdmVyZmxvdyc7XG4gICAgY29uc3Qgb3ZlcmZsb3dCdXR0b24gPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBvdmVyZmxvd0J1dHRvbi50ZXh0Q29udGVudCA9ICdGdWxsIFNpemUnO1xuICAgIG92ZXJmbG93LmFwcGVuZENoaWxkKG92ZXJmbG93QnV0dG9uKTtcbiAgICByZXR1cm4gb3ZlcmZsb3c7XG4gIH1cblxuICAvKiogQG92ZXJyaWRlICovXG4gIGxheW91dENhbGxiYWNrKCkge1xuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhbXAtYXBlc3Rlci1jb250YWluZXInKTtcbiAgICBjb25zdCB2c3luYyA9IFNlcnZpY2VzLnZzeW5jRm9yKHRoaXMud2luKTtcbiAgICByZXR1cm4gdGhpcy5xdWVyeU1lZGlhXygpLnRoZW4oXG4gICAgICAgIHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBjb25zdCBwYXlsb2FkID0gcmVzcG9uc2VbJ3BheWxvYWQnXTtcbiAgICAgICAgICAvLyBJZiBpdCdzIGEgcGxheWxpc3Qgd2UgY2hvb3NlIGEgbWVkaWEgcmFuZG9tbHkuXG4gICAgICAgICAgLy8gVGhlIHJlc3BvbnNlIHdpbGwgYmUgYW4gYXJyYXkuXG4gICAgICAgICAgY29uc3QgbWVkaWEgPSAvKiogQHR5cGUge0pzb25PYmplY3R9ICovICh0aGlzLmVtYmVkT3B0aW9uc18ucGxheWxpc3RcbiAgICAgICAgICAgID8gcGF5bG9hZFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwYXlsb2FkLmxlbmd0aCldXG4gICAgICAgICAgICA6IHBheWxvYWQpO1xuICAgICAgICAgIGNvbnN0IHNyYyA9IHRoaXMuY29uc3RydWN0VXJsRnJvbU1lZGlhXyhtZWRpYVsnaW50ZXJhY3Rpb25JZCddKTtcbiAgICAgICAgICBjb25zdCBpZnJhbWUgPSB0aGlzLmNvbnN0cnVjdElmcmFtZV8oc3JjKTtcbiAgICAgICAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyQXBpXyA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlckFwaShcbiAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgaWZyYW1lXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHRoaXMubWVkaWFJZF8gPSBtZWRpYVsnaW50ZXJhY3Rpb25JZCddO1xuICAgICAgICAgIHRoaXMuaWZyYW1lXyA9IGlmcmFtZTtcbiAgICAgICAgICB0aGlzLnJlZ2lzdGVyVG9BcGVzdGVyRXZlbnRzXygpO1xuXG4gICAgICAgICAgcmV0dXJuIHZzeW5jLm11dGF0ZVByb21pc2UoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3ZlcmZsb3cgPSB0aGlzLmNvbnN0cnVjdE92ZXJmbG93XygpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKG92ZXJmbG93KTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZFByb21pc2UoaWZyYW1lKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZzeW5jLm11dGF0ZVByb21pc2UoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lXy5jbGFzc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgLmFkZCgnaS1hbXBodG1sLWFwZXN0ZXItaWZyYW1lLXJlYWR5Jyk7XG4gICAgICAgICAgICAgICAgaWYgKG1lZGlhWydjYW1wYWlnbkRhdGEnXSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5pZnJhbWVfLmNvbnRlbnRXaW5kb3cuLypPSyovIHBvc3RNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgIC8qKiBAdHlwZSB7SnNvbk9iamVjdH0gKi8gKHt0eXBlOiAnY2FtcGFpZ25zJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG1lZGlhWydjYW1wYWlnbkRhdGEnXX0pLFxuICAgICAgICAgICAgICAgICAgICAgICcqJ1xuICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVQbGFjZWhvbGRlcihmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWFkeV8gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGxldCBoZWlnaHQgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChtZWRpYSAmJiBtZWRpYVsnZGF0YSddICYmIG1lZGlhWydkYXRhJ11bJ3NpemUnXSkge1xuICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gbWVkaWFbJ2RhdGEnXVsnc2l6ZSddWydoZWlnaHQnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhlaWdodCAhPSB0aGlzLmhlaWdodF8pIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0XyA9IGhlaWdodDtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJhbmRvbV8pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4vKk9LKi8gYXR0ZW1wdENoYW5nZUhlaWdodChoZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4vKk9LKi8gY2hhbmdlSGVpZ2h0KGhlaWdodCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgIGRldigpLmVycm9yKFRBRywgJ0Rpc3BsYXknLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgZGV2KCkuZXJyb3IoVEFHLCAnRGlzcGxheScsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgY3JlYXRlUGxhY2Vob2xkZXJDYWxsYmFjaygpIHtcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGlmICh0aGlzLmVsZW1lbnQuaGFzQXR0cmlidXRlKCdhcmlhLWxhYmVsJykpIHtcbiAgICAgIHBsYWNlaG9sZGVyLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdMb2FkaW5nIC0gJ1xuICAgICAgICAgICsgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGxhY2Vob2xkZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0xvYWRpbmcgdmlkZW8nKTtcbiAgICB9XG4gICAgcGxhY2Vob2xkZXIuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsJycpO1xuICAgIHBsYWNlaG9sZGVyLnNldEF0dHJpYnV0ZSgnbGF5b3V0JywgJ2ZpbGwnKTtcbiAgICBwbGFjZWhvbGRlci5jbGFzc05hbWUgPSAnYW1wLWFwZXN0ZXItbG9hZGVyJztcbiAgICBwbGFjZWhvbGRlci5hcHBlbmRDaGlsZCh0aGlzLmNvbnN0cnVjdExvYWRlclN0cnVjdHVyZV8oKSk7XG4gICAgcGxhY2Vob2xkZXIuYXBwZW5kQ2hpbGQodGhpcy5jb25zdHJ1Y3RMb2FkZXJTVkdfKCkpO1xuICAgIHJldHVybiBwbGFjZWhvbGRlcjtcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgdW5sYXlvdXRPblBhdXNlKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICB1bmxheW91dENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLmlmcmFtZV8pIHtcbiAgICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJBcGlfLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJBcGlfID0gbnVsbDtcbiAgICAgIHRoaXMudW5saXN0ZW5lcnNfLmZvckVhY2godW5saXN0ZW4gPT4gdW5saXN0ZW4oKSk7XG4gICAgICByZW1vdmVFbGVtZW50KHRoaXMuaWZyYW1lXyk7XG4gICAgICB0aGlzLmlmcmFtZV8gPSBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTsgLy9DYWxsIGxheW91dENhbGxiYWNrIGFnYWluLlxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0byBhcGVzdGVyIGV2ZW50cy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHJlZ2lzdGVyVG9BcGVzdGVyRXZlbnRzXygpIHtcbiAgICByZWdpc3RlckV2ZW50KFxuICAgICAgICBhcGVzdGVyRXZlbnROYW1lcy5TRVRfRlVMTF9TQ1JFRU4sXG4gICAgICAgIGRhdGEgPT4ge1xuICAgICAgICAvLyBVc2VyIGNsaWNrZWQgZnVsbCBzY3JlZW4gYnV0dG9uLlxuICAgICAgICAgIGlmICh0aGlzLm1lZGlhSWRfID09PSBkYXRhLmlkKSB7XG4gICAgICAgICAgICBzZXRGdWxsc2NyZWVuT24odGhpcy5lbGVtZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRoaXMud2luLFxuICAgICAgICAvKiogQHR5cGUgeyFFbGVtZW50fSovICh0aGlzLmlmcmFtZV8pLFxuICAgICAgICB0aGlzLnVubGlzdGVuZXJzX1xuICAgICk7XG4gICAgcmVnaXN0ZXJFdmVudChcbiAgICAgICAgYXBlc3RlckV2ZW50TmFtZXMuUkVNT1ZFX0ZVTExfU0NSRUVOLFxuICAgICAgICBkYXRhID0+IHtcbiAgICAgICAgLy8gVXNlciBjbGlja2VkIGNsb3NlIGZ1bGwgc2NyZWVuIGJ1dHRvbi5cbiAgICAgICAgICBpZiAodGhpcy5tZWRpYUlkXyA9PT0gZGF0YS5pZCkge1xuICAgICAgICAgICAgc2V0RnVsbHNjcmVlbk9mZih0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGhpcy53aW4sXG4gICAgICAgIC8qKiBAdHlwZSB7IUVsZW1lbnR9Ki8gKHRoaXMuaWZyYW1lXyksXG4gICAgICAgIHRoaXMudW5saXN0ZW5lcnNfXG4gICAgKTtcbiAgICByZWdpc3RlckV2ZW50KFxuICAgICAgICBhcGVzdGVyRXZlbnROYW1lcy5SRVNJWkVfVU5JVCxcbiAgICAgICAgZGF0YSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMubWVkaWFJZF8gPT09IGRhdGEuaWQgJiYgZGF0YS5oZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0ZW1wdENoYW5nZUhlaWdodChkYXRhLmhlaWdodCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0aGlzLndpbixcbiAgICAgICAgLyoqIEB0eXBlIHshRWxlbWVudH0qLyAodGhpcy5pZnJhbWVfKSxcbiAgICAgICAgdGhpcy51bmxpc3RlbmVyc19cbiAgICApO1xuICB9XG59XG5cbkFNUC5leHRlbnNpb24oVEFHLCAnMC4xJywgQU1QID0+IHtcbiAgQU1QLnJlZ2lzdGVyRWxlbWVudChUQUcsIEFtcEFwZXN0ZXJNZWRpYSwgQ1NTKTtcbn0pO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCAqIGFzIGV2ZW50cyBmcm9tICcuLi8uLi8uLi9zcmMvZXZlbnQtaGVscGVyJztcblxuY29uc3QgcnVsZXMgPSBbXG4gIC8vIGlmIGl0IHNheXMgaXQncyBhIHdlYnZpZXcsIGxldCdzIGdvIHdpdGggdGhhdFxuICAnV2ViVmlldycsXG4gIC8vIGlPUyB3ZWJ2aWV3IHdpbGwgYmUgdGhlIHNhbWUgYXMgc2FmYXJpIGJ1dCBtaXNzaW5nIFwiU2FmYXJpXCJcbiAgJyhpUGhvbmV8aVBvZHxpUGFkKSg/IS4qU2FmYXJpKScsXG4gIC8vIEFuZHJvaWQgTG9sbGlwb3AgYW5kIEFib3ZlOiB3ZWJ2aWV3IHdpbGwgYmUgdGhlIHNhbWUgYXMgbmF0aXZlIGJ1dCBpdCB3aWxsXG4gIC8vIGNvbnRhaW4gXCJ3dlwiIEFuZHJvaWQgS2l0S2F0IHRvIGxvbGxpcG9wIHdlYnZpZXcgd2lsbCBwdXQge3ZlcnNpb259LjAuMC4wXG4gICdBbmRyb2lkLiood3Z8LjAuMC4wKScsXG4gIC8vIG9sZCBjaHJvbWUgYW5kcm9pZCB3ZWJ2aWV3IGFnZW50XG4gICdMaW51eDsgVTsgQW5kcm9pZCcsXG5dO1xuXG5jb25zdCB3ZWJ2aWV3UmVnRXhwID0gbmV3IFJlZ0V4cCgnKCcgKyBydWxlcy5qb2luKCd8JykgKyAnKScsICdpZycpO1xuXG4vKipcbiAqIFJldHVybnMgaWYgdWEgYmVsb25ncyB0byBhIHdlYnZpZXdcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWFcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzV2Vidmlldyh1YSkge1xuICByZXR1cm4gISF1YS5tYXRjaCh3ZWJ2aWV3UmVnRXhwKTtcbn1cblxuLyoqXG4gKiBAZGVzY3JpcHRpb25cbiAqIHJlZ2V4IGZvciBkZXRlY3RpbmcgbW9iaWxlIGRldmljZXMuXG4gKiAoaW5jbHVkaW5nIGJsYWNrYmVycnkgYW5kIG90aGVyIHJhcmUgbW9iaWxlIGRldmljZXMpLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNNb2JpbGVEZXZpY2UoKSB7XG4gIGNvbnN0IHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQgfHwgbmF2aWdhdG9yLnZlbmRvciB8fCB3aW5kb3cub3BlcmE7XG4gIHJldHVybiAoXG4gICAgLyhhbmRyb2lkfGJiXFxkK3xtZWVnbykuK21vYmlsZXxhdmFudGdvfGJhZGFcXC98YmxhY2tiZXJyeXxibGF6ZXJ8Y29tcGFsfGVsYWluZXxmZW5uZWN8aGlwdG9wfGllbW9iaWxlfGlwKGhvbmV8b2QpfGlyaXN8a2luZGxlfGxnZSB8bWFlbW98bWlkcHxtbXB8bW9iaWxlLitmaXJlZm94fG5ldGZyb250fG9wZXJhIG0ob2J8aW4paXxwYWxtKCBvcyk/fHBob25lfHAoaXhpfHJlKVxcL3xwbHVja2VyfHBvY2tldHxwc3B8c2VyaWVzKDR8NikwfHN5bWJpYW58dHJlb3x1cFxcLihicm93c2VyfGxpbmspfHZvZGFmb25lfHdhcHx3aW5kb3dzIGNlfHhkYXx4aWlub3xhbmRyb2lkfGlwYWR8cGxheWJvb2t8c2lsay9pLnRlc3QoXG4gICAgICAgIHVzZXJBZ2VudFxuICAgICkgfHxcbiAgICAvMTIwN3w2MzEwfDY1OTB8M2dzb3w0dGhwfDUwWzEtNl1pfDc3MHN8ODAyc3xhIHdhfGFiYWN8YWMoZXJ8b298c1xcLSl8YWkoa298cm4pfGFsKGF2fGNhfGNvKXxhbW9pfGFuKGV4fG55fHl3KXxhcHR1fGFyKGNofGdvKXxhcyh0ZXx1cyl8YXR0d3xhdShkaXxcXC1tfHIgfHMgKXxhdmFufGJlKGNrfGxsfG5xKXxiaShsYnxyZCl8YmwoYWN8YXopfGJyKGV8dil3fGJ1bWJ8YndcXC0obnx1KXxjNTVcXC98Y2FwaXxjY3dhfGNkbVxcLXxjZWxsfGNodG18Y2xkY3xjbWRcXC18Y28obXB8bmQpfGNyYXd8ZGEoaXR8bGx8bmcpfGRidGV8ZGNcXC1zfGRldml8ZGljYXxkbW9ifGRvKGN8cClvfGRzKDEyfFxcLWQpfGVsKDQ5fGFpKXxlbShsMnx1bCl8ZXIoaWN8azApfGVzbDh8ZXooWzQtN10wfG9zfHdhfHplKXxmZXRjfGZseShcXC18Xyl8ZzEgdXxnNTYwfGdlbmV8Z2ZcXC01fGdcXC1tb3xnbyhcXC53fG9kKXxncihhZHx1bil8aGFpZXxoY2l0fGhkXFwtKG18cHx0KXxoZWlcXC18aGkocHR8dGEpfGhwKCBpfGlwKXxoc1xcLWN8aHQoYyhcXC18IHxffGF8Z3xwfHN8dCl8dHApfGh1KGF3fHRjKXxpXFwtKDIwfGdvfG1hKXxpMjMwfGlhYyggfFxcLXxcXC8pfGlicm98aWRlYXxpZzAxfGlrb218aW0xa3xpbm5vfGlwYXF8aXJpc3xqYSh0fHYpYXxqYnJvfGplbXV8amlnc3xrZGRpfGtlaml8a2d0KCB8XFwvKXxrbG9ufGtwdCB8a3djXFwtfGt5byhjfGspfGxlKG5vfHhpKXxsZyggZ3xcXC8oa3xsfHUpfDUwfDU0fFxcLVthLXddKXxsaWJ3fGx5bnh8bTFcXC13fG0zZ2F8bTUwXFwvfG1hKHRlfHVpfHhvKXxtYygwMXwyMXxjYSl8bVxcLWNyfG1lKHJjfHJpKXxtaShvOHxvYXx0cyl8bW1lZnxtbygwMXwwMnxiaXxkZXxkb3x0KFxcLXwgfG98dil8enopfG10KDUwfHAxfHYgKXxtd2JwfG15d2F8bjEwWzAtMl18bjIwWzItM118bjMwKDB8Mil8bjUwKDB8Mnw1KXxuNygwKDB8MSl8MTApfG5lKChjfG0pXFwtfG9ufHRmfHdmfHdnfHd0KXxub2soNnxpKXxuenBofG8yaW18b3AodGl8d3YpfG9yYW58b3dnMXxwODAwfHBhbihhfGR8dCl8cGR4Z3xwZygxM3xcXC0oWzEtOF18YykpfHBoaWx8cGlyZXxwbChheXx1Yyl8cG5cXC0yfHBvKGNrfHJ0fHNlKXxwcm94fHBzaW98cHRcXC1nfHFhXFwtYXxxYygwN3wxMnwyMXwzMnw2MHxcXC1bMi03XXxpXFwtKXxxdGVrfHIzODB8cjYwMHxyYWtzfHJpbTl8cm8odmV8em8pfHM1NVxcL3xzYShnZXxtYXxtbXxtc3xueXx2YSl8c2MoMDF8aFxcLXxvb3xwXFwtKXxzZGtcXC98c2UoYyhcXC18MHwxKXw0N3xtY3xuZHxyaSl8c2doXFwtfHNoYXJ8c2llKFxcLXxtKXxza1xcLTB8c2woNDV8aWQpfHNtKGFsfGFyfGIzfGl0fHQ1KXxzbyhmdHxueSl8c3AoMDF8aFxcLXx2XFwtfHYgKXxzeSgwMXxtYil8dDIoMTh8NTApfHQ2KDAwfDEwfDE4KXx0YShndHxsayl8dGNsXFwtfHRkZ1xcLXx0ZWwoaXxtKXx0aW1cXC18dFxcLW1vfHRvKHBsfHNoKXx0cyg3MHxtXFwtfG0zfG01KXx0eFxcLTl8dXAoXFwuYnxnMXxzaSl8dXRzdHx2NDAwfHY3NTB8dmVyaXx2aShyZ3x0ZSl8dmsoNDB8NVswLTNdfFxcLXYpfHZtNDB8dm9kYXx2dWxjfHZ4KDUyfDUzfDYwfDYxfDcwfDgwfDgxfDgzfDg1fDk4KXx3M2MoXFwtfCApfHdlYmN8d2hpdHx3aShnIHxuY3xudyl8d21sYnx3b251fHg3MDB8eWFzXFwtfHlvdXJ8emV0b3x6dGVcXC0vaS50ZXN0KFxuICAgICAgICB1c2VyQWdlbnQuc3Vic3RyKDAsIDQpXG4gICAgKVxuICApO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIHVzZXIgcGxhdGZvcm0uXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQbGF0Zm9ybSgpIHtcbiAgY29uc3Qgd2VidmlldyA9IGlzV2VidmlldyhuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgY29uc3QgaXNNb2JpbGUgPSBpc01vYmlsZURldmljZSgpO1xuICByZXR1cm4gaXNNb2JpbGUgPyBgbW9iaWxlJHt3ZWJ2aWV3ID8gJy13ZWJ2aWV3JyA6ICcnfWAgOiAnZGVza3RvcCc7XG59XG5cbi8qKlxuICogRXh0cmFjdHMgdGFncyBmcm9tIGEgZ2l2ZW4gZWxlbWVudCAuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RFbGVtZW50VGFncyhlbGVtZW50KSB7XG4gIGNvbnN0IHRhZ3NBdHRyaWJ1dGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1hcGVzdGVyLXRhZ3MnKTtcbiAgaWYgKHRhZ3NBdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gdGFnc0F0dHJpYnV0ZS5zcGxpdCgnLCcpLm1hcCh0YWcgPT4gdGFnLnRyaW0oKSkgfHwgW107XG4gIH1cbiAgcmV0dXJuIFtdO1xufVxuXG4vKipcbiAqIEV4dHJhY3RzIHRhZ3MgZnJvbSBhIGdpdmVuIGVsZW1lbnQgYW5kIGRvY3VtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7QXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUYWdzKGVsZW1lbnQpIHtcbiAgY29uc3QgZXh0cmFjdGFncyA9IGV4dHJhY3RFbGVtZW50VGFncyhlbGVtZW50KTtcbiAgY29uc3QgbG93ZXJlZENhc2UgPSBleHRyYWN0YWdzLm1hcCh0YWcgPT4gdGFnLnRvTG93ZXJDYXNlKCkudHJpbSgpKTtcbiAgY29uc3Qgbm9EdXBsaWNhdGlvbiA9XG4gICAgbG93ZXJlZENhc2UuZmlsdGVyKChpdGVtLCBwb3MsIHNlbGYpID0+IHNlbGYuaW5kZXhPZihpdGVtKSA9PT0gcG9zKTtcbiAgcmV0dXJuIG5vRHVwbGljYXRpb247XG59XG5cbi8qKlxuICogQWRkcyBmdWxsc2NyZWVuIGNsYXNzIHRvIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEZ1bGxzY3JlZW5PbihlbGVtZW50KSB7XG4gIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYW1wLWFwZXN0ZXItZnVsbHNjcmVlbicpO1xufVxuXG4vKipcbiAqIHJlbW92ZXMgZnVsbHNjcmVlbiBjbGFzcyBmcm9tIGFuIGVsZW1lbnRcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEZ1bGxzY3JlZW5PZmYoZWxlbWVudCkge1xuICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FtcC1hcGVzdGVyLWZ1bGxzY3JlZW4nKTtcbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgdG8gYW4gZXZlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWVcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBjYWxsYmFja1xuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IHdpblxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lXG4gKiBAcGFyYW0geyFBcnJheX0gdW5saXN0ZW5lcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyRXZlbnQoZXZlbnROYW1lLCBjYWxsYmFjaywgd2luLCBpZnJhbWUsIHVubGlzdGVuZXJzKSB7XG4gIGNvbnN0IHVubGlzdGVuID0gZXZlbnRzLmxpc3Rlbih3aW4sICdtZXNzYWdlJywgZXZlbnQgPT4ge1xuICAgIGNvbnN0IGZyb21BcGVzdGVyTWVkaWEgPSBpZnJhbWUuY29udGVudFdpbmRvdyA9PT0gZXZlbnQuc291cmNlO1xuICAgIGlmIChldmVudHMuZ2V0RGF0YShldmVudClbJ3R5cGUnXSA9PT0gZXZlbnROYW1lICYmIGZyb21BcGVzdGVyTWVkaWEpIHtcbiAgICAgIGNhbGxiYWNrKGV2ZW50cy5nZXREYXRhKGV2ZW50KSk7XG4gICAgfVxuICB9KTtcbiAgdW5saXN0ZW5lcnMucHVzaCh1bmxpc3Rlbik7XG59XG4iLCIvKiFcblxuQ29weXJpZ2h0IChDKSAyMDE0LTIwMTYgYnkgQW5kcmVhIEdpYW1tYXJjaGkgLSBAV2ViUmVmbGVjdGlvblxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG5cbiovXG4vLyBnbG9iYWwgd2luZG93IE9iamVjdFxuLy8gb3B0aW9uYWwgcG9seWZpbGwgaW5mb1xuLy8gICAgJ2F1dG8nIHVzZWQgYnkgZGVmYXVsdCwgZXZlcnl0aGluZyBpcyBmZWF0dXJlIGRldGVjdGVkXG4vLyAgICAnZm9yY2UnIHVzZSB0aGUgcG9seWZpbGwgZXZlbiBpZiBub3QgZnVsbHkgbmVlZGVkXG5mdW5jdGlvbiBpbnN0YWxsQ3VzdG9tRWxlbWVudHMod2luZG93LCBwb2x5ZmlsbCkgeyd1c2Ugc3RyaWN0JztcblxuICAvLyBETyBOT1QgVVNFIFRISVMgRklMRSBESVJFQ1RMWSwgSVQgV09OJ1QgV09SS1xuICAvLyBUSElTIElTIEEgUFJPSkVDVCBCQVNFRCBPTiBBIEJVSUxEIFNZU1RFTVxuICAvLyBUSElTIEZJTEUgSVMgSlVTVCBXUkFQUEVEIFVQIFJFU1VMVElORyBJTlxuICAvLyBidWlsZC9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50Lm5vZGUuanNcblxuICB2YXJcbiAgICBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcbiAgICBPYmplY3QgPSB3aW5kb3cuT2JqZWN0XG4gIDtcblxuICB2YXIgaHRtbENsYXNzID0gKGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgLy8gKEMpIEFuZHJlYSBHaWFtbWFyY2hpIC0gQFdlYlJlZmxlY3Rpb24gLSBNSVQgU3R5bGVcbiAgICB2YXJcbiAgICAgIGNhdGNoQ2xhc3MgPSAvXltBLVpdK1thLXpdLyxcbiAgICAgIGZpbHRlckJ5ID0gZnVuY3Rpb24gKHJlKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXSwgdGFnO1xuICAgICAgICBmb3IgKHRhZyBpbiByZWdpc3Rlcikge1xuICAgICAgICAgIGlmIChyZS50ZXN0KHRhZykpIGFyci5wdXNoKHRhZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgIH0sXG4gICAgICBhZGQgPSBmdW5jdGlvbiAoQ2xhc3MsIHRhZykge1xuICAgICAgICB0YWcgPSB0YWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKCEodGFnIGluIHJlZ2lzdGVyKSkge1xuICAgICAgICAgIHJlZ2lzdGVyW0NsYXNzXSA9IChyZWdpc3RlcltDbGFzc10gfHwgW10pLmNvbmNhdCh0YWcpO1xuICAgICAgICAgIHJlZ2lzdGVyW3RhZ10gPSAocmVnaXN0ZXJbdGFnLnRvVXBwZXJDYXNlKCldID0gQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVnaXN0ZXIgPSAoT2JqZWN0LmNyZWF0ZSB8fCBPYmplY3QpKG51bGwpLFxuICAgICAgaHRtbENsYXNzID0ge30sXG4gICAgICBpLCBzZWN0aW9uLCB0YWdzLCBDbGFzc1xuICAgIDtcbiAgICBmb3IgKHNlY3Rpb24gaW4gaW5mbykge1xuICAgICAgZm9yIChDbGFzcyBpbiBpbmZvW3NlY3Rpb25dKSB7XG4gICAgICAgIHRhZ3MgPSBpbmZvW3NlY3Rpb25dW0NsYXNzXTtcbiAgICAgICAgcmVnaXN0ZXJbQ2xhc3NdID0gdGFncztcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvTG93ZXJDYXNlKCldID1cbiAgICAgICAgICByZWdpc3Rlclt0YWdzW2ldLnRvVXBwZXJDYXNlKCldID0gQ2xhc3M7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaHRtbENsYXNzLmdldCA9IGZ1bmN0aW9uIGdldCh0YWdPckNsYXNzKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHRhZ09yQ2xhc3MgPT09ICdzdHJpbmcnID9cbiAgICAgICAgKHJlZ2lzdGVyW3RhZ09yQ2xhc3NdIHx8IChjYXRjaENsYXNzLnRlc3QodGFnT3JDbGFzcykgPyBbXSA6ICcnKSkgOlxuICAgICAgICBmaWx0ZXJCeSh0YWdPckNsYXNzKTtcbiAgICB9O1xuICAgIGh0bWxDbGFzcy5zZXQgPSBmdW5jdGlvbiBzZXQodGFnLCBDbGFzcykge1xuICAgICAgcmV0dXJuIChjYXRjaENsYXNzLnRlc3QodGFnKSA/XG4gICAgICAgIGFkZCh0YWcsIENsYXNzKSA6XG4gICAgICAgIGFkZChDbGFzcywgdGFnKVxuICAgICAgKSwgaHRtbENsYXNzO1xuICAgIH07XG4gICAgcmV0dXJuIGh0bWxDbGFzcztcbiAgfSh7XG4gICAgXCJjb2xsZWN0aW9uc1wiOiB7XG4gICAgICBcIkhUTUxBbGxDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJhbGxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTENvbGxlY3Rpb25cIjogW1xuICAgICAgICBcImZvcm1zXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGb3JtQ29udHJvbHNDb2xsZWN0aW9uXCI6IFtcbiAgICAgICAgXCJlbGVtZW50c1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uc0NvbGxlY3Rpb25cIjogW1xuICAgICAgICBcIm9wdGlvbnNcIlxuICAgICAgXVxuICAgIH0sXG4gICAgXCJlbGVtZW50c1wiOiB7XG4gICAgICBcIkVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFuY2hvckVsZW1lbnRcIjogW1xuICAgICAgICBcImFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEFwcGxldEVsZW1lbnRcIjogW1xuICAgICAgICBcImFwcGxldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQXJlYUVsZW1lbnRcIjogW1xuICAgICAgICBcImFyZWFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEF0dGFjaG1lbnRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJhdHRhY2htZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxBdWRpb0VsZW1lbnRcIjogW1xuICAgICAgICBcImF1ZGlvXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCUkVsZW1lbnRcIjogW1xuICAgICAgICBcImJyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxCYXNlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmFzZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQm9keUVsZW1lbnRcIjogW1xuICAgICAgICBcImJvZHlcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEJ1dHRvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImJ1dHRvblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MQ2FudmFzRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY2FudmFzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxDb250ZW50RWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29udGVudFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRExpc3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGF0YUVsZW1lbnRcIjogW1xuICAgICAgICBcImRhdGFcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERhdGFMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGF0YWxpc3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERldGFpbHNFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZXRhaWxzXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEaWFsb2dFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkaWFsb2dcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERpcmVjdG9yeUVsZW1lbnRcIjogW1xuICAgICAgICBcImRpclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRGl2RWxlbWVudFwiOiBbXG4gICAgICAgIFwiZGl2XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEVsZW1lbnRcIjogW1xuICAgICAgICBcImVsZW1lbnRcIixcbiAgICAgICAgXCJhYmJyXCIsXG4gICAgICAgIFwiYWRkcmVzc1wiLFxuICAgICAgICBcImFydGljbGVcIixcbiAgICAgICAgXCJhc2lkZVwiLFxuICAgICAgICBcImJcIixcbiAgICAgICAgXCJiZGlcIixcbiAgICAgICAgXCJiZG9cIixcbiAgICAgICAgXCJjaXRlXCIsXG4gICAgICAgIFwiY29kZVwiLFxuICAgICAgICBcImNvbW1hbmRcIixcbiAgICAgICAgXCJkZFwiLFxuICAgICAgICBcImRmblwiLFxuICAgICAgICBcImR0XCIsXG4gICAgICAgIFwiZW1cIixcbiAgICAgICAgXCJmaWdjYXB0aW9uXCIsXG4gICAgICAgIFwiZmlndXJlXCIsXG4gICAgICAgIFwiZm9vdGVyXCIsXG4gICAgICAgIFwiaGVhZGVyXCIsXG4gICAgICAgIFwiaVwiLFxuICAgICAgICBcImtiZFwiLFxuICAgICAgICBcIm1hcmtcIixcbiAgICAgICAgXCJuYXZcIixcbiAgICAgICAgXCJub3NjcmlwdFwiLFxuICAgICAgICBcInJwXCIsXG4gICAgICAgIFwicnRcIixcbiAgICAgICAgXCJydWJ5XCIsXG4gICAgICAgIFwic1wiLFxuICAgICAgICBcInNhbXBcIixcbiAgICAgICAgXCJzZWN0aW9uXCIsXG4gICAgICAgIFwic21hbGxcIixcbiAgICAgICAgXCJzdHJvbmdcIixcbiAgICAgICAgXCJzdWJcIixcbiAgICAgICAgXCJzdW1tYXJ5XCIsXG4gICAgICAgIFwic3VwXCIsXG4gICAgICAgIFwidVwiLFxuICAgICAgICBcInZhclwiLFxuICAgICAgICBcIndiclwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRW1iZWRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJlbWJlZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRmllbGRTZXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJmaWVsZHNldFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MRm9udEVsZW1lbnRcIjogW1xuICAgICAgICBcImZvbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEZvcm1FbGVtZW50XCI6IFtcbiAgICAgICAgXCJmb3JtXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxGcmFtZVNldEVsZW1lbnRcIjogW1xuICAgICAgICBcImZyYW1lc2V0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIUkVsZW1lbnRcIjogW1xuICAgICAgICBcImhyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxIZWFkRWxlbWVudFwiOiBbXG4gICAgICAgIFwiaGVhZFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSGVhZGluZ0VsZW1lbnRcIjogW1xuICAgICAgICBcImgxXCIsXG4gICAgICAgIFwiaDJcIixcbiAgICAgICAgXCJoM1wiLFxuICAgICAgICBcImg0XCIsXG4gICAgICAgIFwiaDVcIixcbiAgICAgICAgXCJoNlwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSHRtbEVsZW1lbnRcIjogW1xuICAgICAgICBcImh0bWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElGcmFtZUVsZW1lbnRcIjogW1xuICAgICAgICBcImlmcmFtZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MSW1hZ2VFbGVtZW50XCI6IFtcbiAgICAgICAgXCJpbWdcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTElucHV0RWxlbWVudFwiOiBbXG4gICAgICAgIFwiaW5wdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTEtleWdlbkVsZW1lbnRcIjogW1xuICAgICAgICBcImtleWdlblwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTElFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsaVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGFiZWxFbGVtZW50XCI6IFtcbiAgICAgICAgXCJsYWJlbFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTGVnZW5kRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGVnZW5kXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxMaW5rRWxlbWVudFwiOiBbXG4gICAgICAgIFwibGlua1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWFwRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFwXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNYXJxdWVlRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWFycXVlZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVkaWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZWRpYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MTWVudUVsZW1lbnRcIjogW1xuICAgICAgICBcIm1lbnVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1lbnVJdGVtRWxlbWVudFwiOiBbXG4gICAgICAgIFwibWVudWl0ZW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE1ldGFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJtZXRhXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNZXRlckVsZW1lbnRcIjogW1xuICAgICAgICBcIm1ldGVyXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxNb2RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJkZWxcIixcbiAgICAgICAgXCJpbnNcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9MaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwib2xcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTE9iamVjdEVsZW1lbnRcIjogW1xuICAgICAgICBcIm9iamVjdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0R3JvdXBFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvcHRncm91cFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MT3B0aW9uRWxlbWVudFwiOiBbXG4gICAgICAgIFwib3B0aW9uXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxPdXRwdXRFbGVtZW50XCI6IFtcbiAgICAgICAgXCJvdXRwdXRcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFncmFwaEVsZW1lbnRcIjogW1xuICAgICAgICBcInBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBhcmFtRWxlbWVudFwiOiBbXG4gICAgICAgIFwicGFyYW1cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFBpY3R1cmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxQcmVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJwcmVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFByb2dyZXNzRWxlbWVudFwiOiBbXG4gICAgICAgIFwicHJvZ3Jlc3NcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFF1b3RlRWxlbWVudFwiOiBbXG4gICAgICAgIFwiYmxvY2txdW90ZVwiLFxuICAgICAgICBcInFcIixcbiAgICAgICAgXCJxdW90ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2NyaXB0RWxlbWVudFwiOiBbXG4gICAgICAgIFwic2NyaXB0XCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxTZWxlY3RFbGVtZW50XCI6IFtcbiAgICAgICAgXCJzZWxlY3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNoYWRvd0VsZW1lbnRcIjogW1xuICAgICAgICBcInNoYWRvd1wiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU2xvdEVsZW1lbnRcIjogW1xuICAgICAgICBcInNsb3RcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFNvdXJjZUVsZW1lbnRcIjogW1xuICAgICAgICBcInNvdXJjZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MU3BhbkVsZW1lbnRcIjogW1xuICAgICAgICBcInNwYW5cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFN0eWxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwic3R5bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcImNhcHRpb25cIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ2VsbEVsZW1lbnRcIjogW1xuICAgICAgICBcInRkXCIsXG4gICAgICAgIFwidGhcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlQ29sRWxlbWVudFwiOiBbXG4gICAgICAgIFwiY29sXCIsXG4gICAgICAgIFwiY29sZ3JvdXBcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGFibGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlUm93RWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnRcIjogW1xuICAgICAgICBcInRoZWFkXCIsXG4gICAgICAgIFwidGJvZHlcIixcbiAgICAgICAgXCJ0Zm9vdFwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGVtcGxhdGVFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZW1wbGF0ZVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGV4dEFyZWFFbGVtZW50XCI6IFtcbiAgICAgICAgXCJ0ZXh0YXJlYVwiXG4gICAgICBdLFxuICAgICAgXCJIVE1MVGltZUVsZW1lbnRcIjogW1xuICAgICAgICBcInRpbWVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRpdGxlRWxlbWVudFwiOiBbXG4gICAgICAgIFwidGl0bGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFRyYWNrRWxlbWVudFwiOiBbXG4gICAgICAgIFwidHJhY2tcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVMaXN0RWxlbWVudFwiOiBbXG4gICAgICAgIFwidWxcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTFVua25vd25FbGVtZW50XCI6IFtcbiAgICAgICAgXCJ1bmtub3duXCIsXG4gICAgICAgIFwidmhncm91cHZcIixcbiAgICAgICAgXCJ2a2V5Z2VuXCJcbiAgICAgIF0sXG4gICAgICBcIkhUTUxWaWRlb0VsZW1lbnRcIjogW1xuICAgICAgICBcInZpZGVvXCJcbiAgICAgIF1cbiAgICB9LFxuICAgIFwibm9kZXNcIjoge1xuICAgICAgXCJBdHRyXCI6IFtcbiAgICAgICAgXCJub2RlXCJcbiAgICAgIF0sXG4gICAgICBcIkF1ZGlvXCI6IFtcbiAgICAgICAgXCJhdWRpb1wiXG4gICAgICBdLFxuICAgICAgXCJDREFUQVNlY3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiQ2hhcmFjdGVyRGF0YVwiOiBbXG4gICAgICAgIFwibm9kZVwiXG4gICAgICBdLFxuICAgICAgXCJDb21tZW50XCI6IFtcbiAgICAgICAgXCIjY29tbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFwiOiBbXG4gICAgICAgIFwiI2RvY3VtZW50XCJcbiAgICAgIF0sXG4gICAgICBcIkRvY3VtZW50RnJhZ21lbnRcIjogW1xuICAgICAgICBcIiNkb2N1bWVudC1mcmFnbWVudFwiXG4gICAgICBdLFxuICAgICAgXCJEb2N1bWVudFR5cGVcIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiSFRNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCIjZG9jdW1lbnRcIlxuICAgICAgXSxcbiAgICAgIFwiSW1hZ2VcIjogW1xuICAgICAgICBcImltZ1wiXG4gICAgICBdLFxuICAgICAgXCJPcHRpb25cIjogW1xuICAgICAgICBcIm9wdGlvblwiXG4gICAgICBdLFxuICAgICAgXCJQcm9jZXNzaW5nSW5zdHJ1Y3Rpb25cIjogW1xuICAgICAgICBcIm5vZGVcIlxuICAgICAgXSxcbiAgICAgIFwiU2hhZG93Um9vdFwiOiBbXG4gICAgICAgIFwiI3NoYWRvdy1yb290XCJcbiAgICAgIF0sXG4gICAgICBcIlRleHRcIjogW1xuICAgICAgICBcIiN0ZXh0XCJcbiAgICAgIF0sXG4gICAgICBcIlhNTERvY3VtZW50XCI6IFtcbiAgICAgICAgXCJ4bWxcIlxuICAgICAgXVxuICAgIH1cbiAgfSkpO1xuICBcbiAgXG4gICAgXG4gIC8vIHBhc3NlZCBhdCBydW50aW1lLCBjb25maWd1cmFibGVcbiAgLy8gdmlhIG5vZGVqcyBtb2R1bGVcbiAgaWYgKCFwb2x5ZmlsbCkgcG9seWZpbGwgPSAnYXV0byc7XG4gIFxuICB2YXJcbiAgICAvLyBWMCBwb2x5ZmlsbCBlbnRyeVxuICAgIFJFR0lTVEVSX0VMRU1FTlQgPSAncmVnaXN0ZXJFbGVtZW50JyxcbiAgXG4gICAgLy8gSUUgPCAxMSBvbmx5ICsgb2xkIFdlYktpdCBmb3IgYXR0cmlidXRlcyArIGZlYXR1cmUgZGV0ZWN0aW9uXG4gICAgRVhQQU5ET19VSUQgPSAnX18nICsgUkVHSVNURVJfRUxFTUVOVCArICh3aW5kb3cuTWF0aC5yYW5kb20oKSAqIDEwZTQgPj4gMCksXG4gIFxuICAgIC8vIHNob3J0Y3V0cyBhbmQgY29zdGFudHNcbiAgICBBRERfRVZFTlRfTElTVEVORVIgPSAnYWRkRXZlbnRMaXN0ZW5lcicsXG4gICAgQVRUQUNIRUQgPSAnYXR0YWNoZWQnLFxuICAgIENBTExCQUNLID0gJ0NhbGxiYWNrJyxcbiAgICBERVRBQ0hFRCA9ICdkZXRhY2hlZCcsXG4gICAgRVhURU5EUyA9ICdleHRlbmRzJyxcbiAgXG4gICAgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0sgPSAnYXR0cmlidXRlQ2hhbmdlZCcgKyBDQUxMQkFDSyxcbiAgICBBVFRBQ0hFRF9DQUxMQkFDSyA9IEFUVEFDSEVEICsgQ0FMTEJBQ0ssXG4gICAgQ09OTkVDVEVEX0NBTExCQUNLID0gJ2Nvbm5lY3RlZCcgKyBDQUxMQkFDSyxcbiAgICBESVNDT05ORUNURURfQ0FMTEJBQ0sgPSAnZGlzY29ubmVjdGVkJyArIENBTExCQUNLLFxuICAgIENSRUFURURfQ0FMTEJBQ0sgPSAnY3JlYXRlZCcgKyBDQUxMQkFDSyxcbiAgICBERVRBQ0hFRF9DQUxMQkFDSyA9IERFVEFDSEVEICsgQ0FMTEJBQ0ssXG4gIFxuICAgIEFERElUSU9OID0gJ0FERElUSU9OJyxcbiAgICBNT0RJRklDQVRJT04gPSAnTU9ESUZJQ0FUSU9OJyxcbiAgICBSRU1PVkFMID0gJ1JFTU9WQUwnLFxuICBcbiAgICBET01fQVRUUl9NT0RJRklFRCA9ICdET01BdHRyTW9kaWZpZWQnLFxuICAgIERPTV9DT05URU5UX0xPQURFRCA9ICdET01Db250ZW50TG9hZGVkJyxcbiAgICBET01fU1VCVFJFRV9NT0RJRklFRCA9ICdET01TdWJ0cmVlTW9kaWZpZWQnLFxuICBcbiAgICBQUkVGSVhfVEFHID0gJzwnLFxuICAgIFBSRUZJWF9JUyA9ICc9JyxcbiAgXG4gICAgLy8gdmFsaWQgYW5kIGludmFsaWQgbm9kZSBuYW1lc1xuICAgIHZhbGlkTmFtZSA9IC9eW0EtWl1bQS1aMC05XSooPzotW0EtWjAtOV0rKSskLyxcbiAgICBpbnZhbGlkTmFtZXMgPSBbXG4gICAgICAnQU5OT1RBVElPTi1YTUwnLFxuICAgICAgJ0NPTE9SLVBST0ZJTEUnLFxuICAgICAgJ0ZPTlQtRkFDRScsXG4gICAgICAnRk9OVC1GQUNFLVNSQycsXG4gICAgICAnRk9OVC1GQUNFLVVSSScsXG4gICAgICAnRk9OVC1GQUNFLUZPUk1BVCcsXG4gICAgICAnRk9OVC1GQUNFLU5BTUUnLFxuICAgICAgJ01JU1NJTkctR0xZUEgnXG4gICAgXSxcbiAgXG4gICAgLy8gcmVnaXN0ZXJlZCB0eXBlcyBhbmQgdGhlaXIgcHJvdG90eXBlc1xuICAgIHR5cGVzID0gW10sXG4gICAgcHJvdG9zID0gW10sXG4gIFxuICAgIC8vIHRvIHF1ZXJ5IHN1Ym5vZGVzXG4gICAgcXVlcnkgPSAnJyxcbiAgXG4gICAgLy8gaHRtbCBzaG9ydGN1dCB1c2VkIHRvIGZlYXR1cmUgZGV0ZWN0XG4gICAgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICBcbiAgICAvLyBFUzUgaW5saW5lIGhlbHBlcnMgfHwgYmFzaWMgcGF0Y2hlc1xuICAgIGluZGV4T2YgPSB0eXBlcy5pbmRleE9mIHx8IGZ1bmN0aW9uICh2KSB7XG4gICAgICBmb3IodmFyIGkgPSB0aGlzLmxlbmd0aDsgaS0tICYmIHRoaXNbaV0gIT09IHY7KXt9XG4gICAgICByZXR1cm4gaTtcbiAgICB9LFxuICBcbiAgICAvLyBvdGhlciBoZWxwZXJzIC8gc2hvcnRjdXRzXG4gICAgT1AgPSBPYmplY3QucHJvdG90eXBlLFxuICAgIGhPUCA9IE9QLmhhc093blByb3BlcnR5LFxuICAgIGlQTyA9IE9QLmlzUHJvdG90eXBlT2YsXG4gIFxuICAgIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgIGVtcHR5ID0gW10sXG4gICAgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gICAgZ09QTiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICAgIGdQTyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICBzUE8gPSBPYmplY3Quc2V0UHJvdG90eXBlT2YsXG4gIFxuICAgIC8vIGpzaGludCBwcm90bzogdHJ1ZVxuICAgIGhhc1Byb3RvID0gISFPYmplY3QuX19wcm90b19fLFxuICBcbiAgICAvLyBWMSBoZWxwZXJzXG4gICAgZml4R2V0Q2xhc3MgPSBmYWxzZSxcbiAgICBEUkVDRVYxID0gJ19fZHJlQ0V2MScsXG4gICAgY3VzdG9tRWxlbWVudHMgPSB3aW5kb3cuY3VzdG9tRWxlbWVudHMsXG4gICAgdXNhYmxlQ3VzdG9tRWxlbWVudHMgPSBwb2x5ZmlsbCAhPT0gJ2ZvcmNlJyAmJiAhIShcbiAgICAgIGN1c3RvbUVsZW1lbnRzICYmXG4gICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUgJiZcbiAgICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgICAgY3VzdG9tRWxlbWVudHMud2hlbkRlZmluZWRcbiAgICApLFxuICAgIERpY3QgPSBPYmplY3QuY3JlYXRlIHx8IE9iamVjdCxcbiAgICBNYXAgPSB3aW5kb3cuTWFwIHx8IGZ1bmN0aW9uIE1hcCgpIHtcbiAgICAgIHZhciBLID0gW10sIFYgPSBbXSwgaTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICByZXR1cm4gVltpbmRleE9mLmNhbGwoSywgayldO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgICAgICAgaSA9IGluZGV4T2YuY2FsbChLLCBrKTtcbiAgICAgICAgICBpZiAoaSA8IDApIFZbSy5wdXNoKGspIC0gMV0gPSB2O1xuICAgICAgICAgIGVsc2UgVltpXSA9IHY7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBQcm9taXNlID0gd2luZG93LlByb21pc2UgfHwgZnVuY3Rpb24gKGZuKSB7XG4gICAgICB2YXJcbiAgICAgICAgbm90aWZ5ID0gW10sXG4gICAgICAgIGRvbmUgPSBmYWxzZSxcbiAgICAgICAgcCA9IHtcbiAgICAgICAgICAnY2F0Y2gnOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICB9LFxuICAgICAgICAgICd0aGVuJzogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICBub3RpZnkucHVzaChjYik7XG4gICAgICAgICAgICBpZiAoZG9uZSkgc2V0VGltZW91dChyZXNvbHZlLCAxKTtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgO1xuICAgICAgZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSkge1xuICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKG5vdGlmeS5sZW5ndGgpIG5vdGlmeS5zaGlmdCgpKHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGZuKHJlc29sdmUpO1xuICAgICAgcmV0dXJuIHA7XG4gICAgfSxcbiAgICBqdXN0Q3JlYXRlZCA9IGZhbHNlLFxuICAgIGNvbnN0cnVjdG9ycyA9IERpY3QobnVsbCksXG4gICAgd2FpdGluZ0xpc3QgPSBEaWN0KG51bGwpLFxuICAgIG5vZGVOYW1lcyA9IG5ldyBNYXAoKSxcbiAgICBzZWNvbmRBcmd1bWVudCA9IGZ1bmN0aW9uIChpcykge1xuICAgICAgcmV0dXJuIGlzLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZCB0byBjcmVhdGUgdW5pcXVlIGluc3RhbmNlc1xuICAgIGNyZWF0ZSA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gQnJpZGdlKHByb3RvKSB7XG4gICAgICAvLyBzaWxseSBicm9rZW4gcG9seWZpbGwgcHJvYmFibHkgZXZlciB1c2VkIGJ1dCBzaG9ydCBlbm91Z2ggdG8gd29ya1xuICAgICAgcmV0dXJuIHByb3RvID8gKChCcmlkZ2UucHJvdG90eXBlID0gcHJvdG8pLCBuZXcgQnJpZGdlKCkpIDogdGhpcztcbiAgICB9LFxuICBcbiAgICAvLyB3aWxsIHNldCB0aGUgcHJvdG90eXBlIGlmIHBvc3NpYmxlXG4gICAgLy8gb3IgY29weSBvdmVyIGFsbCBwcm9wZXJ0aWVzXG4gICAgc2V0UHJvdG90eXBlID0gc1BPIHx8IChcbiAgICAgIGhhc1Byb3RvID9cbiAgICAgICAgZnVuY3Rpb24gKG8sIHApIHtcbiAgICAgICAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH0gOiAoXG4gICAgICAoZ09QTiAmJiBnT1BEKSA/XG4gICAgICAgIChmdW5jdGlvbigpe1xuICAgICAgICAgIGZ1bmN0aW9uIHNldFByb3BlcnRpZXMobywgcCkge1xuICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBuYW1lcyA9IGdPUE4ocCksXG4gICAgICAgICAgICAgIGkgPSAwLCBsZW5ndGggPSBuYW1lcy5sZW5ndGg7XG4gICAgICAgICAgICAgIGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIGtleSA9IG5hbWVzW2ldO1xuICAgICAgICAgICAgICBpZiAoIWhPUC5jYWxsKG8sIGtleSkpIHtcbiAgICAgICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShvLCBrZXksIGdPUEQocCwga2V5KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvLCBwKSB7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIHNldFByb3BlcnRpZXMobywgcCk7XG4gICAgICAgICAgICB9IHdoaWxlICgocCA9IGdQTyhwKSkgJiYgIWlQTy5jYWxsKHAsIG8pKTtcbiAgICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICAgIH07XG4gICAgICAgIH0oKSkgOlxuICAgICAgICBmdW5jdGlvbiAobywgcCkge1xuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwKSB7XG4gICAgICAgICAgICBvW2tleV0gPSBwW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICB9XG4gICAgKSksXG4gIFxuICAgIC8vIERPTSBzaG9ydGN1dHMgYW5kIGhlbHBlcnMsIGlmIGFueVxuICBcbiAgICBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsXG4gIFxuICAgIEhUTUxFbGVtZW50UHJvdG90eXBlID0gKFxuICAgICAgd2luZG93LkhUTUxFbGVtZW50IHx8XG4gICAgICB3aW5kb3cuRWxlbWVudCB8fFxuICAgICAgd2luZG93Lk5vZGVcbiAgICApLnByb3RvdHlwZSxcbiAgXG4gICAgSUU4ID0gIWlQTy5jYWxsKEhUTUxFbGVtZW50UHJvdG90eXBlLCBkb2N1bWVudEVsZW1lbnQpLFxuICBcbiAgICBzYWZlUHJvcGVydHkgPSBJRTggPyBmdW5jdGlvbiAobywgaywgZCkge1xuICAgICAgb1trXSA9IGQudmFsdWU7XG4gICAgICByZXR1cm4gbztcbiAgICB9IDogZGVmaW5lUHJvcGVydHksXG4gIFxuICAgIGlzVmFsaWROb2RlID0gSUU4ID9cbiAgICAgIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSAxO1xuICAgICAgfSA6XG4gICAgICBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsIG5vZGUpO1xuICAgICAgfSxcbiAgXG4gICAgdGFyZ2V0cyA9IElFOCAmJiBbXSxcbiAgXG4gICAgYXR0YWNoU2hhZG93ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuYXR0YWNoU2hhZG93LFxuICAgIGNsb25lTm9kZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSxcbiAgICBkaXNwYXRjaEV2ZW50ID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuZGlzcGF0Y2hFdmVudCxcbiAgICBnZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5nZXRBdHRyaWJ1dGUsXG4gICAgaGFzQXR0cmlidXRlID0gSFRNTEVsZW1lbnRQcm90b3R5cGUuaGFzQXR0cmlidXRlLFxuICAgIHJlbW92ZUF0dHJpYnV0ZSA9IEhUTUxFbGVtZW50UHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZSxcbiAgICBzZXRBdHRyaWJ1dGUgPSBIVE1MRWxlbWVudFByb3RvdHlwZS5zZXRBdHRyaWJ1dGUsXG4gIFxuICAgIC8vIHJlcGxhY2VkIGxhdGVyIG9uXG4gICAgY3JlYXRlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQsXG4gICAgcGF0Y2hlZENyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50LFxuICBcbiAgICAvLyBzaGFyZWQgb2JzZXJ2ZXIgZm9yIGFsbCBhdHRyaWJ1dGVzXG4gICAgYXR0cmlidXRlc09ic2VydmVyID0gTXV0YXRpb25PYnNlcnZlciAmJiB7XG4gICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcbiAgICAgIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlXG4gICAgfSxcbiAgXG4gICAgLy8gdXNlZnVsIHRvIGRldGVjdCBvbmx5IGlmIHRoZXJlJ3Mgbm8gTXV0YXRpb25PYnNlcnZlclxuICAgIERPTUF0dHJNb2RpZmllZCA9IE11dGF0aW9uT2JzZXJ2ZXIgfHwgZnVuY3Rpb24oZSkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICBET01fQVRUUl9NT0RJRklFRCxcbiAgICAgICAgRE9NQXR0ck1vZGlmaWVkXG4gICAgICApO1xuICAgIH0sXG4gIFxuICAgIC8vIHdpbGwgYm90aCBiZSB1c2VkIHRvIG1ha2UgRE9NTm9kZUluc2VydGVkIGFzeW5jaHJvbm91c1xuICAgIGFzYXBRdWV1ZSxcbiAgICBhc2FwVGltZXIgPSAwLFxuICBcbiAgICAvLyBpbnRlcm5hbCBmbGFnc1xuICAgIFYwID0gUkVHSVNURVJfRUxFTUVOVCBpbiBkb2N1bWVudCxcbiAgICBzZXRMaXN0ZW5lciA9IHRydWUsXG4gICAganVzdFNldHVwID0gZmFsc2UsXG4gICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSB0cnVlLFxuICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gdHJ1ZSxcbiAgXG4gICAgLy8gbmVlZGVkIGZvciB0aGUgaW5uZXJIVE1MIGhlbHBlclxuICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSB0cnVlLFxuICBcbiAgICAvLyBvcHRpb25hbGx5IGRlZmluZWQgbGF0ZXIgb25cbiAgICBvblN1YnRyZWVNb2RpZmllZCxcbiAgICBjYWxsRE9NQXR0ck1vZGlmaWVkLFxuICAgIGdldEF0dHJpYnV0ZXNNaXJyb3IsXG4gICAgb2JzZXJ2ZXIsXG4gICAgb2JzZXJ2ZSxcbiAgXG4gICAgLy8gYmFzZWQgb24gc2V0dGluZyBwcm90b3R5cGUgY2FwYWJpbGl0eVxuICAgIC8vIHdpbGwgY2hlY2sgcHJvdG8gb3IgdGhlIGV4cGFuZG8gYXR0cmlidXRlXG4gICAgLy8gaW4gb3JkZXIgdG8gc2V0dXAgdGhlIG5vZGUgb25jZVxuICAgIHBhdGNoSWZOb3RBbHJlYWR5LFxuICAgIHBhdGNoXG4gIDtcbiAgXG4gIC8vIG9ubHkgaWYgbmVlZGVkXG4gIGlmICghVjApIHtcbiAgXG4gICAgaWYgKHNQTyB8fCBoYXNQcm90bykge1xuICAgICAgICBwYXRjaElmTm90QWxyZWFkeSA9IGZ1bmN0aW9uIChub2RlLCBwcm90bykge1xuICAgICAgICAgIGlmICghaVBPLmNhbGwocHJvdG8sIG5vZGUpKSB7XG4gICAgICAgICAgICBzZXR1cE5vZGUobm9kZSwgcHJvdG8pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcGF0Y2ggPSBzZXR1cE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcGF0Y2hJZk5vdEFscmVhZHkgPSBmdW5jdGlvbiAobm9kZSwgcHJvdG8pIHtcbiAgICAgICAgICBpZiAoIW5vZGVbRVhQQU5ET19VSURdKSB7XG4gICAgICAgICAgICBub2RlW0VYUEFORE9fVUlEXSA9IE9iamVjdCh0cnVlKTtcbiAgICAgICAgICAgIHNldHVwTm9kZShub2RlLCBwcm90byk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBwYXRjaCA9IHBhdGNoSWZOb3RBbHJlYWR5O1xuICAgIH1cbiAgXG4gICAgaWYgKElFOCkge1xuICAgICAgZG9lc05vdFN1cHBvcnRET01BdHRyTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgIChmdW5jdGlvbiAoKXtcbiAgICAgICAgdmFyXG4gICAgICAgICAgZGVzY3JpcHRvciA9IGdPUEQoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiksXG4gICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lciA9IGRlc2NyaXB0b3IudmFsdWUsXG4gICAgICAgICAgcGF0Y2hlZFJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBDdXN0b21FdmVudChET01fQVRUUl9NT0RJRklFRCwge2J1YmJsZXM6IHRydWV9KTtcbiAgICAgICAgICAgIGUuYXR0ck5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgZS5wcmV2VmFsdWUgPSBnZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgZVtSRU1PVkFMXSA9IGUuYXR0ckNoYW5nZSA9IDI7XG4gICAgICAgICAgICByZW1vdmVBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBhdGNoZWRTZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhclxuICAgICAgICAgICAgICBoYWQgPSBoYXNBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lKSxcbiAgICAgICAgICAgICAgb2xkID0gaGFkICYmIGdldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUpLFxuICAgICAgICAgICAgICBlID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pXG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBlLmF0dHJOYW1lID0gbmFtZTtcbiAgICAgICAgICAgIGUucHJldlZhbHVlID0gaGFkID8gb2xkIDogbnVsbDtcbiAgICAgICAgICAgIGUubmV3VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChoYWQpIHtcbiAgICAgICAgICAgICAgZVtNT0RJRklDQVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGVbQURESVRJT05dID0gZS5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgLy8ganNoaW50IGVxbnVsbDp0cnVlXG4gICAgICAgICAgICB2YXJcbiAgICAgICAgICAgICAgbm9kZSA9IGUuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgICAgc3VwZXJTZWNyZXQgPSBub2RlW0VYUEFORE9fVUlEXSxcbiAgICAgICAgICAgICAgcHJvcGVydHlOYW1lID0gZS5wcm9wZXJ0eU5hbWUsXG4gICAgICAgICAgICAgIGV2ZW50XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBpZiAoc3VwZXJTZWNyZXQuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICBzdXBlclNlY3JldCA9IHN1cGVyU2VjcmV0W3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELCB7YnViYmxlczogdHJ1ZX0pO1xuICAgICAgICAgICAgICBldmVudC5hdHRyTmFtZSA9IHN1cGVyU2VjcmV0Lm5hbWU7XG4gICAgICAgICAgICAgIGV2ZW50LnByZXZWYWx1ZSA9IHN1cGVyU2VjcmV0LnZhbHVlIHx8IG51bGw7XG4gICAgICAgICAgICAgIGV2ZW50Lm5ld1ZhbHVlID0gKHN1cGVyU2VjcmV0LnZhbHVlID0gbm9kZVtwcm9wZXJ0eU5hbWVdIHx8IG51bGwpO1xuICAgICAgICAgICAgICBpZiAoZXZlbnQucHJldlZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBldmVudFtBRERJVElPTl0gPSBldmVudC5hdHRyQ2hhbmdlID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBldmVudFtNT0RJRklDQVRJT05dID0gZXZlbnQuYXR0ckNoYW5nZSA9IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGlzcGF0Y2hFdmVudC5jYWxsKG5vZGUsIGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdHlwZSA9PT0gRE9NX0FUVFJfTU9ESUZJRUQgJiZcbiAgICAgICAgICAgIHRoaXNbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdICYmXG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSAhPT0gcGF0Y2hlZFNldEF0dHJpYnV0ZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGhpc1tFWFBBTkRPX1VJRF0gPSB7XG4gICAgICAgICAgICAgIGNsYXNzTmFtZToge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdjbGFzcycsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuY2xhc3NOYW1lXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZSA9IHBhdGNoZWRSZW1vdmVBdHRyaWJ1dGU7XG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgJ3Byb3BlcnR5Y2hhbmdlJywgb25Qcm9wZXJ0eUNoYW5nZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCB0eXBlLCBoYW5kbGVyLCBjYXB0dXJlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZGVmaW5lUHJvcGVydHkoSFRNTEVsZW1lbnRQcm90b3R5cGUsIEFERF9FVkVOVF9MSVNURU5FUiwgZGVzY3JpcHRvcik7XG4gICAgICB9KCkpO1xuICAgIH0gZWxzZSBpZiAoIU11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudFtBRERfRVZFTlRfTElTVEVORVJdKERPTV9BVFRSX01PRElGSUVELCBET01BdHRyTW9kaWZpZWQpO1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShFWFBBTkRPX1VJRCwgMSk7XG4gICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKEVYUEFORE9fVUlEKTtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBvblN1YnRyZWVNb2RpZmllZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gdGhpcyxcbiAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBuZXdBdHRyaWJ1dGVzLFxuICAgICAgICAgICAga2V5XG4gICAgICAgICAgO1xuICAgICAgICAgIGlmIChub2RlID09PSBlLnRhcmdldCkge1xuICAgICAgICAgICAgb2xkQXR0cmlidXRlcyA9IG5vZGVbRVhQQU5ET19VSURdO1xuICAgICAgICAgICAgbm9kZVtFWFBBTkRPX1VJRF0gPSAobmV3QXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNNaXJyb3Iobm9kZSkpO1xuICAgICAgICAgICAgZm9yIChrZXkgaW4gbmV3QXR0cmlidXRlcykge1xuICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gb2xkQXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgd2FzIGFkZGVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIEFERElUSU9OXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdBdHRyaWJ1dGVzW2tleV0gIT09IG9sZEF0dHJpYnV0ZXNba2V5XSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSB3YXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsRE9NQXR0ck1vZGlmaWVkKFxuICAgICAgICAgICAgICAgICAgMSxcbiAgICAgICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICBvbGRBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBuZXdBdHRyaWJ1dGVzW2tleV0sXG4gICAgICAgICAgICAgICAgICBNT0RJRklDQVRJT05cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVja2luZyBpZiBpdCBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBvbGRBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIGlmICghKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgICAgIC8vIGF0dHJpYnV0ZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoXG4gICAgICAgICAgICAgICAgICAyLFxuICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgIG9sZEF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIG5ld0F0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgIFJFTU9WQUxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjYWxsRE9NQXR0ck1vZGlmaWVkID0gZnVuY3Rpb24gKFxuICAgICAgICAgIGF0dHJDaGFuZ2UsXG4gICAgICAgICAgY3VycmVudFRhcmdldCxcbiAgICAgICAgICBhdHRyTmFtZSxcbiAgICAgICAgICBwcmV2VmFsdWUsXG4gICAgICAgICAgbmV3VmFsdWUsXG4gICAgICAgICAgYWN0aW9uXG4gICAgICAgICkge1xuICAgICAgICAgIHZhciBlID0ge1xuICAgICAgICAgICAgYXR0ckNoYW5nZTogYXR0ckNoYW5nZSxcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXG4gICAgICAgICAgICBhdHRyTmFtZTogYXR0ck5hbWUsXG4gICAgICAgICAgICBwcmV2VmFsdWU6IHByZXZWYWx1ZSxcbiAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWx1ZVxuICAgICAgICAgIH07XG4gICAgICAgICAgZVthY3Rpb25dID0gYXR0ckNoYW5nZTtcbiAgICAgICAgICBvbkRPTUF0dHJNb2RpZmllZChlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0QXR0cmlidXRlc01pcnJvciA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgIGF0dHIsIG5hbWUsXG4gICAgICAgICAgICByZXN1bHQgPSB7fSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gYXR0cmlidXRlcy5sZW5ndGg7XG4gICAgICAgICAgICBpIDwgbGVuZ3RoOyBpKytcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgICAgICAgbmFtZSA9IGF0dHIubmFtZTtcbiAgICAgICAgICAgIGlmIChuYW1lICE9PSAnc2V0QXR0cmlidXRlJykge1xuICAgICAgICAgICAgICByZXN1bHRbbmFtZV0gPSBhdHRyLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgXG4gICAgLy8gc2V0IGFzIGVudW1lcmFibGUsIHdyaXRhYmxlIGFuZCBjb25maWd1cmFibGVcbiAgICBkb2N1bWVudFtSRUdJU1RFUl9FTEVNRU5UXSA9IGZ1bmN0aW9uIHJlZ2lzdGVyRWxlbWVudCh0eXBlLCBvcHRpb25zKSB7XG4gICAgICB1cHBlclR5cGUgPSB0eXBlLnRvVXBwZXJDYXNlKCk7XG4gICAgICBpZiAoc2V0TGlzdGVuZXIpIHtcbiAgICAgICAgLy8gb25seSBmaXJzdCB0aW1lIGRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudCBpcyB1c2VkXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gc2V0IHRoaXMgbGlzdGVuZXJcbiAgICAgICAgLy8gc2V0dGluZyBpdCBieSBkZWZhdWx0IG1pZ2h0IHNsb3cgZG93biBmb3Igbm8gcmVhc29uXG4gICAgICAgIHNldExpc3RlbmVyID0gZmFsc2U7XG4gICAgICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIgPSAoZnVuY3Rpb24oYXR0YWNoZWQsIGRldGFjaGVkKXtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrRW1BbGwobGlzdCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBjYWxsYmFjayhsaXN0W2krK10pKXt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKHJlY29yZHMpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXJcbiAgICAgICAgICAgICAgICBjdXJyZW50LCBub2RlLCBuZXdWYWx1ZSxcbiAgICAgICAgICAgICAgICBpID0gMCwgbGVuZ3RoID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrK1xuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gcmVjb3Jkc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgY2hlY2tFbUFsbChjdXJyZW50LmFkZGVkTm9kZXMsIGF0dGFjaGVkKTtcbiAgICAgICAgICAgICAgICAgIGNoZWNrRW1BbGwoY3VycmVudC5yZW1vdmVkTm9kZXMsIGRldGFjaGVkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgbm9kZSA9IGN1cnJlbnQudGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgaWYgKG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICBub2RlW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSAmJlxuICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuYXR0cmlidXRlTmFtZSAhPT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IGdldEF0dHJpYnV0ZS5jYWxsKG5vZGUsIGN1cnJlbnQuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY3VycmVudC5vbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgIG5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdKFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5vbGRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfShleGVjdXRlQWN0aW9uKEFUVEFDSEVEKSwgZXhlY3V0ZUFjdGlvbihERVRBQ0hFRCkpKTtcbiAgICAgICAgICBvYnNlcnZlID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoXG4gICAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBvYnNlcnZlKGRvY3VtZW50KTtcbiAgICAgICAgICBpZiAoYXR0YWNoU2hhZG93KSB7XG4gICAgICAgICAgICBIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlKGF0dGFjaFNoYWRvdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFzYXBRdWV1ZSA9IFtdO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVJbnNlcnRlZCcsIG9uRE9NTm9kZShBVFRBQ0hFRCkpO1xuICAgICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oJ0RPTU5vZGVSZW1vdmVkJywgb25ET01Ob2RlKERFVEFDSEVEKSk7XG4gICAgICAgIH1cbiAgXG4gICAgICAgIGRvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0NPTlRFTlRfTE9BREVELCBvblJlYWR5U3RhdGVDaGFuZ2UpO1xuICAgICAgICBkb2N1bWVudFtBRERfRVZFTlRfTElTVEVORVJdKCdyZWFkeXN0YXRlY2hhbmdlJywgb25SZWFkeVN0YXRlQ2hhbmdlKTtcbiAgXG4gICAgICAgIEhUTUxFbGVtZW50UHJvdG90eXBlLmNsb25lTm9kZSA9IGZ1bmN0aW9uIChkZWVwKSB7XG4gICAgICAgICAgdmFyXG4gICAgICAgICAgICBub2RlID0gY2xvbmVOb2RlLmNhbGwodGhpcywgISFkZWVwKSxcbiAgICAgICAgICAgIGkgPSBnZXRUeXBlSW5kZXgobm9kZSlcbiAgICAgICAgICA7XG4gICAgICAgICAgaWYgKC0xIDwgaSkgcGF0Y2gobm9kZSwgcHJvdG9zW2ldKTtcbiAgICAgICAgICBpZiAoZGVlcCAmJiBxdWVyeS5sZW5ndGgpIGxvb3BBbmRTZXR1cChub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpKTtcbiAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoanVzdFNldHVwKSByZXR1cm4gKGp1c3RTZXR1cCA9IGZhbHNlKTtcbiAgXG4gICAgICBpZiAoLTIgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX0lTICsgdXBwZXJUeXBlKSArXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIHVwcGVyVHlwZSlcbiAgICAgICkpIHtcbiAgICAgICAgdGhyb3dUeXBlRXJyb3IodHlwZSk7XG4gICAgICB9XG4gIFxuICAgICAgaWYgKCF2YWxpZE5hbWUudGVzdCh1cHBlclR5cGUpIHx8IC0xIDwgaW5kZXhPZi5jYWxsKGludmFsaWROYW1lcywgdXBwZXJUeXBlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSB0eXBlICcgKyB0eXBlICsgJyBpcyBpbnZhbGlkJyk7XG4gICAgICB9XG4gIFxuICAgICAgdmFyXG4gICAgICAgIGNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBleHRlbmRpbmcgP1xuICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSwgdXBwZXJUeXBlKSA6XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTtcbiAgICAgICAgfSxcbiAgICAgICAgb3B0ID0gb3B0aW9ucyB8fCBPUCxcbiAgICAgICAgZXh0ZW5kaW5nID0gaE9QLmNhbGwob3B0LCBFWFRFTkRTKSxcbiAgICAgICAgbm9kZU5hbWUgPSBleHRlbmRpbmcgPyBvcHRpb25zW0VYVEVORFNdLnRvVXBwZXJDYXNlKCkgOiB1cHBlclR5cGUsXG4gICAgICAgIHVwcGVyVHlwZSxcbiAgICAgICAgaVxuICAgICAgO1xuICBcbiAgICAgIGlmIChleHRlbmRpbmcgJiYgLTEgPCAoXG4gICAgICAgIGluZGV4T2YuY2FsbCh0eXBlcywgUFJFRklYX1RBRyArIG5vZGVOYW1lKVxuICAgICAgKSkge1xuICAgICAgICB0aHJvd1R5cGVFcnJvcihub2RlTmFtZSk7XG4gICAgICB9XG4gIFxuICAgICAgaSA9IHR5cGVzLnB1c2goKGV4dGVuZGluZyA/IFBSRUZJWF9JUyA6IFBSRUZJWF9UQUcpICsgdXBwZXJUeXBlKSAtIDE7XG4gIFxuICAgICAgcXVlcnkgPSBxdWVyeS5jb25jYXQoXG4gICAgICAgIHF1ZXJ5Lmxlbmd0aCA/ICcsJyA6ICcnLFxuICAgICAgICBleHRlbmRpbmcgPyBub2RlTmFtZSArICdbaXM9XCInICsgdHlwZS50b0xvd2VyQ2FzZSgpICsgJ1wiXScgOiBub2RlTmFtZVxuICAgICAgKTtcbiAgXG4gICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAoXG4gICAgICAgIHByb3Rvc1tpXSA9IGhPUC5jYWxsKG9wdCwgJ3Byb3RvdHlwZScpID9cbiAgICAgICAgICBvcHQucHJvdG90eXBlIDpcbiAgICAgICAgICBjcmVhdGUoSFRNTEVsZW1lbnRQcm90b3R5cGUpXG4gICAgICApO1xuICBcbiAgICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICBBVFRBQ0hFRFxuICAgICAgKTtcbiAgXG4gICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgfTtcbiAgXG4gICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IChwYXRjaGVkQ3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChsb2NhbE5hbWUsIHR5cGVFeHRlbnNpb24pIHtcbiAgICAgIHZhclxuICAgICAgICBpcyA9IGdldElzKHR5cGVFeHRlbnNpb24pLFxuICAgICAgICBub2RlID0gaXMgP1xuICAgICAgICAgIGNyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCwgbG9jYWxOYW1lLCBzZWNvbmRBcmd1bWVudChpcykpIDpcbiAgICAgICAgICBjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsIGxvY2FsTmFtZSksXG4gICAgICAgIG5hbWUgPSAnJyArIGxvY2FsTmFtZSxcbiAgICAgICAgaSA9IGluZGV4T2YuY2FsbChcbiAgICAgICAgICB0eXBlcyxcbiAgICAgICAgICAoaXMgPyBQUkVGSVhfSVMgOiBQUkVGSVhfVEFHKSArXG4gICAgICAgICAgKGlzIHx8IG5hbWUpLnRvVXBwZXJDYXNlKClcbiAgICAgICAgKSxcbiAgICAgICAgc2V0dXAgPSAtMSA8IGlcbiAgICAgIDtcbiAgICAgIGlmIChpcykge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnaXMnLCBpcyA9IGlzLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBpZiAoc2V0dXApIHtcbiAgICAgICAgICBzZXR1cCA9IGlzSW5RU0EobmFtZS50b1VwcGVyQ2FzZSgpLCBpcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG5vdEZyb21Jbm5lckhUTUxIZWxwZXIgPSAhZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5pbm5lckhUTUxIZWxwZXI7XG4gICAgICBpZiAoc2V0dXApIHBhdGNoKG5vZGUsIHByb3Rvc1tpXSk7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9KTtcbiAgXG4gIH1cbiAgXG4gIGZ1bmN0aW9uIEFTQVAoKSB7XG4gICAgdmFyIHF1ZXVlID0gYXNhcFF1ZXVlLnNwbGljZSgwLCBhc2FwUXVldWUubGVuZ3RoKTtcbiAgICBhc2FwVGltZXIgPSAwO1xuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgIHF1ZXVlLnNoaWZ0KCkuY2FsbChcbiAgICAgICAgbnVsbCwgcXVldWUuc2hpZnQoKVxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGxvb3BBbmRWZXJpZnkobGlzdCwgYWN0aW9uKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZlcmlmeUFuZFNldHVwQW5kQWN0aW9uKGxpc3RbaV0sIGFjdGlvbik7XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiBsb29wQW5kU2V0dXAobGlzdCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aCwgbm9kZTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBub2RlID0gbGlzdFtpXTtcbiAgICAgIHBhdGNoKG5vZGUsIHByb3Rvc1tnZXRUeXBlSW5kZXgobm9kZSldKTtcbiAgICB9XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGV4ZWN1dGVBY3Rpb24oYWN0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICBpZiAoaXNWYWxpZE5vZGUobm9kZSkpIHtcbiAgICAgICAgdmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obm9kZSwgYWN0aW9uKTtcbiAgICAgICAgaWYgKHF1ZXJ5Lmxlbmd0aCkgbG9vcEFuZFZlcmlmeShcbiAgICAgICAgICBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgICAgIGFjdGlvblxuICAgICAgICApO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGdldFR5cGVJbmRleCh0YXJnZXQpIHtcbiAgICB2YXJcbiAgICAgIGlzID0gZ2V0QXR0cmlidXRlLmNhbGwodGFyZ2V0LCAnaXMnKSxcbiAgICAgIG5vZGVOYW1lID0gdGFyZ2V0Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCksXG4gICAgICBpID0gaW5kZXhPZi5jYWxsKFxuICAgICAgICB0eXBlcyxcbiAgICAgICAgaXMgP1xuICAgICAgICAgICAgUFJFRklYX0lTICsgaXMudG9VcHBlckNhc2UoKSA6XG4gICAgICAgICAgICBQUkVGSVhfVEFHICsgbm9kZU5hbWVcbiAgICAgIClcbiAgICA7XG4gICAgcmV0dXJuIGlzICYmIC0xIDwgaSAmJiAhaXNJblFTQShub2RlTmFtZSwgaXMpID8gLTEgOiBpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBpc0luUVNBKG5hbWUsIHR5cGUpIHtcbiAgICByZXR1cm4gLTEgPCBxdWVyeS5pbmRleE9mKG5hbWUgKyAnW2lzPVwiJyArIHR5cGUgKyAnXCJdJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG9uRE9NQXR0ck1vZGlmaWVkKGUpIHtcbiAgICB2YXJcbiAgICAgIG5vZGUgPSBlLmN1cnJlbnRUYXJnZXQsXG4gICAgICBhdHRyQ2hhbmdlID0gZS5hdHRyQ2hhbmdlLFxuICAgICAgYXR0ck5hbWUgPSBlLmF0dHJOYW1lLFxuICAgICAgdGFyZ2V0ID0gZS50YXJnZXQsXG4gICAgICBhZGRpdGlvbiA9IGVbQURESVRJT05dIHx8IDIsXG4gICAgICByZW1vdmFsID0gZVtSRU1PVkFMXSB8fCAzXG4gICAgO1xuICAgIGlmIChub3RGcm9tSW5uZXJIVE1MSGVscGVyICYmXG4gICAgICAgICghdGFyZ2V0IHx8IHRhcmdldCA9PT0gbm9kZSkgJiZcbiAgICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10gJiZcbiAgICAgICAgYXR0ck5hbWUgIT09ICdzdHlsZScgJiYgKFxuICAgICAgICAgIGUucHJldlZhbHVlICE9PSBlLm5ld1ZhbHVlIHx8XG4gICAgICAgICAgLy8gSUU5LCBJRTEwLCBhbmQgT3BlcmEgMTIgZ290Y2hhXG4gICAgICAgICAgZS5uZXdWYWx1ZSA9PT0gJycgJiYgKFxuICAgICAgICAgICAgYXR0ckNoYW5nZSA9PT0gYWRkaXRpb24gfHxcbiAgICAgICAgICAgIGF0dHJDaGFuZ2UgPT09IHJlbW92YWxcbiAgICAgICAgICApXG4gICAgKSkge1xuICAgICAgbm9kZVtBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDS10oXG4gICAgICAgIGF0dHJOYW1lLFxuICAgICAgICBhdHRyQ2hhbmdlID09PSBhZGRpdGlvbiA/IG51bGwgOiBlLnByZXZWYWx1ZSxcbiAgICAgICAgYXR0ckNoYW5nZSA9PT0gcmVtb3ZhbCA/IG51bGwgOiBlLm5ld1ZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gb25ET01Ob2RlKGFjdGlvbikge1xuICAgIHZhciBleGVjdXRvciA9IGV4ZWN1dGVBY3Rpb24oYWN0aW9uKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGFzYXBRdWV1ZS5wdXNoKGV4ZWN1dG9yLCBlLnRhcmdldCk7XG4gICAgICBpZiAoYXNhcFRpbWVyKSBjbGVhclRpbWVvdXQoYXNhcFRpbWVyKTtcbiAgICAgIGFzYXBUaW1lciA9IHNldFRpbWVvdXQoQVNBUCwgMSk7XG4gICAgfTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICBpZiAoZHJvcERvbUNvbnRlbnRMb2FkZWQpIHtcbiAgICAgIGRyb3BEb21Db250ZW50TG9hZGVkID0gZmFsc2U7XG4gICAgICBlLmN1cnJlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihET01fQ09OVEVOVF9MT0FERUQsIG9uUmVhZHlTdGF0ZUNoYW5nZSk7XG4gICAgfVxuICAgIGlmIChxdWVyeS5sZW5ndGgpIGxvb3BBbmRWZXJpZnkoXG4gICAgICAoZS50YXJnZXQgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLFxuICAgICAgZS5kZXRhaWwgPT09IERFVEFDSEVEID8gREVUQUNIRUQgOiBBVFRBQ0hFRFxuICAgICk7XG4gICAgaWYgKElFOCkgcHVyZ2UoKTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcGF0Y2hlZFNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSkge1xuICAgIC8vIGpzaGludCB2YWxpZHRoaXM6dHJ1ZVxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZXRBdHRyaWJ1dGUuY2FsbChzZWxmLCBuYW1lLCB2YWx1ZSk7XG4gICAgb25TdWJ0cmVlTW9kaWZpZWQuY2FsbChzZWxmLCB7dGFyZ2V0OiBzZWxmfSk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHNldHVwTm9kZShub2RlLCBwcm90bykge1xuICAgIHNldFByb3RvdHlwZShub2RlLCBwcm90byk7XG4gICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIGF0dHJpYnV0ZXNPYnNlcnZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCkge1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSA9IHBhdGNoZWRTZXRBdHRyaWJ1dGU7XG4gICAgICAgIG5vZGVbRVhQQU5ET19VSURdID0gZ2V0QXR0cmlidXRlc01pcnJvcihub2RlKTtcbiAgICAgICAgbm9kZVtBRERfRVZFTlRfTElTVEVORVJdKERPTV9TVUJUUkVFX01PRElGSUVELCBvblN1YnRyZWVNb2RpZmllZCk7XG4gICAgICB9XG4gICAgICBub2RlW0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsIG9uRE9NQXR0ck1vZGlmaWVkKTtcbiAgICB9XG4gICAgaWYgKG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10gJiYgbm90RnJvbUlubmVySFRNTEhlbHBlcikge1xuICAgICAgbm9kZS5jcmVhdGVkID0gdHJ1ZTtcbiAgICAgIG5vZGVbQ1JFQVRFRF9DQUxMQkFDS10oKTtcbiAgICAgIG5vZGUuY3JlYXRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gcHVyZ2UoKSB7XG4gICAgZm9yICh2YXJcbiAgICAgIG5vZGUsXG4gICAgICBpID0gMCxcbiAgICAgIGxlbmd0aCA9IHRhcmdldHMubGVuZ3RoO1xuICAgICAgaSA8IGxlbmd0aDsgaSsrXG4gICAgKSB7XG4gICAgICBub2RlID0gdGFyZ2V0c1tpXTtcbiAgICAgIGlmICghZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpKSB7XG4gICAgICAgIGxlbmd0aC0tO1xuICAgICAgICB0YXJnZXRzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBERVRBQ0hFRCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBmdW5jdGlvbiB0aHJvd1R5cGVFcnJvcih0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBICcgKyB0eXBlICsgJyB0eXBlIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCcpO1xuICB9XG4gIFxuICBmdW5jdGlvbiB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLCBhY3Rpb24pIHtcbiAgICB2YXJcbiAgICAgIGZuLFxuICAgICAgaSA9IGdldFR5cGVJbmRleChub2RlKVxuICAgIDtcbiAgICBpZiAoLTEgPCBpKSB7XG4gICAgICBwYXRjaElmTm90QWxyZWFkeShub2RlLCBwcm90b3NbaV0pO1xuICAgICAgaSA9IDA7XG4gICAgICBpZiAoYWN0aW9uID09PSBBVFRBQ0hFRCAmJiAhbm9kZVtBVFRBQ0hFRF0pIHtcbiAgICAgICAgbm9kZVtERVRBQ0hFRF0gPSBmYWxzZTtcbiAgICAgICAgbm9kZVtBVFRBQ0hFRF0gPSB0cnVlO1xuICAgICAgICBpID0gMTtcbiAgICAgICAgaWYgKElFOCAmJiBpbmRleE9mLmNhbGwodGFyZ2V0cywgbm9kZSkgPCAwKSB7XG4gICAgICAgICAgdGFyZ2V0cy5wdXNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gREVUQUNIRUQgJiYgIW5vZGVbREVUQUNIRURdKSB7XG4gICAgICAgIG5vZGVbQVRUQUNIRURdID0gZmFsc2U7XG4gICAgICAgIG5vZGVbREVUQUNIRURdID0gdHJ1ZTtcbiAgICAgICAgaSA9IDE7XG4gICAgICB9XG4gICAgICBpZiAoaSAmJiAoZm4gPSBub2RlW2FjdGlvbiArIENBTExCQUNLXSkpIGZuLmNhbGwobm9kZSk7XG4gICAgfVxuICB9XG4gIFxuICBcbiAgXG4gIC8vIFYxIGluIGRhIEhvdXNlIVxuICBmdW5jdGlvbiBDdXN0b21FbGVtZW50UmVnaXN0cnkoKSB7fVxuICBcbiAgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LFxuICAgIC8vIGEgd29ya2Fyb3VuZCBmb3IgdGhlIHN0dWJib3JuIFdlYktpdFxuICAgIGRlZmluZTogdXNhYmxlQ3VzdG9tRWxlbWVudHMgP1xuICAgICAgZnVuY3Rpb24gKG5hbWUsIENsYXNzLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgQ0VSRGVmaW5lKG5hbWUsIENsYXNzLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgTkFNRSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBjb25zdHJ1Y3RvcnNbTkFNRV0gPSB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICAgICAgICBjcmVhdGU6IFtOQU1FXVxuICAgICAgICAgIH07XG4gICAgICAgICAgbm9kZU5hbWVzLnNldChDbGFzcywgTkFNRSk7XG4gICAgICAgICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgfSA6XG4gICAgICBDRVJEZWZpbmUsXG4gICAgZ2V0OiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRWxlbWVudHMuZ2V0KG5hbWUpIHx8IGdldChuYW1lKTtcbiAgICAgIH0gOlxuICAgICAgZ2V0LFxuICAgIHdoZW5EZWZpbmVkOiB1c2FibGVDdXN0b21FbGVtZW50cyA/XG4gICAgICBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZChuYW1lKSxcbiAgICAgICAgICB3aGVuRGVmaW5lZChuYW1lKVxuICAgICAgICBdKTtcbiAgICAgIH0gOlxuICAgICAgd2hlbkRlZmluZWRcbiAgfTtcbiAgXG4gIGZ1bmN0aW9uIENFUkRlZmluZShuYW1lLCBDbGFzcywgb3B0aW9ucykge1xuICAgIHZhclxuICAgICAgaXMgPSBvcHRpb25zICYmIG9wdGlvbnNbRVhURU5EU10gfHwgJycsXG4gICAgICBDUHJvdG8gPSBDbGFzcy5wcm90b3R5cGUsXG4gICAgICBwcm90byA9IGNyZWF0ZShDUHJvdG8pLFxuICAgICAgYXR0cmlidXRlcyA9IENsYXNzLm9ic2VydmVkQXR0cmlidXRlcyB8fCBlbXB0eSxcbiAgICAgIGRlZmluaXRpb24gPSB7cHJvdG90eXBlOiBwcm90b31cbiAgICA7XG4gICAgLy8gVE9ETzogaXMgdGhpcyBuZWVkZWQgYXQgYWxsIHNpbmNlIGl0J3MgaW5oZXJpdGVkP1xuICAgIC8vIGRlZmluZVByb3BlcnR5KHByb3RvLCAnY29uc3RydWN0b3InLCB7dmFsdWU6IENsYXNzfSk7XG4gICAgc2FmZVByb3BlcnR5KHByb3RvLCBDUkVBVEVEX0NBTExCQUNLLCB7XG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKGp1c3RDcmVhdGVkKSBqdXN0Q3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgIGVsc2UgaWYgKCF0aGlzW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICB0aGlzW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgIG5ldyBDbGFzcyh0aGlzKTtcbiAgICAgICAgICAgIGlmIChDUHJvdG9bQ1JFQVRFRF9DQUxMQkFDS10pXG4gICAgICAgICAgICAgIENQcm90b1tDUkVBVEVEX0NBTExCQUNLXS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBjb25zdHJ1Y3RvcnNbbm9kZU5hbWVzLmdldChDbGFzcyldO1xuICAgICAgICAgICAgaWYgKCF1c2FibGVDdXN0b21FbGVtZW50cyB8fCBpbmZvLmNyZWF0ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgIG5vdGlmeUF0dHJpYnV0ZXModGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHNhZmVQcm9wZXJ0eShwcm90bywgQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0ssIHtcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICBpZiAoLTEgPCBpbmRleE9mLmNhbGwoYXR0cmlidXRlcywgbmFtZSkpXG4gICAgICAgICAgQ1Byb3RvW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXSkge1xuICAgICAgc2FmZVByb3BlcnR5KHByb3RvLCBBVFRBQ0hFRF9DQUxMQkFDSywge1xuICAgICAgICB2YWx1ZTogQ1Byb3RvW0NPTk5FQ1RFRF9DQUxMQkFDS11cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoQ1Byb3RvW0RJU0NPTk5FQ1RFRF9DQUxMQkFDS10pIHtcbiAgICAgIHNhZmVQcm9wZXJ0eShwcm90bywgREVUQUNIRURfQ0FMTEJBQ0ssIHtcbiAgICAgICAgdmFsdWU6IENQcm90b1tESVNDT05ORUNURURfQ0FMTEJBQ0tdXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzKSBkZWZpbml0aW9uW0VYVEVORFNdID0gaXM7XG4gICAgbmFtZSA9IG5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBjb25zdHJ1Y3RvcnNbbmFtZV0gPSB7XG4gICAgICBjb25zdHJ1Y3RvcjogQ2xhc3MsXG4gICAgICBjcmVhdGU6IGlzID8gW2lzLCBzZWNvbmRBcmd1bWVudChuYW1lKV0gOiBbbmFtZV1cbiAgICB9O1xuICAgIG5vZGVOYW1lcy5zZXQoQ2xhc3MsIG5hbWUpO1xuICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKG5hbWUudG9Mb3dlckNhc2UoKSwgZGVmaW5pdGlvbik7XG4gICAgd2hlbkRlZmluZWQobmFtZSk7XG4gICAgd2FpdGluZ0xpc3RbbmFtZV0ucigpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXQobmFtZSkge1xuICAgIHZhciBpbmZvID0gY29uc3RydWN0b3JzW25hbWUudG9VcHBlckNhc2UoKV07XG4gICAgcmV0dXJuIGluZm8gJiYgaW5mby5jb25zdHJ1Y3RvcjtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0SXMob3B0aW9ucykge1xuICAgIHJldHVybiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ3N0cmluZycgP1xuICAgICAgICBvcHRpb25zIDogKG9wdGlvbnMgJiYgb3B0aW9ucy5pcyB8fCAnJyk7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIG5vdGlmeUF0dHJpYnV0ZXMoc2VsZikge1xuICAgIHZhclxuICAgICAgY2FsbGJhY2sgPSBzZWxmW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSxcbiAgICAgIGF0dHJpYnV0ZXMgPSBjYWxsYmFjayA/IHNlbGYuYXR0cmlidXRlcyA6IGVtcHR5LFxuICAgICAgaSA9IGF0dHJpYnV0ZXMubGVuZ3RoLFxuICAgICAgYXR0cmlidXRlXG4gICAgO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGF0dHJpYnV0ZSA9ICBhdHRyaWJ1dGVzW2ldOyAvLyB8fCBhdHRyaWJ1dGVzLml0ZW0oaSk7XG4gICAgICBjYWxsYmFjay5jYWxsKFxuICAgICAgICBzZWxmLFxuICAgICAgICBhdHRyaWJ1dGUubmFtZSB8fCBhdHRyaWJ1dGUubm9kZU5hbWUsXG4gICAgICAgIG51bGwsXG4gICAgICAgIGF0dHJpYnV0ZS52YWx1ZSB8fCBhdHRyaWJ1dGUubm9kZVZhbHVlXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gd2hlbkRlZmluZWQobmFtZSkge1xuICAgIG5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgaWYgKCEobmFtZSBpbiB3YWl0aW5nTGlzdCkpIHtcbiAgICAgIHdhaXRpbmdMaXN0W25hbWVdID0ge307XG4gICAgICB3YWl0aW5nTGlzdFtuYW1lXS5wID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgd2FpdGluZ0xpc3RbbmFtZV0uciA9IHJlc29sdmU7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHdhaXRpbmdMaXN0W25hbWVdLnA7XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIHBvbHlmaWxsVjEoKSB7XG4gICAgaWYgKGN1c3RvbUVsZW1lbnRzKSBkZWxldGUgd2luZG93LmN1c3RvbUVsZW1lbnRzO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IG5ldyBDdXN0b21FbGVtZW50UmVnaXN0cnkoKVxuICAgIH0pO1xuICAgIGRlZmluZVByb3BlcnR5KHdpbmRvdywgJ0N1c3RvbUVsZW1lbnRSZWdpc3RyeScsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHZhbHVlOiBDdXN0b21FbGVtZW50UmVnaXN0cnlcbiAgICB9KTtcbiAgICBmb3IgKHZhclxuICAgICAgcGF0Y2hDbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBDbGFzcyA9IHdpbmRvd1tuYW1lXTtcbiAgICAgICAgaWYgKENsYXNzKSB7XG4gICAgICAgICAgd2luZG93W25hbWVdID0gZnVuY3Rpb24gQ3VzdG9tRWxlbWVudHNWMShzZWxmKSB7XG4gICAgICAgICAgICB2YXIgaW5mbywgaXNOYXRpdmU7XG4gICAgICAgICAgICBpZiAoIXNlbGYpIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCFzZWxmW0RSRUNFVjFdKSB7XG4gICAgICAgICAgICAgIGp1c3RDcmVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaW5mbyA9IGNvbnN0cnVjdG9yc1tub2RlTmFtZXMuZ2V0KHNlbGYuY29uc3RydWN0b3IpXTtcbiAgICAgICAgICAgICAgaXNOYXRpdmUgPSB1c2FibGVDdXN0b21FbGVtZW50cyAmJiBpbmZvLmNyZWF0ZS5sZW5ndGggPT09IDE7XG4gICAgICAgICAgICAgIHNlbGYgPSBpc05hdGl2ZSA/XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5jb25zdHJ1Y3QoQ2xhc3MsIGVtcHR5LCBpbmZvLmNvbnN0cnVjdG9yKSA6XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5hcHBseShkb2N1bWVudCwgaW5mby5jcmVhdGUpO1xuICAgICAgICAgICAgICBzZWxmW0RSRUNFVjFdID0gdHJ1ZTtcbiAgICAgICAgICAgICAganVzdENyZWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgaWYgKCFpc05hdGl2ZSkgbm90aWZ5QXR0cmlidXRlcyhzZWxmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgICAgIH07XG4gICAgICAgICAgd2luZG93W25hbWVdLnByb3RvdHlwZSA9IENsYXNzLnByb3RvdHlwZTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gd2luZG93W25hbWVdO1xuICAgICAgICAgIH0gY2F0Y2goV2ViS2l0KSB7XG4gICAgICAgICAgICBmaXhHZXRDbGFzcyA9IHRydWU7XG4gICAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShDbGFzcywgRFJFQ0VWMSwge3ZhbHVlOiB3aW5kb3dbbmFtZV19KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBDbGFzc2VzID0gaHRtbENsYXNzLmdldCgvXkhUTUxbQS1aXSpbYS16XS8pLFxuICAgICAgaSA9IENsYXNzZXMubGVuZ3RoO1xuICAgICAgaS0tO1xuICAgICAgcGF0Y2hDbGFzcyhDbGFzc2VzW2ldKVxuICAgICkge31cbiAgICAoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zKSB7XG4gICAgICB2YXIgaXMgPSBnZXRJcyhvcHRpb25zKTtcbiAgICAgIHJldHVybiBpcyA/XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSwgc2Vjb25kQXJndW1lbnQoaXMpKSA6XG4gICAgICAgIHBhdGNoZWRDcmVhdGVFbGVtZW50LmNhbGwodGhpcywgbmFtZSk7XG4gICAgfSk7XG4gICAgaWYgKCFWMCkge1xuICAgICAganVzdFNldHVwID0gdHJ1ZTtcbiAgICAgIGRvY3VtZW50W1JFR0lTVEVSX0VMRU1FTlRdKCcnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIGlmIGN1c3RvbUVsZW1lbnRzIGlzIG5vdCB0aGVyZSBhdCBhbGxcbiAgaWYgKCFjdXN0b21FbGVtZW50cyB8fCBwb2x5ZmlsbCA9PT0gJ2ZvcmNlJykgcG9seWZpbGxWMSgpO1xuICBlbHNlIHtcbiAgICAvLyBpZiBhdmFpbGFibGUgdGVzdCBleHRlbmRzIHdvcmsgYXMgZXhwZWN0ZWRcbiAgICB0cnkge1xuICAgICAgKGZ1bmN0aW9uIChEUkUsIG9wdGlvbnMsIG5hbWUpIHtcbiAgICAgICAgb3B0aW9uc1tFWFRFTkRTXSA9ICdhJztcbiAgICAgICAgRFJFLnByb3RvdHlwZSA9IGNyZWF0ZShIVE1MQW5jaG9yRWxlbWVudC5wcm90b3R5cGUpO1xuICAgICAgICBEUkUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRFJFO1xuICAgICAgICB3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKG5hbWUsIERSRSwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBnZXRBdHRyaWJ1dGUuY2FsbChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJywge2lzOiBuYW1lfSksICdpcycpICE9PSBuYW1lIHx8XG4gICAgICAgICAgKHVzYWJsZUN1c3RvbUVsZW1lbnRzICYmIGdldEF0dHJpYnV0ZS5jYWxsKG5ldyBEUkUoKSwgJ2lzJykgIT09IG5hbWUpXG4gICAgICAgICkge1xuICAgICAgICAgIHRocm93IG9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgIH0oXG4gICAgICAgIGZ1bmN0aW9uIERSRSgpIHtcbiAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoSFRNTEFuY2hvckVsZW1lbnQsIFtdLCBEUkUpO1xuICAgICAgICB9LFxuICAgICAgICB7fSxcbiAgICAgICAgJ2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQtYSdcbiAgICAgICkpO1xuICAgIH0gY2F0Y2gob19PKSB7XG4gICAgICAvLyBvciBmb3JjZSB0aGUgcG9seWZpbGwgaWYgbm90XG4gICAgICAvLyBhbmQga2VlcCBpbnRlcm5hbCBvcmlnaW5hbCByZWZlcmVuY2VcbiAgICAgIHBvbHlmaWxsVjEoKTtcbiAgICB9XG4gIH1cbiAgXG4gIHRyeSB7XG4gICAgY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCAnYScsICdhJyk7XG4gIH0gY2F0Y2goRmlyZUZveCkge1xuICAgIHNlY29uZEFyZ3VtZW50ID0gZnVuY3Rpb24gKGlzKSB7XG4gICAgICByZXR1cm4ge2lzOiBpcy50b0xvd2VyQ2FzZSgpfTtcbiAgICB9O1xuICB9XG4gIFxufVxuXG5leHBvcnRzLmluc3RhbGxDdXN0b21FbGVtZW50cyA9IGluc3RhbGxDdXN0b21FbGVtZW50cztcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBFUzYvUHJvbWlzZXMgQSsgUHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oZnVuY3Rpb24oKj0pLCBmdW5jdGlvbiAoKj0pKX0gcmVzb2x2ZXJcbiAqL1xuZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDb25zdHJ1Y3RvciBQcm9taXNlIHJlcXVpcmVzIGBuZXdgJyk7XG4gIH1cbiAgaWYgKCFpc0Z1bmN0aW9uKHJlc29sdmVyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ011c3QgcGFzcyByZXNvbHZlciBmdW5jdGlvbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICB0aGlzLl9zdGF0ZSA9IFBlbmRpbmdQcm9taXNlO1xuXG4gIC8qKlxuICAgKiBAdHlwZSB7Kn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHRoaXMuX3ZhbHVlID0gW107XG5cbiAgLyoqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdGhpcy5faXNDaGFpbkVuZCA9IHRydWU7XG5cbiAgZG9SZXNvbHZlKFxuICAgIHRoaXMsXG4gICAgYWRvcHRlcih0aGlzLCBGdWxmaWxsZWRQcm9taXNlKSxcbiAgICBhZG9wdGVyKHRoaXMsIFJlamVjdGVkUHJvbWlzZSksXG4gICAgeyB0aGVuOiByZXNvbHZlciB9XG4gICk7XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gIFB1YmxpYyBJbnN0YW5jZSBNZXRob2RzXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHByb21pc2UgaW5zdGFuY2UgdGhhdCB3aWxsIHJlY2VpdmUgdGhlIHJlc3VsdCBvZiB0aGlzIHByb21pc2VcbiAqIGFzIGlucHV0cyB0byB0aGUgb25GdWxmaWxsZWQgb3Igb25SZWplY3RlZCBjYWxsYmFja3MuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigqKX0gb25GdWxmaWxsZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKil9IG9uUmVqZWN0ZWRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gIG9uRnVsZmlsbGVkID0gaXNGdW5jdGlvbihvbkZ1bGZpbGxlZCkgPyBvbkZ1bGZpbGxlZCA6IHZvaWQgMDtcbiAgb25SZWplY3RlZCA9IGlzRnVuY3Rpb24ob25SZWplY3RlZCkgPyBvblJlamVjdGVkIDogdm9pZCAwO1xuXG4gIGlmIChvbkZ1bGZpbGxlZCB8fCBvblJlamVjdGVkKSB7XG4gICAgdGhpcy5faXNDaGFpbkVuZCA9IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX3N0YXRlKFxuICAgIHRoaXMuX3ZhbHVlLFxuICAgIG9uRnVsZmlsbGVkLFxuICAgIG9uUmVqZWN0ZWRcbiAgKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBwcm9taXNlIHRoYXQgd2lsbCBoYW5kbGUgdGhlIHJlamVjdGVkIHN0YXRlIG9mIHRoaXMgcHJvbWlzZS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCopfSBvblJlamVjdGVkXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cblByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24ob25SZWplY3RlZCkge1xuICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgb25SZWplY3RlZCk7XG59O1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICBQdWJsaWMgU3RhdGljIE1ldGhvZHNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxmaWxsZWQgUHJvbWlzZSBvZiB2YWx1ZS4gSWYgdmFsdWUgaXMgaXRzZWxmIGEgdGhlbi1hYmxlLFxuICogcmVzb2x2ZXMgd2l0aCB0aGUgdGhlbi1hYmxlJ3MgdmFsdWUuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2U7XG5cbiAgaWYgKGlzT2JqZWN0KHZhbHVlKSAmJiB2YWx1ZSBpbnN0YW5jZW9mIHRoaXMpIHtcbiAgICBwcm9taXNlID0gdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlfSAqLyhwcm9taXNlKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIHJlamVjdGVkIFByb21pc2Ugb2YgcmVhc29uLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX1cbiAqIEBwYXJhbSB7Kj19IHJlYXNvblxuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbihfLCByZWplY3QpIHtcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIGFuIGFycmF5IG9mIHRoZSB2YWx1ZXMgb2YgdGhlXG4gKiBwYXNzZWQgaW4gcHJvbWlzZXMuIElmIGFueSBwcm9taXNlIHJlamVjdHMsIHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGxcbiAqIHJlamVjdC5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9XG4gKiBAcGFyYW0geyFBcnJheTxQcm9taXNlfCo+fSBwcm9taXNlc1xuICogQHJldHVybnMgeyFQcm9taXNlfVxuICovXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uKHByb21pc2VzKSB7XG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBsZW5ndGggPSBwcm9taXNlcy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuXG4gICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlc29sdmUodmFsdWVzKTtcbiAgICB9XG5cbiAgICBlYWNoKHByb21pc2VzLCBmdW5jdGlvbihwcm9taXNlLCBpbmRleCkge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKC0tbGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICB9LCByZWplY3QpO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZX0gKi8ocHJvbWlzZSk7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIG9yIHJlamVjdCBiYXNlZCBvbiB0aGUgZmlyc3RcbiAqIHJlc29sdmVkIG9yIHJlamVjdGVkIHByb21pc2UuXG4gKlxuICogQHRoaXMgeyFQcm9taXNlfVxuICogQHBhcmFtIHshQXJyYXk8UHJvbWlzZXwqPn0gcHJvbWlzZXNcbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2V9ICovKHByb21pc2UpO1xufTtcblxudmFyIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbihyZWFzb24sIHByb21pc2UpIHtcbiAgdGhyb3cgcmVhc29uO1xufTtcblxuLyoqXG4gKiBBbiBpbnRlcm5hbCB1c2Ugc3RhdGljIGZ1bmN0aW9uLlxuICovXG5Qcm9taXNlLl9vdmVycmlkZVVuaGFuZGxlZEV4Y2VwdGlvbkhhbmRsZXIgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gIG9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBoYW5kbGVyO1xufTtcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgUHJpdmF0ZSBmdW5jdGlvbnNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4vKipcbiAqIFRoZSBGdWxmaWxsZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25GdWxmaWxsZWQgd2l0aCB0aGUgcmVzb2x2ZWQgdmFsdWUgb2ZcbiAqIHRoaXMgcHJvbWlzZSwgY3JlYXRpbmcgYSBuZXcgcHJvbWlzZS5cbiAqXG4gKiBJZiB0aGVyZSBpcyBubyBvbkZ1bGZpbGxlZCwgcmV0dXJucyB0aGUgY3VycmVudCBwcm9taXNlIHRvIGF2b2lkIGFuIHByb21pc2VcbiAqIGluc3RhbmNlLlxuICpcbiAqIEB0aGlzIHshUHJvbWlzZX0gVGhlIGN1cnJlbnQgcHJvbWlzZVxuICogQHBhcmFtIHsqPX0gdmFsdWUgVGhlIGN1cnJlbnQgcHJvbWlzZSdzIHJlc29sdmVkIHZhbHVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSB1bnVzZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIEZ1bGZpbGxlZCBzdGF0ZSBmcm9tIHRoZVxuICogICAgIFBlbmRpbmcgc3RhdGUuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIEZ1bGZpbGxlZFByb21pc2UodmFsdWUsIG9uRnVsZmlsbGVkLCB1bnVzZWQsIGRlZmVycmVkKSB7XG4gIGlmICghb25GdWxmaWxsZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBGdWxmaWxsZWRQcm9taXNlLCB2YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uRnVsZmlsbGVkLCB2YWx1ZSkpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUmVqZWN0ZWQgUHJvbWlzZSBzdGF0ZS4gQ2FsbHMgb25SZWplY3RlZCB3aXRoIHRoZSByZXNvbHZlZCB2YWx1ZSBvZlxuICogdGhpcyBwcm9taXNlLCBjcmVhdGluZyBhIG5ldyBwcm9taXNlLlxuICpcbiAqIElmIHRoZXJlIGlzIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0byBhdm9pZCBhbiBwcm9taXNlXG4gKiBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHJlYXNvbiBUaGUgY3VycmVudCBwcm9taXNlJ3MgcmVqZWN0aW9uIHJlYXNvbi5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0pPX0gdW51c2VkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KT19IG9uUmVqZWN0ZWRcbiAqIEBwYXJhbSB7RGVmZXJyZWR9IGRlZmVycmVkIEEgZGVmZXJyZWQgb2JqZWN0IHRoYXQgaG9sZHMgYSBwcm9taXNlIGFuZCBpdHNcbiAqICAgICByZXNvbHZlIGFuZCByZWplY3QgZnVuY3Rpb25zLiBJdCBJUyBOT1QgcGFzc2VkIHdoZW4gY2FsbGVkIGZyb21cbiAqICAgICBQcm9taXNlI3RoZW4gdG8gc2F2ZSBhbiBvYmplY3QgaW5zdGFuY2UgKHNpbmNlIHdlIG1heSByZXR1cm4gdGhlIGN1cnJlbnRcbiAqICAgICBwcm9taXNlKS4gSXQgSVMgcGFzc2VkIGluIHdoZW4gYWRvcHRpbmcgdGhlIFJlamVjdGVkIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZS5cbiAqIEByZXR1cm5zIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gUmVqZWN0ZWRQcm9taXNlKHJlYXNvbiwgdW51c2VkLCBvblJlamVjdGVkLCBkZWZlcnJlZCkge1xuICBpZiAoIW9uUmVqZWN0ZWQpIHtcbiAgICBkZWZlcnJlZEFkb3B0KGRlZmVycmVkLCBSZWplY3RlZFByb21pc2UsIHJlYXNvbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGRlZmVycmVkID0gbmV3IERlZmVycmVkKHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG4gIGRlZmVyKHRyeUNhdGNoRGVmZXJyZWQoZGVmZXJyZWQsIG9uUmVqZWN0ZWQsIHJlYXNvbikpO1xuICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUaGUgUGVuZGluZyBQcm9taXNlIHN0YXRlLiBFdmVudHVhbGx5IGNhbGxzIG9uRnVsZmlsbGVkIG9uY2UgdGhlIHByb21pc2UgaGFzXG4gKiByZXNvbHZlZCwgb3Igb25SZWplY3RlZCBvbmNlIHRoZSBwcm9taXNlIHJlamVjdHMuXG4gKlxuICogSWYgdGhlcmUgaXMgbm8gb25GdWxmaWxsZWQgYW5kIG5vIG9uUmVqZWN0ZWQsIHJldHVybnMgdGhlIGN1cnJlbnQgcHJvbWlzZSB0b1xuICogYXZvaWQgYW4gcHJvbWlzZSBpbnN0YW5jZS5cbiAqXG4gKiBAdGhpcyB7IVByb21pc2V9IFRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBwYXJhbSB7Kj19IHF1ZXVlIFRoZSBjdXJyZW50IHByb21pc2UncyBwZW5kaW5nIHByb21pc2VzIHF1ZXVlLlxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvbkZ1bGZpbGxlZFxuICogQHBhcmFtIHtmdW5jdGlvbigqPSk9fSBvblJlamVjdGVkXG4gKiBAcGFyYW0ge0RlZmVycmVkfSBkZWZlcnJlZCBBIGRlZmVycmVkIG9iamVjdCB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzXG4gKiAgICAgcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy4gSXQgSVMgTk9UIHBhc3NlZCB3aGVuIGNhbGxlZCBmcm9tXG4gKiAgICAgUHJvbWlzZSN0aGVuIHRvIHNhdmUgYW4gb2JqZWN0IGluc3RhbmNlIChzaW5jZSB3ZSBtYXkgcmV0dXJuIHRoZSBjdXJyZW50XG4gKiAgICAgcHJvbWlzZSkuIEl0IElTIHBhc3NlZCBpbiB3aGVuIGFkb3B0aW5nIHRoZSBQZW5kaW5nIHN0YXRlIGZyb20gdGhlXG4gKiAgICAgUGVuZGluZyBzdGF0ZSBvZiBhbm90aGVyIHByb21pc2UuXG4gKiBAcmV0dXJucyB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIFBlbmRpbmdQcm9taXNlKHF1ZXVlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgZGVmZXJyZWQpIHtcbiAgaWYgKCFkZWZlcnJlZCkge1xuICAgIGlmICghb25GdWxmaWxsZWQgJiYgIW9uUmVqZWN0ZWQpIHsgcmV0dXJuIHRoaXM7IH1cbiAgICBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCh0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxuICBxdWV1ZS5wdXNoKHtcbiAgICBkZWZlcnJlZDogZGVmZXJyZWQsXG4gICAgb25GdWxmaWxsZWQ6IG9uRnVsZmlsbGVkIHx8IGRlZmVycmVkLnJlc29sdmUsXG4gICAgb25SZWplY3RlZDogb25SZWplY3RlZCB8fCBkZWZlcnJlZC5yZWplY3RcbiAgfSk7XG4gIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xufVxuXG4vKipcbiAqIENvbnN0cnVjdHMgYSBkZWZlcnJlZCBpbnN0YW5jZSB0aGF0IGhvbGRzIGEgcHJvbWlzZSBhbmQgaXRzIHJlc29sdmUgYW5kXG4gKiByZWplY3QgZnVuY3Rpb25zLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBEZWZlcnJlZChQcm9taXNlKSB7XG4gIHZhciBkZWZlcnJlZCA9IHRoaXM7XG4gIC8qKiBAdHlwZSB7IVByb21pc2V9ICovXG4gIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8qKiBAdHlwZSB7ZnVuY3Rpb24oKj0pfSAqL1xuICAgIGRlZmVycmVkLnJlc29sdmUgPSByZXNvbHZlO1xuXG4gICAgLyoqIEB0eXBlIHtmdW5jdGlvbigqPSl9ICovXG4gICAgZGVmZXJyZWQucmVqZWN0ID0gcmVqZWN0O1xuICB9KTtcbiAgcmV0dXJuIGRlZmVycmVkO1xufVxuXG4vKipcbiAqIFRyYW5zaXRpb25zIHRoZSBzdGF0ZSBvZiBwcm9taXNlIHRvIGFub3RoZXIgc3RhdGUuIFRoaXMgaXMgb25seSBldmVyIGNhbGxlZFxuICogb24gd2l0aCBhIHByb21pc2UgdGhhdCBpcyBjdXJyZW50bHkgaW4gdGhlIFBlbmRpbmcgc3RhdGUuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcGFyYW0geyo9fSB2YWx1ZVxuICovXG5mdW5jdGlvbiBhZG9wdChwcm9taXNlLCBzdGF0ZSwgdmFsdWUsIGFkb3B0ZWUpIHtcbiAgdmFyIHF1ZXVlID0gcHJvbWlzZS5fdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gc3RhdGU7XG4gIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG5cbiAgaWYgKGFkb3B0ZWUgJiYgc3RhdGUgPT09IFBlbmRpbmdQcm9taXNlKSB7XG4gICAgYWRvcHRlZS5fc3RhdGUodmFsdWUsIHZvaWQgMCwgdm9pZCAwLCB7XG4gICAgICBwcm9taXNlOiBwcm9taXNlLFxuICAgICAgcmVzb2x2ZTogdm9pZCAwLFxuICAgICAgcmVqZWN0OiB2b2lkIDBcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbmV4dCA9IHF1ZXVlW2ldO1xuICAgIHByb21pc2UuX3N0YXRlKFxuICAgICAgdmFsdWUsXG4gICAgICBuZXh0Lm9uRnVsZmlsbGVkLFxuICAgICAgbmV4dC5vblJlamVjdGVkLFxuICAgICAgbmV4dC5kZWZlcnJlZFxuICAgICk7XG4gIH1cbiAgcXVldWUubGVuZ3RoID0gMDtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhpcyByZWplY3RlZCBwcm9taXNlIHdpbGwgYmUgXCJoYW5kbGVkXCIuXG4gIGlmIChzdGF0ZSA9PT0gUmVqZWN0ZWRQcm9taXNlICYmIHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHByb21pc2UuX2lzQ2hhaW5FbmQpIHtcbiAgICAgICAgb25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbih2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cbn1cblxuLyoqXG4gKiBBIHBhcnRpYWwgYXBwbGljYXRpb24gb2YgYWRvcHQuXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZVxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlByb21pc2UsKj0sZnVuY3Rpb24oKj0pLGZ1bmN0aW9uKCo9KSxEZWZlcnJlZCk6IVByb21pc2V9IHN0YXRlXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKj0pfVxuICovXG5mdW5jdGlvbiBhZG9wdGVyKHByb21pc2UsIHN0YXRlKSB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGFkb3B0KHByb21pc2UsIHN0YXRlLCB2YWx1ZSk7XG4gIH07XG59XG5cbi8qKlxuICogVXBkYXRlcyBhIGRlZmVycmVkIHByb21pc2VzIHN0YXRlLiBOZWNlc3NhcnkgZm9yIHVwZGF0aW5nIGFuIGFkb3B0aW5nXG4gKiBwcm9taXNlJ3Mgc3RhdGUgd2hlbiB0aGUgYWRvcHRlZSByZXNvbHZlcy5cbiAqXG4gKiBAcGFyYW0gez9EZWZlcnJlZH0gZGVmZXJyZWRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24odGhpczpQcm9taXNlLCo9LGZ1bmN0aW9uKCo9KSxmdW5jdGlvbigqPSksRGVmZXJyZWQpOiFQcm9taXNlfSBzdGF0ZVxuICogQHBhcmFtIHsqPX0gdmFsdWVcbiAqL1xuZnVuY3Rpb24gZGVmZXJyZWRBZG9wdChkZWZlcnJlZCwgc3RhdGUsIHZhbHVlKSB7XG4gIGlmIChkZWZlcnJlZCkge1xuICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcbiAgICBwcm9taXNlLl9zdGF0ZSA9IHN0YXRlO1xuICAgIHByb21pc2UuX3ZhbHVlID0gdmFsdWU7XG4gIH1cbn1cblxuLyoqXG4gKiBBIG5vLW9wIGZ1bmN0aW9uIHRvIHByZXZlbnQgZG91YmxlIHJlc29sdmluZy5cbiAqL1xuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYSBGdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7Kn0gZm5cbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuKSB7XG4gIHJldHVybiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbic7XG59XG5cbi8qKlxuICogVGVzdHMgaWYgZm4gaXMgYW4gT2JqZWN0XG4gKlxuICogQHBhcmFtIHsqfSBvYmpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcbiAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG59XG5cbi8qKlxuICogSXRlcmF0ZXMgb3ZlciBlYWNoIGVsZW1lbnQgb2YgYW4gYXJyYXksIGNhbGxpbmcgdGhlIGl0ZXJhdG9yIHdpdGggdGhlXG4gKiBlbGVtZW50IGFuZCBpdHMgaW5kZXguXG4gKlxuICogQHBhcmFtIHshQXJyYXl9IGNvbGxlY3Rpb25cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKj0sbnVtYmVyKX0gaXRlcmF0b3JcbiAqL1xuZnVuY3Rpb24gZWFjaChjb2xsZWN0aW9uLCBpdGVyYXRvcikge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICBpdGVyYXRvcihjb2xsZWN0aW9uW2ldLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYXR0ZW1wdCB0byByZXNvbHZlIHRoZSBkZWZlcnJlZCB3aXRoIHRoZSByZXR1cm5cbiAqIG9mIGZuLiBJZiBhbnkgZXJyb3IgaXMgcmFpc2VkLCByZWplY3RzIGluc3RlYWQuXG4gKlxuICogQHBhcmFtIHshRGVmZXJyZWR9IGRlZmVycmVkXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gZm5cbiAqIEBwYXJhbSB7Kn0gYXJnXG4gKiBAcmV0dXJucyB7ZnVuY3Rpb24oKX1cbiAqL1xuZnVuY3Rpb24gdHJ5Q2F0Y2hEZWZlcnJlZChkZWZlcnJlZCwgZm4sIGFyZykge1xuICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG4gIHZhciByZXNvbHZlID0gZGVmZXJyZWQucmVzb2x2ZTtcbiAgdmFyIHJlamVjdCA9IGRlZmVycmVkLnJlamVjdDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcmVzdWx0ID0gZm4oYXJnKTtcbiAgICAgIGRvUmVzb2x2ZShwcm9taXNlLCByZXNvbHZlLCByZWplY3QsIHJlc3VsdCwgcmVzdWx0KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZWplY3QoZSk7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFF1ZXVlcyBhbmQgZXhlY3V0ZXMgbXVsdGlwbGUgZGVmZXJyZWQgZnVuY3Rpb25zIG9uIGFub3RoZXIgcnVuIGxvb3AuXG4gKi9cbnZhciBkZWZlciA9IChmdW5jdGlvbigpIHtcbiAgLyoqXG4gICAqIERlZmVycyBmbiB0byBhbm90aGVyIHJ1biBsb29wLlxuICAgKi9cbiAgdmFyIHNjaGVkdWxlRmx1c2g7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucG9zdE1lc3NhZ2UpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZsdXNoKTtcbiAgICBzY2hlZHVsZUZsdXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ21hY3JvLXRhc2snLCAnKicpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgc2NoZWR1bGVGbHVzaCA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmbHVzaCwgMCk7XG4gICAgfTtcbiAgfVxuXG4gIHZhciBxdWV1ZSA9IG5ldyBBcnJheSgxNik7XG4gIHZhciBsZW5ndGggPSAwO1xuXG4gIGZ1bmN0aW9uIGZsdXNoKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmbiA9IHF1ZXVlW2ldO1xuICAgICAgcXVldWVbaV0gPSBudWxsO1xuICAgICAgZm4oKTtcbiAgICB9XG4gICAgbGVuZ3RoID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGZuXG4gICAqL1xuICBmdW5jdGlvbiBkZWZlcihmbikge1xuICAgIGlmIChsZW5ndGggPT09IDApIHsgc2NoZWR1bGVGbHVzaCgpOyB9XG4gICAgcXVldWVbbGVuZ3RoKytdID0gZm47XG4gIH1cblxuICByZXR1cm4gZGVmZXI7XG59KSgpO1xuXG4vKipcbiAqIFRoZSBQcm9taXNlIHJlc29sdXRpb24gcHJvY2VkdXJlLlxuICogaHR0cHM6Ly9naXRodWIuY29tL3Byb21pc2VzLWFwbHVzL3Byb21pc2VzLXNwZWMjdGhlLXByb21pc2UtcmVzb2x1dGlvbi1wcm9jZWR1cmVcbiAqXG4gKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCo9KX0gcmVzb2x2ZVxuICogQHBhcmFtIHtmdW5jdGlvbigqPSl9IHJlamVjdFxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHsqPX0gY29udGV4dFxuICovXG5mdW5jdGlvbiBkb1Jlc29sdmUocHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0LCB2YWx1ZSwgY29udGV4dCkge1xuICB2YXIgX3JlamVjdCA9IHJlamVjdDtcbiAgdmFyIHRoZW47XG4gIHZhciBfcmVzb2x2ZTtcbiAgdHJ5IHtcbiAgICBpZiAodmFsdWUgPT09IHByb21pc2UpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBmdWxmaWxsIHByb21pc2Ugd2l0aCBpdHNlbGYnKTtcbiAgICB9XG4gICAgdmFyIGlzT2JqID0gaXNPYmplY3QodmFsdWUpO1xuICAgIGlmIChpc09iaiAmJiB2YWx1ZSBpbnN0YW5jZW9mIHByb21pc2UuY29uc3RydWN0b3IpIHtcbiAgICAgIGFkb3B0KHByb21pc2UsIHZhbHVlLl9zdGF0ZSwgdmFsdWUuX3ZhbHVlLCB2YWx1ZSk7XG4gICAgfSBlbHNlIGlmIChpc09iaiAmJiAodGhlbiA9IHZhbHVlLnRoZW4pICYmIGlzRnVuY3Rpb24odGhlbikpIHtcbiAgICAgIF9yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgX3Jlc29sdmUgPSBfcmVqZWN0ID0gbm9vcDtcbiAgICAgICAgZG9SZXNvbHZlKHByb21pc2UsIHJlc29sdmUsIHJlamVjdCwgdmFsdWUsIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICBfcmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgIF9yZXNvbHZlID0gX3JlamVjdCA9IG5vb3A7XG4gICAgICAgIHJlamVjdChyZWFzb24pO1xuICAgICAgfTtcbiAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsgX3Jlc29sdmUodmFsdWUpOyB9LFxuICAgICAgICBmdW5jdGlvbihyZWFzb24pIHsgX3JlamVjdChyZWFzb24pOyB9XG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBfcmVqZWN0KGUpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvbWlzZTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtkaWN0fSBmcm9tICcuL3V0aWxzL29iamVjdCc7XG5pbXBvcnQge2ludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb259IGZyb20gJy4vZXZlbnQtaGVscGVyLWxpc3Rlbic7XG5pbXBvcnQge3BhcnNlSnNvbn0gZnJvbSAnLi9qc29uJztcblxuXG4vKiogQGNvbnN0ICovXG5jb25zdCBBTVBfTUVTU0FHRV9QUkVGSVggPSAnYW1wLSc7XG5leHBvcnQgY29uc3QgQ09OU1RBTlRTID0ge1xuICByZXNwb25zZVR5cGVTdWZmaXg6ICctcmVzdWx0JyxcbiAgbWVzc2FnZUlkRmllbGROYW1lOiAnbWVzc2FnZUlkJyxcbiAgcGF5bG9hZEZpZWxkTmFtZTogJ3BheWxvYWQnLFxuICBjb250ZW50RmllbGROYW1lOiAnY29udGVudCcsXG59O1xuXG4vKiogQGVudW0ge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBNZXNzYWdlVHlwZSA9IHtcbiAgLy8gRm9yIGFtcC1hZFxuICBTRU5EX0VNQkVEX1NUQVRFOiAnc2VuZC1lbWJlZC1zdGF0ZScsXG4gIEVNQkVEX1NUQVRFOiAnZW1iZWQtc3RhdGUnLFxuICBTRU5EX0VNQkVEX0NPTlRFWFQ6ICdzZW5kLWVtYmVkLWNvbnRleHQnLFxuICBFTUJFRF9DT05URVhUOiAnZW1iZWQtY29udGV4dCcsXG4gIFNFTkRfSU5URVJTRUNUSU9OUzogJ3NlbmQtaW50ZXJzZWN0aW9ucycsXG4gIElOVEVSU0VDVElPTjogJ2ludGVyc2VjdGlvbicsXG4gIEVNQkVEX1NJWkU6ICdlbWJlZC1zaXplJyxcbiAgRU1CRURfU0laRV9DSEFOR0VEOiAnZW1iZWQtc2l6ZS1jaGFuZ2VkJyxcbiAgRU1CRURfU0laRV9ERU5JRUQ6ICdlbWJlZC1zaXplLWRlbmllZCcsXG4gIE5PX0NPTlRFTlQ6ICduby1jb250ZW50JyxcbiAgR0VUX0hUTUw6ICdnZXQtaHRtbCcsXG4gIEdFVF9DT05TRU5UX1NUQVRFOiAnZ2V0LWNvbnNlbnQtc3RhdGUnLFxuXG4gIC8vIEZvciB0aGUgZnJhbWUgdG8gYmUgcGxhY2VkIGluIGZ1bGwgb3ZlcmxheSBtb2RlIGZvciBsaWdodGJveGVzXG4gIEZVTExfT1ZFUkxBWV9GUkFNRTogJ2Z1bGwtb3ZlcmxheS1mcmFtZScsXG4gIEZVTExfT1ZFUkxBWV9GUkFNRV9SRVNQT05TRTogJ2Z1bGwtb3ZlcmxheS1mcmFtZS1yZXNwb25zZScsXG4gIENBTkNFTF9GVUxMX09WRVJMQVlfRlJBTUU6ICdjYW5jZWwtZnVsbC1vdmVybGF5LWZyYW1lJyxcbiAgQ0FOQ0VMX0ZVTExfT1ZFUkxBWV9GUkFNRV9SRVNQT05TRTogJ2NhbmNlbC1mdWxsLW92ZXJsYXktZnJhbWUtcmVzcG9uc2UnLFxuXG4gIC8vIEZvciBhbXAtaW5hYm94XG4gIFNFTkRfUE9TSVRJT05TOiAnc2VuZC1wb3NpdGlvbnMnLFxuICBQT1NJVElPTjogJ3Bvc2l0aW9uJyxcblxuICAvLyBGb3IgYW1wLWFuYWx5dGljcycgaWZyYW1lLXRyYW5zcG9ydFxuICBTRU5EX0lGUkFNRV9UUkFOU1BPUlRfRVZFTlRTOiAnc2VuZC1pZnJhbWUtdHJhbnNwb3J0LWV2ZW50cycsXG4gIElGUkFNRV9UUkFOU1BPUlRfRVZFTlRTOiAnaWZyYW1lLXRyYW5zcG9ydC1ldmVudHMnLFxuICBJRlJBTUVfVFJBTlNQT1JUX1JFU1BPTlNFOiAnaWZyYW1lLXRyYW5zcG9ydC1yZXNwb25zZScsXG5cbiAgLy8gRm9yIHVzZXItZXJyb3ItaW4taWZyYW1lXG4gIFVTRVJfRVJST1JfSU5fSUZSQU1FOiAndXNlci1lcnJvci1pbi1pZnJhbWUnLFxufTtcblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50LlxuICogQHBhcmFtIHshRXZlbnRUYXJnZXR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUV2ZW50KX0gbGlzdGVuZXJcbiAqIEBwYXJhbSB7T2JqZWN0PX0gb3B0X2V2dExpc3RlbmVyT3B0c1xuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgcmV0dXJuIGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oXG4gICAgICBlbGVtZW50LCBldmVudFR5cGUsIGxpc3RlbmVyLCBvcHRfZXZ0TGlzdGVuZXJPcHRzKTtcbn1cblxuXG4vKipcbiAqIFNlcmlhbGl6ZSBhbiBBTVAgcG9zdCBtZXNzYWdlLiBPdXRwdXQgbG9va3MgbGlrZTpcbiAqICdhbXAtMDExNDgxMzIzMDk5NDkwe1widHlwZVwiOlwicG9zaXRpb25cIixcInNlbnRpbmVsXCI6XCIxMjM0NVwiLFwiZm9vXCI6XCJiYXJcIn0nXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICogQHBhcmFtIHtzdHJpbmd9IHNlbnRpbmVsXG4gKiBAcGFyYW0ge0pzb25PYmplY3Q9fSBkYXRhXG4gKiBAcGFyYW0gez9zdHJpbmc9fSBydHZWZXJzaW9uXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVNZXNzYWdlKHR5cGUsIHNlbnRpbmVsLCBkYXRhID0gZGljdCgpLFxuICBydHZWZXJzaW9uID0gbnVsbCkge1xuICAvLyBUT0RPOiBjb25zaWRlciB3cmFwIHRoZSBkYXRhIGluIGEgXCJkYXRhXCIgZmllbGQuIHsgdHlwZSwgc2VudGluYWwsIGRhdGEgfVxuICBjb25zdCBtZXNzYWdlID0gZGF0YTtcbiAgbWVzc2FnZVsndHlwZSddID0gdHlwZTtcbiAgbWVzc2FnZVsnc2VudGluZWwnXSA9IHNlbnRpbmVsO1xuICByZXR1cm4gQU1QX01FU1NBR0VfUFJFRklYICsgKHJ0dlZlcnNpb24gfHwgJycpICsgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG59XG5cblxuLyoqXG4gKiBEZXNlcmlhbGl6ZSBhbiBBTVAgcG9zdCBtZXNzYWdlLlxuICogUmV0dXJucyBudWxsIGlmIGl0J3Mgbm90IHZhbGlkIEFNUCBtZXNzYWdlIGZvcm1hdC5cbiAqXG4gKiBAcGFyYW0geyp9IG1lc3NhZ2VcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlc2VyaWFsaXplTWVzc2FnZShtZXNzYWdlKSB7XG4gIGlmICghaXNBbXBNZXNzYWdlKG1lc3NhZ2UpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3Qgc3RhcnRQb3MgPSBtZXNzYWdlLmluZGV4T2YoJ3snKTtcbiAgZGV2KCkuYXNzZXJ0KHN0YXJ0UG9zICE9IC0xLCAnSlNPTiBtaXNzaW5nIGluICVzJywgbWVzc2FnZSk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHBhcnNlSnNvbihtZXNzYWdlLnN1YnN0cihzdGFydFBvcykpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgZGV2KCkuZXJyb3IoJ01FU1NBR0lORycsICdGYWlsZWQgdG8gcGFyc2UgbWVzc2FnZTogJyArIG1lc3NhZ2UsIGUpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cblxuLyoqXG4gKiAgUmV0dXJucyB0cnVlIGlmIG1lc3NhZ2UgbG9va3MgbGlrZSBpdCBpcyBhbiBBTVAgcG9zdE1lc3NhZ2VcbiAqICBAcGFyYW0geyp9IG1lc3NhZ2VcbiAqICBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBbXBNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuICh0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJyAmJlxuICAgICAgbWVzc2FnZS5pbmRleE9mKEFNUF9NRVNTQUdFX1BSRUZJWCkgPT0gMCAmJlxuICAgICAgbWVzc2FnZS5pbmRleE9mKCd7JykgIT0gLTEpO1xufVxuXG4vKiogQHR5cGVkZWYge3tjcmVhdGl2ZUlkOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZ319ICovXG5leHBvcnQgbGV0IElmcmFtZVRyYW5zcG9ydEV2ZW50O1xuLy8gQW4gZXZlbnQsIGFuZCB0aGUgdHJhbnNwb3J0IElEIG9mIHRoZSBhbXAtYW5hbHl0aWNzIHRhZ3MgdGhhdFxuLy8gZ2VuZXJhdGVkIGl0LiBGb3IgaW5zdGFuY2UgaWYgdGhlIGNyZWF0aXZlIHdpdGggdHJhbnNwb3J0XG4vLyBJRCAyIHNlbmRzIFwiaGlcIiwgdGhlbiBhbiBJZnJhbWVUcmFuc3BvcnRFdmVudCB3b3VsZCBsb29rIGxpa2U6XG4vLyB7IGNyZWF0aXZlSWQ6IFwiMlwiLCBtZXNzYWdlOiBcImhpXCIgfVxuLy8gSWYgdGhlIGNyZWF0aXZlIHdpdGggdHJhbnNwb3J0IElEIDIgc2VudCB0aGF0LCBhbmQgYWxzbyBzZW50IFwiaGVsbG9cIixcbi8vIGFuZCB0aGUgY3JlYXRpdmUgd2l0aCB0cmFuc3BvcnQgSUQgMyBzZW5kcyBcImdvb2RieWVcIiB0aGVuIGFuICphcnJheSogb2YgM1xuLy8gQW1wQW5hbHl0aWNzSWZyYW1lVHJhbnNwb3J0RXZlbnQgd291bGQgYmUgc2VudCB0byB0aGUgM3AgZnJhbWUgbGlrZSBzbzpcbi8vIFtcbi8vICAgeyBjcmVhdGl2ZUlkOiBcIjJcIiwgbWVzc2FnZTogXCJoaVwiIH0sIC8vIEFuIEFtcEFuYWx5dGljc0lmcmFtZVRyYW5zcG9ydEV2ZW50XG4vLyAgIHsgY3JlYXRpdmVJZDogXCIyXCIsIG1lc3NhZ2U6IFwiaGVsbG9cIiB9LCAvLyBBbm90aGVyXG4vLyAgIHsgY3JlYXRpdmVJZDogXCIzXCIsIG1lc3NhZ2U6IFwiZ29vZGJ5ZVwiIH0gLy8gQW5kIGFub3RoZXJcbi8vIF1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEFsbG93cyBmb3IgcnVudGltZSBjb25maWd1cmF0aW9uLiBJbnRlcm5hbGx5LCB0aGUgcnVudGltZSBzaG91bGRcbiAqIHVzZSB0aGUgc3JjL2NvbmZpZy5qcyBtb2R1bGUgZm9yIHZhcmlvdXMgY29uc3RhbnRzLiBXZSBjYW4gdXNlIHRoZVxuICogQU1QX0NPTkZJRyBnbG9iYWwgdG8gdHJhbnNsYXRlIHVzZXItZGVmaW5lZCBjb25maWd1cmF0aW9ucyB0byB0aGlzXG4gKiBtb2R1bGUuXG4gKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIHN0cmluZz59XG4gKi9cbmNvbnN0IGVudiA9IHNlbGYuQU1QX0NPTkZJRyB8fCB7fTtcblxuY29uc3QgdGhpcmRQYXJ0eUZyYW1lUmVnZXggPSB0eXBlb2YgZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ3RoaXJkUGFydHlGcmFtZVJlZ2V4J10pIDogZW52Wyd0aGlyZFBhcnR5RnJhbWVSZWdleCddO1xuXG5jb25zdCBjZG5Qcm94eVJlZ2V4ID0gdHlwZW9mIGVudlsnY2RuUHJveHlSZWdleCddID09ICdzdHJpbmcnID9cbiAgbmV3IFJlZ0V4cChlbnZbJ2NkblByb3h5UmVnZXgnXSkgOiBlbnZbJ2NkblByb3h5UmVnZXgnXTtcblxuLyoqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgc3RyaW5nfGJvb2xlYW58UmVnRXhwPn0gKi9cbmV4cG9ydCBjb25zdCB1cmxzID0ge1xuICB0aGlyZFBhcnR5OiBlbnZbJ3RoaXJkUGFydHlVcmwnXSB8fCAnaHR0cHM6Ly8zcC5hbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZUhvc3Q6IGVudlsndGhpcmRQYXJ0eUZyYW1lSG9zdCddIHx8ICdhbXBwcm9qZWN0Lm5ldCcsXG4gIHRoaXJkUGFydHlGcmFtZVJlZ2V4OiB0aGlyZFBhcnR5RnJhbWVSZWdleCB8fCAvXmQtXFxkK1xcLmFtcHByb2plY3RcXC5uZXQkLyxcbiAgY2RuOiBlbnZbJ2NkblVybCddIHx8ICdodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZycsXG4gIC8qIE5vdGUgdGhhdCBjZG5Qcm94eVJlZ2V4IGlzIG9ubHkgZXZlciBjaGVja2VkIGFnYWluc3Qgb3JpZ2luc1xuICAgKiAocHJvdG86Ly9ob3N0Wzpwb3J0XSkgc28gZG9lcyBub3QgbmVlZCB0byBjb25zaWRlciBwYXRoXG4gICAqL1xuICBjZG5Qcm94eVJlZ2V4OiBjZG5Qcm94eVJlZ2V4IHx8XG4gICAgICAvXmh0dHBzOlxcL1xcLyhbYS16QS1aMC05Xy1dK1xcLik/Y2RuXFwuYW1wcHJvamVjdFxcLm9yZyQvLFxuICBsb2NhbGhvc3RSZWdleDogL15odHRwcz86XFwvXFwvbG9jYWxob3N0KDpcXGQrKT8kLyxcbiAgZXJyb3JSZXBvcnRpbmc6IGVudlsnZXJyb3JSZXBvcnRpbmdVcmwnXSB8fFxuICAgICAgJ2h0dHBzOi8vYW1wLWVycm9yLXJlcG9ydGluZy5hcHBzcG90LmNvbS9yJyxcbiAgbG9jYWxEZXY6IGVudlsnbG9jYWxEZXYnXSB8fCBmYWxzZSxcbn07XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIHVybHMsXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7ZW5kc1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7XG4gIGlzUHJveHlPcmlnaW4sXG4gIHBhcnNlVXJsRGVwcmVjYXRlZCxcbiAgdHJ5RGVjb2RlVXJpQ29tcG9uZW50LFxufSBmcm9tICcuL3VybCc7XG5pbXBvcnQge3VybHN9IGZyb20gJy4vY29uZmlnJztcblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIFJldHVybnMgdGhlIGNvb2tpZSdzIHZhbHVlIG9yIGBudWxsYC5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4gez9zdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29raWUod2luLCBuYW1lKSB7XG4gIGNvbnN0IGNvb2tpZVN0cmluZyA9IHRyeUdldERvY3VtZW50Q29va2llTm9JbmxpbmUod2luKTtcbiAgaWYgKCFjb29raWVTdHJpbmcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCBjb29raWVzID0gY29va2llU3RyaW5nLnNwbGl0KCc7Jyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGNvb2tpZSA9IGNvb2tpZXNbaV0udHJpbSgpO1xuICAgIGNvbnN0IGVxID0gY29va2llLmluZGV4T2YoJz0nKTtcbiAgICBpZiAoZXEgPT0gLTEpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodHJ5RGVjb2RlVXJpQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcoMCwgZXEpLnRyaW0oKSkgPT0gbmFtZSkge1xuICAgICAgY29uc3QgdmFsdWUgPSBjb29raWUuc3Vic3RyaW5nKGVxICsgMSkudHJpbSgpO1xuICAgICAgcmV0dXJuIHRyeURlY29kZVVyaUNvbXBvbmVudCh2YWx1ZSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGlubGluZWQgdG8gcHJldmVudCBUcnlDYXRjaCBkZW9wdGltaXphdGlvbi5cbiAqIE5vSW5saW5lIGtleXdvcmQgYXQgdGhlIGVuZCBvZiBmdW5jdGlvbiBuYW1lIGFsc28gcHJldmVudHMgQ2xvc3VyZSBjb21waWxlclxuICogZnJvbSBpbmxpbmluZyB0aGUgZnVuY3Rpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0cnlHZXREb2N1bWVudENvb2tpZU5vSW5saW5lKHdpbikge1xuICB0cnkge1xuICAgIHJldHVybiB3aW4uZG9jdW1lbnQuY29va2llO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gQWN0IGFzIGlmIG5vIGNvb2tpZSBpcyBhdmFpbGFibGUuIEV4Y2VwdGlvbnMgY2FuIGJlIHRocm93biB3aGVuXG4gICAgLy8gQU1QIGRvY3MgYXJlIG9wZW5lZCBvbiBvcmlnaW5zIHRoYXQgZG8gbm90IGFsbG93IHNldHRpbmdcbiAgICAvLyBjb29raWVzIHN1Y2ggYXMgbnVsbCBvcmlnaW5zLlxuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG4vKipcbiAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBjb29raWUuIFRoZSBjb29raWUgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgYW5kIG11c3RcbiAqIGdvIHRocm91Z2ggdGhlIHByaXZhY3kgcmV2aWV3LiBCZWZvcmUgdXNpbmcgdGhpcyBtZXRob2QgcGxlYXNlIGZpbGUgYVxuICogR2l0SHViIGlzc3VlIHdpdGggXCJQcml2YWN5IFJldmlld1wiIGxhYmVsLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge3RpbWV9IGV4cGlyYXRpb25UaW1lXG4gKiBAcGFyYW0ge3tcbiAqICAgaGlnaGVzdEF2YWlsYWJsZURvbWFpbjooYm9vbGVhbnx1bmRlZmluZWQpLFxuICogICBkb21haW46KHN0cmluZ3x1bmRlZmluZWQpXG4gKiB9PX0gb3B0X29wdGlvbnNcbiAqICAgICAtIGhpZ2hlc3RBdmFpbGFibGVEb21haW46IElmIHRydWUsIHNldCB0aGUgY29va2llIGF0IHRoZSB3aWRlc3QgZG9tYWluXG4gKiAgICAgICBzY29wZSBhbGxvd2VkIGJ5IHRoZSBicm93c2VyLiBFLmcuIG9uIGV4YW1wbGUuY29tIGlmIHdlIGFyZSBjdXJyZW50bHlcbiAqICAgICAgIG9uIHd3dy5leGFtcGxlLmNvbS5cbiAqICAgICAtIGRvbWFpbjogRXhwbGljaXQgZG9tYWluIHRvIHNldC5cbiAqICAgICAtIGFsbG93T25Qcm94eU9yaWdpbjogQWxsb3cgc2V0dGluZyBhIGNvb2tpZSBvbiB0aGUgQU1QIENhY2hlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBvcHRfb3B0aW9ucykge1xuICBjaGVja09yaWdpbkZvclNldHRpbmdDb29raWUod2luLCBvcHRfb3B0aW9ucywgbmFtZSk7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5oaWdoZXN0QXZhaWxhYmxlRG9tYWluKSB7XG4gICAgY29uc3QgcGFydHMgPSB3aW4ubG9jYXRpb24uaG9zdG5hbWUuc3BsaXQoJy4nKTtcbiAgICBsZXQgZG9tYWluID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IHBhcnRzLmxlbmd0aCAtIDI7IGkgPj0gMDsgaS0tKSB7XG4gICAgICBkb21haW4gPSBwYXJ0c1tpXSArICcuJyArIGRvbWFpbjtcbiAgICAgIHRyeVNldENvb2tpZSh3aW4sIG5hbWUsIHZhbHVlLCBleHBpcmF0aW9uVGltZSwgZG9tYWluKTtcbiAgICAgIGlmIChnZXRDb29raWUod2luLCBuYW1lKSA9PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGxldCBkb21haW4gPSB1bmRlZmluZWQ7XG4gIGlmIChvcHRfb3B0aW9ucyAmJiBvcHRfb3B0aW9ucy5kb21haW4pIHtcbiAgICBkb21haW4gPSBvcHRfb3B0aW9ucy5kb21haW47XG4gIH1cbiAgdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pO1xufVxuXG4vKipcbiAqIEF0dGVtcHQgdG8gc2V0IGEgY29va2llIHdpdGggdGhlIGdpdmVuIHBhcmFtcy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICogQHBhcmFtIHt0aW1lfSBleHBpcmF0aW9uVGltZVxuICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBkb21haW5cbiAqL1xuZnVuY3Rpb24gdHJ5U2V0Q29va2llKHdpbiwgbmFtZSwgdmFsdWUsIGV4cGlyYXRpb25UaW1lLCBkb21haW4pIHtcbiAgLy8gV2UgZG8gbm90IGFsbG93IHNldHRpbmcgY29va2llcyBvbiB0aGUgZG9tYWluIHRoYXQgY29udGFpbnMgYm90aFxuICAvLyB0aGUgY2RuLiBhbmQgd3d3LiBob3N0cy5cbiAgaWYgKGRvbWFpbiA9PSAnYW1wcHJvamVjdC5vcmcnKSB7XG4gICAgLy8gQWN0aXZlbHkgZGVsZXRlIHRoZW0uXG4gICAgdmFsdWUgPSAnZGVsZXRlJztcbiAgICBleHBpcmF0aW9uVGltZSA9IDA7XG4gIH1cbiAgY29uc3QgY29va2llID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJz0nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgK1xuICAgICAgJzsgcGF0aD0vJyArXG4gICAgICAoZG9tYWluID8gJzsgZG9tYWluPScgKyBkb21haW4gOiAnJykgK1xuICAgICAgJzsgZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJhdGlvblRpbWUpLnRvVVRDU3RyaW5nKCk7XG4gIHRyeSB7XG4gICAgd2luLmRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZTtcbiAgfSBjYXRjaCAoaWdub3JlKSB7XG4gICAgLy8gRG8gbm90IHRocm93IGlmIHNldHRpbmcgdGhlIGNvb2tpZSBmYWlsZWQgRXhjZXB0aW9ucyBjYW4gYmUgdGhyb3duXG4gICAgLy8gd2hlbiBBTVAgZG9jcyBhcmUgb3BlbmVkIG9uIG9yaWdpbnMgdGhhdCBkbyBub3QgYWxsb3cgc2V0dGluZ1xuICAgIC8vIGNvb2tpZXMgc3VjaCBhcyBudWxsIG9yaWdpbnMuXG4gIH1cbn1cblxuLyoqXG4gKiBUaHJvd3MgaWYgYSBnaXZlbiBjb29raWUgc2hvdWxkIG5vdCBiZSBzZXQgb24gdGhlIGdpdmVuIG9yaWdpbi5cbiAqIFRoaXMgaXMgYSBkZWZlbnNlLWluLWRlcHRoLiBDYWxsZXJzIHNob3VsZCBuZXZlciBydW4gaW50byB0aGlzLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBGb3IgdGhlIGVycm9yIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT3JpZ2luRm9yU2V0dGluZ0Nvb2tpZSh3aW4sIG9wdGlvbnMsIG5hbWUpIHtcbiAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd09uUHJveHlPcmlnaW4pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlzUHJveHlPcmlnaW4od2luLmxvY2F0aW9uLmhyZWYpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgbmV2ZXIgYXR0ZW1wdCB0byBzZXQgY29va2llIG9uIHByb3h5IG9yaWdpbjogJ1xuICAgICAgICArIG5hbWUpO1xuICB9XG5cbiAgY29uc3QgY3VycmVudCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh3aW4ubG9jYXRpb24uaHJlZikuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgcHJveHkgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJscy5jZG4pLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChjdXJyZW50ID09IHByb3h5IHx8IGVuZHNXaXRoKGN1cnJlbnQsICcuJyArIHByb3h5KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIG5ldmVyIGF0dGVtcHQgdG8gc2V0IGNvb2tpZSBvbiBwcm94eSBvcmlnaW4uJ1xuICAgICAgICArICcgKGluIGRlcHRoIGNoZWNrKTogJyArIG5hbWUpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtEZWZlcnJlZH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7Y3NzRXNjYXBlfSBmcm9tICcuLi90aGlyZF9wYXJ0eS9jc3MtZXNjYXBlL2Nzcy1lc2NhcGUnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtzdGFydHNXaXRofSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQge3RvV2lufSBmcm9tICcuL3R5cGVzJztcblxuY29uc3QgSFRNTF9FU0NBUEVfQ0hBUlMgPSB7XG4gICcmJzogJyZhbXA7JyxcbiAgJzwnOiAnJmx0OycsXG4gICc+JzogJyZndDsnLFxuICAnXCInOiAnJnF1b3Q7JyxcbiAgXCInXCI6ICcmI3gyNzsnLFxuICAnYCc6ICcmI3g2MDsnLFxufTtcbmNvbnN0IEhUTUxfRVNDQVBFX1JFR0VYID0gLygmfDx8PnxcInwnfGApL2c7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRSA9XG4gICAgJ19fQU1QX1VQR19QUk0nO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5leHBvcnQgY29uc3QgVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSID1cbiAgICAnX19BTVBfVVBHX1JFUyc7XG5cbi8qKlxuICogV2FpdHMgdW50aWwgdGhlIGNoaWxkIGVsZW1lbnQgaXMgY29uc3RydWN0ZWQuIE9uY2UgdGhlIGNoaWxkIGlzIGZvdW5kLCB0aGVcbiAqIGNhbGxiYWNrIGlzIGV4ZWN1dGVkLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjaGVja0Z1bmNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgY2FsbGJhY2spIHtcbiAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgY2FsbGJhY2soKTtcbiAgICByZXR1cm47XG4gIH1cbiAgLyoqIEBjb25zdCB7IVdpbmRvd30gKi9cbiAgY29uc3Qgd2luID0gdG9XaW4ocGFyZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICBpZiAod2luLk11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAvKiogQGNvbnN0IHtNdXRhdGlvbk9ic2VydmVyfSAqL1xuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHdpbi5NdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcbiAgICAgIGlmIChjaGVja0Z1bmMocGFyZW50KSkge1xuICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShwYXJlbnQsIHtjaGlsZExpc3Q6IHRydWV9KTtcbiAgfSBlbHNlIHtcbiAgICAvKiogQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgY29uc3QgaW50ZXJ2YWwgPSB3aW4uc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKGNoZWNrRnVuYyhwYXJlbnQpKSB7XG4gICAgICAgIHdpbi5jbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAvKiBtaWxsaXNlY29uZHMgKi8gNSk7XG4gIH1cbn1cblxuLyoqXG4gKiBXYWl0cyB1bnRpbCB0aGUgY2hpbGQgZWxlbWVudCBpcyBjb25zdHJ1Y3RlZC4gT25jZSB0aGUgY2hpbGQgaXMgZm91bmQsIHRoZVxuICogcHJvbWlzZSBpcyByZXNvbHZlZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2hlY2tGdW5jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JDaGlsZFByb21pc2UocGFyZW50LCBjaGVja0Z1bmMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JDaGlsZChwYXJlbnQsIGNoZWNrRnVuYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBkb2N1bWVudCdzIGJvZHkgdG8gYmUgYXZhaWxhYmxlLlxuICogV2lsbCBiZSBkZXByZWNhdGVkIHNvb247IHVzZSB7QGxpbmsgQW1wRG9jI3doZW5Cb2R5QXZhaWxhYmxlfSBvclxuICogQHtsaW5rIERvY3VtZW50U3RhdGUjb25Cb2R5QXZhaWxhYmxlfSBpbnN0ZWFkLlxuICogQHBhcmFtIHshRG9jdW1lbnR9IGRvY1xuICogQHBhcmFtIHtmdW5jdGlvbigpfSBjYWxsYmFja1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FpdEZvckJvZHkoZG9jLCBjYWxsYmFjaykge1xuICB3YWl0Rm9yQ2hpbGQoZG9jLmRvY3VtZW50RWxlbWVudCwgKCkgPT4gISFkb2MuYm9keSwgY2FsbGJhY2spO1xufVxuXG5cbi8qKlxuICogV2FpdHMgZm9yIGRvY3VtZW50J3MgYm9keSB0byBiZSBhdmFpbGFibGUuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JCb2R5UHJvbWlzZShkb2MpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIHdhaXRGb3JCb2R5KGRvYywgcmVzb2x2ZSk7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5wYXJlbnRFbGVtZW50KSB7XG4gICAgZWxlbWVudC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBjaGlsZCBub2RlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNoaWxkcmVuKHBhcmVudCkge1xuICB3aGlsZSAocGFyZW50LmZpcnN0Q2hpbGQpIHtcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQocGFyZW50LmZpcnN0Q2hpbGQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBDb3BpZXMgYWxsIGNoaWxkcmVuIG5vZGVzIG9mIGVsZW1lbnQgXCJmcm9tXCIgdG8gZWxlbWVudCBcInRvXCIuIENoaWxkIG5vZGVzXG4gKiBhcmUgZGVlcGx5IGNsb25lZC4gTm90aWNlLCB0aGF0IHRoaXMgbWV0aG9kIHNob3VsZCBiZSB1c2VkIHdpdGggY2FyZSBhbmRcbiAqIHByZWZlcmFibHkgb24gc21hbGxlciBzdWJ0cmVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGZyb21cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IURvY3VtZW50RnJhZ21lbnR9IHRvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb3B5Q2hpbGRyZW4oZnJvbSwgdG8pIHtcbiAgY29uc3QgZnJhZyA9IHRvLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICBmb3IgKGxldCBuID0gZnJvbS5maXJzdENoaWxkOyBuOyBuID0gbi5uZXh0U2libGluZykge1xuICAgIGZyYWcuYXBwZW5kQ2hpbGQobi5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG4gIHRvLmFwcGVuZENoaWxkKGZyYWcpO1xufVxuXG4vKipcbiAqIEluc2VydCB0aGUgZWxlbWVudCBpbiB0aGUgcm9vdCBhZnRlciB0aGUgZWxlbWVudCBuYW1lZCBhZnRlciBvclxuICogaWYgdGhhdCBpcyBudWxsIGF0IHRoZSBiZWdpbm5pbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFTaGFkb3dSb290fSByb290XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBhZnRlclxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0QWZ0ZXJPckF0U3RhcnQocm9vdCwgZWxlbWVudCwgYWZ0ZXIpIHtcbiAgY29uc3QgYmVmb3JlID0gYWZ0ZXIgPyBhZnRlci5uZXh0U2libGluZyA6IHJvb3QuZmlyc3RDaGlsZDtcbiAgcm9vdC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgYmVmb3JlKTtcbn1cblxuLyoqXG4gKiBBZGQgYXR0cmlidXRlcyB0byBhbiBlbGVtZW50LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICBmb3IgKGNvbnN0IGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJpYnV0ZXNbYXR0cl0pO1xuICB9XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBlbGVtZW50IG9uIGRvY3VtZW50IHdpdGggc3BlY2lmaWVkIHRhZ05hbWUgYW5kIGF0dHJpYnV0ZXMuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHBhcmFtIHshSnNvbk9iamVjdDxzdHJpbmcsIHN0cmluZz59IGF0dHJpYnV0ZXNcbiAqIEByZXR1cm4geyFFbGVtZW50fSBjcmVhdGVkIGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRXaXRoQXR0cmlidXRlcyhkb2MsIHRhZ05hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICByZXR1cm4gYWRkQXR0cmlidXRlc1RvRWxlbWVudChlbGVtZW50LCBhdHRyaWJ1dGVzKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBjb25uZWN0ZWQgKGF0dGFjaGVkKS5cbiAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAc2VlIGh0dHBzOi8vZG9tLnNwZWMud2hhdHdnLm9yZy8jY29ubmVjdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Nvbm5lY3RlZE5vZGUobm9kZSkge1xuICBjb25zdCBjb25uZWN0ZWQgPSBub2RlLmlzQ29ubmVjdGVkO1xuICBpZiAoY29ubmVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY29ubmVjdGVkO1xuICB9XG5cbiAgLy8gXCJBbiBlbGVtZW50IGlzIGNvbm5lY3RlZCBpZiBpdHMgc2hhZG93LWluY2x1ZGluZyByb290IGlzIGEgZG9jdW1lbnQuXCJcbiAgbGV0IG4gPSBub2RlO1xuICBkbyB7XG4gICAgbiA9IHJvb3ROb2RlRm9yKG4pO1xuICAgIGlmIChuLmhvc3QpIHtcbiAgICAgIG4gPSBuLmhvc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSB3aGlsZSAodHJ1ZSk7XG4gIHJldHVybiBuLm5vZGVUeXBlID09PSBOb2RlLkRPQ1VNRU5UX05PREU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcm9vdCBmb3IgYSBnaXZlbiBub2RlLiBEb2VzIG5vdCBjcm9zcyBzaGFkb3cgRE9NIGJvdW5kYXJ5LlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHJldHVybiB7IU5vZGV9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb290Tm9kZUZvcihub2RlKSB7XG4gIGlmIChOb2RlLnByb3RvdHlwZS5nZXRSb290Tm9kZSkge1xuICAgIC8vIFR5cGUgY2hlY2tlciBzYXlzIGBnZXRSb290Tm9kZWAgbWF5IHJldHVybiBudWxsLlxuICAgIHJldHVybiBub2RlLmdldFJvb3ROb2RlKCkgfHwgbm9kZTtcbiAgfVxuICBsZXQgbjtcbiAgZm9yIChuID0gbm9kZTsgISFuLnBhcmVudE5vZGU7IG4gPSBuLnBhcmVudE5vZGUpIHt9XG4gIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrIGZyb20gdGhpcyBlbGVtZW50XG4gKiB1cCB0aGUgRE9NIHN1YnRyZWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHBhcmFtIHtFbGVtZW50PX0gb3B0X3N0b3BBdCBvcHRpb25hbCBlbGVtbnQgdG8gc3RvcCB0aGUgc2VhcmNoIGF0LlxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0KGVsZW1lbnQsIGNhbGxiYWNrLCBvcHRfc3RvcEF0KSB7XG4gIGZvciAobGV0IGVsID0gZWxlbWVudDsgZWwgJiYgZWwgIT09IG9wdF9zdG9wQXQ7IGVsID0gZWwucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChjYWxsYmFjayhlbCkpIHtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBub2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBjYWxsYmFjayBmcm9tIHRoaXMgbm9kZVxuICogdXAgdGhlIERPTSBzdWJ0cmVlLlxuICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICogQHBhcmFtIHtmdW5jdGlvbighTm9kZSk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4gez9Ob2RlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VzdE5vZGUobm9kZSwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgbiA9IG5vZGU7IG47IG4gPSBuLnBhcmVudE5vZGUpIHtcbiAgICBpZiAoY2FsbGJhY2sobikpIHtcbiAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBjbG9zZXN0IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUgZnJvbSB0aGlzIGVsZW1lbnRcbiAqIHVwIHRoZSBET00gc3VidHJlZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVRhZyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHRhZ05hbWUpO1xuICB9XG4gIHRhZ05hbWUgPSB0YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gZWwudGFnTmFtZSA9PSB0YWdOYW1lO1xuICB9KTtcbn1cblxuLyoqXG4gKiBGaW5kcyB0aGUgY2xvc2VzdCBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBzZWxlY3RvciBmcm9tIHRoaXMgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yXG4gKiBAcmV0dXJuIHs/RWxlbWVudH0gY2xvc2VzdCBhbmNlc3RvciBpZiBmb3VuZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb3Nlc3RCeVNlbGVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGlmIChlbGVtZW50LmNsb3Nlc3QpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKTtcbiAgfVxuXG4gIHJldHVybiBjbG9zZXN0KGVsZW1lbnQsIGVsID0+IHtcbiAgICByZXR1cm4gbWF0Y2hlcyhlbCwgc2VsZWN0b3IpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVsZW1lbnQgbWF0Y2hlcyB0aGUgc2VsZWN0b3JcbiAqIEBwYXJhbSAgeyFFbGVtZW50fSBlbCBUaGUgZWxlbWVudCB0byB2ZXJpZnlcbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgVGhlIHNlbGVjdG9yIHRvIGNoZWNrIGFnYWluc3RcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVsZW1lbnQgbWF0Y2hlZCB0aGUgc2VsZWN0b3IuIEZhbHNlIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoZXMoZWwsIHNlbGVjdG9yKSB7XG4gIGNvbnN0IG1hdGNoZXIgPSBlbC5tYXRjaGVzIHx8XG4gICAgICBlbC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZWwubXNNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIGVsLm9NYXRjaGVzU2VsZWN0b3I7XG4gIGlmIChtYXRjaGVyKSB7XG4gICAgcmV0dXJuIG1hdGNoZXIuY2FsbChlbCwgc2VsZWN0b3IpO1xuICB9XG4gIHJldHVybiBmYWxzZTsgLy8gSUU4IGFsd2F5cyByZXR1cm5zIGZhbHNlLlxufVxuXG4vKipcbiAqIEZpbmRzIHRoZSBmaXJzdCBkZXNjZW5kYW50IGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFEb2N1bWVudHwhU2hhZG93Um9vdH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHRhZ05hbWVcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZWxlbWVudEJ5VGFnKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgbGV0IGVsZW1lbnRzO1xuICAvLyBnZXRFbGVtZW50c0J5VGFnTmFtZSgpIGlzIG5vdCBzdXBwb3J0ZWQgb24gU2hhZG93Um9vdC5cbiAgaWYgKHR5cGVvZiBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgZWxlbWVudHMgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnRzID0gZWxlbWVudC4vKk9LKi9xdWVyeVNlbGVjdG9yQWxsKHRhZ05hbWUpO1xuICB9XG4gIHJldHVybiAoZWxlbWVudHMgJiYgZWxlbWVudHNbMF0pIHx8IG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IHNhdGlzZmllcyB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIUVsZW1lbnQpOmJvb2xlYW59IGNhbGxiYWNrXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudChwYXJlbnQsIGNhbGxiYWNrKSB7XG4gIGZvciAobGV0IGNoaWxkID0gcGFyZW50LmZpcnN0RWxlbWVudENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRFbGVtZW50U2libGluZykge1xuICAgIGlmIChjYWxsYmFjayhjaGlsZCkpIHtcbiAgICAgIHJldHVybiBjaGlsZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gY2FsbGJhY2tcbiAqIEByZXR1cm4geyFBcnJheTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRzKHBhcmVudCwgY2FsbGJhY2spIHtcbiAgY29uc3QgY2hpbGRyZW4gPSBbXTtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7IGNoaWxkO1xuICAgIGNoaWxkID0gY2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBjaGlsZHJlbjtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBzYXRpc2ZpZXMgdGhlIGNhbGxiYWNrLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFbGVtZW50KTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgY2FsbGJhY2spIHtcbiAgZm9yIChsZXQgY2hpbGQgPSBwYXJlbnQubGFzdEVsZW1lbnRDaGlsZDsgY2hpbGQ7XG4gICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgbm9kZXMgdGhhdCBzYXRpc2Z5IHRoZSBjYWxsYmFjay5cbiAqIFRoZXNlIG5vZGVzIGNhbiBpbmNsdWRlIFRleHQsIENvbW1lbnQgYW5kIG90aGVyIGNoaWxkIG5vZGVzLlxuICogQHBhcmFtIHshTm9kZX0gcGFyZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFOb2RlKTpib29sZWFufSBjYWxsYmFja1xuICogQHJldHVybiB7IUFycmF5PCFOb2RlPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkTm9kZXMocGFyZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBub2RlcyA9IFtdO1xuICBmb3IgKGxldCBjaGlsZCA9IHBhcmVudC5maXJzdENoaWxkOyBjaGlsZDtcbiAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKSB7XG4gICAgaWYgKGNhbGxiYWNrKGNoaWxkKSkge1xuICAgICAgbm9kZXMucHVzaChjaGlsZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBub2Rlcztcbn1cblxuLyoqXG4gKiBAdHlwZSB7Ym9vbGVhbnx1bmRlZmluZWR9XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xubGV0IHNjb3BlU2VsZWN0b3JTdXBwb3J0ZWQ7XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFufHVuZGVmaW5lZH0gdmFsXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFNjb3BlU2VsZWN0b3JTdXBwb3J0ZWRGb3JUZXN0aW5nKHZhbCkge1xuICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gdmFsO1xufVxuXG4vKipcbiAqIFRlc3QgdGhhdCB0aGUgOnNjb3BlIHNlbGVjdG9yIGlzIHN1cHBvcnRlZCBhbmQgYmVoYXZlcyBjb3JyZWN0bHkuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChwYXJlbnQpIHtcbiAgY29uc3QgZG9jID0gcGFyZW50Lm93bmVyRG9jdW1lbnQ7XG4gIHRyeSB7XG4gICAgY29uc3QgdGVzdEVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGVzdENoaWxkID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRlc3RFbGVtZW50LmFwcGVuZENoaWxkKHRlc3RDaGlsZCk7XG4gICAgLy8gTk9URShjdmlhbGl6LCAjMTIzODMpOiBGaXJlZm94J3MgaW1wbGVtZW50YXRpb24gaXMgaW5jb21wbGV0ZSxcbiAgICAvLyB0aGVyZWZvcmUgd2UgdGVzdCBhY3R1YWwgZnVuY3Rpb25hbGl0eSBvZmA6c2NvcGVgIGFzIHdlbGwuXG4gICAgcmV0dXJuIHRlc3RFbGVtZW50Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoJzpzY29wZSBkaXYnKSA9PT0gdGVzdENoaWxkO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRmluZHMgdGhlIGZpcnN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudEJ5QXR0cihwYXJlbnQsIGF0dHIpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiBbJHthdHRyfV1gKTtcbn1cblxuXG4vKipcbiAqIEZpbmRzIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBwYXJlbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhdHRyXG4gKiBAcmV0dXJuIHs/RWxlbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDaGlsZEVsZW1lbnRCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBsYXN0Q2hpbGRFbGVtZW50KHBhcmVudCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC5oYXNBdHRyaWJ1dGUoYXR0cik7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgaGFzIHRoZSBzcGVjaWZpZWQgYXR0cmlidXRlLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0clxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeUF0dHIocGFyZW50LCBhdHRyKSB7XG4gIHJldHVybiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsLypPSyovKHBhcmVudCwgYD4gWyR7YXR0cn1dYCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgY2hpbGQgZWxlbWVudCB0aGF0IGhhcyB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7P0VsZW1lbnR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZEVsZW1lbnRCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3IvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgY2hpbGQgZWxlbWVudHMgd2l0aCB0aGUgc3BlY2lmaWVkIHRhZyBuYW1lLlxuICogQHBhcmFtIHshRWxlbWVudH0gcGFyZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IU5vZGVMaXN0PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkRWxlbWVudHNCeVRhZyhwYXJlbnQsIHRhZ05hbWUpIHtcbiAgcmV0dXJuIHNjb3BlZFF1ZXJ5U2VsZWN0b3JBbGwvKk9LKi8ocGFyZW50LCBgPiAke3RhZ05hbWV9YCk7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4gez9FbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NvcGVkUXVlcnlTZWxlY3Rvcihyb290LCBzZWxlY3Rvcikge1xuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgc2NvcGVTZWxlY3RvclN1cHBvcnRlZCA9IGlzU2NvcGVTZWxlY3RvclN1cHBvcnRlZChyb290KTtcbiAgfVxuICBpZiAoc2NvcGVTZWxlY3RvclN1cHBvcnRlZCkge1xuICAgIHJldHVybiByb290Li8qT0sqL3F1ZXJ5U2VsZWN0b3IoYDpzY29wZSAke3NlbGVjdG9yfWApO1xuICB9XG5cbiAgLy8gT25seSBJRS5cbiAgY29uc3QgdW5pcXVlID0gJ2ktYW1waHRtbC1zY29wZWQnO1xuICByb290LmNsYXNzTGlzdC5hZGQodW5pcXVlKTtcbiAgY29uc3QgZWxlbWVudCA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvcihgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cblxuLyoqXG4gKiBGaW5kcyB0aGUgZXZlcnkgZWxlbWVudCB0aGF0IG1hdGNoZXMgYHNlbGVjdG9yYCwgc2NvcGVkIGluc2lkZSBgcm9vdGAuXG4gKiBOb3RlOiBpbiBJRSwgdGhpcyBjYXVzZXMgYSBxdWljayBtdXRhdGlvbiBvZiB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3QuXG4gKiBAcGFyYW0geyFFbGVtZW50fSByb290XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4geyFOb2RlTGlzdDwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY29wZWRRdWVyeVNlbGVjdG9yQWxsKHJvb3QsIHNlbGVjdG9yKSB7XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkID09IG51bGwpIHtcbiAgICBzY29wZVNlbGVjdG9yU3VwcG9ydGVkID0gaXNTY29wZVNlbGVjdG9yU3VwcG9ydGVkKHJvb3QpO1xuICB9XG4gIGlmIChzY29wZVNlbGVjdG9yU3VwcG9ydGVkKSB7XG4gICAgcmV0dXJuIHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgOnNjb3BlICR7c2VsZWN0b3J9YCk7XG4gIH1cblxuICAvLyBPbmx5IElFLlxuICBjb25zdCB1bmlxdWUgPSAnaS1hbXBodG1sLXNjb3BlZCc7XG4gIHJvb3QuY2xhc3NMaXN0LmFkZCh1bmlxdWUpO1xuICBjb25zdCBlbGVtZW50cyA9IHJvb3QuLypPSyovcXVlcnlTZWxlY3RvckFsbChgLiR7dW5pcXVlfSAke3NlbGVjdG9yfWApO1xuICByb290LmNsYXNzTGlzdC5yZW1vdmUodW5pcXVlKTtcbiAgcmV0dXJuIGVsZW1lbnRzO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBlbGVtZW50IGRhdGEtcGFyYW0tIGF0dHJpYnV0ZXMgYXMgdXJsIHBhcmFtZXRlcnMga2V5LXZhbHVlIHBhaXJzLlxuICogZS5nLiBkYXRhLXBhcmFtLXNvbWUtYXR0cj12YWx1ZSAtPiB7c29tZUF0dHI6IHZhbHVlfS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKTpzdHJpbmc9fSBvcHRfY29tcHV0ZVBhcmFtTmFtZUZ1bmMgdG8gY29tcHV0ZSB0aGVcbiAqICAgIHBhcmFtZXRlciBuYW1lLCBnZXQgcGFzc2VkIHRoZSBjYW1lbC1jYXNlIHBhcmFtZXRlciBuYW1lLlxuICogQHBhcmFtIHshUmVnRXhwPX0gb3B0X3BhcmFtUGF0dGVybiBSZWdleCBwYXR0ZXJuIHRvIG1hdGNoIGRhdGEgYXR0cmlidXRlcy5cbiAqIEByZXR1cm4geyFKc29uT2JqZWN0fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YVBhcmFtc0Zyb21BdHRyaWJ1dGVzKGVsZW1lbnQsIG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyxcbiAgb3B0X3BhcmFtUGF0dGVybikge1xuICBjb25zdCBjb21wdXRlUGFyYW1OYW1lRnVuYyA9IG9wdF9jb21wdXRlUGFyYW1OYW1lRnVuYyB8fCAoa2V5ID0+IGtleSk7XG4gIGNvbnN0IHtkYXRhc2V0fSA9IGVsZW1lbnQ7XG4gIGNvbnN0IHBhcmFtcyA9IGRpY3QoKTtcbiAgY29uc3QgcGFyYW1QYXR0ZXJuID0gb3B0X3BhcmFtUGF0dGVybiA/IG9wdF9wYXJhbVBhdHRlcm4gOiAvXnBhcmFtKC4rKS87XG4gIGZvciAoY29uc3Qga2V5IGluIGRhdGFzZXQpIHtcbiAgICBjb25zdCBtYXRjaGVzID0ga2V5Lm1hdGNoKHBhcmFtUGF0dGVybik7XG4gICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gbWF0Y2hlc1sxXVswXS50b0xvd2VyQ2FzZSgpICsgbWF0Y2hlc1sxXS5zdWJzdHIoMSk7XG4gICAgICBwYXJhbXNbY29tcHV0ZVBhcmFtTmFtZUZ1bmMocGFyYW0pXSA9IGRhdGFzZXRba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmFtcztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBlbGVtZW50IGhhdmUgYSBuZXh0IG5vZGUgaW4gdGhlIGRvY3VtZW50IG9yZGVyLlxuICogVGhpcyBtZWFucyBlaXRoZXI6XG4gKiAgYS4gVGhlIGVsZW1lbnQgaXRzZWxmIGhhcyBhIG5leHRTaWJsaW5nLlxuICogIGIuIEFueSBvZiB0aGUgZWxlbWVudCBhbmNlc3RvcnMgaGFzIGEgbmV4dFNpYmxpbmcuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0gez9Ob2RlfSBvcHRfc3RvcE5vZGVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNOZXh0Tm9kZUluRG9jdW1lbnRPcmRlcihlbGVtZW50LCBvcHRfc3RvcE5vZGUpIHtcbiAgbGV0IGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgZG8ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9IHdoaWxlICgoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnROb2RlKSAmJlxuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQgIT0gb3B0X3N0b3BOb2RlKTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5cbi8qKlxuICogRmluZHMgYWxsIGFuY2VzdG9yIGVsZW1lbnRzIHRoYXQgc2F0aXNmeSBwcmVkaWNhdGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBjaGlsZFxuICogQHBhcmFtIHtmdW5jdGlvbighRWxlbWVudCk6Ym9vbGVhbn0gcHJlZGljYXRlXG4gKiBAcmV0dXJuIHshQXJyYXk8IUVsZW1lbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgcHJlZGljYXRlKSB7XG4gIGNvbnN0IGFuY2VzdG9ycyA9IFtdO1xuICBmb3IgKGxldCBhbmNlc3RvciA9IGNoaWxkLnBhcmVudEVsZW1lbnQ7IGFuY2VzdG9yO1xuICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50RWxlbWVudCkge1xuICAgIGlmIChwcmVkaWNhdGUoYW5jZXN0b3IpKSB7XG4gICAgICBhbmNlc3RvcnMucHVzaChhbmNlc3Rvcik7XG4gICAgfVxuICB9XG4gIHJldHVybiBhbmNlc3RvcnM7XG59XG5cblxuLyoqXG4gKiBGaW5kcyBhbGwgYW5jZXN0b3IgZWxlbWVudHMgdGhhdCBoYXMgdGhlIHNwZWNpZmllZCB0YWcgbmFtZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGNoaWxkXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7IUFycmF5PCFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFuY2VzdG9yRWxlbWVudHNCeVRhZyhjaGlsZCwgdGFnTmFtZSkge1xuICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xuICByZXR1cm4gYW5jZXN0b3JFbGVtZW50cyhjaGlsZCwgZWwgPT4ge1xuICAgIHJldHVybiBlbC50YWdOYW1lID09IHRhZ05hbWU7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgY29udGVudCBvZiBhIHRlbXBsYXRlIGVsZW1lbnQuXG4gKlxuICogUG9seWZpbGwgdG8gcmVwbGFjZSAuY29udGVudCBhY2Nlc3MgZm9yIGJyb3dzZXJzIHRoYXQgZG8gbm90IHN1cHBvcnRcbiAqIEhUTUxUZW1wbGF0ZUVsZW1lbnRzIG5hdGl2ZWx5LlxuICpcbiAqIEBwYXJhbSB7IUhUTUxUZW1wbGF0ZUVsZW1lbnR8IUVsZW1lbnR9IHRlbXBsYXRlXG4gKiBAcmV0dXJuIHshRG9jdW1lbnRGcmFnbWVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlQ29udGVudENsb25lKHRlbXBsYXRlKSB7XG4gIGlmICgnY29udGVudCcgaW4gdGVtcGxhdGUpIHtcbiAgICByZXR1cm4gdGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY29udGVudCA9IHRlbXBsYXRlLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGNvcHlDaGlsZHJlbih0ZW1wbGF0ZSwgY29udGVudCk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cbn1cblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYW4gYXJyYXktbGlrZS4gU29tZSBjb2xsZWN0aW9ucyBsaWtlIE5vZGVMaXN0IGFyZVxuICogbGF6aWx5IGV2YWx1YXRlZCBpbiBzb21lIGJyb3dzZXJzLCBhbmQgYWNjZXNzaW5nIGBsZW5ndGhgIGZvcmNlcyBmdWxsXG4gKiBldmFsdWF0aW9uLiBXZSBjYW4gaW1wcm92ZSBwZXJmb3JtYW5jZSBieSBpdGVyYXRpbmcgdW50aWwgYW4gZWxlbWVudCBpc1xuICogYHVuZGVmaW5lZGAgdG8gYXZvaWQgY2hlY2tpbmcgdGhlIGBsZW5ndGhgIHByb3BlcnR5LlxuICogVGVzdCBjYXNlczogaHR0cHM6Ly9qc3BlcmYuY29tL2l0ZXJhdGluZy1vdmVyLWNvbGxlY3Rpb25zLW9mLWVsZW1lbnRzXG4gKiBAcGFyYW0geyFJQXJyYXlMaWtlPFQ+fSBpdGVyYWJsZVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIpfSBjYlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGl0ZXJhdGVDdXJzb3IoaXRlcmFibGUsIGNiKSB7XG4gIGZvciAobGV0IGkgPSAwLCB2YWx1ZTsgKHZhbHVlID0gaXRlcmFibGVbaV0pICE9PSB1bmRlZmluZWQ7IGkrKykge1xuICAgIGNiKHZhbHVlLCBpKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIHdyYXBzIGFyb3VuZCB3aW5kb3cncyBvcGVuIG1ldGhvZC4gSXQgZmlyc3QgdHJpZXMgdG8gZXhlY3V0ZVxuICogYG9wZW5gIGNhbGwgd2l0aCB0aGUgcHJvdmlkZWQgdGFyZ2V0IGFuZCBpZiBpdCBmYWlscywgaXQgcmV0cmllcyB0aGUgY2FsbFxuICogd2l0aCB0aGUgYF90b3BgIHRhcmdldC4gVGhpcyBpcyBuZWNlc3NhcnkgZ2l2ZW4gdGhhdCBpbiBzb21lIGVtYmVkZGluZ1xuICogc2NlbmFyaW9zLCBzdWNoIGFzIGlPUycgV0tXZWJWaWV3LCBuYXZpZ2F0aW9uIHRvIGBfYmxhbmtgIGFuZCBvdGhlciB0YXJnZXRzXG4gKiBpcyBibG9ja2VkIGJ5IGRlZmF1bHQuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRcbiAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X2ZlYXR1cmVzXG4gKiBAcmV0dXJuIHs/V2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3BlbldpbmRvd0RpYWxvZyh3aW4sIHVybCwgdGFyZ2V0LCBvcHRfZmVhdHVyZXMpIHtcbiAgLy8gVHJ5IGZpcnN0IHdpdGggdGhlIHNwZWNpZmllZCB0YXJnZXQuIElmIHdlJ3JlIGluc2lkZSB0aGUgV0tXZWJWaWV3IG9yXG4gIC8vIGEgc2ltaWxhciBlbnZpcm9ubWVudHMsIHRoaXMgbWV0aG9kIGlzIGV4cGVjdGVkIHRvIGZhaWwgYnkgZGVmYXVsdCBmb3JcbiAgLy8gYWxsIHRhcmdldHMgZXhjZXB0IGBfdG9wYC5cbiAgbGV0IHJlcztcbiAgdHJ5IHtcbiAgICByZXMgPSB3aW4ub3Blbih1cmwsIHRhcmdldCwgb3B0X2ZlYXR1cmVzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGRldigpLmVycm9yKCdET00nLCAnRmFpbGVkIHRvIG9wZW4gdXJsIG9uIHRhcmdldDogJywgdGFyZ2V0LCBlKTtcbiAgfVxuXG4gIC8vIFRoZW4gdHJ5IHdpdGggYF90b3BgIHRhcmdldC5cbiAgaWYgKCFyZXMgJiYgdGFyZ2V0ICE9ICdfdG9wJykge1xuICAgIHJlcyA9IHdpbi5vcGVuKHVybCwgJ190b3AnKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgYSBzY3JpcHQgdGFnIHdpdGggYXBwbGljYXRpb24vanNvbiB0eXBlLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvblNjcmlwdFRhZyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT0gJ1NDUklQVCcgJiZcbiAgICAgICAgICAgIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykudG9VcHBlckNhc2UoKSA9PSAnQVBQTElDQVRJT04vSlNPTic7XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgZWxlbWVudCBpcyBhIHNjcmlwdCB0YWcgd2l0aCBhcHBsaWNhdGlvbi9qc29uIHR5cGUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNKc29uTGRTY3JpcHRUYWcoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdTQ1JJUFQnICYmXG4gICAgICBlbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpLnRvVXBwZXJDYXNlKCkgPT0gJ0FQUExJQ0FUSU9OL0xEK0pTT04nO1xufVxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHBhZ2UncyBkaXJlY3Rpb24gaXMgcmlnaHQgdG8gbGVmdCBvciBub3QuXG4gKiBAcGFyYW0geyFEb2N1bWVudH0gZG9jXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNSVEwoZG9jKSB7XG4gIGNvbnN0IGRpciA9IGRvYy5ib2R5LmdldEF0dHJpYnV0ZSgnZGlyJylcbiAgICAgICAgICAgICAgICAgfHwgZG9jLmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RpcicpXG4gICAgICAgICAgICAgICAgIHx8ICdsdHInO1xuICByZXR1cm4gZGlyID09ICdydGwnO1xufVxuXG5cbi8qKlxuICogRXNjYXBlcyBhbiBpZGVudCAoSUQgb3IgYSBjbGFzcyBuYW1lKSB0byBiZSB1c2VkIGFzIGEgQ1NTIHNlbGVjdG9yLlxuICpcbiAqIFNlZSBodHRwczovL2RyYWZ0cy5jc3N3Zy5vcmcvY3Nzb20vI3NlcmlhbGl6ZS1hbi1pZGVudGlmaWVyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JJZGVudChpZGVudCkge1xuICByZXR1cm4gY3NzRXNjYXBlKGlkZW50KTtcbn1cblxuLyoqXG4gKiBFc2NhcGVzIGFuIGlkZW50IGluIGEgd2F5IHRoYXQgY2FuIGJlIHVzZWQgYnkgOm50aC1jaGlsZCgpIHBzdWVkby1jbGFzcy5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3czYy9jc3N3Zy1kcmFmdHMvaXNzdWVzLzIzMDYuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBpZGVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlQ3NzU2VsZWN0b3JOdGgoaWRlbnQpIHtcbiAgY29uc3QgZXNjYXBlZCA9IFN0cmluZyhpZGVudCk7XG4gIC8vIEVuc3VyZSBpdCBkb2Vzbid0IGNsb3NlIHRoZSBudGgtY2hpbGQgcHN1ZWRvIGNsYXNzLlxuICBkZXYoKS5hc3NlcnQoZXNjYXBlZC5pbmRleE9mKCcpJykgPT09IC0xKTtcbiAgcmV0dXJuIGVzY2FwZWQ7XG59XG5cbi8qKlxuICogRXNjYXBlcyBgPGAsIGA+YCBhbmQgb3RoZXIgSFRNTCBjaGFyY2F0ZXJzIHdpdGggdGhlaXIgZXNjYXBlZCBmb3Jtcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVIdG1sKHRleHQpIHtcbiAgaWYgKCF0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cbiAgcmV0dXJuIHRleHQucmVwbGFjZShIVE1MX0VTQ0FQRV9SRUdFWCwgZXNjYXBlSHRtbENoYXIpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBjXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGVzY2FwZUh0bWxDaGFyKGMpIHtcbiAgcmV0dXJuIEhUTUxfRVNDQVBFX0NIQVJTW2NdO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIGZvY3VzIG9uIHRoZSBnaXZlbiBlbGVtZW50OyBmYWlscyBzaWxlbnRseSBpZiBicm93c2VyIHRocm93cyBhblxuICogZXhjZXB0aW9uLlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5Rm9jdXMoZWxlbWVudCkge1xuICB0cnkge1xuICAgIGVsZW1lbnQuLypPSyovZm9jdXMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIElFIDw9IDcgbWF5IHRocm93IGV4Y2VwdGlvbnMgd2hlbiBmb2N1c2luZyBvbiBoaWRkZW4gaXRlbXMuXG4gIH1cbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBnaXZlbiB3aW5kb3cgaXMgaW4gYW4gaWZyYW1lIG9yIG5vdC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJZnJhbWVkKHdpbikge1xuICByZXR1cm4gd2luLnBhcmVudCAmJiB3aW4ucGFyZW50ICE9IHdpbjtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIGlmIHRoaXMgZWxlbWVudCBpcyBhbiBBTVAgZWxlbWVudFxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQW1wRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IHRhZyA9IGVsZW1lbnQudGFnTmFtZTtcbiAgLy8gVXNlIHByZWZpeCB0byByZWNvZ25pemUgQU1QIGVsZW1lbnQuIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc3R1YlxuICAvLyBtYXkgbm90IGJlIGF0dGFjaGVkIHlldC5cbiAgcmV0dXJuIHN0YXJ0c1dpdGgodGFnLCAnQU1QLScpICYmXG4gICAgICAvLyBTb21lIFwiYW1wLSpcIiBlbGVtZW50cyBhcmUgbm90IHJlYWxseSBBTVAgZWxlbWVudHMuIDpzbWg6XG4gICAgICAhKHRhZyA9PSAnQU1QLVNUSUNLWS1BRC1UT1AtUEFERElORycgfHwgdGFnID09ICdBTVAtQk9EWScpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21pc2UgdGhhdCByZXNvbHZlIHdoZW4gYW4gQU1QIGVsZW1lbnQgdXBncmFkZSBmcm9tIEhUTUxFbGVtZW50XG4gKiB0byBDdXN0b21FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRWxlbWVudD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aGVuVXBncmFkZWRUb0N1c3RvbUVsZW1lbnQoZWxlbWVudCkge1xuICBkZXYoKS5hc3NlcnQoaXNBbXBFbGVtZW50KGVsZW1lbnQpLCAnZWxlbWVudCBpcyBub3QgQW1wRWxlbWVudCcpO1xuICBpZiAoZWxlbWVudC5jcmVhdGVkQ2FsbGJhY2spIHtcbiAgICAvLyBFbGVtZW50IGFscmVhZHkgaXMgQ3VzdG9tRWxlbWVudDtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVsZW1lbnQpO1xuICB9XG4gIC8vIElmIEVsZW1lbnQgaXMgc3RpbGwgSFRNTEVsZW1lbnQsIHdhaXQgZm9yIGl0IHRvIHVwZ3JhZGUgdG8gY3VzdG9tRWxlbWVudFxuICAvLyBOb3RlOiB1c2UgcHVyZSBzdHJpbmcgdG8gYXZvaWQgb2JmdXNjYXRpb24gYmV0d2VlbiB2ZXJzaW9ucy5cbiAgaWYgKCFlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXSkge1xuICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgZWxlbWVudFtVUEdSQURFX1RPX0NVU1RPTUVMRU1FTlRfUFJPTUlTRV0gPSBkZWZlcnJlZC5wcm9taXNlO1xuICAgIGVsZW1lbnRbVVBHUkFERV9UT19DVVNUT01FTEVNRU5UX1JFU09MVkVSXSA9IGRlZmVycmVkLnJlc29sdmU7XG5cbiAgfVxuXG4gIHJldHVybiBlbGVtZW50W1VQR1JBREVfVE9fQ1VTVE9NRUxFTUVOVF9QUk9NSVNFXTtcbn1cblxuLyoqXG4gKiBSZXBsYWNlbWVudCBmb3IgYEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvcmVxdWVzdEZ1bGxzY3JlZW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZ1bGxzY3JlZW5FbnRlcihlbGVtZW50KSB7XG4gIGNvbnN0IHJlcXVlc3RGcyA9IGVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQucmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQud2Via2l0RW50ZXJGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50LndlYmtpdEVudGVyRnVsbFNjcmVlblxuICAgfHwgZWxlbWVudC5tc1JlcXVlc3RGdWxsc2NyZWVuXG4gICB8fCBlbGVtZW50Lm1zUmVxdWVzdEZ1bGxTY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxzY3JlZW5cbiAgIHx8IGVsZW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW47XG4gIGlmIChyZXF1ZXN0RnMpIHtcbiAgICByZXF1ZXN0RnMuY2FsbChlbGVtZW50KTtcbiAgfVxufVxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKWAgbWV0aG9kLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2V4aXRGdWxsc2NyZWVuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmdWxsc2NyZWVuRXhpdChlbGVtZW50KSB7XG4gIGxldCBleGl0RnMgPSBlbGVtZW50LmNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LmV4aXRGdWxsc2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgICDCoHx8IGVsZW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW5cbiAgICAgICAgICAgICAgwqB8fCBlbGVtZW50LndlYmtpdEV4aXRGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgIMKgfHwgZWxlbWVudC5tc0V4aXRGdWxsc2NyZWVuO1xuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQpIHtcbiAgICBleGl0RnMgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuY2FuY2VsRnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC5leGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRFeGl0RnVsbFNjcmVlblxuICAgICAgICAgICAgIHx8IGVsZW1lbnQub3duZXJEb2N1bWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuXG4gICAgICAgICAgICAgfHwgZWxlbWVudC5vd25lckRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW5cbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcbiAgfVxuICBpZiAoZXhpdEZzKSB7XG4gICAgZXhpdEZzLmNhbGwoZWxlbWVudC5vd25lckRvY3VtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbn1cblxuXG4vKipcbiAqIFJlcGxhY2VtZW50IGZvciBgRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRgLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0RvY3VtZW50L2Z1bGxzY3JlZW5FbGVtZW50XG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdWxsc2NyZWVuRWxlbWVudChlbGVtZW50KSB7XG4gIGNvbnN0IGlzRnVsbHNjcmVlbiA9IGVsZW1lbnQud2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW47XG4gIGlmIChpc0Z1bGxzY3JlZW4pIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoZWxlbWVudC5vd25lckRvY3VtZW50KSB7XG4gICAgY29uc3QgZnVsbHNjcmVlbkVsZW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnRcbiAgICAgICAgICAgICB8fCBlbGVtZW50LndlYmtpdEN1cnJlbnRGdWxsU2NyZWVuRWxlbWVudDtcbiAgICBpZiAoZnVsbHNjcmVlbkVsZW1lbnQgPT0gZWxlbWVudCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgbm9kZSBpcyBub3QgZGlzYWJsZWQuXG4gKlxuICogSUU4IGNhbiByZXR1cm4gZmFsc2UgcG9zaXRpdmVzLCBzZWUge0BsaW5rIG1hdGNoZXN9LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEBzZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1L2Zvcm1zLmh0bWwjY29uY2VwdC1mZS1kaXNhYmxlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbmFibGVkKGVsZW1lbnQpIHtcbiAgcmV0dXJuICEoZWxlbWVudC5kaXNhYmxlZCB8fCBtYXRjaGVzKGVsZW1lbnQsICc6ZGlzYWJsZWQnKSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0ICogYXMgZG9tIGZyb20gJy4vZG9tJztcbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRTZXJ2aWNlLFxuICBnZXRTZXJ2aWNlUHJvbWlzZSxcbiAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MsXG4gIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsLFxuICBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEZvckRvYyxcbiAgZ2V0VG9wV2luZG93LFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHt0b1dpbn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhbiBlbGVtZW50LFxuICogICAgIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8Kj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZSh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpLnRoZW4oXG4gICAgICBzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uIE5hbWUgb2YgdGhlIGN1c3RvbSBleHRlbnNpb24gdGhhdCBwcm92aWRlcyB0aGVcbiAqICAgICBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudCBXaGV0aGVyIHRoaXMgc2VydmljZSBpcyBwcm92aWRlZCBieSBhblxuICogICAgIGVsZW1lbnQsIG5vdCB0aGUgZXh0ZW5zaW9uLlxuICogQHJldHVybiB7IVByb21pc2U8P09iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpIHtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cbiAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnROYW1lIE5hbWUgb2YgYW4gZXh0ZW5kZWQgY3VzdG9tIGVsZW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoaXMgZWxlbWVudCBpcyBzY2hlZHVsZWQgdG8gYmUgbG9hZGVkLlxuICovXG5mdW5jdGlvbiBpc0VsZW1lbnRTY2hlZHVsZWQod2luLCBlbGVtZW50TmFtZSkge1xuICAvLyBTZXQgaW4gY3VzdG9tLWVsZW1lbnQuanNcbiAgaWYgKCF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50cykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gISF3aW4uYW1wRXh0ZW5kZWRFbGVtZW50c1tlbGVtZW50TmFtZV07XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBTZXJ2aWNlcy52aWV3cG9ydEZvckRvYyguLi4pKSBmb3IgdHlwZSBzYWZldHkgYW5kIGJlY2F1c2UgdGhlXG4gKiBmYWN0b3J5IHNob3VsZCBub3QgYmUgcGFzc2VkIGFyb3VuZC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW4gZWxlbWVudCxcbiAqICAgICBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPCo+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLFxuICBvcHRfZWxlbWVudCkge1xuICByZXR1cm4gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgICAgIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbiwgb3B0X2VsZW1lbnQpXG4gICAgICAudGhlbihzZXJ2aWNlID0+IGFzc2VydFNlcnZpY2Uoc2VydmljZSwgaWQsIGV4dGVuc2lvbikpO1xufVxuXG4vKipcbiAqIFNhbWUgYXMgZ2V0RWxlbWVudFNlcnZpY2UgYnV0IHByb2R1Y2VzIG51bGwgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgbm90XG4gKiBhY3R1YWxseSBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvbiBOYW1lIG9mIHRoZSBjdXN0b20gZXh0ZW5zaW9uIHRoYXQgcHJvdmlkZXMgdGhlXG4gKiAgICAgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBzZXJ2aWNlLlxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2VsZW1lbnQgV2hldGhlciB0aGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYnkgYW5cbiAqICAgICBlbGVtZW50LCBub3QgdGhlIGV4dGVuc2lvbi5cbiAqIEByZXR1cm4geyFQcm9taXNlPD9PYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZUZvckRvYyhcbiAgZWxlbWVudE9yQW1wRG9jLCBpZCwgZXh0ZW5zaW9uLCBvcHRfZWxlbWVudCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2MoZWxlbWVudE9yQW1wRG9jKTtcbiAgY29uc3QgcyA9IGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAocyk7XG4gIH1cblxuICByZXR1cm4gYW1wZG9jLndoZW5Cb2R5QXZhaWxhYmxlKClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQoXG4gICAgICAgICAgYW1wZG9jLndpbiwgZXh0ZW5zaW9uLFxuICAgICAgICAgIGFtcGRvYy5nZXRIZWFkTm9kZSgpKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZChhbXBkb2Mud2luLCBleHRlbnNpb24pKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgZm9yIHRoZSBnaXZlbiBpZCBpbiB0aGUgZW1iZWQgc2NvcGUgb2ZcbiAqIGEgZ2l2ZW4gbm9kZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UsIGZhbGxzIGJhY2sgdG8gYW1wZG9jIHNjb3BlIElGRlxuICogdGhlIGdpdmVuIG5vZGUgaXMgaW4gdGhlIHRvcC1sZXZlbCB3aW5kb3cuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb24gTmFtZSBvZiB0aGUgY3VzdG9tIGVsZW1lbnQgdGhhdCBwcm92aWRlc1xuICogICAgIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTw/T2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbikge1xuICBjb25zdCBzID0gZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKGVsZW1lbnRPckFtcERvYywgaWQpO1xuICBpZiAocykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKHMpKTtcbiAgfVxuICAvLyBSZXR1cm4gZW1iZWQtc2NvcGUgZWxlbWVudCBzZXJ2aWNlIHByb21pc2UgaWYgc2NoZWR1bGVkLlxuICBpZiAoZWxlbWVudE9yQW1wRG9jLm5vZGVUeXBlKSB7XG4gICAgY29uc3Qgd2luID0gdG9XaW4oZWxlbWVudE9yQW1wRG9jLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpO1xuICAgIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICAgIC8vIEluIGVtYmVkcywgZG9jLXNjb3BlIHNlcnZpY2VzIGFyZSB3aW5kb3ctc2NvcGUuIEJ1dCBtYWtlIHN1cmUgdG9cbiAgICAvLyBvbmx5IGRvIHRoaXMgZm9yIGVtYmVkcyAobm90IHRoZSB0b3Agd2luZG93KSwgb3RoZXJ3aXNlIHdlJ2QgZ3JhYlxuICAgIC8vIGEgcHJvbWlzZSBmcm9tIHRoZSB3cm9uZyBzZXJ2aWNlIGhvbGRlciB3aGljaCB3b3VsZCBuZXZlciByZXNvbHZlLlxuICAgIGlmICh3aW4gIT09IHRvcFdpbikge1xuICAgICAgcmV0dXJuIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBGYWxsYmFjayB0byBhbXBkb2MgSUZGIHRoZSBnaXZlbiBub2RlIGlzIF9ub3RfIEZJRS5cbiAgICAgIHJldHVybiBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQsIGV4dGVuc2lvbik7XG4gICAgfVxuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q+fSAqLyAoUHJvbWlzZS5yZXNvbHZlKG51bGwpKTtcbn1cblxuLyoqXG4gKiBUaHJvd3MgdXNlciBlcnJvciBpZiBgc2VydmljZWAgaXMgbnVsbC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzZXJ2aWNlXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlbnNpb25cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBhc3NlcnRTZXJ2aWNlKHNlcnZpY2UsIGlkLCBleHRlbnNpb24pIHtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKHVzZXIoKS5hc3NlcnQoc2VydmljZSxcbiAgICAgICdTZXJ2aWNlICVzIHdhcyByZXF1ZXN0ZWQgdG8gYmUgcHJvdmlkZWQgdGhyb3VnaCAlcywgJyArXG4gICAgICAnYnV0ICVzIGlzIG5vdCBsb2FkZWQgaW4gdGhlIGN1cnJlbnQgcGFnZS4gVG8gZml4IHRoaXMgJyArXG4gICAgICAncHJvYmxlbSBsb2FkIHRoZSBKYXZhU2NyaXB0IGZpbGUgZm9yICVzIGluIHRoaXMgcGFnZS4nLFxuICAgICAgaWQsIGV4dGVuc2lvbiwgZXh0ZW5zaW9uLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBHZXQgbGlzdCBvZiBhbGwgdGhlIGV4dGVuc2lvbiBKUyBmaWxlc1xuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcmV0dXJuIHshQXJyYXk8c3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoaGVhZCkge1xuICAvLyBhbXBkb2MuZ2V0SGVhZE5vZGUoKSBjYW4gcmV0dXJuIG51bGxcbiAgaWYgKCFoZWFkKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNvbnN0IHNjcmlwdHMgPSBbXTtcbiAgY29uc3QgbGlzdCA9IGhlYWQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W2N1c3RvbS1lbGVtZW50XScpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBzY3JpcHRzLnB1c2gobGlzdFtpXS5nZXRBdHRyaWJ1dGUoJ2N1c3RvbS1lbGVtZW50JykpO1xuICB9XG4gIHJldHVybiBzY3JpcHRzO1xufVxuXG4vKipcbiAqIFdhaXRzIGZvciBhbiBleHRlbnNpb24gaWYgaXRzIHNjcmlwdCBpcyBwcmVzZW50XG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4dGVuc2lvblxuICogQHBhcmFtIHtIVE1MSGVhZEVsZW1lbnR8RWxlbWVudHxTaGFkb3dSb290fSBoZWFkXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQod2luLCBleHRlbnNpb24sIGhlYWQpIHtcbiAgLyoqXG4gICAqIElmIHRoZXJlIGlzIGFuIGV4dGVuc2lvbiBzY3JpcHQgd2FpdCBmb3IgaXQgdG8gbG9hZCBiZWZvcmUgdHJ5aW5nXG4gICAqIHRvIGdldCB0aGUgc2VydmljZS4gUHJldmVudHMgYSByYWNlIGNvbmRpdGlvbiB3aGVuIGV2ZXJ5dGhpbmcgYnV0XG4gICAqIHRoZSBleHRlbnNpb25zIGlzIGluIGNhY2hlLiBJZiB0aGVyZSBpcyBubyBzY3JpcHQgdGhlbiBpdCdzIGVpdGhlclxuICAgKiBub3QgcHJlc2VudCwgb3IgdGhlIHNlcnZpY2Ugd2FzIGRlZmluZWQgYnkgYSB0ZXN0LiBJbiB0aG9zZSBjYXNlc1xuICAgKiB3ZSBkb24ndCB3YWl0IGFyb3VuZCBmb3IgYW4gZXh0ZW5zaW9uIHRoYXQgZG9lcyBub3QgZXhpc3QuXG4gICAqL1xuXG4gIC8vIFRPRE8oanBldHRpdHQpIGludmVzdGlnYXRlIHJlZ2lzdGVyRXh0ZW5zaW9uIHRvIHNob3J0IGNpcmN1aXRcbiAgLy8gdGhlIGRvbSBjYWxsIGluIGV4dGVuc2lvblNjcmlwdHNJbk5vZGUoKVxuICBpZiAoIWV4dGVuc2lvblNjcmlwdHNJbk5vZGUoaGVhZCkuaW5jbHVkZXMoZXh0ZW5zaW9uKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGNvbnN0IGV4dGVuc2lvbnMgPSBnZXRTZXJ2aWNlKHdpbiwgJ2V4dGVuc2lvbnMnKTtcbiAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8P09iamVjdD59ICovIChcbiAgICBleHRlbnNpb25zLndhaXRGb3JFeHRlbnNpb24od2luLCBleHRlbnNpb24pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm9taXNlIGZvciBzZXJ2aWNlIHdpdGggYGlkYCBvbiB0aGUgZ2l2ZW4gd2luZG93IGlmIGF2YWlsYWJsZS5cbiAqIE90aGVyd2lzZSwgcmVzb2x2ZXMgd2l0aCBudWxsIChzZXJ2aWNlIHdhcyBub3QgcmVnaXN0ZXJlZCkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZW5zaW9uXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7IVByb21pc2U8T2JqZWN0Pn1cbiAqIEBwcml2YXRlXG4gKi9cbmZ1bmN0aW9uIGdldEVsZW1lbnRTZXJ2aWNlUHJvbWlzZU9yTnVsbCh3aW4sIGlkLCBleHRlbnNpb24sIG9wdF9lbGVtZW50KSB7XG4gIHJldHVybiBkb20ud2FpdEZvckJvZHlQcm9taXNlKHdpbi5kb2N1bWVudClcbiAgICAgIC50aGVuKCgpID0+IHdhaXRGb3JFeHRlbnNpb25JZlByZXNlbnQod2luLCBleHRlbnNpb24sIHdpbi5kb2N1bWVudC5oZWFkKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgdGhpcyBzZXJ2aWNlIGlzIHByb3ZpZGVkIGJ5IGFuIGVsZW1lbnQsIHRoZW4gd2UgY2FuJ3QgZGVwZW5kIG9uXG4gICAgICAgIC8vIHRoZSBzZXJ2aWNlICh0aGV5IG1heSBub3QgdXNlIHRoZSBlbGVtZW50KS5cbiAgICAgICAgaWYgKG9wdF9lbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsKHdpbiwgaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFNjaGVkdWxlZCh3aW4sIGV4dGVuc2lvbikpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAgKiBXaGV0aGVyIGFkZEV2ZW50TGlzdGVuZXIgc3VwcG9ydHMgb3B0aW9ucyBvciBvbmx5IHRha2VzIGNhcHR1cmUgYXMgYSBib29sZWFuXG4gICogQHR5cGUge2Jvb2xlYW58dW5kZWZpbmVkfVxuICAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICAqL1xubGV0IG9wdHNTdXBwb3J0ZWQ7XG5cbi8qKlxuICogTGlzdGVucyBmb3IgdGhlIHNwZWNpZmllZCBldmVudCBvbiB0aGUgZWxlbWVudC5cbiAqXG4gKiBEbyBub3QgdXNlIHRoaXMgZGlyZWN0bHkuIFRoaXMgbWV0aG9kIGlzIGltcGxlbWVudGVkIGFzIGEgc2hhcmVkXG4gKiBkZXBlbmRlbmN5LiBVc2UgYGxpc3RlbigpYCBpbiBlaXRoZXIgYGV2ZW50LWhlbHBlcmAgb3IgYDNwLWZyYW1lLW1lc3NhZ2luZ2AsXG4gKiBkZXBlbmRpbmcgb24geW91ciB1c2UgY2FzZS5cbiAqXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcm5hbExpc3RlbkltcGxlbWVudGF0aW9uKGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsXG4gIG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgbGV0IGxvY2FsRWxlbWVudCA9IGVsZW1lbnQ7XG4gIGxldCBsb2NhbExpc3RlbmVyID0gbGlzdGVuZXI7XG4gIC8qKlxuICAgKiBAdHlwZSB7P0Z1bmN0aW9ufVxuICAgKi9cbiAgbGV0IHdyYXBwZWQ7XG5cbiAgd3JhcHBlZCA9IGV2ZW50ID0+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGxvY2FsTGlzdGVuZXIoZXZlbnQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZSk7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgb3B0c1N1cHBvcnRlZCA9IGRldGVjdEV2dExpc3RlbmVyT3B0c1N1cHBvcnQoKTtcbiAgbGV0IGNhcHR1cmUgPSBmYWxzZTtcbiAgaWYgKG9wdF9ldnRMaXN0ZW5lck9wdHMpIHtcbiAgICBjYXB0dXJlID0gb3B0X2V2dExpc3RlbmVyT3B0cy5jYXB0dXJlO1xuICB9XG4gIGxvY2FsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgZXZlbnRUeXBlLFxuICAgICAgd3JhcHBlZCxcbiAgICAgIG9wdHNTdXBwb3J0ZWQgPyBvcHRfZXZ0TGlzdGVuZXJPcHRzIDogY2FwdHVyZVxuICApO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGlmIChsb2NhbEVsZW1lbnQpIHtcbiAgICAgIGxvY2FsRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICB3cmFwcGVkLFxuICAgICAgICAgIG9wdHNTdXBwb3J0ZWQgPyBvcHRfZXZ0TGlzdGVuZXJPcHRzIDogY2FwdHVyZVxuICAgICAgKTtcbiAgICB9XG4gICAgLy8gRW5zdXJlIHRoZXNlIGFyZSBHQydkXG4gICAgbG9jYWxMaXN0ZW5lciA9IG51bGw7XG4gICAgbG9jYWxFbGVtZW50ID0gbnVsbDtcbiAgICB3cmFwcGVkID0gbnVsbDtcbiAgfTtcbn1cblxuLyoqXG4gKiBUZXN0cyB3aGV0aGVyIHRoZSBicm93c2VyIHN1cHBvcnRzIG9wdGlvbnMgYXMgYW4gYXJndW1lbnQgb2YgYWRkRXZlbnRMaXN0ZW5lclxuICogb3Igbm90LlxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3RFdnRMaXN0ZW5lck9wdHNTdXBwb3J0KCkge1xuICAvLyBPbmx5IHJ1biB0aGUgdGVzdCBvbmNlXG4gIGlmIChvcHRzU3VwcG9ydGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gb3B0c1N1cHBvcnRlZDtcbiAgfVxuXG4gIG9wdHNTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICAvLyBUZXN0IHdoZXRoZXIgYnJvd3NlciBzdXBwb3J0cyBFdmVudExpc3RlbmVyT3B0aW9ucyBvciBub3RcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgZ2V0IGNhcHR1cmUoKSB7XG4gICAgICAgIG9wdHNTdXBwb3J0ZWQgPSB0cnVlO1xuICAgICAgfSxcbiAgICB9O1xuICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcigndGVzdC1vcHRpb25zJywgbnVsbCwgb3B0aW9ucyk7XG4gICAgc2VsZi5yZW1vdmVFdmVudExpc3RlbmVyKCd0ZXN0LW9wdGlvbnMnLCBudWxsLCBvcHRpb25zKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gRXZlbnRMaXN0ZW5lck9wdGlvbnMgYXJlIG5vdCBzdXBwb3J0ZWRcbiAgfVxuICByZXR1cm4gb3B0c1N1cHBvcnRlZDtcbn1cblxuLyoqXG4gICogUmVzZXRzIHRoZSB0ZXN0IGZvciB3aGV0aGVyIGFkZEV2ZW50TGlzdGVuZXIgc3VwcG9ydHMgb3B0aW9ucyBvciBub3QuXG4gICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRFdnRMaXN0ZW5lck9wdHNTdXBwb3J0Rm9yVGVzdGluZygpIHtcbiAgb3B0c1N1cHBvcnRlZCA9IHVuZGVmaW5lZDtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2ludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb259IGZyb20gJy4vZXZlbnQtaGVscGVyLWxpc3Rlbic7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAgKi9cbmNvbnN0IExPQURfRkFJTFVSRV9QUkVGSVggPSAnRmFpbGVkIHRvIGxvYWQ6JztcblxuLyoqXG4gKiBSZXR1cm5zIGEgQ3VzdG9tRXZlbnQgd2l0aCBhIGdpdmVuIHR5cGUgYW5kIGRldGFpbDsgc3VwcG9ydHMgZmFsbGJhY2sgZm9yIElFLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR8bnVsbH0gZGV0YWlsXG4gKiBAcGFyYW0ge0V2ZW50SW5pdD19IG9wdF9ldmVudEluaXRcbiAqIEByZXR1cm4geyFFdmVudH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUV2ZW50KHdpbiwgdHlwZSwgZGV0YWlsLCBvcHRfZXZlbnRJbml0KSB7XG4gIGNvbnN0IGV2ZW50SW5pdCA9IC8qKiBAdHlwZSB7IUN1c3RvbUV2ZW50SW5pdH0gKi8gKHtkZXRhaWx9KTtcbiAgT2JqZWN0LmFzc2lnbihldmVudEluaXQsIG9wdF9ldmVudEluaXQpO1xuICAvLyB3aW4uQ3VzdG9tRXZlbnQgaXMgYSBmdW5jdGlvbiBvbiBFZGdlLCBDaHJvbWUsIEZGLCBTYWZhcmkgYnV0XG4gIC8vIGlzIGFuIG9iamVjdCBvbiBJRSAxMS5cbiAgaWYgKHR5cGVvZiB3aW4uQ3VzdG9tRXZlbnQgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBuZXcgd2luLkN1c3RvbUV2ZW50KHR5cGUsIGV2ZW50SW5pdCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gRGVwcmVjYXRlZCBmYWxsYmFjayBmb3IgSUUuXG4gICAgY29uc3QgZSA9IHdpbi5kb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBlLmluaXRDdXN0b21FdmVudChcbiAgICAgICAgdHlwZSwgISFldmVudEluaXQuYnViYmxlcywgISFldmVudEluaXQuY2FuY2VsYWJsZSwgZGV0YWlsKTtcbiAgICByZXR1cm4gZTtcbiAgfVxufVxuXG4vKipcbiAqIExpc3RlbnMgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQgb24gdGhlIGVsZW1lbnQuXG4gKiBAcGFyYW0geyFFdmVudFRhcmdldH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50VHlwZVxuICogQHBhcmFtIHtmdW5jdGlvbighRXZlbnQpfSBsaXN0ZW5lclxuICogQHBhcmFtIHtPYmplY3Q9fSBvcHRfZXZ0TGlzdGVuZXJPcHRzXG4gKiBAcmV0dXJuIHshVW5saXN0ZW5EZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW4oZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICByZXR1cm4gaW50ZXJuYWxMaXN0ZW5JbXBsZW1lbnRhdGlvbihcbiAgICAgIGVsZW1lbnQsIGV2ZW50VHlwZSwgbGlzdGVuZXIsIG9wdF9ldnRMaXN0ZW5lck9wdHMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRhdGEgcHJvcGVydHkgb2YgYW4gZXZlbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlLlxuICogQHBhcmFtIHshRXZlbnR8e2RhdGE6ICFKc29uT2JqZWN0fX0gZXZlbnRcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRhKGV2ZW50KSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fHN0cmluZ3x1bmRlZmluZWR9ICovIChldmVudC5kYXRhKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBkZXRhaWwgcHJvcGVydHkgb2YgYW4gZXZlbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBlLlxuICogQHBhcmFtIHshRXZlbnR8e2RldGFpbDogIUpzb25PYmplY3R9fSBldmVudFxuICogQHJldHVybiB7P0pzb25PYmplY3R8c3RyaW5nfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERldGFpbChldmVudCkge1xuICByZXR1cm4gLyoqIEB0eXBlIHs/SnNvbk9iamVjdHxzdHJpbmd8dW5kZWZpbmVkfSAqLyAoZXZlbnQuZGV0YWlsKTtcbn1cblxuLyoqXG4gKiBMaXN0ZW5zIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50IG9uIHRoZSBlbGVtZW50IGFuZCByZW1vdmVzIHRoZSBsaXN0ZW5lclxuICogYXMgc29vbiBhcyBldmVudCBoYXMgYmVlbiByZWNlaXZlZC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFdmVudCl9IGxpc3RlbmVyXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEByZXR1cm4geyFVbmxpc3RlbkRlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3Rlbk9uY2UoZWxlbWVudCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgb3B0X2V2dExpc3RlbmVyT3B0cykge1xuICBsZXQgbG9jYWxMaXN0ZW5lciA9IGxpc3RlbmVyO1xuICBjb25zdCB1bmxpc3RlbiA9IGludGVybmFsTGlzdGVuSW1wbGVtZW50YXRpb24oZWxlbWVudCwgZXZlbnRUeXBlLCBldmVudCA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsTGlzdGVuZXIoZXZlbnQpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBFbnN1cmUgbGlzdGVuZXIgaXMgR0MnZFxuICAgICAgbG9jYWxMaXN0ZW5lciA9IG51bGw7XG4gICAgICB1bmxpc3RlbigpO1xuICAgIH1cbiAgfSwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG4gIHJldHVybiB1bmxpc3Rlbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBhcyBzb29uIGFzIHRoZSBzcGVjaWZpZWQgZXZlbnQgaGFzXG4gKiBmaXJlZCBvbiB0aGUgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUV2ZW50VGFyZ2V0fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gZXZlbnRUeXBlXG4gKiBAcGFyYW0ge09iamVjdD19IG9wdF9ldnRMaXN0ZW5lck9wdHNcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oIVVubGlzdGVuRGVmKT19IG9wdF9jYW5jZWwgQW4gb3B0aW9uYWwgZnVuY3Rpb24gdGhhdCwgd2hlblxuICogICAgIHByb3ZpZGVkLCB3aWxsIGJlIGNhbGxlZCB3aXRoIHRoZSB1bmxpc3RlbmVyLiBUaGlzIGdpdmVzIHRoZSBjYWxsZXJcbiAqICAgICBhY2Nlc3MgdG8gdGhlIHVubGlzdGVuZXIsIHNvIGl0IG1heSBiZSBjYWxsZWQgbWFudWFsbHkgd2hlbiBuZWNlc3NhcnkuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhRXZlbnQ+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25jZVByb21pc2UoZWxlbWVudCwgZXZlbnRUeXBlLCBvcHRfZXZ0TGlzdGVuZXJPcHRzLFxuICBvcHRfY2FuY2VsKSB7XG4gIGxldCB1bmxpc3RlbjtcbiAgY29uc3QgZXZlbnRQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgdW5saXN0ZW4gPSBsaXN0ZW5PbmNlKGVsZW1lbnQsIGV2ZW50VHlwZSwgcmVzb2x2ZSwgb3B0X2V2dExpc3RlbmVyT3B0cyk7XG4gIH0pO1xuICBldmVudFByb21pc2UudGhlbih1bmxpc3RlbiwgdW5saXN0ZW4pO1xuICBpZiAob3B0X2NhbmNlbCkge1xuICAgIG9wdF9jYW5jZWwodW5saXN0ZW4pO1xuICB9XG4gIHJldHVybiBldmVudFByb21pc2U7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgZWxlbWVudC93aW5kb3cgaGFzIGJlZW4gbG9hZGVkIGFscmVhZHkuXG4gKiBAcGFyYW0geyFFbGVtZW50fCFXaW5kb3d9IGVsZU9yV2luZG93XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2FkZWQoZWxlT3JXaW5kb3cpIHtcbiAgcmV0dXJuICEhKGVsZU9yV2luZG93LmNvbXBsZXRlIHx8IGVsZU9yV2luZG93LnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJ1xuICAgICAgLy8gSWYgdGhlIHBhc3NlZCBpbiB0aGluZyBpcyBhIFdpbmRvdywgaW5mZXIgbG9hZGVkIHN0YXRlIGZyb21cbiAgICAgIC8vXG4gICAgICB8fCAoZWxlT3JXaW5kb3cuZG9jdW1lbnRcbiAgICAgICAgICAmJiBlbGVPcldpbmRvdy5kb2N1bWVudC5yZWFkeVN0YXRlID09ICdjb21wbGV0ZScpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBvciBmYWlsIGJhc2VkIG9uIHRoZSBlbGVPcldpbmRvdydzICdsb2FkJ1xuICogYW5kICdlcnJvcicgZXZlbnRzLiBPcHRpb25hbGx5IHRoaXMgbWV0aG9kIHRha2VzIGEgdGltZW91dCwgd2hpY2ggd2lsbCByZWplY3RcbiAqIHRoZSBwcm9taXNlIGlmIHRoZSByZXNvdXJjZSBoYXMgbm90IGxvYWRlZCBieSB0aGVuLlxuICogQHBhcmFtIHtUfSBlbGVPcldpbmRvdyBTdXBwb3J0cyBib3RoIEVsZW1lbnRzIGFuZCBhcyBhIHNwZWNpYWwgY2FzZSBXaW5kb3dzLlxuICogQHJldHVybiB7IVByb21pc2U8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZFByb21pc2UoZWxlT3JXaW5kb3cpIHtcbiAgbGV0IHVubGlzdGVuTG9hZDtcbiAgbGV0IHVubGlzdGVuRXJyb3I7XG4gIGlmIChpc0xvYWRlZChlbGVPcldpbmRvdykpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVsZU9yV2luZG93KTtcbiAgfVxuICBjb25zdCBsb2FkaW5nUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAvLyBMaXN0ZW4gb25jZSBzaW5jZSBJRSA1LzYvNyBmaXJlIHRoZSBvbmxvYWQgZXZlbnQgY29udGludW91c2x5IGZvclxuICAgIC8vIGFuaW1hdGVkIEdJRnMuXG4gICAgY29uc3Qge3RhZ05hbWV9ID0gZWxlT3JXaW5kb3c7XG4gICAgaWYgKHRhZ05hbWUgPT09ICdBVURJTycgfHwgdGFnTmFtZSA9PT0gJ1ZJREVPJykge1xuICAgICAgdW5saXN0ZW5Mb2FkID0gbGlzdGVuT25jZShlbGVPcldpbmRvdywgJ2xvYWRzdGFydCcsIHJlc29sdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB1bmxpc3RlbkxvYWQgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnbG9hZCcsIHJlc29sdmUpO1xuICAgIH1cbiAgICAvLyBGb3IgZWxlbWVudHMsIHVubGlzdGVuIG9uIGVycm9yIChkb24ndCBmb3IgV2luZG93cykuXG4gICAgaWYgKHRhZ05hbWUpIHtcbiAgICAgIHVubGlzdGVuRXJyb3IgPSBsaXN0ZW5PbmNlKGVsZU9yV2luZG93LCAnZXJyb3InLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGxvYWRpbmdQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgIGlmICh1bmxpc3RlbkVycm9yKSB7XG4gICAgICB1bmxpc3RlbkVycm9yKCk7XG4gICAgfVxuICAgIHJldHVybiBlbGVPcldpbmRvdztcbiAgfSwgKCkgPT4ge1xuICAgIGlmICh1bmxpc3RlbkxvYWQpIHtcbiAgICAgIHVubGlzdGVuTG9hZCgpO1xuICAgIH1cbiAgICBmYWlsZWRUb0xvYWQoZWxlT3JXaW5kb3cpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBFbWl0IGVycm9yIG9uIGxvYWQgZmFpbHVyZS5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IVdpbmRvd30gZWxlT3JXaW5kb3cgU3VwcG9ydHMgYm90aCBFbGVtZW50cyBhbmQgYXMgYSBzcGVjaWFsXG4gKiAgICAgY2FzZSBXaW5kb3dzLlxuICovXG5mdW5jdGlvbiBmYWlsZWRUb0xvYWQoZWxlT3JXaW5kb3cpIHtcbiAgLy8gUmVwb3J0IGZhaWxlZCBsb2FkcyBhcyB1c2VyIGVycm9ycyBzbyB0aGF0IHRoZXkgYXV0b21hdGljYWxseSBnb1xuICAvLyBpbnRvIHRoZSBcImRvY3VtZW50IGVycm9yXCIgYnVja2V0LlxuICBsZXQgdGFyZ2V0ID0gZWxlT3JXaW5kb3c7XG4gIGlmICh0YXJnZXQgJiYgdGFyZ2V0LnNyYykge1xuICAgIHRhcmdldCA9IHRhcmdldC5zcmM7XG4gIH1cbiAgdGhyb3cgdXNlcigpLmNyZWF0ZUVycm9yKExPQURfRkFJTFVSRV9QUkVGSVgsIHRhcmdldCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgZXJyb3IgbWVzc2FnZSBpcyB3YXMgY3JlYXRlZCBmb3IgYSBsb2FkIGVycm9yLlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgQW4gZXJyb3IgbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZEVycm9yTWVzc2FnZShtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoTE9BRF9GQUlMVVJFX1BSRUZJWCkgIT0gLTE7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEV4cGVyaW1lbnRzIHN5c3RlbSBhbGxvd3MgYSBkZXZlbG9wZXIgdG8gb3B0LWluIHRvIHRlc3RcbiAqIGZlYXR1cmVzIHRoYXQgYXJlIG5vdCB5ZXQgZnVsbHkgdGVzdGVkLlxuICpcbiAqIEV4cGVyaW1lbnRzIHBhZ2U6IGh0dHBzOi8vY2RuLmFtcHByb2plY3Qub3JnL2V4cGVyaW1lbnRzLmh0bWwgKlxuICovXG5cbmltcG9ydCB7Z2V0Q29va2llLCBzZXRDb29raWV9IGZyb20gJy4vY29va2llcyc7XG5pbXBvcnQge2hhc093bn0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtwYXJzZVF1ZXJ5U3RyaW5nfSBmcm9tICcuL3VybCc7XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmNvbnN0IENPT0tJRV9OQU1FID0gJ0FNUF9FWFAnO1xuXG4vKiogQGNvbnN0IHtudW1iZXJ9ICovXG5jb25zdCBDT09LSUVfTUFYX0FHRV9EQVlTID0gMTgwOyAvLyA2IG1vbnRoXG5cbi8qKiBAY29uc3Qge3RpbWV9ICovXG5jb25zdCBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCA9IENPT0tJRV9NQVhfQUdFX0RBWVMgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG4vKiogQGNvbnN0IHtzdHJpbmd9ICovXG5jb25zdCBUT0dHTEVTX1dJTkRPV19QUk9QRVJUWSA9ICdfX0FNUF9fRVhQRVJJTUVOVF9UT0dHTEVTJztcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICBpc1RyYWZmaWNFbGlnaWJsZTogZnVuY3Rpb24oIVdpbmRvdyk6Ym9vbGVhbixcbiAqICAgYnJhbmNoZXM6ICFBcnJheTxzdHJpbmc+XG4gKiB9fVxuICovXG5leHBvcnQgbGV0IEV4cGVyaW1lbnRJbmZvO1xuXG4vKipcbiAqIFdoZXRoZXIgd2UgYXJlIGluIGNhbmFyeS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDYW5hcnkod2luKSB7XG4gIHJldHVybiAhISh3aW4uQU1QX0NPTkZJRyAmJiB3aW4uQU1QX0NPTkZJRy5jYW5hcnkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYmluYXJ5IHR5cGUsIGUuZy4sIGNhbmFyeSwgY29udHJvbCwgb3IgcHJvZHVjdGlvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCaW5hcnlUeXBlKHdpbikge1xuICByZXR1cm4gd2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudHlwZSA/XG4gICAgd2luLkFNUF9DT05GSUcudHlwZSA6ICd1bmtub3duJztcbn1cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSBzcGVjaWZpZWQgZXhwZXJpbWVudCBpcyBvbiBvciBvZmYuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnRJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRXhwZXJpbWVudE9uKHdpbiwgZXhwZXJpbWVudElkKSB7XG4gIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICByZXR1cm4gISF0b2dnbGVzW2V4cGVyaW1lbnRJZF07XG59XG5cbi8qKlxuICogVG9nZ2xlcyB0aGUgZXhwZXJpbWVudCBvbiBvciBvZmYuIFJldHVybnMgdGhlIGFjdHVhbCB2YWx1ZSBvZiB0aGUgZXhwZXJpbWVudFxuICogYWZ0ZXIgdG9nZ2xpbmcgaXMgZG9uZS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gZXhwZXJpbWVudElkXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfb25cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF90cmFuc2llbnRFeHBlcmltZW50ICBXaGV0aGVyIHRvIHRvZ2dsZSB0aGVcbiAqICAgICBleHBlcmltZW50IHN0YXRlIFwidHJhbnNpZW50bHlcIiAoaS5lLiwgZm9yIHRoaXMgcGFnZSBsb2FkIG9ubHkpIG9yXG4gKiAgICAgZHVyYWJseSAoYnkgc2F2aW5nIHRoZSBleHBlcmltZW50IElEcyB0byB0aGUgY29va2llIGFmdGVyIHRvZ2dsaW5nKS5cbiAqICAgICBEZWZhdWx0OiBmYWxzZSAoc2F2ZSBkdXJhYmx5KS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IE5ldyBzdGF0ZSBmb3IgZXhwZXJpbWVudElkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlRXhwZXJpbWVudCh3aW4sIGV4cGVyaW1lbnRJZCwgb3B0X29uLFxuICBvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICBjb25zdCBjdXJyZW50bHlPbiA9IGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudElkKTtcbiAgY29uc3Qgb24gPSAhIShvcHRfb24gIT09IHVuZGVmaW5lZCA/IG9wdF9vbiA6ICFjdXJyZW50bHlPbik7XG4gIGlmIChvbiAhPSBjdXJyZW50bHlPbikge1xuICAgIGNvbnN0IHRvZ2dsZXMgPSBleHBlcmltZW50VG9nZ2xlcyh3aW4pO1xuICAgIHRvZ2dsZXNbZXhwZXJpbWVudElkXSA9IG9uO1xuXG4gICAgaWYgKCFvcHRfdHJhbnNpZW50RXhwZXJpbWVudCkge1xuICAgICAgY29uc3QgY29va2llVG9nZ2xlcyA9IGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xuICAgICAgY29va2llVG9nZ2xlc1tleHBlcmltZW50SWRdID0gb247XG4gICAgICBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIGNvb2tpZVRvZ2dsZXMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb247XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHdoZXRoZXIgdGhlIGV4cGVyaW1lbnQgaXMgb24gb3Igb2ZmIGJhc2VkIG9mZiBvZiB0aGVcbiAqIGNvb2tpZUZsYWcgb3IgdGhlIGdsb2JhbCBjb25maWcgZnJlcXVlbmN5IGdpdmVuLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cGVyaW1lbnRUb2dnbGVzKHdpbikge1xuICBpZiAod2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXSkge1xuICAgIHJldHVybiB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldO1xuICB9XG4gIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBjb25zdCB0b2dnbGVzID0gd2luW1RPR0dMRVNfV0lORE9XX1BST1BFUlRZXTtcblxuICAvLyBSZWFkIHRoZSBkZWZhdWx0IGNvbmZpZyBvZiB0aGlzIGJ1aWxkLlxuICBpZiAod2luLkFNUF9DT05GSUcpIHtcbiAgICBmb3IgKGNvbnN0IGV4cGVyaW1lbnRJZCBpbiB3aW4uQU1QX0NPTkZJRykge1xuICAgICAgY29uc3QgZnJlcXVlbmN5ID0gd2luLkFNUF9DT05GSUdbZXhwZXJpbWVudElkXTtcbiAgICAgIGlmICh0eXBlb2YgZnJlcXVlbmN5ID09PSAnbnVtYmVyJyAmJiBmcmVxdWVuY3kgPj0gMCAmJiBmcmVxdWVuY3kgPD0gMSkge1xuICAgICAgICB0b2dnbGVzW2V4cGVyaW1lbnRJZF0gPSBNYXRoLnJhbmRvbSgpIDwgZnJlcXVlbmN5O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBSZWFkIGRvY3VtZW50IGxldmVsIG92ZXJyaWRlIGZyb20gbWV0YSB0YWcuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctZG9jLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LWRvYy1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy1kb2Mtb3B0LWluJ107XG4gICAgY29uc3QgbWV0YSA9XG4gICAgICAgIHdpbi5kb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImFtcC1leHBlcmltZW50cy1vcHQtaW5cIl0nKTtcbiAgICBpZiAobWV0YSkge1xuICAgICAgY29uc3Qgb3B0ZWRJbkV4cGVyaW1lbnRzID0gbWV0YS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKS5zcGxpdCgnLCcpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRlZEluRXhwZXJpbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFsbG93ZWQuaW5kZXhPZihvcHRlZEluRXhwZXJpbWVudHNbaV0pICE9IC0xKSB7XG4gICAgICAgICAgdG9nZ2xlc1tvcHRlZEluRXhwZXJpbWVudHNbaV1dID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIE9iamVjdC5hc3NpZ24odG9nZ2xlcywgZ2V0RXhwZXJpbWVudFRvZ2dsZXNGcm9tQ29va2llKHdpbikpO1xuXG4gIGlmICh3aW4uQU1QX0NPTkZJR1xuICAgICAgJiYgQXJyYXkuaXNBcnJheSh3aW4uQU1QX0NPTkZJR1snYWxsb3ctdXJsLW9wdC1pbiddKVxuICAgICAgJiYgd2luLkFNUF9DT05GSUdbJ2FsbG93LXVybC1vcHQtaW4nXS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgYWxsb3dlZCA9IHdpbi5BTVBfQ09ORklHWydhbGxvdy11cmwtb3B0LWluJ107XG4gICAgY29uc3QgaGFzaCA9IHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2g7XG4gICAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVN0cmluZyhoYXNoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbG93ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHBhcmFtID0gcGFyYW1zW2BlLSR7YWxsb3dlZFtpXX1gXTtcbiAgICAgIGlmIChwYXJhbSA9PSAnMScpIHtcbiAgICAgICAgdG9nZ2xlc1thbGxvd2VkW2ldXSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAocGFyYW0gPT0gJzAnKSB7XG4gICAgICAgIHRvZ2dsZXNbYWxsb3dlZFtpXV0gPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRvZ2dsZXM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY2FjaGVkIGV4cGVyaW1lbnRzIHRvZ2dsZXMsIG9yIG51bGwgaWYgdGhleSBoYXZlIG5vdCBiZWVuXG4gKiBjb21wdXRlZCB5ZXQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7T2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBlcmltZW50VG9nZ2xlc09yTnVsbCh3aW4pIHtcbiAgcmV0dXJuIHdpbltUT0dHTEVTX1dJTkRPV19QUk9QRVJUWV0gfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKi9cbmZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pIHtcbiAgY29uc3QgZXhwZXJpbWVudENvb2tpZSA9IGdldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FKTtcbiAgY29uc3QgdG9rZW5zID0gZXhwZXJpbWVudENvb2tpZSA/IGV4cGVyaW1lbnRDb29raWUuc3BsaXQoL1xccyosXFxzKi9nKSA6IFtdO1xuXG4gIGNvbnN0IHRvZ2dsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0b2tlbnNbaV0ubGVuZ3RoID09IDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodG9rZW5zW2ldWzBdID09ICctJykge1xuICAgICAgdG9nZ2xlc1t0b2tlbnNbaV0uc3Vic3RyKDEpXSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b2dnbGVzW3Rva2Vuc1tpXV0gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0b2dnbGVzO1xufVxuXG4vKipcbiAqIFNhdmVzIGEgc2V0IG9mIGV4cGVyaW1lbnQgSURzIGN1cnJlbnRseSBvbi5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCBib29sZWFuPn0gdG9nZ2xlc1xuICovXG5mdW5jdGlvbiBzYXZlRXhwZXJpbWVudFRvZ2dsZXNUb0Nvb2tpZSh3aW4sIHRvZ2dsZXMpIHtcbiAgY29uc3QgZXhwZXJpbWVudElkcyA9IFtdO1xuICBmb3IgKGNvbnN0IGV4cGVyaW1lbnQgaW4gdG9nZ2xlcykge1xuICAgIGV4cGVyaW1lbnRJZHMucHVzaCgodG9nZ2xlc1tleHBlcmltZW50XSA9PT0gZmFsc2UgPyAnLScgOiAnJykgKyBleHBlcmltZW50KTtcbiAgfVxuXG4gIHNldENvb2tpZSh3aW4sIENPT0tJRV9OQU1FLCBleHBlcmltZW50SWRzLmpvaW4oJywnKSxcbiAgICAgIERhdGUubm93KCkgKyBDT09LSUVfRVhQSVJBVElPTl9JTlRFUlZBTCwge1xuICAgICAgICAvLyBTZXQgZXhwbGljaXQgZG9tYWluLCBzbyB0aGUgY29va2llIGdldHMgc2VuZCB0byBzdWIgZG9tYWlucy5cbiAgICAgICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICAgIGFsbG93T25Qcm94eU9yaWdpbjogdHJ1ZSxcbiAgICAgIH0pO1xufVxuXG4vKipcbiAqIFNlZSBnZXRFeHBlcmltZW50VG9nZ2xlc0Zyb21Db29raWUoKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgYm9vbGVhbj59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRUb2dsZXNGcm9tQ29va2llRm9yVGVzdGluZyh3aW4pIHtcbiAgcmV0dXJuIGdldEV4cGVyaW1lbnRUb2dnbGVzRnJvbUNvb2tpZSh3aW4pO1xufVxuXG4vKipcbiAqIFJlc2V0cyB0aGUgZXhwZXJpbWVudHNUb2dnbGUgY2FjaGUgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEV4cGVyaW1lbnRUb2dnbGVzRm9yVGVzdGluZyh3aW4pIHtcbiAgc2V0Q29va2llKHdpbiwgQ09PS0lFX05BTUUsICcnLCAwLCB7XG4gICAgZG9tYWluOiB3aW4ubG9jYXRpb24uaG9zdG5hbWUsXG4gIH0pO1xuICB3aW5bVE9HR0xFU19XSU5ET1dfUFJPUEVSVFldID0gbnVsbDtcbn1cblxuLyoqXG4gKiBJbiBzb21lIGJyb3dzZXIgaW1wbGVtZW50YXRpb25zIG9mIE1hdGgucmFuZG9tKCksIHNlcXVlbnRpYWwgY2FsbHMgb2ZcbiAqIE1hdGgucmFuZG9tKCkgYXJlIGNvcnJlbGF0ZWQgYW5kIGNhbiBjYXVzZSBhIGJpYXMuICBJbiBwYXJ0aWN1bGFyLFxuICogaWYgdGhlIHByZXZpb3VzIHJhbmRvbSgpIGNhbGwgd2FzIDwgMC4wMDEgKGFzIGl0IHdpbGwgYmUgaWYgd2Ugc2VsZWN0XG4gKiBpbnRvIGFuIGV4cGVyaW1lbnQpLCB0aGUgbmV4dCB2YWx1ZSBjb3VsZCBiZSBsZXNzIHRoYW4gMC41IG1vcmUgdGhhblxuICogNTAuNyUgb2YgdGhlIHRpbWUuICBUaGlzIHByb3ZpZGVzIGFuIGltcGxlbWVudGF0aW9uIHRoYXQgcm9vdHMgZG93biBpbnRvXG4gKiB0aGUgY3J5cHRvIEFQSSwgd2hlbiBhdmFpbGFibGUsIHRvIHByb2R1Y2UgbGVzcyBiaWFzZWQgc2FtcGxlcy5cbiAqXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFBzZXVkby1yYW5kb20gZmxvYXRpbmctcG9pbnQgdmFsdWUgb24gdGhlIHJhbmdlIFswLCAxKS5cbiAqL1xuZnVuY3Rpb24gc2xvd0J1dEFjY3VyYXRlUHJuZygpIHtcbiAgLy8gVE9ETyh0ZHJsKTogSW1wbGVtZW50LlxuICByZXR1cm4gTWF0aC5yYW5kb20oKTtcbn1cblxuLyoqXG4gKiBDb250YWluZXIgZm9yIGFsdGVybmF0ZSByYW5kb20gbnVtYmVyIGdlbmVyYXRvciBpbXBsZW1lbnRhdGlvbnMuICBUaGlzXG4gKiBhbGxvd3MgdXMgdG8gc2V0IGFuIFwiYWNjdXJhdGVcIiBQUk5HIGZvciBicmFuY2ggc2VsZWN0aW9uLCBidXQgdG8gbW9jayBpdFxuICogb3V0IGVhc2lseSBpbiB0ZXN0cy5cbiAqXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqIEBjb25zdCB7IXthY2N1cmF0ZVBybmc6IGZ1bmN0aW9uKCk6bnVtYmVyfX1cbiAqL1xuZXhwb3J0IGNvbnN0IFJBTkRPTV9OVU1CRVJfR0VORVJBVE9SUyA9IHtcbiAgYWNjdXJhdGVQcm5nOiBzbG93QnV0QWNjdXJhdGVQcm5nLFxufTtcblxuLyoqXG4gKiBTZWxlY3RzLCB1bmlmb3JtbHkgYXQgcmFuZG9tLCBhIHNpbmdsZSBpdGVtIGZyb20gdGhlIGFycmF5LlxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gYXJyIE9iamVjdCB0byBzZWxlY3QgZnJvbS5cbiAqIEByZXR1cm4gez9zdHJpbmd9IFNpbmdsZSBpdGVtIGZyb20gYXJyIG9yIG51bGwgaWYgYXJyIHdhcyBlbXB0eS5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0UmFuZG9tSXRlbShhcnIpIHtcbiAgY29uc3Qgcm4gPSBSQU5ET01fTlVNQkVSX0dFTkVSQVRPUlMuYWNjdXJhdGVQcm5nKCk7XG4gIHJldHVybiBhcnJbTWF0aC5mbG9vcihybiAqIGFyci5sZW5ndGgpXSB8fCBudWxsO1xufVxuXG4vKipcbiAqIFNlbGVjdHMgd2hpY2ggcGFnZS1sZXZlbCBleHBlcmltZW50IGJyYW5jaGVzIGFyZSBlbmFibGVkLiBJZiBhIGdpdmVuXG4gKiBleHBlcmltZW50IG5hbWUgaXMgYWxyZWFkeSBzZXQgKGluY2x1ZGluZyB0byB0aGUgbnVsbCAvIG5vIGJyYW5jaGVzIHNlbGVjdGVkXG4gKiBzdGF0ZSksIHRoaXMgd29uJ3QgYWx0ZXIgaXRzIHN0YXRlLlxuICpcbiAqIENoZWNrIHdoZXRoZXIgYSBnaXZlbiBleHBlcmltZW50IGlzIHNldCB1c2luZyBpc0V4cGVyaW1lbnRPbih3aW4sXG4gKiBleHBlcmltZW50TmFtZSkgYW5kLCBpZiBpdCBpcyBvbiwgbG9vayBmb3Igd2hpY2ggYnJhbmNoIGlzIHNlbGVjdGVkIGluXG4gKiB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCBvbiB3aGljaCB0byBzYXZlIGV4cGVyaW1lbnRcbiAqICAgICBzZWxlY3Rpb24gc3RhdGUuXG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAhRXhwZXJpbWVudEluZm8+fSBleHBlcmltZW50cyAgU2V0IG9mIGV4cGVyaW1lbnRzIHRvXG4gKiAgICAgY29uZmlndXJlIGZvciB0aGlzIHBhZ2UgbG9hZC5cbiAqIEByZXR1cm4geyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSBNYXAgb2YgZXhwZXJpbWVudCBuYW1lcyB0byBzZWxlY3RlZFxuICogICAgIGJyYW5jaGVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tbHlTZWxlY3RVbnNldEV4cGVyaW1lbnRzKHdpbiwgZXhwZXJpbWVudHMpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIGNvbnN0IHNlbGVjdGVkRXhwZXJpbWVudHMgPSB7fTtcbiAgZm9yIChjb25zdCBleHBlcmltZW50TmFtZSBpbiBleHBlcmltZW50cykge1xuICAgIC8vIFNraXAgZXhwZXJpbWVudE5hbWUgaWYgaXQgaXMgbm90IGEga2V5IG9mIGV4cGVyaW1lbnRzIG9iamVjdCBvciBpZiBpdFxuICAgIC8vIGhhcyBhbHJlYWR5IGJlZW4gcG9wdWxhdGVkIGJ5IHNvbWUgb3RoZXIgcHJvcGVydHkuXG4gICAgaWYgKCFoYXNPd24oZXhwZXJpbWVudHMsIGV4cGVyaW1lbnROYW1lKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChoYXNPd24od2luLmV4cGVyaW1lbnRCcmFuY2hlcywgZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBzZWxlY3RlZEV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXSA9XG4gICAgICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIWV4cGVyaW1lbnRzW2V4cGVyaW1lbnROYW1lXS5pc1RyYWZmaWNFbGlnaWJsZSB8fFxuICAgICAgICAhZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdLmlzVHJhZmZpY0VsaWdpYmxlKHdpbikpIHtcbiAgICAgIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gbnVsbDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIElmIHdlJ3JlIGluIHRoZSBleHBlcmltZW50LCBidXQgd2UgaGF2ZW4ndCBhbHJlYWR5IGZvcmNlZCBhIHNwZWNpZmljXG4gICAgLy8gZXhwZXJpbWVudCBicmFuY2ggKGUuZy4sIHZpYSBhIHRlc3Qgc2V0dXApLCB0aGVuIHJhbmRvbWl6ZSB0aGUgYnJhbmNoXG4gICAgLy8gY2hvaWNlLlxuICAgIGlmICghd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gJiZcbiAgICAgIGlzRXhwZXJpbWVudE9uKHdpbiwgLypPSyovZXhwZXJpbWVudE5hbWUpKSB7XG4gICAgICBjb25zdCB7YnJhbmNoZXN9ID0gZXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdO1xuICAgICAgd2luLmV4cGVyaW1lbnRCcmFuY2hlc1tleHBlcmltZW50TmFtZV0gPSBzZWxlY3RSYW5kb21JdGVtKGJyYW5jaGVzKTtcbiAgICAgIHNlbGVjdGVkRXhwZXJpbWVudHNbZXhwZXJpbWVudE5hbWVdID1cbiAgICAgICAgICB3aW4uZXhwZXJpbWVudEJyYW5jaGVzW2V4cGVyaW1lbnROYW1lXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNlbGVjdGVkRXhwZXJpbWVudHM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZXhwZXJpbWVudCBicmFuY2ggZW5hYmxlZCBmb3IgdGhlIGdpdmVuIGV4cGVyaW1lbnQgSUQuXG4gKiBGb3IgZXhhbXBsZSwgJ2NvbnRyb2wnIG9yICdleHBlcmltZW50Jy5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpbiBXaW5kb3cgY29udGV4dCB0byBjaGVjayBmb3IgZXhwZXJpbWVudCBzdGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHBlcmltZW50TmFtZSBOYW1lIG9mIHRoZSBleHBlcmltZW50IHRvIGNoZWNrLlxuICogQHJldHVybiB7P3N0cmluZ30gQWN0aXZlIGV4cGVyaW1lbnQgYnJhbmNoIElEIGZvciBleHBlcmltZW50TmFtZSAocG9zc2libHlcbiAqICAgICBudWxsIGlmIGV4cGVyaW1lbnROYW1lIGhhcyBiZWVuIHRlc3RlZCBidXQgbm8gYnJhbmNoIHdhcyBlbmFibGVkKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSkge1xuICByZXR1cm4gd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA/IHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdIDogbnVsbDtcbn1cblxuLyoqXG4gKiBGb3JjZSBlbmFibGUgKG9yIGRpc2FibGUpIGEgc3BlY2lmaWMgYnJhbmNoIG9mIGEgZ2l2ZW4gZXhwZXJpbWVudCBuYW1lLlxuICogRGlzYWJsZXMgdGhlIGV4cGVyaW1lbnQgbmFtZSBhbHRvZ2V0aGVyIGlmIGJyYW5jaElkIGlzIGZhbHNlaXNoLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luIFdpbmRvdyBjb250ZXh0IHRvIGNoZWNrIGZvciBleHBlcmltZW50IHN0YXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IGV4cGVyaW1lbnROYW1lIE5hbWUgb2YgdGhlIGV4cGVyaW1lbnQgdG8gY2hlY2suXG4gKiBAcGFyYW0gez9zdHJpbmd9IGJyYW5jaElkIElEIG9mIGJyYW5jaCB0byBmb3JjZSBvciBudWxsIHRvIGRpc2FibGVcbiAqICAgICBhbHRvZ2V0aGVyLlxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JjZUV4cGVyaW1lbnRCcmFuY2god2luLCBleHBlcmltZW50TmFtZSwgYnJhbmNoSWQpIHtcbiAgd2luLmV4cGVyaW1lbnRCcmFuY2hlcyA9IHdpbi5leHBlcmltZW50QnJhbmNoZXMgfHwge307XG4gIHRvZ2dsZUV4cGVyaW1lbnQod2luLCBleHBlcmltZW50TmFtZSwgISFicmFuY2hJZCwgdHJ1ZSk7XG4gIHdpbi5leHBlcmltZW50QnJhbmNoZXNbZXhwZXJpbWVudE5hbWVdID0gYnJhbmNoSWQ7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHthZGRBdHRyaWJ1dGVzVG9FbGVtZW50LCBjbG9zZXN0QnlTZWxlY3Rvcn0gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtkZXNlcmlhbGl6ZU1lc3NhZ2UsIGlzQW1wTWVzc2FnZX0gZnJvbSAnLi8zcC1mcmFtZS1tZXNzYWdpbmcnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZGljdH0gZnJvbSAnLi91dGlscy9vYmplY3QnO1xuaW1wb3J0IHtmaWx0ZXJTcGxpY2V9IGZyb20gJy4vdXRpbHMvYXJyYXknO1xuaW1wb3J0IHtnZXREYXRhfSBmcm9tICcuL2V2ZW50LWhlbHBlcic7XG5pbXBvcnQge3BhcnNlVXJsRGVwcmVjYXRlZH0gZnJvbSAnLi91cmwnO1xuaW1wb3J0IHtzZXRTdHlsZX0gZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQge3RyeVBhcnNlSnNvbn0gZnJvbSAnLi9qc29uJztcblxuLyoqXG4gKiBTZW50aW5lbCB1c2VkIHRvIGZvcmNlIHVubGlzdGVuaW5nIGFmdGVyIGEgaWZyYW1lIGlzIGRldGFjaGVkLlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xuY29uc3QgVU5MSVNURU5fU0VOVElORUwgPSAndW5saXN0ZW4nO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGZyYW1lOiAhRWxlbWVudCxcbiAqICAgZXZlbnRzOiAhT2JqZWN0PHN0cmluZywgIUFycmF5PGZ1bmN0aW9uKCFKc29uT2JqZWN0KT4+XG4gKiB9fVxuICovXG5sZXQgV2luZG93RXZlbnRzRGVmO1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXBwaW5nIGZyb20gYSBVUkwncyBvcmlnaW4gdG8gYW4gYXJyYXkgb2Ygd2luZG93cyBhbmQgdGhlaXJcbiAqIGxpc3RlbkZvciBsaXN0ZW5lcnMuXG4gKiBAcGFyYW0gez9XaW5kb3d9IHBhcmVudFdpbiB0aGUgd2luZG93IHRoYXQgY3JlYXRlZCB0aGUgaWZyYW1lXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfY3JlYXRlIGNyZWF0ZSB0aGUgbWFwcGluZyBpZiBpdCBkb2VzIG5vdCBleGlzdFxuICogQHJldHVybiB7P09iamVjdDxzdHJpbmcsICFBcnJheTwhV2luZG93RXZlbnRzRGVmPj59XG4gKi9cbmZ1bmN0aW9uIGdldExpc3RlbkZvcnMocGFyZW50V2luLCBvcHRfY3JlYXRlKSB7XG4gIGxldCB7bGlzdGVuaW5nRm9yc30gPSBwYXJlbnRXaW47XG5cbiAgaWYgKCFsaXN0ZW5pbmdGb3JzICYmIG9wdF9jcmVhdGUpIHtcbiAgICBsaXN0ZW5pbmdGb3JzID0gcGFyZW50V2luLmxpc3RlbmluZ0ZvcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG4gIHJldHVybiBsaXN0ZW5pbmdGb3JzIHx8IG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBhcnJheSBvZiBXaW5kb3dFdmVudHNEZWYgdGhhdCBoYXZlIGhhZCBhbnkgbGlzdGVuRm9yIGxpc3RlbmVyc1xuICogcmVnaXN0ZXJlZCBmb3IgdGhpcyBzZW50aW5lbC5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZW50aW5lbCB0aGUgc2VudGluZWwgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9jcmVhdGUgY3JlYXRlIHRoZSBhcnJheSBpZiBpdCBkb2VzIG5vdCBleGlzdFxuICogQHJldHVybiB7P0FycmF5PCFXaW5kb3dFdmVudHNEZWY+fVxuICovXG5mdW5jdGlvbiBnZXRMaXN0ZW5Gb3JTZW50aW5lbChwYXJlbnRXaW4sIHNlbnRpbmVsLCBvcHRfY3JlYXRlKSB7XG4gIGNvbnN0IGxpc3RlbmluZ0ZvcnMgPSBnZXRMaXN0ZW5Gb3JzKHBhcmVudFdpbiwgb3B0X2NyZWF0ZSk7XG4gIGlmICghbGlzdGVuaW5nRm9ycykge1xuICAgIHJldHVybiBsaXN0ZW5pbmdGb3JzO1xuICB9XG5cbiAgbGV0IGxpc3RlblNlbnRpbmVsID0gbGlzdGVuaW5nRm9yc1tzZW50aW5lbF07XG4gIGlmICghbGlzdGVuU2VudGluZWwgJiYgb3B0X2NyZWF0ZSkge1xuICAgIGxpc3RlblNlbnRpbmVsID0gbGlzdGVuaW5nRm9yc1tzZW50aW5lbF0gPSBbXTtcbiAgfVxuICByZXR1cm4gbGlzdGVuU2VudGluZWwgfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIG1hcHBpbmcgb2YgZXZlbnQgbmFtZXMgdG8gbGlzdGVuRm9yIGxpc3RlbmVycy5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luIHRoZSB3aW5kb3cgdGhhdCBjcmVhdGVkIHRoZSBpZnJhbWVcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGlmcmFtZSB0aGUgaWZyYW1lIGVsZW1lbnQgd2hvJ3MgY29udGV4dCB3aWxsIHRyaWdnZXIgdGhlXG4gKiAgICAgZXZlbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKiBAcmV0dXJuIHs/T2JqZWN0PHN0cmluZywgIUFycmF5PGZ1bmN0aW9uKCFKc29uT2JqZWN0LCAhV2luZG93LCBzdHJpbmcpPj59XG4gKi9cbmZ1bmN0aW9uIGdldE9yQ3JlYXRlTGlzdGVuRm9yRXZlbnRzKHBhcmVudFdpbiwgaWZyYW1lLCBvcHRfaXMzUCkge1xuICBjb25zdCB7b3JpZ2lufSA9IHBhcnNlVXJsRGVwcmVjYXRlZChpZnJhbWUuc3JjKTtcbiAgY29uc3Qgc2VudGluZWwgPSBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCk7XG4gIGNvbnN0IGxpc3RlblNlbnRpbmVsID0gZ2V0TGlzdGVuRm9yU2VudGluZWwocGFyZW50V2luLCBzZW50aW5lbCwgdHJ1ZSk7XG5cbiAgbGV0IHdpbmRvd0V2ZW50cztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0ZW5TZW50aW5lbC5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHdlID0gbGlzdGVuU2VudGluZWxbaV07XG4gICAgaWYgKHdlLmZyYW1lID09PSBpZnJhbWUpIHtcbiAgICAgIHdpbmRvd0V2ZW50cyA9IHdlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKCF3aW5kb3dFdmVudHMpIHtcbiAgICB3aW5kb3dFdmVudHMgPSB7XG4gICAgICBmcmFtZTogaWZyYW1lLFxuICAgICAgb3JpZ2luLFxuICAgICAgZXZlbnRzOiBPYmplY3QuY3JlYXRlKG51bGwpLFxuICAgIH07XG4gICAgbGlzdGVuU2VudGluZWwucHVzaCh3aW5kb3dFdmVudHMpO1xuICB9XG5cbiAgcmV0dXJuIHdpbmRvd0V2ZW50cy5ldmVudHM7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBtYXBwaW5nIG9mIGV2ZW50IG5hbWVzIHRvIGxpc3RlbkZvciBsaXN0ZW5lcnMuXG4gKiBAcGFyYW0gez9XaW5kb3d9IHBhcmVudFdpbiB0aGUgd2luZG93IHRoYXQgY3JlYXRlZCB0aGUgaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VudGluZWwgdGhlIHNlbnRpbmVsIG9mIHRoZSBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luIHRoZSBzb3VyY2Ugd2luZG93J3Mgb3JpZ2luXG4gKiBAcGFyYW0gez9XaW5kb3d9IHRyaWdnZXJXaW4gdGhlIHdpbmRvdyB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnRcbiAqIEByZXR1cm4gez9PYmplY3Q8c3RyaW5nLCAhQXJyYXk8ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyk+Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0TGlzdGVuRm9yRXZlbnRzKHBhcmVudFdpbiwgc2VudGluZWwsIG9yaWdpbiwgdHJpZ2dlcldpbikge1xuICBjb25zdCBsaXN0ZW5TZW50aW5lbCA9IGdldExpc3RlbkZvclNlbnRpbmVsKHBhcmVudFdpbiwgc2VudGluZWwpO1xuXG4gIGlmICghbGlzdGVuU2VudGluZWwpIHtcbiAgICByZXR1cm4gbGlzdGVuU2VudGluZWw7XG4gIH1cblxuICAvLyBGaW5kIHRoZSBlbnRyeSBmb3IgdGhlIGZyYW1lLlxuICAvLyBUT0RPKEBuZWtvZG8pOiBBZGQgYSBXZWFrTWFwPFdpbmRvdywgV2luZG93RXZlbnRzRGVmPiBjYWNoZSB0b1xuICAvLyAgICAgc3BlZWQgdXAgdGhpcyBwcm9jZXNzLlxuICBsZXQgd2luZG93RXZlbnRzO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlblNlbnRpbmVsLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgd2UgPSBsaXN0ZW5TZW50aW5lbFtpXTtcbiAgICBjb25zdCB7Y29udGVudFdpbmRvd30gPSB3ZS5mcmFtZTtcbiAgICBpZiAoIWNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIHNldFRpbWVvdXQoZHJvcExpc3RlblNlbnRpbmVsLCAwLCBsaXN0ZW5TZW50aW5lbCk7XG4gICAgfSBlbHNlIGlmIChzZW50aW5lbCA9PT0gJ2FtcCcpIHtcbiAgICAgIC8vIEEgbm9uLTNQIGNvZGUgcGF0aCwgb3JpZ2luIG11c3QgbWF0Y2guXG4gICAgICBpZiAod2Uub3JpZ2luID09PSBvcmlnaW4gJiYgY29udGVudFdpbmRvdyA9PSB0cmlnZ2VyV2luKSB7XG4gICAgICAgIHdpbmRvd0V2ZW50cyA9IHdlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRyaWdnZXJXaW4gPT0gY29udGVudFdpbmRvdyB8fFxuICAgICAgICBpc0Rlc2NlbmRhbnRXaW5kb3coY29udGVudFdpbmRvdywgdHJpZ2dlcldpbikpIHtcbiAgICAgIC8vIDNwIGNvZGUgcGF0aCwgd2UgbWF5IGFjY2VwdCBtZXNzYWdlcyBmcm9tIG5lc3RlZCBmcmFtZXMuXG4gICAgICB3aW5kb3dFdmVudHMgPSB3ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB3aW5kb3dFdmVudHMgPyB3aW5kb3dFdmVudHMuZXZlbnRzIDogbnVsbDtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBvbmUgd2luZG93IGlzIGEgZGVzY2VuZGFudCBvZiBhbm90aGVyIGJ5IGNsaW1iaW5nXG4gKiB0aGUgcGFyZW50IGNoYWluLlxuICogQHBhcmFtIHs/V2luZG93fSBhbmNlc3RvciBwb3RlbnRpYWwgYW5jZXN0b3Igd2luZG93XG4gKiBAcGFyYW0gez9XaW5kb3d9IGRlc2NlbmRhbnQgcG90ZW50aWFsIGRlc2NlbmRhbnQgd2luZG93XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc0Rlc2NlbmRhbnRXaW5kb3coYW5jZXN0b3IsIGRlc2NlbmRhbnQpIHtcbiAgZm9yIChsZXQgd2luID0gZGVzY2VuZGFudDsgd2luICYmIHdpbiAhPSB3aW4ucGFyZW50OyB3aW4gPSB3aW4ucGFyZW50KSB7XG4gICAgaWYgKHdpbiA9PSBhbmNlc3Rvcikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFueSBsaXN0ZW5Gb3JzIHJlZ2lzdGVkIG9uIGxpc3RlblNlbnRpbmVsIHRoYXQgZG8gbm90IGhhdmVcbiAqIGEgY29udGVudFdpbmRvdyAodGhlIGZyYW1lIHdhcyByZW1vdmVkIGZyb20gdGhlIERPTSB0cmVlKS5cbiAqIEBwYXJhbSB7IUFycmF5PCFXaW5kb3dFdmVudHNEZWY+fSBsaXN0ZW5TZW50aW5lbFxuICovXG5mdW5jdGlvbiBkcm9wTGlzdGVuU2VudGluZWwobGlzdGVuU2VudGluZWwpIHtcbiAgY29uc3Qgbm9vcERhdGEgPSBkaWN0KHsnc2VudGluZWwnOiBVTkxJU1RFTl9TRU5USU5FTH0pO1xuXG4gIGZvciAobGV0IGkgPSBsaXN0ZW5TZW50aW5lbC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGNvbnN0IHdpbmRvd0V2ZW50cyA9IGxpc3RlblNlbnRpbmVsW2ldO1xuXG4gICAgaWYgKCF3aW5kb3dFdmVudHMuZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgbGlzdGVuU2VudGluZWwuc3BsaWNlKGksIDEpO1xuXG4gICAgICBjb25zdCB7ZXZlbnRzfSA9IHdpbmRvd0V2ZW50cztcbiAgICAgIGZvciAoY29uc3QgbmFtZSBpbiBldmVudHMpIHtcbiAgICAgICAgLy8gU3BsaWNlIGhlcmUsIHNvIHRoYXQgZWFjaCB1bmxpc3RlbiBkb2VzIG5vdCBzaGlmdCB0aGUgYXJyYXlcbiAgICAgICAgZXZlbnRzW25hbWVdLnNwbGljZSgwLCBJbmZpbml0eSkuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICAgICAgZXZlbnQobm9vcERhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgdGhlIGdsb2JhbCBsaXN0ZW5Gb3IgZXZlbnQgbGlzdGVuZXIgaWYgaXQgaGFzIHlldCB0byBiZS5cbiAqIEBwYXJhbSB7P1dpbmRvd30gcGFyZW50V2luXG4gKi9cbmZ1bmN0aW9uIHJlZ2lzdGVyR2xvYmFsTGlzdGVuZXJJZk5lZWRlZChwYXJlbnRXaW4pIHtcbiAgaWYgKHBhcmVudFdpbi5saXN0ZW5pbmdGb3JzKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGxpc3RlbkZvckxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIWdldERhdGEoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRhdGEgPSBwYXJzZUlmTmVlZGVkKGdldERhdGEoZXZlbnQpKTtcbiAgICBpZiAoIWRhdGEgfHwgIWRhdGFbJ3NlbnRpbmVsJ10pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBsaXN0ZW5Gb3JFdmVudHMgPSBnZXRMaXN0ZW5Gb3JFdmVudHMoXG4gICAgICAgIHBhcmVudFdpbixcbiAgICAgICAgZGF0YVsnc2VudGluZWwnXSxcbiAgICAgICAgZXZlbnQub3JpZ2luLFxuICAgICAgICBldmVudC5zb3VyY2VcbiAgICApO1xuICAgIGlmICghbGlzdGVuRm9yRXZlbnRzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGxpc3RlbmVycyA9IGxpc3RlbkZvckV2ZW50c1tkYXRhWyd0eXBlJ11dO1xuICAgIGlmICghbGlzdGVuZXJzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gV2Ugc2xpY2UgdG8gYXZvaWQgaXNzdWVzIHdpdGggYWRkaW5nIGFub3RoZXIgbGlzdGVuZXIgb3IgdW5saXN0ZW5pbmdcbiAgICAvLyBkdXJpbmcgaXRlcmF0aW9uLiBXZSBjb3VsZCBtb3ZlIHRvIGEgRG91Ymx5IExpbmtlZCBMaXN0IHdpdGhcbiAgICAvLyBiYWNrdHJhY2tpbmcsIGJ1dCB0aGF0J3Mgb3Zlcmx5IGNvbXBsaWNhdGVkLlxuICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5zbGljZSgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTtcbiAgICAgIGxpc3RlbmVyKGRhdGEsIGV2ZW50LnNvdXJjZSwgZXZlbnQub3JpZ2luKTtcbiAgICB9XG4gIH07XG5cbiAgcGFyZW50V2luLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5Gb3JMaXN0ZW5lcik7XG59XG5cbi8qKlxuICogQWxsb3dzIGxpc3RlbmluZyBmb3IgbWVzc2FnZSBmcm9tIHRoZSBpZnJhbWUuIFJldHVybnMgYW4gdW5saXN0ZW5cbiAqIGZ1bmN0aW9uIHRvIHJlbW92ZSB0aGUgbGlzdGVuZXIuXG4gKlxuICogQHBhcmFtIHs/RWxlbWVudH0gaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZU9mTWVzc2FnZVxuICogQHBhcmFtIHs/ZnVuY3Rpb24oIUpzb25PYmplY3QsICFXaW5kb3csIHN0cmluZyl9IGNhbGxiYWNrIENhbGxlZCB3aGVuIGFcbiAqICAgICBtZXNzYWdlIG9mIHRoaXMgdHlwZSBhcnJpdmVzIGZvciB0aGlzIGlmcmFtZS5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cyBzZXQgdG8gdHJ1ZSBpZiBhIG1lc3NhZ2VzIGZyb21cbiAqICAgICBuZXN0ZWQgZnJhbWVzIHNob3VsZCBhbHNvIGJlIGFjY2VwdGVkLlxuICogQHJldHVybiB7IVVubGlzdGVuRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuRm9yKFxuICBpZnJhbWUsIHR5cGVPZk1lc3NhZ2UsIGNhbGxiYWNrLCBvcHRfaXMzUCwgb3B0X2luY2x1ZGluZ05lc3RlZFdpbmRvd3MpIHtcbiAgZGV2KCkuYXNzZXJ0KGlmcmFtZS5zcmMsICdvbmx5IGlmcmFtZXMgd2l0aCBzcmMgc3VwcG9ydGVkJyk7XG4gIGRldigpLmFzc2VydCghaWZyYW1lLnBhcmVudE5vZGUsICdjYW5ub3QgcmVnaXN0ZXIgZXZlbnRzIG9uIGFuIGF0dGFjaGVkICcgK1xuICAgICAgJ2lmcmFtZS4gSXQgd2lsbCBjYXVzZSBoYWlyLXB1bGxpbmcgYnVncyBsaWtlICMyOTQyJyk7XG4gIGRldigpLmFzc2VydChjYWxsYmFjayk7XG4gIGNvbnN0IHBhcmVudFdpbiA9IGlmcmFtZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3O1xuXG4gIHJlZ2lzdGVyR2xvYmFsTGlzdGVuZXJJZk5lZWRlZChwYXJlbnRXaW4pO1xuXG4gIGNvbnN0IGxpc3RlbkZvckV2ZW50cyA9IGdldE9yQ3JlYXRlTGlzdGVuRm9yRXZlbnRzKFxuICAgICAgcGFyZW50V2luLFxuICAgICAgaWZyYW1lLFxuICAgICAgb3B0X2lzM1BcbiAgKTtcblxuXG4gIGxldCBldmVudHMgPSBsaXN0ZW5Gb3JFdmVudHNbdHlwZU9mTWVzc2FnZV0gfHxcbiAgICAobGlzdGVuRm9yRXZlbnRzW3R5cGVPZk1lc3NhZ2VdID0gW10pO1xuXG4gIGxldCB1bmxpc3RlbjtcbiAgbGV0IGxpc3RlbmVyID0gZnVuY3Rpb24oZGF0YSwgc291cmNlLCBvcmlnaW4pIHtcbiAgICAvLyBFeGNsdWRlIG5lc3RlZCBmcmFtZXMgaWYgbmVjZXNzYXJ5LlxuICAgIC8vIE5vdGUgdGhhdCB0aGUgc291cmNlIHdhcyBhbHJlYWR5IHZlcmlmaWVkIHRvIGJlIGVpdGhlciB0aGUgY29udGVudFdpbmRvd1xuICAgIC8vIG9mIHRoZSBpZnJhbWUgaXRzZWxmIG9yIGEgZGVzY2VuZGFudCB3aW5kb3cgd2l0aGluIGl0LlxuICAgIGlmICghb3B0X2luY2x1ZGluZ05lc3RlZFdpbmRvd3MgJiYgc291cmNlICE9IGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGRhdGEuc2VudGluZWwgPT0gVU5MSVNURU5fU0VOVElORUwpIHtcbiAgICAgIHVubGlzdGVuKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNhbGxiYWNrKGRhdGEsIHNvdXJjZSwgb3JpZ2luKTtcbiAgfTtcblxuICBldmVudHMucHVzaChsaXN0ZW5lcik7XG5cbiAgcmV0dXJuIHVubGlzdGVuID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGV2ZW50cy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIGV2ZW50cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgICAgLy8gTWFrZSBzdXJlIHJlZmVyZW5jZXMgdG8gdGhlIHVubGlzdGVuIGZ1bmN0aW9uIGRvIG5vdCBrZWVwXG4gICAgICAvLyBhbGl2ZSB0b28gbXVjaC5cbiAgICAgIGxpc3RlbmVyID0gbnVsbDtcbiAgICAgIGV2ZW50cyA9IG51bGw7XG4gICAgICBjYWxsYmFjayA9IG51bGw7XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiBvbmUgb2YgZ2l2ZW4gbWVzc2FnZXMgaGFzIGJlZW4gb2JzZXJ2ZWRcbiAqIGZvciB0aGUgZmlyc3QgdGltZS4gQW5kIHJlbW92ZSBsaXN0ZW5lciBmb3IgYWxsIG90aGVyIG1lc3NhZ2VzLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lXG4gKiBAcGFyYW0ge3N0cmluZ3whQXJyYXk8c3RyaW5nPn0gdHlwZU9mTWVzc2FnZXNcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwhe2RhdGE6ICFKc29uT2JqZWN0LCBzb3VyY2U6ICFXaW5kb3csIG9yaWdpbjogc3RyaW5nfT59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5Gb3JPbmNlUHJvbWlzZShpZnJhbWUsIHR5cGVPZk1lc3NhZ2VzLCBvcHRfaXMzUCkge1xuICBjb25zdCB1bmxpc3Rlbkxpc3QgPSBbXTtcbiAgaWYgKHR5cGVvZiB0eXBlT2ZNZXNzYWdlcyA9PSAnc3RyaW5nJykge1xuICAgIHR5cGVPZk1lc3NhZ2VzID0gW3R5cGVPZk1lc3NhZ2VzXTtcbiAgfVxuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eXBlT2ZNZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHR5cGVPZk1lc3NhZ2VzW2ldO1xuICAgICAgY29uc3QgdW5saXN0ZW4gPSBsaXN0ZW5Gb3IoaWZyYW1lLCBtZXNzYWdlLCAoZGF0YSwgc291cmNlLCBvcmlnaW4pID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1bmxpc3Rlbkxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB1bmxpc3Rlbkxpc3RbaV0oKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlKHtkYXRhLCBzb3VyY2UsIG9yaWdpbn0pO1xuICAgICAgfSwgb3B0X2lzM1ApO1xuICAgICAgdW5saXN0ZW5MaXN0LnB1c2godW5saXN0ZW4pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogUG9zdHMgYSBtZXNzYWdlIHRvIHRoZSBpZnJhbWUuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFR5cGUgb2YgdGhlIG1lc3NhZ2UuXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBvYmplY3QgTWVzc2FnZSBwYXlsb2FkLlxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldE9yaWdpbiBvcmlnaW4gb2YgdGhlIHRhcmdldC5cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNQIHNldCB0byB0cnVlIGlmIHRoZSBpZnJhbWUgaXMgM3AuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb3N0TWVzc2FnZShpZnJhbWUsIHR5cGUsIG9iamVjdCwgdGFyZ2V0T3JpZ2luLCBvcHRfaXMzUCkge1xuICBwb3N0TWVzc2FnZVRvV2luZG93cyhpZnJhbWUsXG4gICAgICBbe3dpbjogaWZyYW1lLmNvbnRlbnRXaW5kb3csIG9yaWdpbjogdGFyZ2V0T3JpZ2lufV0sIHR5cGUsIG9iamVjdCxcbiAgICAgIG9wdF9pczNQKTtcbn1cblxuLyoqXG4gKiBQb3N0cyBhbiBpZGVudGljYWwgbWVzc2FnZSB0byBtdWx0aXBsZSB0YXJnZXQgd2luZG93cyB3aXRoIHRoZSBzYW1lXG4gKiBzZW50aW5lbC5cbiAqIFRoZSBtZXNzYWdlIGlzIHNlcmlhbGl6ZWQgb25seSBvbmNlLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lIFRoZSBpZnJhbWUuXG4gKiBAcGFyYW0geyFBcnJheTx7d2luOiAhV2luZG93LCBvcmlnaW46IHN0cmluZ30+fSB0YXJnZXRzIHRvIHNlbmQgdGhlIG1lc3NhZ2VcbiAqICAgICB0bywgcGFpcnMgb2Ygd2luZG93IGFuZCBpdHMgb3JpZ2luLlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgbWVzc2FnZS5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9iamVjdCBNZXNzYWdlIHBheWxvYWQuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXMzUCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcG9zdE1lc3NhZ2VUb1dpbmRvd3MoaWZyYW1lLCB0YXJnZXRzLCB0eXBlLCBvYmplY3QsIG9wdF9pczNQKSB7XG4gIGlmICghaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgb2JqZWN0Wyd0eXBlJ10gPSB0eXBlO1xuICBvYmplY3RbJ3NlbnRpbmVsJ10gPSBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCk7XG4gIGxldCBwYXlsb2FkID0gb2JqZWN0O1xuICBpZiAob3B0X2lzM1ApIHtcbiAgICAvLyBTZXJpYWxpemUgb3Vyc2VsdmVzIGJlY2F1c2UgdGhhdCBpcyBtdWNoIGZhc3RlciBpbiBDaHJvbWUuXG4gICAgcGF5bG9hZCA9ICdhbXAtJyArIEpTT04uc3RyaW5naWZ5KG9iamVjdCk7XG4gIH1cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0c1tpXTtcbiAgICB0YXJnZXQud2luLi8qT0sqL3Bvc3RNZXNzYWdlKHBheWxvYWQsIHRhcmdldC5vcmlnaW4pO1xuICB9XG59XG5cbi8qKlxuICogR2V0cyB0aGUgc2VudGluZWwgc3RyaW5nLlxuICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lIFRoZSBpZnJhbWUuXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfaXMzUCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICogQHJldHVybiB7c3RyaW5nfSBTZW50aW5lbCBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBnZXRTZW50aW5lbF8oaWZyYW1lLCBvcHRfaXMzUCkge1xuICByZXR1cm4gb3B0X2lzM1AgPyBpZnJhbWUuZ2V0QXR0cmlidXRlKCdkYXRhLWFtcC0zcC1zZW50aW5lbCcpIDogJ2FtcCc7XG59XG5cbi8qKlxuICogSlNPTiBwYXJzZXMgZXZlbnQuZGF0YSBpZiBpdCBuZWVkcyB0byBiZVxuICogQHBhcmFtIHsqfSBkYXRhXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdH0gb2JqZWN0IG1lc3NhZ2VcbiAqIEBwcml2YXRlXG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSWZOZWVkZWQoZGF0YSkge1xuICBpZiAodHlwZW9mIGRhdGEgPT0gJ3N0cmluZycpIHtcbiAgICBpZiAoZGF0YS5jaGFyQXQoMCkgPT0gJ3snKSB7XG4gICAgICBkYXRhID0gdHJ5UGFyc2VKc29uKGRhdGEsIGUgPT4ge1xuICAgICAgICBkZXYoKS53YXJuKCdJRlJBTUUtSEVMUEVSJyxcbiAgICAgICAgICAgICdQb3N0bWVzc2FnZSBjb3VsZCBub3QgYmUgcGFyc2VkLiAnICtcbiAgICAgICAgICAgICdJcyBpdCBpbiBhIHZhbGlkIEpTT04gZm9ybWF0PycsIGUpO1xuICAgICAgfSkgfHwgbnVsbDtcbiAgICB9IGVsc2UgaWYgKGlzQW1wTWVzc2FnZShkYXRhKSkge1xuICAgICAgZGF0YSA9IGRlc2VyaWFsaXplTWVzc2FnZShkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YSA9IG51bGw7XG4gICAgfVxuICB9XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fSAqLyAoZGF0YSk7XG59XG5cblxuXG4vKipcbiAqIE1hbmFnZXMgYSBwb3N0TWVzc2FnZSBBUEkgZm9yIGFuIGlmcmFtZSB3aXRoIGEgc3Vic2NyaXB0aW9uIG1lc3NhZ2UgYW5kXG4gKiBhIHdheSB0byBicm9hZGNhc3QgbWVzc2FnZXMgdG8gYWxsIHN1YnNjcmliZWQgd2luZG93cywgd2hpY2hcbiAqIGluIHR1cm4gbXVzdCBhbGwgYmUgZGVzY2VuZGFudHMgb2YgdGhlIGNvbnRlbnRXaW5kb3cgb2YgdGhlIGlmcmFtZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdGlvbkFwaSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWUgVGhlIGlmcmFtZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVHlwZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXMzcCBzZXQgdG8gdHJ1ZSBpZiB0aGUgaWZyYW1lIGlzIDNwLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFKc29uT2JqZWN0LCAhV2luZG93LCBzdHJpbmcpfSByZXF1ZXN0Q2FsbGJhY2sgQ2FsbGJhY2tcbiAgICogICAgIGludm9rZWQgd2hlbmV2ZXIgYSBuZXcgd2luZG93IHN1YnNjcmliZXMuXG4gICAqL1xuICBjb25zdHJ1Y3RvcihpZnJhbWUsIHR5cGUsIGlzM3AsIHJlcXVlc3RDYWxsYmFjaykge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFFbGVtZW50fSAqL1xuICAgIHRoaXMuaWZyYW1lXyA9IGlmcmFtZTtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtib29sZWFufSAqL1xuICAgIHRoaXMuaXMzcF8gPSBpczNwO1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFBcnJheTx7d2luOiAhV2luZG93LCBvcmlnaW46IHN0cmluZ30+fSAqL1xuICAgIHRoaXMuY2xpZW50V2luZG93c18gPSBbXTtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFVbmxpc3RlbkRlZn0gKi9cbiAgICB0aGlzLnVubGlzdGVuXyA9IGxpc3RlbkZvcih0aGlzLmlmcmFtZV8sIHR5cGUsIChkYXRhLCBzb3VyY2UsIG9yaWdpbikgPT4ge1xuICAgICAgLy8gVGhpcyBtZXNzYWdlIG1pZ2h0IGJlIGZyb20gYW55IHdpbmRvdyB3aXRoaW4gdGhlIGlmcmFtZSwgd2UgbmVlZFxuICAgICAgLy8gdG8ga2VlcCB0cmFjayBvZiB3aGljaCB3aW5kb3dzIHdhbnQgdG8gYmUgc2VudCB1cGRhdGVzLlxuICAgICAgaWYgKCF0aGlzLmNsaWVudFdpbmRvd3NfLnNvbWUoZW50cnkgPT4gZW50cnkud2luID09IHNvdXJjZSkpIHtcbiAgICAgICAgdGhpcy5jbGllbnRXaW5kb3dzXy5wdXNoKHt3aW46IHNvdXJjZSwgb3JpZ2lufSk7XG4gICAgICB9XG4gICAgICByZXF1ZXN0Q2FsbGJhY2soZGF0YSwgc291cmNlLCBvcmlnaW4pO1xuICAgIH0sIHRoaXMuaXMzcF8sXG4gICAgICAgIC8vIEZvciAzUCBmcmFtZXMgd2UgYWxzbyBhbGxvdyBuZXN0ZWQgZnJhbWVzIHdpdGhpbiB0aGVtIHRvIHN1YnNjcmliZS4uXG4gICAgdGhpcy5pczNwXyAvKiBvcHRfaW5jbHVkaW5nTmVzdGVkV2luZG93cyAqLyk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBtZXNzYWdlIHRvIGFsbCBzdWJzY3JpYmVkIHdpbmRvd3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFR5cGUgb2YgdGhlIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7IUpzb25PYmplY3R9IGRhdGEgTWVzc2FnZSBwYXlsb2FkLlxuICAgKi9cbiAgc2VuZCh0eXBlLCBkYXRhKSB7XG4gICAgLy8gUmVtb3ZlIGNsaWVudHMgdGhhdCBoYXZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBET00uXG4gICAgZmlsdGVyU3BsaWNlKHRoaXMuY2xpZW50V2luZG93c18sIGNsaWVudCA9PiAhIWNsaWVudC53aW4ucGFyZW50KTtcbiAgICBwb3N0TWVzc2FnZVRvV2luZG93cyhcbiAgICAgICAgdGhpcy5pZnJhbWVfLFxuICAgICAgICB0aGlzLmNsaWVudFdpbmRvd3NfLFxuICAgICAgICB0eXBlLFxuICAgICAgICBkYXRhLFxuICAgICAgICB0aGlzLmlzM3BfKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95cyBpZnJhbWUuXG4gICAqL1xuICBkZXN0cm95KCkge1xuICAgIHRoaXMudW5saXN0ZW5fKCk7XG4gICAgdGhpcy5jbGllbnRXaW5kb3dzXy5sZW5ndGggPSAwO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2tzTGlrZVRyYWNraW5nSWZyYW1lKGVsZW1lbnQpIHtcbiAgY29uc3QgYm94ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgLy8gVGhpcyBoZXVyaXN0aWMgaXMgc3ViamVjdCB0byBjaGFuZ2UuXG4gIGlmIChib3gud2lkdGggPiAxMCB8fCBib3guaGVpZ2h0ID4gMTApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gSWZyYW1lIGlzIG5vdCB0cmFja2luZyBpZnJhbWUgaWYgb3BlbiB3aXRoIHVzZXIgaW50ZXJhY3Rpb25cbiAgcmV0dXJuICFjbG9zZXN0QnlTZWxlY3RvcihlbGVtZW50LCAnLmktYW1waHRtbC1vdmVybGF5Jyk7XG59XG5cbi8vIE1vc3QgY29tbW9uIGFkIHNpemVzXG4vLyBBcnJheSBvZiBbd2lkdGgsIGhlaWdodF0gcGFpcnMuXG5jb25zdCBhZFNpemVzID0gW1xuICBbMzAwLCAyNTBdLFxuICBbMzIwLCA1MF0sXG4gIFszMDAsIDUwXSxcbiAgWzMyMCwgMTAwXSxcbl07XG5cbi8qKlxuICogR3Vlc3Mgd2hldGhlciB0aGlzIGVsZW1lbnQgbWlnaHQgYmUgYW4gYWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50IEFuIGFtcC1pZnJhbWUgZWxlbWVudC5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdmlzaWJsZUZvclRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQWRMaWtlKGVsZW1lbnQpIHtcbiAgY29uc3QgYm94ID0gZWxlbWVudC5nZXRMYXlvdXRCb3goKTtcbiAgY29uc3Qge2hlaWdodCwgd2lkdGh9ID0gYm94O1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFkU2l6ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCByZWZXaWR0aCA9IGFkU2l6ZXNbaV1bMF07XG4gICAgY29uc3QgcmVmSGVpZ2h0ID0gYWRTaXplc1tpXVsxXTtcbiAgICBpZiAocmVmSGVpZ2h0ID4gaGVpZ2h0KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHJlZldpZHRoID4gd2lkdGgpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICAvLyBGdXp6eSBtYXRjaGluZyB0byBhY2NvdW50IGZvciBwYWRkaW5nLlxuICAgIGlmIChoZWlnaHQgLSByZWZIZWlnaHQgPD0gMjAgJiYgd2lkdGggLSByZWZXaWR0aCA8PSAyMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFFbGVtZW50fSBpZnJhbWVcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXNhYmxlU2Nyb2xsaW5nT25JZnJhbWUoaWZyYW1lKSB7XG4gIGFkZEF0dHJpYnV0ZXNUb0VsZW1lbnQoaWZyYW1lLCBkaWN0KHsnc2Nyb2xsaW5nJzogJ25vJ30pKTtcblxuICAvLyBUaGlzIHNob3VsZG4ndCB3b3JrLCBidXQgaXQgZG9lcyBvbiBGaXJlZm94LlxuICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTU0OTQ5NjlcbiAgc2V0U3R5bGUoaWZyYW1lLCAnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XG5cbiAgcmV0dXJuIGlmcmFtZTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1N1YnNjcmlwdGlvbkFwaX0gZnJvbSAnLi9pZnJhbWUtaGVscGVyJztcbmltcG9ydCB7ZGV2fSBmcm9tICcuL2xvZyc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7aXNBcnJheSwgaXNGaW5pdGVOdW1iZXJ9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtsYXlvdXRSZWN0THR3aCwgbW92ZUxheW91dFJlY3QsIHJlY3RJbnRlcnNlY3Rpb259IGZyb20gJy4vbGF5b3V0LXJlY3QnO1xuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCBkZWZpbmVzIHRoZSByZWN0YW5nbGUgdXNlZCBpbiBpbnRlcnNlY3Rpb24gb2JzZXJ2ZXJzLlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogbnVtYmVyLFxuICogICBib3R0b206IG51bWJlcixcbiAqICAgbGVmdDogbnVtYmVyLFxuICogICByaWdodDogbnVtYmVyLFxuICogICB3aWR0aDogbnVtYmVyLFxuICogICBoZWlnaHQ6IG51bWJlcixcbiAqICAgeDogbnVtYmVyLFxuICogICB5OiBudW1iZXIsXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IERPTVJlY3Q7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1RIUkVTSE9MRCA9XG4gICAgWzAsIDAuMDUsIDAuMSwgMC4xNSwgMC4yLCAwLjI1LCAwLjMsIDAuMzUsIDAuNCxcbiAgICAgIDAuNDUsIDAuNSwgMC41NSwgMC42LCAwLjY1LCAwLjcsIDAuNzUsIDAuOCwgMC44NSwgMC45LCAwLjk1LCAxXTtcblxuLyoqIEB0eXBlZGVmIHt7XG4gKiAgICBlbGVtZW50OiAhRWxlbWVudCxcbiAqICAgIGN1cnJlbnRUaHJlc2hvbGRTbG90OiBudW1iZXIsXG4gKiAgfX1cbiAqL1xubGV0IEVsZW1lbnRJbnRlcnNlY3Rpb25TdGF0ZURlZjtcblxuLyoqIEBjb25zdCBAcHJpdmF0ZSAqL1xuY29uc3QgVEFHID0gJ0lOVEVSU0VDVElPTi1PQlNFUlZFUic7XG5cbi8qKiBAY29uc3QgQHByaXZhdGUgKi9cbmNvbnN0IElOSVRfVElNRSA9IERhdGUubm93KCk7XG5cbi8qKlxuICogQSBmdW5jdGlvbiB0byBnZXQgdGhlIGVsZW1lbnQncyBjdXJyZW50IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnlcbiAqIHJlZ2FyZGxlc3Mgb2YgdGhlIGludGVyc2V0aW9uIHJhdGlvLiBPbmx5IGF2YWlsYWJsZSB3aGVuIGVsZW1lbnQgaXMgbm90XG4gKiBuZXN0ZWQgaW4gYSBjb250YWluZXIgaWZyYW1lLlxuICogVE9ETzogc3VwcG9ydCBvcHRfaWZyYW1lIGlmIHRoZXJlJ3MgdmFsaWQgdXNlIGNhc2VzLlxuICogQHBhcmFtIHshLi9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfSBlbGVtZW50IGVsZW1lbnQncyByZWN0XG4gKiBAcGFyYW0gez8uL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IG93bmVyIGVsZW1lbnQncyBvd25lciByZWN0XG4gKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IGhvc3RWaWV3cG9ydCBob3N0Vmlld3BvcnQncyByZWN0XG4gKiBAcmV0dXJuIHshSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeX0gQSBjaGFuZ2UgZW50cnkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeShcbiAgZWxlbWVudCwgb3duZXIsIGhvc3RWaWV3cG9ydCkge1xuICBjb25zdCBpbnRlcnNlY3Rpb24gPSByZWN0SW50ZXJzZWN0aW9uKGVsZW1lbnQsIG93bmVyLCBob3N0Vmlld3BvcnQpIHx8XG4gICAgICBsYXlvdXRSZWN0THR3aCgwLCAwLCAwLCAwKTtcbiAgY29uc3QgcmF0aW8gPSBpbnRlcnNlY3Rpb25SYXRpbyhpbnRlcnNlY3Rpb24sIGVsZW1lbnQpO1xuICByZXR1cm4gY2FsY3VsYXRlQ2hhbmdlRW50cnkoXG4gICAgICBlbGVtZW50LCBob3N0Vmlld3BvcnQsIGludGVyc2VjdGlvbiwgcmF0aW8pO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbmF0aXZlSW50ZXJzZWN0aW9uT2JzZXJ2ZXJTdXBwb3J0ZWQod2luKSB7XG4gIHJldHVybiAnSW50ZXJzZWN0aW9uT2JzZXJ2ZXInIGluIHdpbiAmJlxuICAgICAgJ0ludGVyc2VjdGlvbk9ic2VydmVyRW50cnknIGluIHdpbiAmJlxuICAgICAgJ2ludGVyc2VjdGlvblJhdGlvJyBpbiB3aW4uSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeS5wcm90b3R5cGU7XG59XG5cbi8qKlxuICogQSBjbGFzcyB0byBoZWxwIGFtcC1pZnJhbWUgYW5kIGFtcC1hZCBuZXN0ZWQgaWZyYW1lIGxpc3RlbiB0byBpbnRlcnNlY3Rpb25cbiAqIGNoYW5nZS5cbiAqL1xuZXhwb3J0IGNsYXNzIEludGVyc2VjdGlvbk9ic2VydmVyQXBpIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IUFNUC5CYXNlRWxlbWVudH0gYmFzZUVsZW1lbnRcbiAgICogQHBhcmFtIHshRWxlbWVudH0gaWZyYW1lXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pczNwXG4gICAqL1xuICBjb25zdHJ1Y3RvcihiYXNlRWxlbWVudCwgaWZyYW1lLCBvcHRfaXMzcCkge1xuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFBTVAuQmFzZUVsZW1lbnR9ICovXG4gICAgdGhpcy5iYXNlRWxlbWVudF8gPSBiYXNlRWxlbWVudDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P0ludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGx9ICovXG4gICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcl8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIHtib29sZWFufSAqL1xuICAgIHRoaXMuc2hvdWxkT2JzZXJ2ZV8gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Ym9vbGVhbn0gKi9cbiAgICB0aGlzLmlzSW5WaWV3cG9ydF8gPSBmYWxzZTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P2Z1bmN0aW9uKCl9ICovXG4gICAgdGhpcy51bmxpc3Rlbk9uRGVzdHJveV8gPSBudWxsO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7IS4vc2VydmljZS92aWV3cG9ydC92aWV3cG9ydC1pbXBsLlZpZXdwb3J0fSAqL1xuICAgIHRoaXMudmlld3BvcnRfID0gYmFzZUVsZW1lbnQuZ2V0Vmlld3BvcnQoKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7P1N1YnNjcmlwdGlvbkFwaX0gKi9cbiAgICB0aGlzLnN1YnNjcmlwdGlvbkFwaV8gPSBuZXcgU3Vic2NyaXB0aW9uQXBpKFxuICAgICAgICBpZnJhbWUsICdzZW5kLWludGVyc2VjdGlvbnMnLCBvcHRfaXMzcCB8fCBmYWxzZSwgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc3RhcnRTZW5kaW5nSW50ZXJzZWN0aW9uXygpO1xuICAgICAgICB9KTtcblxuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGwoZW50cmllcyA9PiB7XG4gICAgICAvLyBSZW1vdmUgdGFyZ2V0IGluZm8gZnJvbSBjcm9zcyBvcmlnaW4gaWZyYW1lLlxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGRlbGV0ZSBlbnRyaWVzW2ldWyd0YXJnZXQnXTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uQXBpXy5zZW5kKCdpbnRlcnNlY3Rpb24nLCBkaWN0KHsnY2hhbmdlcyc6IGVudHJpZXN9KSk7XG4gICAgfSwge3RocmVzaG9sZDogREVGQVVMVF9USFJFU0hPTER9KTtcbiAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyXy50aWNrKHRoaXMudmlld3BvcnRfLmdldFJlY3QoKSk7XG5cbiAgICAvKiogQGNvbnN0IHtmdW5jdGlvbigpfSAqL1xuICAgIHRoaXMuZmlyZSA9ICgpID0+IHtcbiAgICAgIGlmICghdGhpcy5zaG91bGRPYnNlcnZlXyB8fCAhdGhpcy5pc0luVmlld3BvcnRfKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfLnRpY2sodGhpcy52aWV3cG9ydF8uZ2V0UmVjdCgpKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHRvIHN0YXJ0IGxpc3RlbmluZyB0byB2aWV3cG9ydCBldmVudC4gYW5kIG9ic2VydmVyIGludGVyc2VjdGlvblxuICAgKiBjaGFuZ2Ugb24gdGhlIGVsZW1lbnQuXG4gICAqL1xuICBzdGFydFNlbmRpbmdJbnRlcnNlY3Rpb25fKCkge1xuICAgIHRoaXMuc2hvdWxkT2JzZXJ2ZV8gPSB0cnVlO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfLm9ic2VydmUodGhpcy5iYXNlRWxlbWVudF8uZWxlbWVudCk7XG4gICAgdGhpcy5iYXNlRWxlbWVudF8uZ2V0VnN5bmMoKS5tZWFzdXJlKCgpID0+IHtcbiAgICAgIHRoaXMuaXNJblZpZXdwb3J0XyA9IHRoaXMuYmFzZUVsZW1lbnRfLmlzSW5WaWV3cG9ydCgpO1xuICAgICAgdGhpcy5maXJlKCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCB1bmxpc3RlblZpZXdwb3J0U2Nyb2xsID0gdGhpcy52aWV3cG9ydF8ub25TY3JvbGwodGhpcy5maXJlKTtcbiAgICBjb25zdCB1bmxpc3RlblZpZXdwb3J0Q2hhbmdlID0gdGhpcy52aWV3cG9ydF8ub25DaGFuZ2VkKHRoaXMuZmlyZSk7XG4gICAgdGhpcy51bmxpc3Rlbk9uRGVzdHJveV8gPSAoKSA9PiB7XG4gICAgICB1bmxpc3RlblZpZXdwb3J0U2Nyb2xsKCk7XG4gICAgICB1bmxpc3RlblZpZXdwb3J0Q2hhbmdlKCk7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbmFibGUgdG8gdGhlIFBvc2l0aW9uT2JzZXJ2ZXIgdG8gbGlzdGVuIHRvIHZpZXdwb3J0IGV2ZW50c1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGluVmlld3BvcnRcbiAgICovXG4gIG9uVmlld3BvcnRDYWxsYmFjayhpblZpZXdwb3J0KSB7XG4gICAgdGhpcy5pc0luVmlld3BvcnRfID0gaW5WaWV3cG9ydDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiBhbGwgbGlzdGVucnNcbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgdGhpcy5zaG91bGRPYnNlcnZlXyA9IGZhbHNlO1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJfID0gbnVsbDtcbiAgICBpZiAodGhpcy51bmxpc3Rlbk9uRGVzdHJveV8pIHtcbiAgICAgIHRoaXMudW5saXN0ZW5PbkRlc3Ryb3lfKCk7XG4gICAgICB0aGlzLnVubGlzdGVuT25EZXN0cm95XyA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuc3Vic2NyaXB0aW9uQXBpXy5kZXN0cm95KCk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25BcGlfID0gbnVsbDtcbiAgfVxufVxuXG5cbi8qKlxuICogVGhlIEludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGwgY2xhc3MgbGV0cyBhbnkgZWxlbWVudCByZWNlaXZlIGl0c1xuICogaW50ZXJzZWN0aW9uIGRhdGEgd2l0aCB0aGUgdmlld3BvcnQuIEl0IGFjdHMgbGlrZSBuYXRpdmUgYnJvd3NlciBzdXBwb3J0ZWRcbiAqIEludGVyc2VjdGlvbk9ic2VydmVyLlxuICogVGhlIEludGVyc2VjdGlvbk9ic2VydmVyIHJlY2VpdmVzIGEgY2FsbGJhY2sgZnVuY3Rpb24gYW5kIGFuIG9wdGlvbmFsIG9wdGlvblxuICogYXMgcGFyYW1zLiBXaGVuZXZlciB0aGUgZWxlbWVudCBpbnRlcnNlY3Rpb24gcmF0aW8gY3Jvc3MgYSB0aHJlc2hvbGQgdmFsdWUsXG4gKiBJbnRlcnNlY3Rpb25PYnNlcnZlclBvbHlmaWxsIHdpbGwgY2FsbCB0aGUgcHJvdmlkZWQgY2FsbGJhY2sgZnVuY3Rpb24gd2l0aFxuICogdGhlIGNoYW5nZSBlbnRyeS5cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgY2xhc3MgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJQb2x5ZmlsbCB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCFBcnJheTwhSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeT4pfSBjYWxsYmFja1xuICAgKiBAcGFyYW0ge09iamVjdD19IG9wdF9vcHRpb25cbiAgICovXG4gIGNvbnN0cnVjdG9yKGNhbGxiYWNrLCBvcHRfb3B0aW9uKSB7XG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7ZnVuY3Rpb24oIUFycmF5PCFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5Pil9ICovXG4gICAgdGhpcy5jYWxsYmFja18gPSBjYWxsYmFjaztcblxuICAgIC8vIFRoZSBpbnB1dCB0aHJlc2hvbGQgY2FuIGJlIGEgbnVtYmVyIG9yIGFuIGFycmF5IG9mIG51bWJlcnMuXG4gICAgbGV0IHRocmVzaG9sZCA9IG9wdF9vcHRpb24gJiYgb3B0X29wdGlvbi50aHJlc2hvbGQ7XG4gICAgaWYgKHRocmVzaG9sZCkge1xuICAgICAgdGhyZXNob2xkID0gaXNBcnJheSh0aHJlc2hvbGQpID9cbiAgICAgICAgdGhyZXNob2xkIDogW3RocmVzaG9sZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocmVzaG9sZCA9IFswXTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRocmVzaG9sZC5sZW5ndGg7IGkrKykge1xuICAgICAgZGV2KCkuYXNzZXJ0KGlzRmluaXRlTnVtYmVyKHRocmVzaG9sZFtpXSksICdUaHJlc2hvbGQgc2hvdWxkIGJlIGEgJyArXG4gICAgICAgICAgJ2Zpbml0ZSBudW1iZXIgb3IgYW4gYXJyYXkgb2YgZmluaXRlIG51bWJlcnMnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGxpc3Qgb2YgdGhyZXNob2xkLCBzb3J0ZWQgaW4gaW5jcmVhc2luZyBudW1lcmljIG9yZGVyXG4gICAgICogQHByaXZhdGUgQGNvbnN0IHshQXJyYXl9XG4gICAgICovXG4gICAgdGhpcy50aHJlc2hvbGRfID0gdGhyZXNob2xkLnNvcnQoKTtcbiAgICBkZXYoKS5hc3NlcnQodGhpcy50aHJlc2hvbGRfWzBdID49IDAgJiZcbiAgICAgICAgdGhpcy50aHJlc2hvbGRfW3RoaXMudGhyZXNob2xkXy5sZW5ndGggLSAxXSA8PSAxLFxuICAgICdUaHJlc2hvbGQgc2hvdWxkIGJlIGluIHRoZSByYW5nZSBmcm9tIFwiWzAsIDFdXCInKTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Py4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gKi9cbiAgICB0aGlzLmxhc3RWaWV3cG9ydFJlY3RfID0gbnVsbDtcblxuICAgIC8qKiBAcHJpdmF0ZSB7Li9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmfHVuZGVmaW5lZH0gKi9cbiAgICB0aGlzLmxhc3RJZnJhbWVSZWN0XyA9IHVuZGVmaW5lZDtcblxuICAgIC8qKlxuICAgICAqIFN0b3JlIGEgbGlzdCBvZiBvYnNlcnZlZCBlbGVtZW50cyBhbmQgdGhlaXIgY3VycmVudCB0aHJlc2hvbGQgc2xvdCB3aGljaFxuICAgICAqIHRoZWlyIGludGVyc2VjdGlvbiByYXRpbyBmaWxscywgcmFuZ2UgZnJvbSBbMCwgdGhpcy50aHJlc2hvbGRfLmxlbmd0aF1cbiAgICAgKiBAcHJpdmF0ZSB7QXJyYXk8IUVsZW1lbnRJbnRlcnNlY3Rpb25TdGF0ZURlZj59XG4gICAgICovXG4gICAgdGhpcy5vYnNlcnZlRW50cmllc18gPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKi9cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLm9ic2VydmVFbnRyaWVzXy5sZW5ndGggPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGUgYSB3YXkgdG8gb2JzZXJ2ZSB0aGUgaW50ZXJzZWN0aW9uIGNoYW5nZSBmb3IgYSBzcGVjaWZpYyBlbGVtZW50XG4gICAqIFBsZWFzZSBub3RlIEludGVyc2VjdGlvbk9ic2VydmVyUG9seWZpbGwgb25seSBzdXBwb3J0IEFNUCBlbGVtZW50IG5vd1xuICAgKiBUT0RPOiBTdXBwb3J0IG5vbiBBTVAgZWxlbWVudFxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICBvYnNlcnZlKGVsZW1lbnQpIHtcbiAgICAvLyBDaGVjayB0aGUgZWxlbWVudCBpcyBhbiBBTVAgZWxlbWVudC5cbiAgICBkZXYoKS5hc3NlcnQoZWxlbWVudC5nZXRMYXlvdXRCb3gpO1xuXG4gICAgLy8gSWYgdGhlIGVsZW1lbnQgYWxyZWFkeSBleGlzdHMgaW4gY3VycmVudCBvYnNlcnZlRW50cmllcywgZG8gbm90aGluZ1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlRW50cmllc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLm9ic2VydmVFbnRyaWVzX1tpXS5lbGVtZW50ID09PSBlbGVtZW50KSB7XG4gICAgICAgIGRldigpLndhcm4oVEFHLCAnc2hvdWxkIG9ic2VydmUgc2FtZSBlbGVtZW50IG9uY2UnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgZWxlbWVudCxcbiAgICAgIGN1cnJlbnRUaHJlc2hvbGRTbG90OiAwLFxuICAgIH07XG5cbiAgICAvLyBHZXQgdGhlIG5ldyBvYnNlcnZlZCBlbGVtZW50J3MgZmlyc3QgY2hhbmdlRW50cnkgYmFzZWQgb24gbGFzdCB2aWV3cG9ydFxuICAgIGlmICh0aGlzLmxhc3RWaWV3cG9ydFJlY3RfKSB7XG4gICAgICBjb25zdCBjaGFuZ2UgPSB0aGlzLmdldFZhbGlkSW50ZXJzZWN0aW9uQ2hhbmdlRW50cnlfKFxuICAgICAgICAgIG5ld1N0YXRlLCB0aGlzLmxhc3RWaWV3cG9ydFJlY3RfLCB0aGlzLmxhc3RJZnJhbWVSZWN0Xyk7XG4gICAgICBpZiAoY2hhbmdlKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tfKFtjaGFuZ2VdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBwdXNoIG5ldyBvYnNlcnZlZCBlbGVtZW50XG4gICAgdGhpcy5vYnNlcnZlRW50cmllc18ucHVzaChuZXdTdGF0ZSk7XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZSBhIHdheSB0byB1bm9ic2VydmUgaW50ZXJzZWN0aW9uIGNoYW5nZSBmb3IgYSBzcGVjaWZpZWQgZWxlbWVudFxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICB1bm9ic2VydmUoZWxlbWVudCkge1xuICAgIC8vIGZpbmQgdGhlIHVub2JzZXJ2ZWQgZWxlbWVudCBpbiBvYnNlcnZlRW50cmllc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlRW50cmllc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLm9ic2VydmVFbnRyaWVzX1tpXS5lbGVtZW50ID09PSBlbGVtZW50KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZUVudHJpZXNfLnNwbGljZShpLCAxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBkZXYoKS53YXJuKFRBRywgJ3Vub2JzZXJ2ZSBub24tb2JzZXJ2ZWQgZWxlbWVudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRpY2sgZnVuY3Rpb24gdGhhdCB1cGRhdGUgdGhlIERPTVJlY3Qgb2YgdGhlIHJvb3Qgb2Ygb2JzZXJ2ZWQgZWxlbWVudHMuXG4gICAqIENhbGxlciBuZWVkcyB0byBtYWtlIHN1cmUgdG8gcGFzcyBpbiB0aGUgY29ycmVjdCBjb250YWluZXIuXG4gICAqIE5vdGU6IHRoZSBvcHRfaWZyYW1lIHBhcmFtIGlzIHRoZSBpZnJhbWUgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGhvc3QgZG9jLFxuICAgKiBUaGUgaWZyYW1lIG11c3QgYmUgYSBub24tc2Nyb2xsYWJsZSBpZnJhbWUuXG4gICAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gaG9zdFZpZXdwb3J0XG4gICAqIEBwYXJhbSB7Li9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmPX0gb3B0X2lmcmFtZVxuICAgKi9cbiAgdGljayhob3N0Vmlld3BvcnQsIG9wdF9pZnJhbWUpIHtcblxuICAgIGlmIChvcHRfaWZyYW1lKSB7XG4gICAgICAvLyBJZiBlbGVtZW50IGluc2lkZSBhbiBpZnJhbWUuIEFkanVzdCBvcmlnaW4gdG8gdGhlIGlmcmFtZS5sZWZ0L3RvcC5cbiAgICAgIGhvc3RWaWV3cG9ydCA9XG4gICAgICAgICAgbW92ZUxheW91dFJlY3QoaG9zdFZpZXdwb3J0LCAtb3B0X2lmcmFtZS5sZWZ0LCAtb3B0X2lmcmFtZS50b3ApO1xuICAgICAgb3B0X2lmcmFtZSA9XG4gICAgICAgICAgbW92ZUxheW91dFJlY3Qob3B0X2lmcmFtZSwgLW9wdF9pZnJhbWUubGVmdCwgLW9wdF9pZnJhbWUudG9wKTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3RWaWV3cG9ydFJlY3RfID0gaG9zdFZpZXdwb3J0O1xuICAgIHRoaXMubGFzdElmcmFtZVJlY3RfID0gb3B0X2lmcmFtZTtcblxuICAgIGNvbnN0IGNoYW5nZXMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlRW50cmllc18ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNoYW5nZSA9IHRoaXMuZ2V0VmFsaWRJbnRlcnNlY3Rpb25DaGFuZ2VFbnRyeV8oXG4gICAgICAgICAgdGhpcy5vYnNlcnZlRW50cmllc19baV0sIGhvc3RWaWV3cG9ydCwgb3B0X2lmcmFtZSk7XG4gICAgICBpZiAoY2hhbmdlKSB7XG4gICAgICAgIGNoYW5nZXMucHVzaChjaGFuZ2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzLmxlbmd0aCkge1xuICAgICAgdGhpcy5jYWxsYmFja18oY2hhbmdlcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBhIGNoYW5nZSBlbnRyeSBmb3Igb25lIGVsZW1lbnQgdGhhdCBzaG91bGQgYmUgY29tcGF0aWJsZSB3aXRoXG4gICAqIEludGVyc2VjdGlvbk9ic2VydmVyRW50cnkgaWYgaXQncyB2YWxpZCB3aXRoIGN1cnJlbnQgY29uZmlnLlxuICAgKiBXaGVuIHRoZSBuZXcgaW50ZXJzZWN0aW9uIHJhdGlvIGRvZXNuJ3QgY3Jvc3Mgb25lIG9mIGEgdGhyZXNob2xkIHZhbHVlLFxuICAgKiB0aGUgZnVuY3Rpb24gd2lsbCByZXR1cm4gbnVsbC5cbiAgICpcbiAgICogQHBhcmFtIHshRWxlbWVudEludGVyc2VjdGlvblN0YXRlRGVmfSBzdGF0ZVxuICAgKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IGhvc3RWaWV3cG9ydCBob3N0Vmlld3BvcnQncyByZWN0XG4gICAqIEBwYXJhbSB7Li9sYXlvdXQtcmVjdC5MYXlvdXRSZWN0RGVmPX0gb3B0X2lmcmFtZSBpZnJhbWUgY29udGFpbmVyIHJlY3RcbiAgICogQHJldHVybiB7P0ludGVyc2VjdGlvbk9ic2VydmVyRW50cnl9IEEgdmFsaWQgY2hhbmdlIGVudHJ5IG9yIG51bGwgaWYgcmF0aW9cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGdldFZhbGlkSW50ZXJzZWN0aW9uQ2hhbmdlRW50cnlfKHN0YXRlLCBob3N0Vmlld3BvcnQsIG9wdF9pZnJhbWUpIHtcbiAgICBjb25zdCB7ZWxlbWVudH0gPSBzdGF0ZTtcblxuICAgIC8vIE5vcm1hbGl6ZSBjb250YWluZXIgTGF5b3V0UmVjdCB0byBiZSByZWxhdGl2ZSB0byBwYWdlXG4gICAgbGV0IG93bmVyUmVjdCA9IG51bGw7XG5cbiAgICAvLyBJZiBvcHRfaWZyYW1lIGlzIHByb3ZpZGVkLCBhbGwgTGF5b3V0UmVjdCBoYXMgcG9zaXRpb24gcmVsYXRpdmUgdG9cbiAgICAvLyB0aGUgaWZyYW1lLlxuICAgIC8vIElmIG9wdF9pZnJhbWUgaXMgbm90IHByb3ZpZGVkLCBhbGwgTGF5b3V0UmVjdCBoYXMgcG9zaXRpb24gcmVsYXRpdmUgdG9cbiAgICAvLyB0aGUgaG9zdCBkb2N1bWVudC5cbiAgICBjb25zdCBlbGVtZW50UmVjdCA9IGVsZW1lbnQuZ2V0TGF5b3V0Qm94KCk7XG4gICAgY29uc3Qgb3duZXIgPSBlbGVtZW50LmdldE93bmVyKCk7XG4gICAgb3duZXJSZWN0ID0gb3duZXIgJiYgb3duZXIuZ2V0TGF5b3V0Qm94KCk7XG5cbiAgICAvLyBjYWxjdWxhdGUgaW50ZXJzZWN0aW9uUmVjdC4gdGhhdCB0aGUgZWxlbWVudCBpbnRlcnNlY3RzIHdpdGggaG9zdFZpZXdwb3J0XG4gICAgLy8gYW5kIGludGVyc2VjdHMgd2l0aCBvd25lciBlbGVtZW50IGFuZCBjb250YWluZXIgaWZyYW1lIGlmIGV4aXN0cy5cbiAgICBjb25zdCBpbnRlcnNlY3Rpb25SZWN0ID1cbiAgICAgICAgcmVjdEludGVyc2VjdGlvbihlbGVtZW50UmVjdCwgb3duZXJSZWN0LCBob3N0Vmlld3BvcnQsIG9wdF9pZnJhbWUpIHx8XG4gICAgICAgIGxheW91dFJlY3RMdHdoKDAsIDAsIDAsIDApO1xuICAgIC8vIGNhbGN1bGF0ZSByYXRpbywgY2FsbCBjYWxsYmFjayBiYXNlZCBvbiBuZXcgcmF0aW8gdmFsdWUuXG4gICAgY29uc3QgcmF0aW8gPSBpbnRlcnNlY3Rpb25SYXRpbyhpbnRlcnNlY3Rpb25SZWN0LCBlbGVtZW50UmVjdCk7XG4gICAgY29uc3QgbmV3VGhyZXNob2xkU2xvdCA9IGdldFRocmVzaG9sZFNsb3QodGhpcy50aHJlc2hvbGRfLCByYXRpbyk7XG5cbiAgICBpZiAobmV3VGhyZXNob2xkU2xvdCA9PSBzdGF0ZS5jdXJyZW50VGhyZXNob2xkU2xvdCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHN0YXRlLmN1cnJlbnRUaHJlc2hvbGRTbG90ID0gbmV3VGhyZXNob2xkU2xvdDtcblxuICAgIC8vIFRvIGdldCBzYW1lIGJlaGF2aW9yIGFzIG5hdGl2ZSBJbnRlcnNlY3Rpb25PYnNlcnZlciBzZXQgaG9zdFZpZXdwb3J0IG51bGxcbiAgICAvLyBpZiBpbnNpZGUgYW4gaWZyYW1lXG4gICAgY29uc3QgY2hhbmdlRW50cnkgPSBjYWxjdWxhdGVDaGFuZ2VFbnRyeShlbGVtZW50UmVjdCxcbiAgICAgICAgKG9wdF9pZnJhbWUgPyBudWxsIDogaG9zdFZpZXdwb3J0KSwgaW50ZXJzZWN0aW9uUmVjdCwgcmF0aW8pO1xuICAgIGNoYW5nZUVudHJ5LnRhcmdldCA9IGVsZW1lbnQ7XG4gICAgcmV0dXJuIGNoYW5nZUVudHJ5O1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcmF0aW8gb2YgdGhlIHNtYWxsZXIgYm94J3MgYXJlYSB0byB0aGUgbGFyZ2VyIGJveCdzIGFyZWEuXG4gKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IHNtYWxsZXJcbiAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gbGFyZ2VyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIGludGVyc2VjdGlvblJhdGlvKHNtYWxsZXIsIGxhcmdlcikge1xuICByZXR1cm4gKHNtYWxsZXIud2lkdGggKiBzbWFsbGVyLmhlaWdodCkgLyAobGFyZ2VyLndpZHRoICogbGFyZ2VyLmhlaWdodCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc2xvdCBudW1iZXIgdGhhdCB0aGUgY3VycmVudCByYXRpbyBmaWxscyBpbi5cbiAqIEBwYXJhbSB7IUFycmF5fSBzb3J0ZWRUaHJlc2hvbGQgdmFsaWQgc29ydGVkIElvQiB0aHJlc2hvbGRcbiAqIEBwYXJhbSB7bnVtYmVyfSByYXRpbyBSYW5nZSBmcm9tIFswLCAxXVxuICogQHJldHVybiB7bnVtYmVyfSBSYW5nZSBmcm9tIFswLCB0aHJlc2hvbGQubGVuZ3RoXVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaHJlc2hvbGRTbG90KHNvcnRlZFRocmVzaG9sZCwgcmF0aW8pIHtcbiAgbGV0IHN0YXJ0SWR4ID0gMDtcbiAgbGV0IGVuZElkeCA9IHNvcnRlZFRocmVzaG9sZC5sZW5ndGg7XG4gIC8vIDAgaXMgYSBzcGVjaWFsIGNhc2UgdGhhdCBkb2VzIG5vdCBmaXQgaW50byBbc21hbGwsIGxhcmdlKSByYW5nZVxuICBpZiAocmF0aW8gPT0gMCkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIGxldCBtaWQgPSAoKHN0YXJ0SWR4ICsgZW5kSWR4KSAvIDIpIHwgMDtcbiAgd2hpbGUgKHN0YXJ0SWR4IDwgbWlkKSB7XG4gICAgY29uc3QgbWlkVmFsdWUgPSBzb3J0ZWRUaHJlc2hvbGRbbWlkXTtcbiAgICAvLyBJbiB0aGUgcmFuZ2Ugb2YgW3NtYWxsLCBsYXJnZSlcbiAgICBpZiAocmF0aW8gPCBtaWRWYWx1ZSkge1xuICAgICAgZW5kSWR4ID0gbWlkO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFydElkeCA9IG1pZDtcbiAgICB9XG4gICAgbWlkID0gKChzdGFydElkeCArIGVuZElkeCkgLyAyKSB8IDA7XG4gIH1cbiAgcmV0dXJuIGVuZElkeDtcbn1cblxuLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHRoZSBJbnRlcnNlY3Rpb25PYnNlcnZlciBjaGFuZ2UgZW50cnkuXG4gKiBAcGFyYW0geyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9IGVsZW1lbnQgZWxlbWVudCdzIHJlY3RcbiAqIEBwYXJhbSB7Py4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gaG9zdFZpZXdwb3J0IGhvc3RWaWV3cG9ydCdzIHJlY3RcbiAqIEBwYXJhbSB7IS4vbGF5b3V0LXJlY3QuTGF5b3V0UmVjdERlZn0gaW50ZXJzZWN0aW9uXG4gKiBAcGFyYW0ge251bWJlcn0gcmF0aW9cbiAqIEByZXR1cm4geyFJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5fX1cbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlQ2hhbmdlRW50cnkoXG4gIGVsZW1lbnQsIGhvc3RWaWV3cG9ydCwgaW50ZXJzZWN0aW9uLCByYXRpbykge1xuICAvLyBJZiBlbGVtZW50IG5vdCBpbiBhbiBpZnJhbWUuXG4gIC8vIGFkanVzdCBhbGwgTGF5b3V0UmVjdCB0byBob3N0Vmlld3BvcnQgT3JpZ2luLlxuICBsZXQgYm91bmRpbmdDbGllbnRSZWN0ID0gZWxlbWVudDtcbiAgbGV0IHJvb3RCb3VuZHMgPSBob3N0Vmlld3BvcnQ7XG4gIC8vIElmIG5vIGhvc3RWaWV3cG9ydCBpcyBwcm92aWRlZCwgZWxlbWVudCBpcyBpbnNpZGUgYW4gbm9uLXNjcm9sbGFibGUgaWZyYW1lLlxuICAvLyBFdmVyeSBMYXlvdXRyZWN0IGhhcyBhbHJlYWR5IGFkanVzdCB0aGVpciBvcmlnaW4gYWNjb3JkaW5nIHRvIGlmcmFtZVxuICAvLyByZWN0IG9yaWdpbi4gTGF5b3V0UmVjdCBwb3NpdGlvbiBpcyByZWxhdGl2ZSB0byBpZnJhbWUgb3JpZ2luLFxuICAvLyB0aHVzIHJlbGF0aXZlIHRvIGlmcmFtZSdzIHZpZXdwb3J0IG9yaWdpbiBiZWNhdXNlIHRoZSB2aWV3cG9ydCBpcyBhdCB0aGVcbiAgLy8gaWZyYW1lIG9yaWdpbi4gTm8gbmVlZCB0byBhZGp1c3QgcG9zaXRpb24gaGVyZS5cblxuICBpZiAoaG9zdFZpZXdwb3J0KSB7XG4gICAgLy8gSWYgZWxlbWVudCBub3QgaW4gYW4gaWZyYW1lLlxuICAgIC8vIGFkanVzdCBhbGwgTGF5b3V0UmVjdCB0byBob3N0Vmlld3BvcnQgT3JpZ2luLlxuICAgIHJvb3RCb3VuZHMgPSAvKiogQHR5cGUgeyEuL2xheW91dC1yZWN0LkxheW91dFJlY3REZWZ9ICovIChyb290Qm91bmRzKTtcbiAgICBpbnRlcnNlY3Rpb24gPSBtb3ZlTGF5b3V0UmVjdChpbnRlcnNlY3Rpb24sIC1ob3N0Vmlld3BvcnQubGVmdCxcbiAgICAgICAgLWhvc3RWaWV3cG9ydC50b3ApO1xuICAgIC8vIFRoZSBlbGVtZW50IGlzIHJlbGF0aXZlIHRvICgwLCAwKSwgd2hpbGUgdGhlIHZpZXdwb3J0IG1vdmVzLiBTbywgd2UgbXVzdFxuICAgIC8vIGFkanVzdC5cbiAgICBib3VuZGluZ0NsaWVudFJlY3QgPSBtb3ZlTGF5b3V0UmVjdChib3VuZGluZ0NsaWVudFJlY3QsXG4gICAgICAgIC1ob3N0Vmlld3BvcnQubGVmdCwgLWhvc3RWaWV3cG9ydC50b3ApO1xuICAgIC8vIE5vdywgbW92ZSB0aGUgdmlld3BvcnQgdG8gKDAsIDApXG4gICAgcm9vdEJvdW5kcyA9IG1vdmVMYXlvdXRSZWN0KHJvb3RCb3VuZHMsXG4gICAgICAgIC1ob3N0Vmlld3BvcnQubGVmdCwgLWhvc3RWaWV3cG9ydC50b3ApO1xuICB9XG5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUludGVyc2VjdGlvbk9ic2VydmVyRW50cnl9ICovICh7XG4gICAgdGltZTogKHR5cGVvZiBwZXJmb3JtYW5jZSAhPT0gJ3VuZGVmaW5lZCcgJiYgcGVyZm9ybWFuY2Uubm93KSA/XG4gICAgICBwZXJmb3JtYW5jZS5ub3coKSA6IERhdGUubm93KCkgLSBJTklUX1RJTUUsXG4gICAgcm9vdEJvdW5kcyxcbiAgICBib3VuZGluZ0NsaWVudFJlY3QsXG4gICAgaW50ZXJzZWN0aW9uUmVjdDogaW50ZXJzZWN0aW9uLFxuICAgIGludGVyc2VjdGlvblJhdGlvOiByYXRpbyxcbiAgfSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFRoaXMgbW9kdWxlIGRlY2xhcmVzIEpTT04gdHlwZXMgYXMgZGVmaW5lZCBpbiB0aGVcbiAqIHtAbGluayBodHRwOi8vanNvbi5vcmcvfS5cbiAqL1xuXG5pbXBvcnQge2lzT2JqZWN0fSBmcm9tICcuL3R5cGVzJztcblxuXG4vLyBOT1RFIFR5cGUgYXJlIGNoYW5nZWQgdG8geyp9IGJlY2F1c2Ugb2Zcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1jb21waWxlci9pc3N1ZXMvMTk5OVxuXG4vKipcbiAqIEpTT04gc2NhbGFyLiBJdCdzIGVpdGhlciBzdHJpbmcsIG51bWJlciBvciBib29sZWFuLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSBzdHJpbmd8bnVtYmVyfGJvb2xlYW5cbiAqL1xubGV0IEpTT05TY2FsYXJEZWY7XG5cblxuLyoqXG4gKiBKU09OIG9iamVjdC4gSXQncyBhIG1hcCB3aXRoIHN0cmluZyBrZXlzIGFuZCBKU09OIHZhbHVlcy5cbiAqIEB0eXBlZGVmIHsqfSBzaG91bGQgYmUgIU9iamVjdDxzdHJpbmcsID9KU09OVmFsdWVEZWY+XG4gKi9cbmxldCBKU09OT2JqZWN0RGVmO1xuXG5cbi8qKlxuICogSlNPTiBhcnJheS4gSXQncyBhbiBhcnJheSB3aXRoIEpTT04gdmFsdWVzLlxuICogQHR5cGVkZWYgeyp9IHNob3VsZCBiZSAhQXJyYXk8P0pTT05WYWx1ZURlZj5cbiAqL1xubGV0IEpTT05BcnJheURlZjtcblxuXG4vKipcbiAqIEpTT04gdmFsdWUuIEl0J3MgZWl0aGVyIGEgc2NhbGFyLCBhbiBvYmplY3Qgb3IgYW4gYXJyYXkuXG4gKiBAdHlwZWRlZiB7Kn0gc2hvdWxkIGJlICFKU09OU2NhbGFyRGVmfCFKU09OT2JqZWN0RGVmfCFKU09OQXJyYXlEZWZcbiAqL1xubGV0IEpTT05WYWx1ZURlZjtcblxuLyoqXG4gKiBSZWNyZWF0ZXMgb2JqZWN0cyB3aXRoIHByb3RvdHlwZS1sZXNzIGNvcGllcy5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3R9IG9ialxuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWNyZWF0ZU5vblByb3RvT2JqZWN0KG9iaikge1xuICBjb25zdCBjb3B5ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgIGlmICghaGFzT3duUHJvcGVydHkob2JqLCBrKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHYgPSBvYmpba107XG4gICAgY29weVtrXSA9IGlzT2JqZWN0KHYpID8gcmVjcmVhdGVOb25Qcm90b09iamVjdCh2KSA6IHY7XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChjb3B5KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZnJvbSBhbiBvYmplY3QgZm9yIGEgZmllbGQtYmFzZWQgZXhwcmVzc2lvbi4gVGhlIGV4cHJlc3Npb25cbiAqIGlzIGEgc2ltcGxlIG5lc3RlZCBkb3Qtbm90YXRpb24gb2YgZmllbGRzLCBzdWNoIGFzIGBmaWVsZDEuZmllbGQyYC4gSWYgYW55XG4gKiBmaWVsZCBpbiBhIGNoYWluIGRvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCBhbiBvYmplY3Qgb3IgYXJyYXksIHRoZSByZXR1cm5lZFxuICogdmFsdWUgd2lsbCBiZSBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAcGFyYW0geyFKc29uT2JqZWN0fSBvYmpcbiAqIEBwYXJhbSB7c3RyaW5nfSBleHByXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWVGb3JFeHByKG9iaiwgZXhwcikge1xuICAvLyBUaGUgYC5gIGluZGljYXRlcyBcInRoZSBvYmplY3QgaXRzZWxmXCIuXG4gIGlmIChleHByID09ICcuJykge1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgLy8gT3RoZXJ3aXNlLCBuYXZpZ2F0ZSB2aWEgcHJvcGVydGllcy5cbiAgY29uc3QgcGFydHMgPSBleHByLnNwbGl0KCcuJyk7XG4gIGxldCB2YWx1ZSA9IG9iajtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTtcbiAgICBpZiAocGFydCAmJlxuICAgICAgICB2YWx1ZSAmJlxuICAgICAgICB2YWx1ZVtwYXJ0XSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIGhhc093blByb3BlcnR5KHZhbHVlLCBwYXJ0KVxuICAgICkge1xuICAgICAgdmFsdWUgPSB2YWx1ZVtwYXJ0XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICBicmVhaztcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIEpTT04ucGFyc2UgdGhhdCBjYXN0cyB0aGUgcmV0dXJuIHZhbHVlXG4gKiB0byBKc29uT2JqZWN0LlxuICogQ3JlYXRlIGEgbmV3IHdyYXBwZXIgaWYgYW4gYXJyYXkgcmV0dXJuIHZhbHVlIGlzIGRlc2lyZWQuXG4gKiBAcGFyYW0geyp9IGpzb24gSlNPTiBzdHJpbmcgdG8gcGFyc2VcbiAqIEByZXR1cm4gez9Kc29uT2JqZWN0fSBNYXkgYmUgZXh0ZW5kIHRvIHBhcnNlIGFycmF5cy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSnNvbihqc29uKSB7XG4gIHJldHVybiAvKiogQHR5cGUgez9Kc29uT2JqZWN0fSAqLyhKU09OLnBhcnNlKC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAoanNvbikpKTtcbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIGdpdmVuIGBqc29uYCBzdHJpbmcgd2l0aG91dCB0aHJvd2luZyBhbiBleGNlcHRpb24gaWYgbm90IHZhbGlkLlxuICogUmV0dXJucyBgdW5kZWZpbmVkYCBpZiBwYXJzaW5nIGZhaWxzLlxuICogUmV0dXJucyB0aGUgYE9iamVjdGAgY29ycmVzcG9uZGluZyB0byB0aGUgSlNPTiBzdHJpbmcgd2hlbiBwYXJzaW5nIHN1Y2NlZWRzLlxuICogQHBhcmFtIHsqfSBqc29uIEpTT04gc3RyaW5nIHRvIHBhcnNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCFFcnJvcik9fSBvcHRfb25GYWlsZWQgT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZFxuICogICAgIHdpdGggdGhlIGVycm9yIGlmIHBhcnNpbmcgZmFpbHMuXG4gKiBAcmV0dXJuIHs/SnNvbk9iamVjdHx1bmRlZmluZWR9IE1heSBiZSBleHRlbmQgdG8gcGFyc2UgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5UGFyc2VKc29uKGpzb24sIG9wdF9vbkZhaWxlZCkge1xuICB0cnkge1xuICAgIHJldHVybiBwYXJzZUpzb24oanNvbik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAob3B0X29uRmFpbGVkKSB7XG4gICAgICBvcHRfb25GYWlsZWQoZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWN1cnNpdmVseSBjaGVja3Mgc3RyaWN0IGVxdWFsaXR5IG9mIGl0ZW1zIGluIG5lc3RlZCBhcnJheXMgYW5kIG9iamVjdHMuXG4gKlxuICogQHBhcmFtIHtKU09OVmFsdWVEZWZ9IGFcbiAqIEBwYXJhbSB7SlNPTlZhbHVlRGVmfSBiXG4gKiBAcGFyYW0ge251bWJlcn0gZGVwdGggVGhlIG1heGltdW0gcmVjdXJzaW9uIGRlcHRoLiBNdXN0IGJlIGZpbml0ZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgZGVwdGggYXJndW1lbnQgaXMgbm90IGZpbml0ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlY3Vyc2l2ZUVxdWFscyhhLCBiLCBkZXB0aCA9IDMpIHtcbiAgaWYgKCFpc0Zpbml0ZShkZXB0aCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2RlcHRoIGFyZyBtdXN0IGJlIGZpbml0ZTogJyArIGRlcHRoKTtcbiAgfVxuICBpZiAoYSA9PT0gYikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIC8vIE9ubHkgY2hlY2sgc2hhbGxvdyBlcXVhbGl0eSBmb3IgZGVwdGggPCAxLlxuICBpZiAoZGVwdGggPCAxKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgYSAhPT0gdHlwZW9mIGIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYSkgJiYgQXJyYXkuaXNBcnJheShiKSkge1xuICAgIGlmIChhLmxlbmd0aCAhPT0gYi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIXJlY3Vyc2l2ZUVxdWFscyhhW2ldLCBiW2ldLCBkZXB0aCAtIDEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKGEgJiYgYiAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGIgPT09ICdvYmplY3QnKSB7XG4gICAgY29uc3Qga2V5c0EgPSBPYmplY3Qua2V5cygvKiogQHR5cGUgeyFPYmplY3R9ICovIChhKSk7XG4gICAgY29uc3Qga2V5c0IgPSBPYmplY3Qua2V5cygvKiogQHR5cGUgeyFPYmplY3R9ICovIChiKSk7XG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5c0EubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGtleUEgPSBrZXlzQVtpXTtcbiAgICAgIGNvbnN0IHZhbHVlQSA9IGFba2V5QV07XG4gICAgICBjb25zdCB2YWx1ZUIgPSBiW2tleUFdO1xuICAgICAgaWYgKCFyZWN1cnNpdmVFcXVhbHModmFsdWVBLCB2YWx1ZUIsIGRlcHRoIC0gMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cblxuLyoqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKG9iaiA9PSBudWxsIHx8IHR5cGVvZiBvYmogIT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChcbiAgICAgIC8qKiBAdHlwZSB7IU9iamVjdH0gKi8gKG9iaiksIGtleSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFRoZSBzdHJ1Y3R1cmUgdGhhdCBjb21iaW5lcyBwb3NpdGlvbiBhbmQgc2l6ZSBmb3IgYW4gZWxlbWVudC4gVGhlIGV4YWN0XG4gKiBpbnRlcnByZXRhdGlvbiBvZiBwb3NpdGlvbiBhbmQgc2l6ZSBkZXBlbmRzIG9uIHRoZSB1c2UgY2FzZS5cbiAqXG4gKiBAdHlwZWRlZiB7e1xuICogICB0b3A6IG51bWJlcixcbiAqICAgYm90dG9tOiBudW1iZXIsXG4gKiAgIGxlZnQ6IG51bWJlcixcbiAqICAgcmlnaHQ6IG51bWJlcixcbiAqICAgd2lkdGg6IG51bWJlcixcbiAqICAgaGVpZ2h0OiBudW1iZXIsXG4gKiAgIHg6IG51bWJlcixcbiAqICAgeTogbnVtYmVyXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IExheW91dFJlY3REZWY7XG5cblxuLyoqXG4gKiBUaGUgc3RydWN0dXJlIHRoYXQgcmVwcmVzZW50cyB0aGUgbWFyZ2lucyBvZiBhbiBFbGVtZW50LlxuICpcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHRvcDogbnVtYmVyLFxuICogICByaWdodDogbnVtYmVyLFxuICogICBib3R0b206IG51bWJlcixcbiAqICAgbGVmdDogbnVtYmVyXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IExheW91dE1hcmdpbnNEZWY7XG5cblxuLyoqXG4gKiBUaGUgc3RydWN0dXJlIHRoYXQgcmVwcmVzZW50cyBhIHJlcXVlc3RlZCBjaGFuZ2UgdG8gdGhlIG1hcmdpbnMgb2YgYW5cbiAqIEVsZW1lbnQuIEFueSBuZXcgdmFsdWVzIHNwZWNpZmllZCB3aWxsIHJlcGxhY2UgZXhpc3Rpbmcgb25lcyAocmF0aGVyIHRoYW5cbiAqIGJlaW5nIGFkZGl0aXZlKS5cbiAqXG4gKiBAdHlwZWRlZiB7e1xuICogICB0b3A6IChudW1iZXJ8dW5kZWZpbmVkKSxcbiAqICAgcmlnaHQ6IChudW1iZXJ8dW5kZWZpbmVkKSxcbiAqICAgYm90dG9tOiAobnVtYmVyfHVuZGVmaW5lZCksXG4gKiAgIGxlZnQ6IChudW1iZXJ8dW5kZWZpbmVkKVxuICogfX1cbiAqL1xuZXhwb3J0IGxldCBMYXlvdXRNYXJnaW5zQ2hhbmdlRGVmO1xuXG4vKipcbiogUmVsYXRpdmVQb3NpdGlvbnNcbipcbiogRGVzY3JpYmVzIHRoZSByZWxhdGl2ZSBwb3NpdGlvbiBvZiBhbiBlbGVtZW50IHRvIGFub3RoZXIgKHdoZXRoZXIgdGhlXG4qIGZpcnN0IGlzIGluc2lkZSB0aGUgc2Vjb25kLCBvbiB0b3Agb2YgdGhlIHNlY29uZCBvciBvbiB0aGUgYm90dG9tXG4qIEBlbnVtIHtzdHJpbmd9XG4qL1xuZXhwb3J0IGNvbnN0IFJlbGF0aXZlUG9zaXRpb25zID0ge1xuICBJTlNJREU6ICdpbnNpZGUnLFxuICBUT1A6ICd0b3AnLFxuICBCT1RUT006ICdib3R0b20nLFxufTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgbGF5b3V0IHJlY3QgYmFzZWQgb24gdGhlIGxlZnQsIHRvcCwgd2lkdGggYW5kIGhlaWdodCBwYXJhbWV0ZXJzXG4gKiBpbiB0aGF0IG9yZGVyLlxuICogQHBhcmFtIHtudW1iZXJ9IGxlZnRcbiAqIEBwYXJhbSB7bnVtYmVyfSB0b3BcbiAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICogQHJldHVybiB7IUxheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0THR3aChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHtcbiAgcmV0dXJuIHtcbiAgICBsZWZ0LFxuICAgIHRvcCxcbiAgICB3aWR0aCxcbiAgICBoZWlnaHQsXG4gICAgYm90dG9tOiB0b3AgKyBoZWlnaHQsXG4gICAgcmlnaHQ6IGxlZnQgKyB3aWR0aCxcbiAgICB4OiBsZWZ0LFxuICAgIHk6IHRvcCxcbiAgfTtcbn1cblxuXG4vKipcbiAqIENyZWF0ZXMgYSBsYXlvdXQgcmVjdCBiYXNlZCBvbiB0aGUgRE9NUmVjdCwgZS5nLiBvYnRhaW5lZCBmcm9tIGNhbGxpbmdcbiAqIGdldEJvdW5kaW5nQ2xpZW50UmVjdC5cbiAqIEBwYXJhbSB7IUNsaWVudFJlY3R9IHJlY3RcbiAqIEByZXR1cm4geyFMYXlvdXRSZWN0RGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdEZyb21Eb21SZWN0KHJlY3QpIHtcbiAgcmV0dXJuIGxheW91dFJlY3RMdHdoKE51bWJlcihyZWN0LmxlZnQpLCBOdW1iZXIocmVjdC50b3ApLFxuICAgICAgTnVtYmVyKHJlY3Qud2lkdGgpLCBOdW1iZXIocmVjdC5oZWlnaHQpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHNwZWNpZmllZCB0d28gcmVjdHMgb3ZlcmxhcCBieSBhIHNpbmdsZSBwaXhlbC5cbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIxXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByMlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxheW91dFJlY3RzT3ZlcmxhcChyMSwgcjIpIHtcbiAgcmV0dXJuIChyMS50b3AgPD0gcjIuYm90dG9tICYmIHIyLnRvcCA8PSByMS5ib3R0b20gJiZcbiAgICAgIHIxLmxlZnQgPD0gcjIucmlnaHQgJiYgcjIubGVmdCA8PSByMS5yaWdodCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbnRlcnNlY3Rpb24gYmV0d2VlbiBhLCBiIG9yIG51bGwgaWYgdGhlcmUgaXMgbm9uZS5cbiAqIEBwYXJhbSB7Li4uP0xheW91dFJlY3REZWZ8dW5kZWZpbmVkfSB2YXJfYXJnc1xuICogQHJldHVybiB7P0xheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWN0SW50ZXJzZWN0aW9uKHZhcl9hcmdzKSB7XG4gIGxldCB4MCA9IC1JbmZpbml0eTtcbiAgbGV0IHgxID0gSW5maW5pdHk7XG4gIGxldCB5MCA9IC1JbmZpbml0eTtcbiAgbGV0IHkxID0gSW5maW5pdHk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY3VycmVudCA9IGFyZ3VtZW50c1tpXTtcbiAgICBpZiAoIWN1cnJlbnQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB4MCA9IE1hdGgubWF4KHgwLCBjdXJyZW50LmxlZnQpO1xuICAgIHgxID0gTWF0aC5taW4oeDEsIGN1cnJlbnQubGVmdCArIGN1cnJlbnQud2lkdGgpO1xuICAgIHkwID0gTWF0aC5tYXgoeTAsIGN1cnJlbnQudG9wKTtcbiAgICB5MSA9IE1hdGgubWluKHkxLCBjdXJyZW50LnRvcCArIGN1cnJlbnQuaGVpZ2h0KTtcbiAgICBpZiAoeDEgPCB4MCB8fCB5MSA8IHkwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cbiAgaWYgKHgxID09IEluZmluaXR5KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIGxheW91dFJlY3RMdHdoKHgwLCB5MCwgeDEgLSB4MCwgeTEgLSB5MCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgcG9zaXRpb24gb2YgcjIgcmVsYXRpdmUgdG8gcjFcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHIxXG4gKiBAcGFyYW0geyFMYXlvdXRSZWN0RGVmfSByMlxuICogQHJldHVybiB7UmVsYXRpdmVQb3NpdGlvbnN9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsYXlvdXRSZWN0c1JlbGF0aXZlUG9zKHIxLCByMikge1xuICBpZiAocjEudG9wIDwgcjIudG9wKSB7XG4gICAgcmV0dXJuIFJlbGF0aXZlUG9zaXRpb25zLlRPUDtcbiAgfSBlbHNlIGlmIChyMS5ib3R0b20gPiByMi5ib3R0b20pIHtcbiAgICByZXR1cm4gUmVsYXRpdmVQb3NpdGlvbnMuQk9UVE9NO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBSZWxhdGl2ZVBvc2l0aW9ucy5JTlNJREU7XG4gIH1cbn1cblxuLyoqXG4gKiBFeHBhbmQgdGhlIGxheW91dCByZWN0IHVzaW5nIG11bHRpcGxlcyBvZiB3aWR0aCBhbmQgaGVpZ2h0LlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcmVjdCBPcmlnaW5hbCByZWN0LlxuICogQHBhcmFtIHtudW1iZXJ9IGR3IEV4cGFuc2lvbiBpbiB3aWR0aCwgc3BlY2lmaWVkIGFzIGEgbXVsdGlwbGUgb2Ygd2lkdGguXG4gKiBAcGFyYW0ge251bWJlcn0gZGggRXhwYW5zaW9uIGluIGhlaWdodCwgc3BlY2lmaWVkIGFzIGEgbXVsdGlwbGUgb2YgaGVpZ2h0LlxuICogQHJldHVybiB7IUxheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmRMYXlvdXRSZWN0KHJlY3QsIGR3LCBkaCkge1xuICByZXR1cm4gbGF5b3V0UmVjdEx0d2gocmVjdC5sZWZ0IC0gcmVjdC53aWR0aCAqIGR3LFxuICAgICAgcmVjdC50b3AgLSByZWN0LmhlaWdodCAqIGRoLFxuICAgICAgcmVjdC53aWR0aCAqICgxICsgZHcgKiAyKSxcbiAgICAgIHJlY3QuaGVpZ2h0ICogKDEgKyBkaCAqIDIpKTtcbn1cblxuLyoqXG4gKiBNb3ZlcyB0aGUgbGF5b3V0IHJlY3QgdXNpbmcgZHggYW5kIGR5LlxuICogQHBhcmFtIHshTGF5b3V0UmVjdERlZn0gcmVjdCBPcmlnaW5hbCByZWN0LlxuICogQHBhcmFtIHtudW1iZXJ9IGR4IE1vdmUgaG9yaXpvbnRhbGx5IHdpdGggdGhpcyB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSBkeSBNb3ZlIHZlcnRpY2FsbHkgd2l0aCB0aGlzIHZhbHVlLlxuICogQHJldHVybiB7IUxheW91dFJlY3REZWZ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlTGF5b3V0UmVjdChyZWN0LCBkeCwgZHkpIHtcbiAgaWYgKChkeCA9PSAwICYmIGR5ID09IDApIHx8XG4gICAgICAocmVjdC53aWR0aCA9PSAwICYmIHJlY3QuaGVpZ2h0ID09IDApKSB7XG4gICAgcmV0dXJuIHJlY3Q7XG4gIH1cbiAgcmV0dXJuIGxheW91dFJlY3RMdHdoKHJlY3QubGVmdCArIGR4LCByZWN0LnRvcCArIGR5LFxuICAgICAgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTGF5b3V0TWFyZ2luc0RlZn0gbWFyZ2luc1xuICogQHBhcmFtIHshTGF5b3V0TWFyZ2luc0NoYW5nZURlZn0gY2hhbmdlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlTWFyZ2luc0NoYW5nZWQobWFyZ2lucywgY2hhbmdlKSB7XG4gIHJldHVybiAoY2hhbmdlLnRvcCAhPT0gdW5kZWZpbmVkICYmIGNoYW5nZS50b3AgIT0gbWFyZ2lucy50b3ApIHx8XG4gICAgICAoY2hhbmdlLnJpZ2h0ICE9PSB1bmRlZmluZWQgJiYgY2hhbmdlLnJpZ2h0ICE9IG1hcmdpbnMucmlnaHQpIHx8XG4gICAgICAoY2hhbmdlLmJvdHRvbSAhPT0gdW5kZWZpbmVkICYmIGNoYW5nZS5ib3R0b20gIT0gbWFyZ2lucy5ib3R0b20pIHx8XG4gICAgICAoY2hhbmdlLmxlZnQgIT09IHVuZGVmaW5lZCAmJiBjaGFuZ2UubGVmdCAhPSBtYXJnaW5zLmxlZnQpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IGZyb21cbiAqIEBwYXJhbSB7IUxheW91dFJlY3REZWZ9IHRvXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdFNpemVFcXVhbHMoZnJvbSwgdG8pIHtcbiAgcmV0dXJuIGZyb20ud2lkdGggPT0gdG8ud2lkdGggJiZcbiAgICAgIGZyb20uaGVpZ2h0ID09PSB0by5oZWlnaHQ7XG59XG5cbi8qKlxuICogQHBhcmFtIHs/TGF5b3V0UmVjdERlZn0gcjFcbiAqIEBwYXJhbSB7P0xheW91dFJlY3REZWZ9IHIyXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0UmVjdEVxdWFscyhyMSwgcjIpIHtcbiAgaWYgKCFyMSB8fCAhcjIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHIxLmxlZnQgPT0gcjIubGVmdCAmJiByMS50b3AgPT0gcjIudG9wICYmXG4gICAgICByMS53aWR0aCA9PSByMi53aWR0aCAmJiByMS5oZWlnaHQgPT0gcjIuaGVpZ2h0O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBJbXBsZW1lbnRzIGVsZW1lbnQgbGF5b3V0LiBTZWUgaHR0cHM6Ly9nb28uZ2wvOWF2WHVUIGZvclxuICogZGV0YWlscy5cbiAqL1xuXG5pbXBvcnQge2RldiwgdXNlcn0gZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtodG1sRm9yfSBmcm9tICcuL3N0YXRpYy10ZW1wbGF0ZSc7XG5pbXBvcnQge2lzRmluaXRlTnVtYmVyfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7c2V0U3R5bGUsIHNldFN0eWxlc30gZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQge3N0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcblxuLyoqXG4gKiBAZW51bSB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgTGF5b3V0ID0ge1xuICBOT0RJU1BMQVk6ICdub2Rpc3BsYXknLFxuICBGSVhFRDogJ2ZpeGVkJyxcbiAgRklYRURfSEVJR0hUOiAnZml4ZWQtaGVpZ2h0JyxcbiAgUkVTUE9OU0lWRTogJ3Jlc3BvbnNpdmUnLFxuICBDT05UQUlORVI6ICdjb250YWluZXInLFxuICBGSUxMOiAnZmlsbCcsXG4gIEZMRVhfSVRFTTogJ2ZsZXgtaXRlbScsXG4gIEZMVUlEOiAnZmx1aWQnLFxuICBJTlRSSU5TSUM6ICdpbnRyaW5zaWMnLFxufTtcblxuXG4vKipcbiAqIExheW91dCBwcmlvcml0aWVzIHRvIHVzZSB3aXRoIEJhc2VFbGVtZW50I2dldExheW91dFByaW9yaXR5KCkgYW5kXG4gKiBCYXNlRWxlbWVudCN1cGRhdGVMYXlvdXRQcmlvcml0eSgpLlxuICogQGVudW0ge251bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IExheW91dFByaW9yaXR5ID0ge1xuICBDT05URU5UOiAwLFxuICBNRVRBREFUQTogMSxcbiAgQURTOiAyLFxuICBCQUNLR1JPVU5EOiAzLFxufTtcblxuXG4vKipcbiAqIENTUyBMZW5ndGggdHlwZS4gRS5nLiBcIjFweFwiIG9yIFwiMjB2aFwiLlxuICogQHR5cGVkZWYge3N0cmluZ31cbiAqL1xuZXhwb3J0IGxldCBMZW5ndGhEZWY7XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogICB3aWR0aDogc3RyaW5nLFxuICogICBoZWlnaHQ6IHN0cmluZ1xuICogfX1cbiAqL1xubGV0IERpbWVuc2lvbnNEZWY7XG5cblxuLyoqXG4gKiBUaGUgc2V0IG9mIGVsZW1lbnRzIHdpdGggbmF0dXJhbCBkaW1lbnNpb25zLCB0aGF0IGlzLCBlbGVtZW50c1xuICogd2hpY2ggaGF2ZSBhIGtub3duIGRpbWVuc2lvbiBlaXRoZXIgYmFzZWQgb24gdGhlaXIgdmFsdWUgc3BlY2lmaWVkIGhlcmUsXG4gKiBvciwgaWYgdGhlIHZhbHVlIGlzIG51bGwsIGEgZGltZW5zaW9uIHNwZWNpZmljIHRvIHRoZSBicm93c2VyLlxuICogYGhhc05hdHVyYWxEaW1lbnNpb25zYCBjaGVja3MgZm9yIG1lbWJlcnNoaXAgaW4gdGhpcyBzZXQuXG4gKiBgZ2V0TmF0dXJhbERpbWVuc2lvbnNgIGRldGVybWluZXMgdGhlIGRpbWVuc2lvbnMgZm9yIGFuIGVsZW1lbnQgaW4gdGhlXG4gKiAgICBzZXQgYW5kIGNhY2hlcyBpdC5cbiAqIEB0eXBlIHshT2JqZWN0PHN0cmluZywgP0RpbWVuc2lvbnNEZWY+fVxuICogQHByaXZhdGUgIFZpc2libGUgZm9yIHRlc3Rpbmcgb25seSFcbiAqL1xuZXhwb3J0IGNvbnN0IG5hdHVyYWxEaW1lbnNpb25zXyA9IHtcbiAgJ0FNUC1QSVhFTCc6IHt3aWR0aDogJzBweCcsIGhlaWdodDogJzBweCd9LFxuICAnQU1QLUFOQUxZVElDUyc6IHt3aWR0aDogJzFweCcsIGhlaWdodDogJzFweCd9LFxuICAvLyBUT0RPKGR2b3l0ZW5rbyk6IGF1ZGlvIHNob3VsZCBoYXZlIHdpZHRoOmF1dG8uXG4gICdBTVAtQVVESU8nOiBudWxsLFxuICAnQU1QLVNPQ0lBTC1TSEFSRSc6IHt3aWR0aDogJzYwcHgnLCBoZWlnaHQ6ICc0NHB4J30sXG59O1xuXG5cbi8qKlxuICogRWxlbWVudHMgdGhhdCB0aGUgcHJvZ2VzcyBjYW4gYmUgc2hvd24gZm9yLiBUaGlzIHNldCBoYXMgdG8gYmUgZXh0ZXJuYWxpemVkXG4gKiBzaW5jZSB0aGUgZWxlbWVudCdzIGltcGxlbWVudGF0aW9uIG1heSBub3QgYmUgZG93bmxvYWRlZCB5ZXQuXG4gKiBAZW51bSB7Ym9vbGVhbn1cbiAqIEBwcml2YXRlICBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkhXG4gKi9cbmV4cG9ydCBjb25zdCBMT0FESU5HX0VMRU1FTlRTXyA9IHtcbiAgJ0FNUC1BTklNJzogdHJ1ZSxcbiAgJ0FNUC1CUklHSFRDT1ZFJzogdHJ1ZSxcbiAgJ0FNUC1HT09HTEUtRE9DVU1FTlQtRU1CRUQnOiB0cnVlLFxuICAnQU1QLUVNQkVEJzogdHJ1ZSxcbiAgJ0FNUC1GQUNFQk9PSyc6IHRydWUsXG4gICdBTVAtRkFDRUJPT0stQ09NTUVOVFMnOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LLUxJS0UnOiB0cnVlLFxuICAnQU1QLUZBQ0VCT09LLVBBR0UnOiB0cnVlLFxuICAnQU1QLUlGUkFNRSc6IHRydWUsXG4gICdBTVAtSU1HJzogdHJ1ZSxcbiAgJ0FNUC1JTlNUQUdSQU0nOiB0cnVlLFxuICAnQU1QLUxJU1QnOiB0cnVlLFxuICAnQU1QLU9PWUFMQS1QTEFZRVInOiB0cnVlLFxuICAnQU1QLVBJTlRFUkVTVCc6IHRydWUsXG4gICdBTVAtUExBWUJVWlonOiB0cnVlLFxuICAnQU1QLVZJREVPJzogdHJ1ZSxcbiAgJ0FNUC1ZT1VUVUJFJzogdHJ1ZSxcbn07XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gc1xuICogQHJldHVybiB7TGF5b3V0fHVuZGVmaW5lZH0gUmV0dXJucyB1bmRlZmluZWQgaW4gY2FzZSBvZiBmYWlsdXJlIHRvIHBhcnNlXG4gKiAgIHRoZSBsYXlvdXQgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMYXlvdXQocykge1xuICBmb3IgKGNvbnN0IGsgaW4gTGF5b3V0KSB7XG4gICAgaWYgKExheW91dFtrXSA9PSBzKSB7XG4gICAgICByZXR1cm4gTGF5b3V0W2tdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshTGF5b3V0fSBsYXlvdXRcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExheW91dENsYXNzKGxheW91dCkge1xuICByZXR1cm4gJ2ktYW1waHRtbC1sYXlvdXQtJyArIGxheW91dDtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgYW4gZWxlbWVudCB3aXRoIHRoaXMgbGF5b3V0IGluaGVyZW50bHkgZGVmaW5lcyB0aGUgc2l6ZS5cbiAqIEBwYXJhbSB7IUxheW91dH0gbGF5b3V0XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMYXlvdXRTaXplRGVmaW5lZChsYXlvdXQpIHtcbiAgcmV0dXJuIChsYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LkZJWEVEX0hFSUdIVCB8fFxuICAgICAgbGF5b3V0ID09IExheW91dC5SRVNQT05TSVZFIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LkZJTEwgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuRkxFWF9JVEVNIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LkZMVUlEIHx8XG4gICAgICBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQyk7XG59XG5cblxuLyoqXG4gKiBXaGV0aGVyIHRoZSB0YWcgaXMgYW4gaW50ZXJuYWwgKHNlcnZpY2UpIEFNUCB0YWcuXG4gKiBAcGFyYW0geyFOb2RlfHN0cmluZ30gdGFnXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbnRlcm5hbEVsZW1lbnQodGFnKSB7XG4gIGNvbnN0IHRhZ05hbWUgPSAodHlwZW9mIHRhZyA9PSAnc3RyaW5nJykgPyB0YWcgOiB0YWcudGFnTmFtZTtcbiAgcmV0dXJuIHRhZ05hbWUgJiYgc3RhcnRzV2l0aCh0YWdOYW1lLnRvTG93ZXJDYXNlKCksICdpLScpO1xufVxuXG5cbi8qKlxuICogUGFyc2VzIHRoZSBDU1MgbGVuZ3RoIHZhbHVlLiBJZiBubyB1bml0cyBzcGVjaWZpZWQsIHRoZSBhc3N1bWVkIHZhbHVlIGlzXG4gKiBcInB4XCIuIFJldHVybnMgdW5kZWZpbmVkIGluIGNhc2Ugb2YgcGFyc2luZyBlcnJvci5cbiAqIEBwYXJhbSB7c3RyaW5nfHVuZGVmaW5lZHxudWxsfSBzXG4gKiBAcmV0dXJuIHshTGVuZ3RoRGVmfHVuZGVmaW5lZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTGVuZ3RoKHMpIHtcbiAgaWYgKHR5cGVvZiBzID09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIHMgKyAncHgnO1xuICB9XG4gIGlmICghcykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKCEvXlxcZCsoXFwuXFxkKyk/KHB4fGVtfHJlbXx2aHx2d3x2bWlufHZtYXh8Y218bW18cXxpbnxwY3xwdCk/JC8udGVzdChzKSkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgaWYgKC9eXFxkKyhcXC5cXGQrKT8kLy50ZXN0KHMpKSB7XG4gICAgcmV0dXJuIHMgKyAncHgnO1xuICB9XG4gIHJldHVybiBzO1xufVxuXG5cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgdGhlIHN1cHBsaWVkIHZhbHVlIGlzIGEgbm9uLXBlcmNlbnQgQ1NTIExlbmd0aCB2YWx1ZS5cbiAqIEBwYXJhbSB7IUxlbmd0aERlZnxzdHJpbmd8bnVsbHx1bmRlZmluZWR9IGxlbmd0aFxuICogQHJldHVybiB7IUxlbmd0aERlZn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydExlbmd0aChsZW5ndGgpIHtcbiAgdXNlcigpLmFzc2VydChcbiAgICAgIC9eXFxkKyhcXC5cXGQrKT8ocHh8ZW18cmVtfHZofHZ3fHZtaW58dm1heHxjbXxtbXxxfGlufHBjfHB0KSQvLnRlc3QobGVuZ3RoKSxcbiAgICAgICdJbnZhbGlkIGxlbmd0aCB2YWx1ZTogJXMnLCBsZW5ndGgpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshTGVuZ3RoRGVmfSAqLyAobGVuZ3RoKTtcbn1cblxuXG5cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgdGhlIHN1cHBsaWVkIHZhbHVlIGlzIGEgQ1NTIExlbmd0aCB2YWx1ZVxuICogKGluY2x1ZGluZyBwZXJjZW50IHVuaXQpLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ30gbGVuZ3RoXG4gKiBAcmV0dXJuIHshTGVuZ3RoRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0TGVuZ3RoT3JQZXJjZW50KGxlbmd0aCkge1xuICB1c2VyKCkuYXNzZXJ0KC9eXFxkKyhcXC5cXGQrKT8ocHh8ZW18cmVtfHZofHZ3fHZtaW58dm1heHwlKSQvLnRlc3QobGVuZ3RoKSxcbiAgICAgICdJbnZhbGlkIGxlbmd0aCBvciBwZXJjZW50IHZhbHVlOiAlcycsIGxlbmd0aCk7XG4gIHJldHVybiBsZW5ndGg7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHVuaXRzIGZyb20gdGhlIENTUyBsZW5ndGggdmFsdWUuXG4gKiBAcGFyYW0geyFMZW5ndGhEZWZ8c3RyaW5nfG51bGx8dW5kZWZpbmVkfSBsZW5ndGhcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExlbmd0aFVuaXRzKGxlbmd0aCkge1xuICBhc3NlcnRMZW5ndGgobGVuZ3RoKTtcbiAgZGV2KCkuYXNzZXJ0U3RyaW5nKGxlbmd0aCk7XG4gIGNvbnN0IG0gPSB1c2VyKCkuYXNzZXJ0KGxlbmd0aC5tYXRjaCgvW2Etel0rL2kpLFxuICAgICAgJ0ZhaWxlZCB0byByZWFkIHVuaXRzIGZyb20gJXMnLCBsZW5ndGgpO1xuICByZXR1cm4gbVswXTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIG51bWVyaWMgdmFsdWUgb2YgYSBDU1MgbGVuZ3RoIHZhbHVlLlxuICogQHBhcmFtIHshTGVuZ3RoRGVmfHN0cmluZ3xudWxsfHVuZGVmaW5lZH0gbGVuZ3RoXG4gKiBAcmV0dXJuIHtudW1iZXJ8dW5kZWZpbmVkfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGVuZ3RoTnVtZXJhbChsZW5ndGgpIHtcbiAgY29uc3QgcmVzID0gcGFyc2VGbG9hdChsZW5ndGgpO1xuICByZXR1cm4gaXNGaW5pdGVOdW1iZXIocmVzKSA/IHJlcyA6IHVuZGVmaW5lZDtcbn1cblxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciB0aGUgdGFnTmFtZSBpcyBhIGtub3duIGVsZW1lbnQgdGhhdCBoYXMgbmF0dXJhbCBkaW1lbnNpb25zXG4gKiBpbiBvdXIgcnVudGltZSBvciB0aGUgYnJvd3Nlci5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0YWdOYW1lIFRoZSBlbGVtZW50IHRhZyBuYW1lLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc05hdHVyYWxEaW1lbnNpb25zKHRhZ05hbWUpIHtcbiAgdGFnTmFtZSA9IHRhZ05hbWUudG9VcHBlckNhc2UoKTtcbiAgcmV0dXJuIG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyB0aGUgZGVmYXVsdCBkaW1lbnNpb25zIGZvciBhbiBlbGVtZW50IHdoaWNoIGNvdWxkIHZhcnkgYWNyb3NzXG4gKiBkaWZmZXJlbnQgYnJvd3NlciBpbXBsZW1lbnRhdGlvbnMsIGxpa2UgPGF1ZGlvPiBmb3IgaW5zdGFuY2UuXG4gKiBUaGlzIG9wZXJhdGlvbiBjYW4gb25seSBiZSBjb21wbGV0ZWQgZm9yIGFuIGVsZW1lbnQgd2hpdGVsaXN0ZWQgYnlcbiAqIGBoYXNOYXR1cmFsRGltZW5zaW9uc2AuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtEaW1lbnNpb25zRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmF0dXJhbERpbWVuc2lvbnMoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIGRldigpLmFzc2VydChuYXR1cmFsRGltZW5zaW9uc19bdGFnTmFtZV0gIT09IHVuZGVmaW5lZCk7XG4gIGlmICghbmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdKSB7XG4gICAgY29uc3QgZG9jID0gZWxlbWVudC5vd25lckRvY3VtZW50O1xuICAgIGNvbnN0IG5hdHVyYWxUYWdOYW1lID0gdGFnTmFtZS5yZXBsYWNlKC9eQU1QXFwtLywgJycpO1xuICAgIGNvbnN0IHRlbXAgPSBkb2MuY3JlYXRlRWxlbWVudChuYXR1cmFsVGFnTmFtZSk7XG4gICAgLy8gRm9yIGF1ZGlvLCBzaG91bGQgbm8tb3AgZWxzZXdoZXJlLlxuICAgIHRlbXAuY29udHJvbHMgPSB0cnVlO1xuICAgIHNldFN0eWxlcyh0ZW1wLCB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nLFxuICAgIH0pO1xuICAgIGRvYy5ib2R5LmFwcGVuZENoaWxkKHRlbXApO1xuICAgIG5hdHVyYWxEaW1lbnNpb25zX1t0YWdOYW1lXSA9IHtcbiAgICAgIHdpZHRoOiAodGVtcC4vKk9LKi9vZmZzZXRXaWR0aCB8fCAxKSArICdweCcsXG4gICAgICBoZWlnaHQ6ICh0ZW1wLi8qT0sqL29mZnNldEhlaWdodCB8fCAxKSArICdweCcsXG4gICAgfTtcbiAgICBkb2MuYm9keS5yZW1vdmVDaGlsZCh0ZW1wKTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHtEaW1lbnNpb25zRGVmfSAqLyAobmF0dXJhbERpbWVuc2lvbnNfW3RhZ05hbWVdKTtcbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGxvYWRpbmcgY2FuIGJlIHNob3duIGZvciB0aGUgc3BlY2lmaWVkIGVsZW1lZW50LiBUaGlzIHNldCBoYXNcbiAqIHRvIGJlIGV4dGVybmFsaXplZCBzaW5jZSB0aGUgZWxlbWVudCdzIGltcGxlbWVudGF0aW9uIG1heSBub3QgYmVcbiAqIGRvd25sb2FkZWQgeWV0LlxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZGluZ0FsbG93ZWQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lLnRvVXBwZXJDYXNlKCk7XG4gIGlmICh0YWdOYW1lID09ICdBTVAtQUQnIHx8IHRhZ05hbWUgPT0gJ0FNUC1FTUJFRCcpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gTE9BRElOR19FTEVNRU5UU19bdGFnTmFtZV0gfHwgZmFsc2U7XG59XG5cblxuLyoqXG4gKiBBcHBsaWVzIGxheW91dCB0byB0aGUgZWxlbWVudC4gVmlzaWJsZSBmb3IgdGVzdGluZyBvbmx5LlxuICpcbiAqIFxcICAgXFwgIC8gIFxcICAvICAgLyAvICAgXFwgICAgIHwgICBfICBcXCAgICAgfCAgXFwgfCAgfCB8ICB8IHwgIFxcIHwgIHwgIC8gX19fX198XG4gKiAgXFwgICBcXC8gICAgXFwvICAgLyAvICBeICBcXCAgICB8ICB8XykgIHwgICAgfCAgIFxcfCAgfCB8ICB8IHwgICBcXHwgIHwgfCAgfCAgX19cbiAqICAgXFwgICAgICAgICAgICAvIC8gIC9fXFwgIFxcICAgfCAgICAgIC8gICAgIHwgIC4gYCAgfCB8ICB8IHwgIC4gYCAgfCB8ICB8IHxfIHxcbiAqICAgIFxcICAgIC9cXCAgICAvIC8gIF9fX19fICBcXCAgfCAgfFxcICBcXC0tLS0ufCAgfFxcICAgfCB8ICB8IHwgIHxcXCAgIHwgfCAgfF9ffCB8XG4gKiAgICAgXFxfXy8gIFxcX18vIC9fXy8gICAgIFxcX19cXCB8IF98IGAuX19fX198fF9ffCBcXF9ffCB8X198IHxfX3wgXFxfX3wgIFxcX19fX19ffFxuICpcbiAqIFRoZSBlcXVpdmFsZW50IG9mIHRoaXMgbWV0aG9kIGlzIHVzZWQgZm9yIHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSBhbmRcbiAqIGFueSBjaGFuZ2VzIG1hZGUgdG8gaXQgbXVzdCBiZSBtYWRlIGluIGNvb3JkaW5hdGlvbiB3aXRoIGNhY2hlcyB0aGF0XG4gKiBpbXBsZW1lbnQgU1NSLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBTU1Igc2VlIGJpdC5seS9hbXAtc3NyLlxuICpcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEByZXR1cm4geyFMYXlvdXR9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseVN0YXRpY0xheW91dChlbGVtZW50KSB7XG4gIC8vIENoZWNrIGlmIHRoZSBsYXlvdXQgaGFzIGFscmVhZHkgYmVlbiBkb25lIGJ5IHNlcnZlci1zaWRlIHJlbmRlcmluZy4gVGhlXG4gIC8vIGRvY3VtZW50IG1heSBiZSB2aXNpYmxlIHRvIHRoZSB1c2VyIGlmIHRoZSBib2lsZXJwbGF0ZSB3YXMgcmVtb3ZlZCBzb1xuICAvLyBwbGVhc2UgdGFrZSBjYXJlIGluIG1ha2luZyBjaGFuZ2VzIGhlcmUuXG4gIGNvbnN0IGNvbXBsZXRlZExheW91dEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaS1hbXBodG1sLWxheW91dCcpO1xuICBpZiAoY29tcGxldGVkTGF5b3V0QXR0cikge1xuICAgIGNvbnN0IGxheW91dCA9IC8qKiBAdHlwZSB7IUxheW91dH0gKi8gKGRldigpLmFzc2VydChcbiAgICAgICAgcGFyc2VMYXlvdXQoY29tcGxldGVkTGF5b3V0QXR0cikpKTtcbiAgICBpZiAoKGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fCBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQylcbiAgICAgICYmIGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgIC8vIEZpbmQgc2l6ZXIsIGJ1dCBhc3N1bWUgdGhhdCBpdCBtaWdodCBub3QgaGF2ZSBiZWVuIHBhcnNlZCB5ZXQuXG4gICAgICBlbGVtZW50LnNpemVyRWxlbWVudCA9XG4gICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpLWFtcGh0bWwtc2l6ZXInKSB8fCB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0Lk5PRElTUExBWSkge1xuICAgICAgYXBwbHlOb0Rpc3BsYXlMYXlvdXQoZWxlbWVudCk7XG4gICAgfVxuICAgIHJldHVybiBsYXlvdXQ7XG4gIH1cblxuICAvLyBJZiB0aGUgbGF5b3V0IHdhcyBhbHJlYWR5IGRvbmUgYnkgc2VydmVyLXNpZGUgcmVuZGVyaW5nIChTU1IpLCB0aGVuIHRoZVxuICAvLyBjb2RlIGJlbG93IHdpbGwgbm90IHJ1bi4gQW55IGNoYW5nZXMgYmVsb3cgd2lsbCBuZWNlc3NpdGF0ZSBhIGNoYW5nZSB0byBTU1JcbiAgLy8gYW5kIG11c3QgYmUgY29vcmRpbmF0ZWQgd2l0aCBjYWNoZXMgdGhhdCBpbXBsZW1lbnQgU1NSLiBTZWUgYml0Lmx5L2FtcC1zc3IuXG5cbiAgLy8gUGFyc2UgbGF5b3V0IGZyb20gdGhlIGVsZW1lbnQuXG4gIGNvbnN0IGxheW91dEF0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnbGF5b3V0Jyk7XG4gIGNvbnN0IHdpZHRoQXR0ciA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd3aWR0aCcpO1xuICBjb25zdCBoZWlnaHRBdHRyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2hlaWdodCcpO1xuICBjb25zdCBzaXplc0F0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnc2l6ZXMnKTtcbiAgY29uc3QgaGVpZ2h0c0F0dHIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnaGVpZ2h0cycpO1xuXG4gIC8vIElucHV0IGxheW91dCBhdHRyaWJ1dGVzLlxuICBjb25zdCBpbnB1dExheW91dCA9IGxheW91dEF0dHIgPyBwYXJzZUxheW91dChsYXlvdXRBdHRyKSA6IG51bGw7XG4gIHVzZXIoKS5hc3NlcnQoaW5wdXRMYXlvdXQgIT09IHVuZGVmaW5lZCwgJ1Vua25vd24gbGF5b3V0OiAlcycsIGxheW91dEF0dHIpO1xuICAvKiogQGNvbnN0IHtzdHJpbmd8bnVsbHx1bmRlZmluZWR9ICovXG4gIGNvbnN0IGlucHV0V2lkdGggPSAod2lkdGhBdHRyICYmIHdpZHRoQXR0ciAhPSAnYXV0bycpID9cbiAgICBwYXJzZUxlbmd0aCh3aWR0aEF0dHIpIDogd2lkdGhBdHRyO1xuICB1c2VyKCkuYXNzZXJ0KGlucHV0V2lkdGggIT09IHVuZGVmaW5lZCwgJ0ludmFsaWQgd2lkdGggdmFsdWU6ICVzJywgd2lkdGhBdHRyKTtcbiAgLyoqIEBjb25zdCB7c3RyaW5nfG51bGx8dW5kZWZpbmVkfSAqL1xuICBjb25zdCBpbnB1dEhlaWdodCA9IChoZWlnaHRBdHRyICYmIGhlaWdodEF0dHIgIT0gJ2ZsdWlkJykgP1xuICAgIHBhcnNlTGVuZ3RoKGhlaWdodEF0dHIpIDogaGVpZ2h0QXR0cjtcbiAgdXNlcigpLmFzc2VydChpbnB1dEhlaWdodCAhPT0gdW5kZWZpbmVkLCAnSW52YWxpZCBoZWlnaHQgdmFsdWU6ICVzJyxcbiAgICAgIGhlaWdodEF0dHIpO1xuXG4gIC8vIEVmZmVjdGl2ZSBsYXlvdXQgYXR0cmlidXRlcy4gVGhlc2UgYXJlIGVmZmVjdGl2ZWx5IGNvbnN0YW50cy5cbiAgbGV0IHdpZHRoO1xuICBsZXQgaGVpZ2h0O1xuICBsZXQgbGF5b3V0O1xuXG4gIC8vIENhbGN1bGF0ZSBlZmZlY3RpdmUgd2lkdGggYW5kIGhlaWdodC5cbiAgaWYgKCghaW5wdXRMYXlvdXQgfHwgaW5wdXRMYXlvdXQgPT0gTGF5b3V0LkZJWEVEIHx8XG4gICAgICBpbnB1dExheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSAmJlxuICAgICAgKCFpbnB1dFdpZHRoIHx8ICFpbnB1dEhlaWdodCkgJiYgaGFzTmF0dXJhbERpbWVuc2lvbnMoZWxlbWVudC50YWdOYW1lKSkge1xuICAgIC8vIERlZmF1bHQgd2lkdGggYW5kIGhlaWdodDogaGFuZGxlIGVsZW1lbnRzIHRoYXQgZG8gbm90IHNwZWNpZnkgYVxuICAgIC8vIHdpZHRoL2hlaWdodCBhbmQgYXJlIGRlZmluZWQgdG8gaGF2ZSBuYXR1cmFsIGJyb3dzZXIgZGltZW5zaW9ucy5cbiAgICBjb25zdCBkaW1lbnNpb25zID0gZ2V0TmF0dXJhbERpbWVuc2lvbnMoZWxlbWVudCk7XG4gICAgd2lkdGggPSAoaW5wdXRXaWR0aCB8fCBpbnB1dExheW91dCA9PSBMYXlvdXQuRklYRURfSEVJR0hUKSA/IGlucHV0V2lkdGggOlxuICAgICAgZGltZW5zaW9ucy53aWR0aDtcbiAgICBoZWlnaHQgPSBpbnB1dEhlaWdodCB8fCBkaW1lbnNpb25zLmhlaWdodDtcbiAgfSBlbHNlIHtcbiAgICB3aWR0aCA9IGlucHV0V2lkdGg7XG4gICAgaGVpZ2h0ID0gaW5wdXRIZWlnaHQ7XG4gIH1cblxuICAvLyBDYWxjdWxhdGUgZWZmZWN0aXZlIGxheW91dC5cbiAgaWYgKGlucHV0TGF5b3V0KSB7XG4gICAgbGF5b3V0ID0gaW5wdXRMYXlvdXQ7XG4gIH0gZWxzZSBpZiAoIXdpZHRoICYmICFoZWlnaHQpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuQ09OVEFJTkVSO1xuICB9IGVsc2UgaWYgKGhlaWdodCA9PSAnZmx1aWQnKSB7XG4gICAgbGF5b3V0ID0gTGF5b3V0LkZMVUlEO1xuICB9IGVsc2UgaWYgKGhlaWdodCAmJiAoIXdpZHRoIHx8IHdpZHRoID09ICdhdXRvJykpIHtcbiAgICBsYXlvdXQgPSBMYXlvdXQuRklYRURfSEVJR0hUO1xuICB9IGVsc2UgaWYgKGhlaWdodCAmJiB3aWR0aCAmJiAoc2l6ZXNBdHRyIHx8IGhlaWdodHNBdHRyKSkge1xuICAgIGxheW91dCA9IExheW91dC5SRVNQT05TSVZFO1xuICB9IGVsc2Uge1xuICAgIGxheW91dCA9IExheW91dC5GSVhFRDtcbiAgfVxuXG4gIC8vIFZlcmlmeSBsYXlvdXQgYXR0cmlidXRlcy5cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuRklYRUQgfHwgbGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fCBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIHVzZXIoKS5hc3NlcnQoaGVpZ2h0LCAnRXhwZWN0ZWQgaGVpZ2h0IHRvIGJlIGF2YWlsYWJsZTogJXMnLCBoZWlnaHRBdHRyKTtcbiAgfVxuICBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpIHtcbiAgICB1c2VyKCkuYXNzZXJ0KCF3aWR0aCB8fCB3aWR0aCA9PSAnYXV0bycsXG4gICAgICAgICdFeHBlY3RlZCB3aWR0aCB0byBiZSBlaXRoZXIgYWJzZW50IG9yIGVxdWFsIFwiYXV0b1wiICcgK1xuICAgICAgICAnZm9yIGZpeGVkLWhlaWdodCBsYXlvdXQ6ICVzJywgd2lkdGhBdHRyKTtcbiAgfVxuICBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRCB8fCBsYXlvdXQgPT0gTGF5b3V0LlJFU1BPTlNJVkUgfHxcbiAgICAgIGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgdXNlcigpLmFzc2VydCh3aWR0aCAmJiB3aWR0aCAhPSAnYXV0bycsXG4gICAgICAgICdFeHBlY3RlZCB3aWR0aCB0byBiZSBhdmFpbGFibGUgYW5kIG5vdCBlcXVhbCB0byBcImF1dG9cIjogJXMnLFxuICAgICAgICB3aWR0aEF0dHIpO1xuICB9XG5cbiAgaWYgKGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSB8fCBsYXlvdXQgPT0gTGF5b3V0LklOVFJJTlNJQykge1xuICAgIHVzZXIoKS5hc3NlcnQoZ2V0TGVuZ3RoVW5pdHMod2lkdGgpID09IGdldExlbmd0aFVuaXRzKGhlaWdodCksXG4gICAgICAgICdMZW5ndGggdW5pdHMgc2hvdWxkIGJlIHRoZSBzYW1lIGZvciB3aWR0aCBhbmQgaGVpZ2h0OiAlcywgJXMnLFxuICAgICAgICB3aWR0aEF0dHIsIGhlaWdodEF0dHIpO1xuICB9IGVsc2Uge1xuICAgIHVzZXIoKS5hc3NlcnQoaGVpZ2h0c0F0dHIgPT09IG51bGwsXG4gICAgICAgICdVbmV4cGVjdGVkIFwiaGVpZ2h0c1wiIGF0dHJpYnV0ZSBmb3Igbm9uZS1yZXNwb25zaXZlIGxheW91dCcpO1xuICB9XG5cbiAgLy8gQXBwbHkgVUkuXG4gIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChnZXRMYXlvdXRDbGFzcyhsYXlvdXQpKTtcbiAgaWYgKGlzTGF5b3V0U2l6ZURlZmluZWQobGF5b3V0KSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaS1hbXBodG1sLWxheW91dC1zaXplLWRlZmluZWQnKTtcbiAgfVxuICBpZiAobGF5b3V0ID09IExheW91dC5OT0RJU1BMQVkpIHtcbiAgICAvLyBDU1MgZGVmaW5lcyBsYXlvdXQ9bm9kaXNwbGF5IGF1dG9tYXRpY2FsbHkgd2l0aCBgZGlzcGxheTpub25lYC4gVGh1c1xuICAgIC8vIG5vIGFkZGl0aW9uYWwgc3R5bGluZyBpcyBuZWVkZWQuXG4gICAgYXBwbHlOb0Rpc3BsYXlMYXlvdXQoZWxlbWVudCk7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRCkge1xuICAgIHNldFN0eWxlcyhlbGVtZW50LCB7XG4gICAgICB3aWR0aDogZGV2KCkuYXNzZXJ0U3RyaW5nKHdpZHRoKSxcbiAgICAgIGhlaWdodDogZGV2KCkuYXNzZXJ0U3RyaW5nKGhlaWdodCksXG4gICAgfSk7XG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GSVhFRF9IRUlHSFQpIHtcbiAgICBzZXRTdHlsZShlbGVtZW50LCAnaGVpZ2h0JywgZGV2KCkuYXNzZXJ0U3RyaW5nKGhlaWdodCkpO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuUkVTUE9OU0lWRSkge1xuICAgIGNvbnN0IHNpemVyID0gZWxlbWVudC5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ktYW1waHRtbC1zaXplcicpO1xuICAgIHNldFN0eWxlcyhzaXplciwge1xuICAgICAgZGlzcGxheTogJ2Jsb2NrJyxcbiAgICAgIHBhZGRpbmdUb3A6XG4gICAgICAgICgoZ2V0TGVuZ3RoTnVtZXJhbChoZWlnaHQpIC8gZ2V0TGVuZ3RoTnVtZXJhbCh3aWR0aCkpICogMTAwKSArICclJyxcbiAgICB9KTtcbiAgICBlbGVtZW50Lmluc2VydEJlZm9yZShzaXplciwgZWxlbWVudC5maXJzdENoaWxkKTtcbiAgICBlbGVtZW50LnNpemVyRWxlbWVudCA9IHNpemVyO1xuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuSU5UUklOU0lDKSB7XG4gICAgLy8gSW50cmluc2ljIHVzZXMgYW4gc3ZnIGluc2lkZSB0aGUgc2l6ZXIgZWxlbWVudCByYXRoZXIgdGhhbiB0aGUgcGFkZGluZ1xuICAgIC8vIHRyaWNrIE5vdGUgYSBuYWtlZCBzdmcgd29uJ3Qgd29yayBiZWNhc3VlIG90aGVyIHRoaW5nIGV4cGVjdCB0aGVcbiAgICAvLyBpLWFtcGh0bWwtc2l6ZXIgZWxlbWVudFxuICAgIGNvbnN0IHNpemVyID0gaHRtbEZvcihlbGVtZW50KWBcbiAgICAgIDxpLWFtcGh0bWwtc2l6ZXIgY2xhc3M9XCJpLWFtcGh0bWwtc2l6ZXJcIj5cbiAgICAgICAgPGltZyBjbGFzcz1cImktYW1waHRtbC1pbnRyaW5zaWMtc2l6ZXJcIiAvPlxuICAgICAgPC9pLWFtcGh0bWwtc2l6ZXI+YDtcbiAgICBjb25zdCBpbnRyaW5zaWNTaXplciA9IHNpemVyLmZpcnN0RWxlbWVudENoaWxkO1xuICAgIGludHJpbnNpY1NpemVyLnNldEF0dHJpYnV0ZSgnc3JjJyxcbiAgICAgICAgYGRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04LDxzdmcgaGVpZ2h0PVwiJHtoZWlnaHR9XCIgd2lkdGg9XCIke3dpZHRofVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2ZXJzaW9uPVwiMS4xXCIvPmApO1xuICAgIGVsZW1lbnQuaW5zZXJ0QmVmb3JlKHNpemVyLCBlbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIC8vIFRPRE8oanBldHRpdHQpOiBzaXplciBpcyBsZWFrZWQgYW5kIGNhbid0IGJlIGNsZWFuZWQgdXAuXG4gICAgZWxlbWVudC5zaXplckVsZW1lbnQgPSBpbnRyaW5zaWNTaXplcjtcbiAgfSBlbHNlIGlmIChsYXlvdXQgPT0gTGF5b3V0LkZJTEwpIHtcbiAgICAvLyBEbyBub3RoaW5nLlxuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuQ09OVEFJTkVSKSB7XG4gICAgLy8gRG8gbm90aGluZy4gRWxlbWVudHMgdGhlbXNlbHZlcyB3aWxsIGNoZWNrIHdoZXRoZXIgdGhlIHN1cHBsaWVkXG4gICAgLy8gbGF5b3V0IHZhbHVlIGlzIGFjY2VwdGFibGUuIEluIHBhcnRpY3VsYXIgY29udGFpbmVyIGlzIG9ubHkgT0tcbiAgICAvLyBzb21ldGltZXMuXG4gIH0gZWxzZSBpZiAobGF5b3V0ID09IExheW91dC5GTEVYX0lURU0pIHtcbiAgICAvLyBTZXQgaGVpZ2h0IGFuZCB3aWR0aCB0byBhIGZsZXggaXRlbSBpZiB0aGV5IGV4aXN0LlxuICAgIC8vIFRoZSBzaXplIHNldCB0byBhIGZsZXggaXRlbSBjb3VsZCBiZSBvdmVycmlkZGVuIGJ5IGBkaXNwbGF5OiBmbGV4YCBsYXRlci5cbiAgICBpZiAod2lkdGgpIHtcbiAgICAgIHNldFN0eWxlKGVsZW1lbnQsICd3aWR0aCcsIHdpZHRoKTtcbiAgICB9XG4gICAgaWYgKGhlaWdodCkge1xuICAgICAgc2V0U3R5bGUoZWxlbWVudCwgJ2hlaWdodCcsIGhlaWdodCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGxheW91dCA9PSBMYXlvdXQuRkxVSUQpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ktYW1waHRtbC1sYXlvdXQtYXdhaXRpbmctc2l6ZScpO1xuICAgIGlmICh3aWR0aCkge1xuICAgICAgc2V0U3R5bGUoZWxlbWVudCwgJ3dpZHRoJywgd2lkdGgpO1xuICAgIH1cbiAgICBzZXRTdHlsZShlbGVtZW50LCAnaGVpZ2h0JywgMCk7XG4gIH1cbiAgcmV0dXJuIGxheW91dDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gYXBwbHlOb0Rpc3BsYXlMYXlvdXQoZWxlbWVudCkge1xuICAvLyBUT0RPKGR2b3l0ZW5rbywgIzkzNTMpOiBvbmNlIGB0b2dnbGVMYXlvdXREaXNwbGF5YCBBUEkgaGFzIGJlZW4gZGVwbG95ZWRcbiAgLy8gZXZlcnl3aGVyZSwgc3dpdGNoIGFsbCByZWxldmFudCBlbGVtZW50cyB0byB0aGlzIEFQSS4gSW4gdGhlIG1lYW50aW1lLFxuICAvLyBzaW1wbHkgdW5ibG9jayBkaXNwbGF5IHRvZ2dsaW5nIHZpYSBgc3R5bGU9XCJkaXNwbGF5OiAuLi5cImAuXG4gIHNldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5JywgJ25vbmUnKTtcbiAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpLWFtcGh0bWwtZGlzcGxheScpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcbmltcG9ydCB7Z2V0TW9kZU9iamVjdH0gZnJvbSAnLi9tb2RlLW9iamVjdCc7XG5pbXBvcnQge2lzRW51bVZhbHVlfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBUcmlwbGUgemVybyB3aWR0aCBzcGFjZS5cbiAqXG4gKiBUaGlzIGlzIGFkZGVkIHRvIHVzZXIgZXJyb3IgbWVzc2FnZXMsIHNvIHRoYXQgd2UgY2FuIGxhdGVyIGlkZW50aWZ5XG4gKiB0aGVtLCB3aGVuIHRoZSBvbmx5IHRoaW5nIHRoYXQgd2UgaGF2ZSBpcyB0aGUgbWVzc2FnZS4gVGhpcyBpcyB0aGVcbiAqIGNhc2UgaW4gbWFueSBicm93c2VycyB3aGVuIHRoZSBnbG9iYWwgZXhjZXB0aW9uIGhhbmRsZXIgaXMgaW52b2tlZC5cbiAqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IFVTRVJfRVJST1JfU0VOVElORUwgPSAnXFx1MjAwQlxcdTIwMEJcXHUyMDBCJztcblxuXG4vKipcbiAqIEZvdXIgemVybyB3aWR0aCBzcGFjZS5cbiAqXG4gKiBAY29uc3Qge3N0cmluZ31cbiAqL1xuZXhwb3J0IGNvbnN0IFVTRVJfRVJST1JfRU1CRURfU0VOVElORUwgPSAnXFx1MjAwQlxcdTIwMEJcXHUyMDBCXFx1MjAwQic7XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIG1lc3NhZ2Ugd2FzIGEgdXNlciBlcnJvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVXNlckVycm9yTWVzc2FnZShtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoVVNFUl9FUlJPUl9TRU5USU5FTCkgPj0gMDtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIG1lc3NhZ2Ugd2FzIGEgYSB1c2VyIGVycm9yIGZyb20gYW4gaWZyYW1lIGVtYmVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVc2VyRXJyb3JFbWJlZChtZXNzYWdlKSB7XG4gIHJldHVybiBtZXNzYWdlLmluZGV4T2YoVVNFUl9FUlJPUl9FTUJFRF9TRU5USU5FTCkgPj0gMDtcbn1cblxuXG4vKipcbiAqIEBlbnVtIHtudW1iZXJ9XG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKi9cbmV4cG9ydCBjb25zdCBMb2dMZXZlbCA9IHtcbiAgT0ZGOiAwLFxuICBFUlJPUjogMSxcbiAgV0FSTjogMixcbiAgSU5GTzogMyxcbiAgRklORTogNCxcbn07XG5cbi8qKlxuICogU2V0cyByZXBvcnRFcnJvciBmdW5jdGlvbi4gQ2FsbGVkIGZyb20gZXJyb3IuanMgdG8gYnJlYWsgY3ljbGljXG4gKiBkZXBlbmRlbmN5LlxuICogQHBhcmFtIHtmdW5jdGlvbigqLCAhRWxlbWVudD0pfHVuZGVmaW5lZH0gZm5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFJlcG9ydEVycm9yKGZuKSB7XG4gIHNlbGYucmVwb3J0RXJyb3IgPSBmbjtcbn1cblxuLyoqXG4gKiBAdHlwZSB7IUxvZ0xldmVsfHVuZGVmaW5lZH1cbiAqIEBwcml2YXRlXG4gKi9cbmxldCBsZXZlbE92ZXJyaWRlXyA9IHVuZGVmaW5lZDtcblxuLyoqXG4gKiBAcGFyYW0geyFMb2dMZXZlbH0gbGV2ZWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG92ZXJyaWRlTG9nTGV2ZWwobGV2ZWwpIHtcbiAgbGV2ZWxPdmVycmlkZV8gPSBsZXZlbDtcbn1cblxuLyoqXG4gKiBMb2dnaW5nIGNsYXNzLiBVc2Ugb2Ygc2VudGluZWwgc3RyaW5nIGluc3RlYWQgb2YgYSBib29sZWFuIHRvIGNoZWNrIHVzZXIvZGV2XG4gKiBlcnJvcnMgYmVjYXVzZSBlcnJvcnMgY291bGQgYmUgcmV0aHJvd24gYnkgc29tZSBuYXRpdmUgY29kZSBhcyBhIG5ldyBlcnJvcixcbiAqIGFuZCBvbmx5IGEgbWVzc2FnZSB3b3VsZCBzdXJ2aXZlLiBBbHNvLCBzb21lIGJyb3dzZXIgZG9u4oCZdCBzdXBwb3J0IGEgNXRoXG4gKiBlcnJvciBvYmplY3QgYXJndW1lbnQgaW4gd2luZG93Lm9uZXJyb3IuIExpc3Qgb2Ygc3VwcG9ydGluZyBicm93c2VyIGNhbiBiZVxuICogZm91bmQgaGVyZTpcbiAqIGh0dHBzOi8vYmxvZy5zZW50cnkuaW8vMjAxNi8wMS8wNC9jbGllbnQtamF2YXNjcmlwdC1yZXBvcnRpbmctd2luZG93LW9uZXJyb3IuaHRtbFxuICogQGZpbmFsXG4gKiBAcHJpdmF0ZSBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHkuXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2cge1xuICAvKipcbiAgICogb3B0X3N1ZmZpeCB3aWxsIGJlIGFwcGVuZGVkIHRvIGVycm9yIG1lc3NhZ2UgdG8gaWRlbnRpZnkgdGhlIHR5cGUgb2YgdGhlXG4gICAqIGVycm9yIG1lc3NhZ2UuIFdlIGNhbid0IHJlbHkgb24gdGhlIGVycm9yIG9iamVjdCB0byBwYXNzIGFsb25nIHRoZSB0eXBlXG4gICAqIGJlY2F1c2Ugc29tZSBicm93c2VycyBkbyBub3QgaGF2ZSB0aGlzIHBhcmFtIGluIGl0cyB3aW5kb3cub25lcnJvciBBUEkuXG4gICAqIFNlZTpcbiAgICogaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvci5odG1sXG4gICAqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb24oIS4vbW9kZS5Nb2RlRGVmKTohTG9nTGV2ZWx9IGxldmVsRnVuY1xuICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdF9zdWZmaXhcbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbiwgbGV2ZWxGdW5jLCBvcHRfc3VmZml4KSB7XG4gICAgLyoqXG4gICAgICogSW4gdGVzdHMgd2UgdXNlIHRoZSBtYWluIHRlc3Qgd2luZG93IGluc3RlYWQgb2YgdGhlIGlmcmFtZSB3aGVyZVxuICAgICAqIHRoZSB0ZXN0cyBydW5zIGJlY2F1c2Ugb25seSB0aGUgZm9ybWVyIGlzIHJlbGF5ZWQgdG8gdGhlIGNvbnNvbGUuXG4gICAgICogQGNvbnN0IHshV2luZG93fVxuICAgICAqL1xuICAgIHRoaXMud2luID0gKGdldE1vZGUoKS50ZXN0ICYmIHdpbi5BTVBfVEVTVF9JRlJBTUUpID8gd2luLnBhcmVudCA6IHdpbjtcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3Qge2Z1bmN0aW9uKCEuL21vZGUuTW9kZURlZik6IUxvZ0xldmVsfSAqL1xuICAgIHRoaXMubGV2ZWxGdW5jXyA9IGxldmVsRnVuYztcblxuICAgIC8qKiBAcHJpdmF0ZSBAY29uc3QgeyFMb2dMZXZlbH0gKi9cbiAgICB0aGlzLmxldmVsXyA9IHRoaXMuZGVmYXVsdExldmVsXygpO1xuXG4gICAgLyoqIEBwcml2YXRlIEBjb25zdCB7c3RyaW5nfSAqL1xuICAgIHRoaXMuc3VmZml4XyA9IG9wdF9zdWZmaXggfHwgJyc7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7IUxvZ0xldmVsfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZ2V0TGV2ZWxfKCkge1xuICAgIHJldHVybiAobGV2ZWxPdmVycmlkZV8gIT09IHVuZGVmaW5lZCkgPyBsZXZlbE92ZXJyaWRlXyA6IHRoaXMubGV2ZWxfO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4geyFMb2dMZXZlbH1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRlZmF1bHRMZXZlbF8oKSB7XG4gICAgLy8gTm8gY29uc29sZSAtIGNhbid0IGVuYWJsZSBsb2dnaW5nLlxuICAgIGlmICghdGhpcy53aW4uY29uc29sZSB8fCAhdGhpcy53aW4uY29uc29sZS5sb2cpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5PRkY7XG4gICAgfVxuXG4gICAgLy8gTG9nZ2luZyBoYXMgYmVlbiBleHBsaWNpdGx5IGRpc2FibGVkLlxuICAgIGlmIChnZXRNb2RlKCkubG9nID09ICcwJykge1xuICAgICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgICB9XG5cbiAgICAvLyBMb2dnaW5nIGlzIGVuYWJsZWQgZm9yIHRlc3RzIGRpcmVjdGx5LlxuICAgIGlmIChnZXRNb2RlKCkudGVzdCAmJiB0aGlzLndpbi5FTkFCTEVfTE9HKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG5cbiAgICAvLyBMb2NhbERldiBieSBkZWZhdWx0IGFsbG93cyBJTkZPIGxldmVsLCB1bmxlc3Mgb3ZlcnJpZGVuIGJ5IGAjbG9nYC5cbiAgICBpZiAoZ2V0TW9kZSgpLmxvY2FsRGV2ICYmICFnZXRNb2RlKCkubG9nKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICB9XG5cbiAgICAvLyBEZWxlZ2F0ZSB0byB0aGUgc3BlY2lmaWMgcmVzb2x2ZXIuXG4gICAgcmV0dXJuIHRoaXMubGV2ZWxGdW5jXyhnZXRNb2RlT2JqZWN0KCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHtzdHJpbmd9IGxldmVsXG4gICAqIEBwYXJhbSB7IUFycmF5fSBtZXNzYWdlc1xuICAgKi9cbiAgbXNnXyh0YWcsIGxldmVsLCBtZXNzYWdlcykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpICE9IExvZ0xldmVsLk9GRikge1xuICAgICAgbGV0IGZuID0gdGhpcy53aW4uY29uc29sZS5sb2c7XG4gICAgICBpZiAobGV2ZWwgPT0gJ0VSUk9SJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUuZXJyb3IgfHwgZm47XG4gICAgICB9IGVsc2UgaWYgKGxldmVsID09ICdJTkZPJykge1xuICAgICAgICBmbiA9IHRoaXMud2luLmNvbnNvbGUuaW5mbyB8fCBmbjtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ1dBUk4nKSB7XG4gICAgICAgIGZuID0gdGhpcy53aW4uY29uc29sZS53YXJuIHx8IGZuO1xuICAgICAgfVxuICAgICAgaWYgKGdldE1vZGUoKS5sb2NhbERldikge1xuICAgICAgICBtZXNzYWdlcy51bnNoaWZ0KCdbJyArIHRhZyArICddJyk7XG4gICAgICB9XG4gICAgICBmbi5hcHBseSh0aGlzLndpbi5jb25zb2xlLCBtZXNzYWdlcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIGxvZ2dpbmcgaXMgZW5hYmxlZC5cbiAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICovXG4gIGlzRW5hYmxlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMZXZlbF8oKSAhPSBMb2dMZXZlbC5PRkY7XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIGZpbmUtZ3JhaW5lZCBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGZpbmUodGFnLCB2YXJfYXJncykge1xuICAgIGlmICh0aGlzLmdldExldmVsXygpID49IExvZ0xldmVsLkZJTkUpIHtcbiAgICAgIHRoaXMubXNnXyh0YWcsICdGSU5FJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcG9ydHMgYSBpbmZvcm1hdGlvbmFsIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKi9cbiAgaW5mbyh0YWcsIHZhcl9hcmdzKSB7XG4gICAgaWYgKHRoaXMuZ2V0TGV2ZWxfKCkgPj0gTG9nTGV2ZWwuSU5GTykge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0lORk8nLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhIHdhcm5pbmcgbWVzc2FnZS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHRhZ1xuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqL1xuICB3YXJuKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5XQVJOKSB7XG4gICAgICB0aGlzLm1zZ18odGFnLCAnV0FSTicsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXBvcnRzIGFuIGVycm9yIG1lc3NhZ2UuIElmIHRoZSBsb2dnaW5nIGlzIGRpc2FibGVkLCB0aGUgZXJyb3IgaXMgcmV0aHJvd25cbiAgICogYXN5bmNocm9ub3VzbHkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0YWdcbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J8dW5kZWZpbmVkfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZXJyb3JfKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBpZiAodGhpcy5nZXRMZXZlbF8oKSA+PSBMb2dMZXZlbC5FUlJPUikge1xuICAgICAgdGhpcy5tc2dfKHRhZywgJ0VSUk9SJywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLFxuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgICAgdGhpcy5wcmVwYXJlRXJyb3JfKGVycm9yKTtcbiAgICAgIHJldHVybiBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGVycm9yKHRhZywgdmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuZXJyb3JfLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvci5uYW1lID0gdGFnIHx8IGVycm9yLm5hbWU7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVwb3J0cyBhbiBlcnJvciBtZXNzYWdlIGFuZCBtYXJrcyB3aXRoIGFuIGV4cGVjdGVkIHByb3BlcnR5LiBJZiB0aGVcbiAgICogbG9nZ2luZyBpcyBkaXNhYmxlZCwgdGhlIGVycm9yIGlzIHJldGhyb3duIGFzeW5jaHJvbm91c2x5LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdW51c2VkVGFnXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3NcbiAgICovXG4gIGV4cGVjdGVkRXJyb3IodW51c2VkVGFnLCB2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gdGhpcy5lcnJvcl8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yLmV4cGVjdGVkID0gdHJ1ZTtcbiAgICAgIC8vIHJlcG9ydEVycm9yIGlzIGluc3RhbGxlZCBnbG9iYWxseSBwZXIgd2luZG93IGluIHRoZSBlbnRyeSBwb2ludC5cbiAgICAgIHNlbGYucmVwb3J0RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGVycm9yIG9iamVjdC5cbiAgICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICAgKiBAcmV0dXJuIHshRXJyb3J9XG4gICAqL1xuICBjcmVhdGVFcnJvcih2YXJfYXJncykge1xuICAgIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgIHRoaXMucHJlcGFyZUVycm9yXyhlcnJvcik7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gZXJyb3Igb2JqZWN0IHdpdGggaXRzIGV4cGVjdGVkIHByb3BlcnR5IHNldCB0byB0cnVlLlxuICAgKiBAcGFyYW0gey4uLip9IHZhcl9hcmdzXG4gICAqIEByZXR1cm4geyFFcnJvcn1cbiAgICovXG4gIGNyZWF0ZUV4cGVjdGVkRXJyb3IodmFyX2FyZ3MpIHtcbiAgICBjb25zdCBlcnJvciA9IGNyZWF0ZUVycm9yVmFyZ3MuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICB0aGlzLnByZXBhcmVFcnJvcl8oZXJyb3IpO1xuICAgIGVycm9yLmV4cGVjdGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCB0cnVlaXNoLlxuICAgKlxuICAgKiBTdXBwb3J0cyBhcmd1bWVudCBzdWJzdGl0dXRpb24gaW50byB0aGUgbWVzc2FnZSB2aWEgJXMgcGxhY2Vob2xkZXJzLlxuICAgKlxuICAgKiBUaHJvd3MgYW4gZXJyb3Igb2JqZWN0IHRoYXQgaGFzIHR3byBleHRyYSBwcm9wZXJ0aWVzOlxuICAgKiAtIGFzc29jaWF0ZWRFbGVtZW50OiBUaGlzIGlzIHRoZSBmaXJzdCBlbGVtZW50IHByb3ZpZGVkIGluIHRoZSB2YXIgYXJncy5cbiAgICogICBJdCBjYW4gYmUgdXNlZCBmb3IgaW1wcm92ZWQgZGlzcGxheSBvZiBlcnJvciBtZXNzYWdlcy5cbiAgICogLSBtZXNzYWdlQXJyYXk6IFRoZSBlbGVtZW50cyBvZiB0aGUgc3Vic3RpdHV0ZWQgbWVzc2FnZSBhcyBub24tc3RyaW5naWZpZWRcbiAgICogICBlbGVtZW50cyBpbiBhbiBhcnJheS4gV2hlbiBlLmcuIHBhc3NlZCB0byBjb25zb2xlLmVycm9yIHRoaXMgeWllbGRzXG4gICAqICAgbmF0aXZlIGRpc3BsYXlzIG9mIHRoaW5ncyBsaWtlIEhUTUwgZWxlbWVudHMuXG4gICAqXG4gICAqIEBwYXJhbSB7VH0gc2hvdWxkQmVUcnVlaXNoIFRoZSB2YWx1ZSB0byBhc3NlcnQuIFRoZSBhc3NlcnQgZmFpbHMgaWYgaXQgZG9lc1xuICAgKiAgICAgbm90IGV2YWx1YXRlIHRvIHRydWUuXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQXJndW1lbnRzIHN1YnN0aXR1dGVkIGludG8gJXMgaW4gdGhlIG1lc3NhZ2UuXG4gICAqIEByZXR1cm4ge1R9IFRoZSB2YWx1ZSBvZiBzaG91bGRCZVRydWVpc2guXG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAwXG4gICAqL1xuICBhc3NlcnQoc2hvdWxkQmVUcnVlaXNoLCBvcHRfbWVzc2FnZSwgdmFyX2FyZ3MpIHtcbiAgICBsZXQgZmlyc3RFbGVtZW50O1xuICAgIGlmICghc2hvdWxkQmVUcnVlaXNoKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gb3B0X21lc3NhZ2UgfHwgJ0Fzc2VydGlvbiBmYWlsZWQnO1xuICAgICAgY29uc3Qgc3BsaXRNZXNzYWdlID0gbWVzc2FnZS5zcGxpdCgnJXMnKTtcbiAgICAgIGNvbnN0IGZpcnN0ID0gc3BsaXRNZXNzYWdlLnNoaWZ0KCk7XG4gICAgICBsZXQgZm9ybWF0dGVkID0gZmlyc3Q7XG4gICAgICBjb25zdCBtZXNzYWdlQXJyYXkgPSBbXTtcbiAgICAgIHB1c2hJZk5vbkVtcHR5KG1lc3NhZ2VBcnJheSwgZmlyc3QpO1xuICAgICAgZm9yIChsZXQgaSA9IDI7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdmFsID0gYXJndW1lbnRzW2ldO1xuICAgICAgICBpZiAodmFsICYmIHZhbC50YWdOYW1lKSB7XG4gICAgICAgICAgZmlyc3RFbGVtZW50ID0gdmFsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5leHRDb25zdGFudCA9IHNwbGl0TWVzc2FnZS5zaGlmdCgpO1xuICAgICAgICBtZXNzYWdlQXJyYXkucHVzaCh2YWwpO1xuICAgICAgICBwdXNoSWZOb25FbXB0eShtZXNzYWdlQXJyYXksIG5leHRDb25zdGFudC50cmltKCkpO1xuICAgICAgICBmb3JtYXR0ZWQgKz0gdG9TdHJpbmcodmFsKSArIG5leHRDb25zdGFudDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGUgPSBuZXcgRXJyb3IoZm9ybWF0dGVkKTtcbiAgICAgIGUuZnJvbUFzc2VydCA9IHRydWU7XG4gICAgICBlLmFzc29jaWF0ZWRFbGVtZW50ID0gZmlyc3RFbGVtZW50O1xuICAgICAgZS5tZXNzYWdlQXJyYXkgPSBtZXNzYWdlQXJyYXk7XG4gICAgICB0aGlzLnByZXBhcmVFcnJvcl8oZSk7XG4gICAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgICBzZWxmLnJlcG9ydEVycm9yKGUpO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgcmV0dXJuIHNob3VsZEJlVHJ1ZWlzaDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzbid0IGFuIEVsZW1lbnRcbiAgICpcbiAgICogT3RoZXJ3aXNlIHNlZSBgYXNzZXJ0YCBmb3IgdXNhZ2VcbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZUVsZW1lbnRcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7IUVsZW1lbnR9IFRoZSB2YWx1ZSBvZiBzaG91bGRCZVRydWVpc2guXG4gICAqIEB0ZW1wbGF0ZSBUXG4gICAqIGVzbGludCBcImdvb2dsZS1jYW1lbGNhc2UvZ29vZ2xlLWNhbWVsY2FzZVwiOiAyXG4gICAqL1xuICBhc3NlcnRFbGVtZW50KHNob3VsZEJlRWxlbWVudCwgb3B0X21lc3NhZ2UpIHtcbiAgICBjb25zdCBzaG91bGRCZVRydWVpc2ggPSBzaG91bGRCZUVsZW1lbnQgJiYgc2hvdWxkQmVFbGVtZW50Lm5vZGVUeXBlID09IDE7XG4gICAgdGhpcy5hc3NlcnQoc2hvdWxkQmVUcnVlaXNoLCAob3B0X21lc3NhZ2UgfHwgJ0VsZW1lbnQgZXhwZWN0ZWQnKSArICc6ICVzJyxcbiAgICAgICAgc2hvdWxkQmVFbGVtZW50KTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshRWxlbWVudH0gKi8gKHNob3VsZEJlRWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIHN0cmluZy4gVGhlIHN0cmluZyBjYW5cbiAgICogYmUgZW1wdHkuXG4gICAqXG4gICAqIEZvciBtb3JlIGRldGFpbHMgc2VlIGBhc3NlcnRgLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IHNob3VsZEJlU3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X21lc3NhZ2UgVGhlIGFzc2VydGlvbiBtZXNzYWdlXG4gICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyB2YWx1ZS4gQ2FuIGJlIGFuIGVtcHR5IHN0cmluZy5cbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydFN0cmluZyhzaG91bGRCZVN0cmluZywgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCh0eXBlb2Ygc2hvdWxkQmVTdHJpbmcgPT0gJ3N0cmluZycsXG4gICAgICAgIChvcHRfbWVzc2FnZSB8fCAnU3RyaW5nIGV4cGVjdGVkJykgKyAnOiAlcycsIHNob3VsZEJlU3RyaW5nKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovIChzaG91bGRCZVN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpc24ndCBhIG51bWJlci4gVGhlIGFsbG93ZWQgdmFsdWVzXG4gICAqIGluY2x1ZGUgYDBgIGFuZCBgTmFOYC5cbiAgICpcbiAgICogRm9yIG1vcmUgZGV0YWlscyBzZWUgYGFzc2VydGAuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gc2hvdWxkQmVOdW1iZXJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIHZhbHVlLiBUaGUgYWxsb3dlZCB2YWx1ZXMgaW5jbHVkZSBgMGBcbiAgICogICBhbmQgYE5hTmAuXG4gICAqL1xuICBhc3NlcnROdW1iZXIoc2hvdWxkQmVOdW1iZXIsIG9wdF9tZXNzYWdlKSB7XG4gICAgdGhpcy5hc3NlcnQodHlwZW9mIHNob3VsZEJlTnVtYmVyID09ICdudW1iZXInLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ051bWJlciBleHBlY3RlZCcpICsgJzogJXMnLCBzaG91bGRCZU51bWJlcik7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7bnVtYmVyfSAqLyAoc2hvdWxkQmVOdW1iZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgZmlyc3QgYXJndW1lbnQgaXNuJ3QgYSBib29sZWFuLlxuICAgKlxuICAgKiBGb3IgbW9yZSBkZXRhaWxzIHNlZSBgYXNzZXJ0YC5cbiAgICpcbiAgICogQHBhcmFtIHsqfSBzaG91bGRCZUJvb2xlYW5cbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfbWVzc2FnZSBUaGUgYXNzZXJ0aW9uIG1lc3NhZ2VcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gVGhlIGJvb2xlYW4gdmFsdWUuXG4gICAqL1xuICBhc3NlcnRCb29sZWFuKHNob3VsZEJlQm9vbGVhbiwgb3B0X21lc3NhZ2UpIHtcbiAgICB0aGlzLmFzc2VydCghIXNob3VsZEJlQm9vbGVhbiA9PT0gc2hvdWxkQmVCb29sZWFuLFxuICAgICAgICAob3B0X21lc3NhZ2UgfHwgJ0Jvb2xlYW4gZXhwZWN0ZWQnKSArICc6ICVzJywgc2hvdWxkQmVCb29sZWFuKTtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHtib29sZWFufSAqLyAoc2hvdWxkQmVCb29sZWFuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBc3NlcnRzIGFuZCByZXR1cm5zIHRoZSBlbnVtIHZhbHVlLiBJZiB0aGUgZW51bSBkb2Vzbid0IGNvbnRhaW4gc3VjaCBhXG4gICAqIHZhbHVlLCB0aGUgZXJyb3IgaXMgdGhyb3duLlxuICAgKlxuICAgKiBAcGFyYW0geyFPYmplY3Q8VD59IGVudW1PYmpcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZW51bU5hbWVcbiAgICogQHJldHVybiB7VH1cbiAgICogQHRlbXBsYXRlIFRcbiAgICogZXNsaW50IFwiZ29vZ2xlLWNhbWVsY2FzZS9nb29nbGUtY2FtZWxjYXNlXCI6IDJcbiAgICovXG4gIGFzc2VydEVudW1WYWx1ZShlbnVtT2JqLCBzLCBvcHRfZW51bU5hbWUpIHtcbiAgICBpZiAoaXNFbnVtVmFsdWUoZW51bU9iaiwgcykpIHtcbiAgICAgIHJldHVybiBzO1xuICAgIH1cbiAgICB0aGlzLmFzc2VydChmYWxzZSxcbiAgICAgICAgJ1Vua25vd24gJXMgdmFsdWU6IFwiJXNcIicsXG4gICAgICAgIG9wdF9lbnVtTmFtZSB8fCAnZW51bScsIHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVycm9yfSBlcnJvclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJlcGFyZUVycm9yXyhlcnJvcikge1xuICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShlcnJvcik7XG4gICAgaWYgKHRoaXMuc3VmZml4Xykge1xuICAgICAgaWYgKCFlcnJvci5tZXNzYWdlKSB7XG4gICAgICAgIGVycm9yLm1lc3NhZ2UgPSB0aGlzLnN1ZmZpeF87XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5kZXhPZih0aGlzLnN1ZmZpeF8pID09IC0xKSB7XG4gICAgICAgIGVycm9yLm1lc3NhZ2UgKz0gdGhpcy5zdWZmaXhfO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNVc2VyRXJyb3JNZXNzYWdlKGVycm9yLm1lc3NhZ2UpKSB7XG4gICAgICBlcnJvci5tZXNzYWdlID0gZXJyb3IubWVzc2FnZS5yZXBsYWNlKFVTRVJfRVJST1JfU0VOVElORUwsICcnKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ3whRWxlbWVudH0gdmFsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbCkge1xuICAvLyBEbyBjaGVjayBlcXVpdmFsZW50IHRvIGB2YWwgaW5zdGFuY2VvZiBFbGVtZW50YCB3aXRob3V0IGNyb3NzLXdpbmRvdyBidWdcbiAgaWYgKHZhbCAmJiB2YWwubm9kZVR5cGUgPT0gMSkge1xuICAgIHJldHVybiB2YWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpICsgKHZhbC5pZCA/ICcjJyArIHZhbC5pZCA6ICcnKTtcbiAgfVxuICByZXR1cm4gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2YWwpO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshQXJyYXl9IGFycmF5XG4gKiBAcGFyYW0geyp9IHZhbFxuICovXG5mdW5jdGlvbiBwdXNoSWZOb25FbXB0eShhcnJheSwgdmFsKSB7XG4gIGlmICh2YWwgIT0gJycpIHtcbiAgICBhcnJheS5wdXNoKHZhbCk7XG4gIH1cbn1cblxuLyoqXG4gKiBTb21lIGV4Y2VwdGlvbnMgKERPTUV4Y2VwdGlvbiwgbmFtZWx5KSBoYXZlIHJlYWQtb25seSBtZXNzYWdlLlxuICogQHBhcmFtIHshRXJyb3J9IGVycm9yXG4gKiBAcmV0dXJuIHshRXJyb3J9O1xuICovXG5leHBvcnQgZnVuY3Rpb24gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShlcnJvcikge1xuICBjb25zdCB7bWVzc2FnZX0gPSBlcnJvcjtcbiAgY29uc3QgdGVzdCA9IFN0cmluZyhNYXRoLnJhbmRvbSgpKTtcbiAgZXJyb3IubWVzc2FnZSA9IHRlc3Q7XG5cbiAgaWYgKGVycm9yLm1lc3NhZ2UgPT09IHRlc3QpIHtcbiAgICBlcnJvci5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICBjb25zdCBlID0gbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpO1xuICAvLyBDb3B5IGFsbCB0aGUgZXh0cmFuZW91cyB0aGluZ3Mgd2UgYXR0YWNoLlxuICBmb3IgKGNvbnN0IHByb3AgaW4gZXJyb3IpIHtcbiAgICBlW3Byb3BdID0gZXJyb3JbcHJvcF07XG4gIH1cbiAgLy8gRW5zdXJlIHRoZXNlIGFyZSBjb3BpZWQuXG4gIGUuc3RhY2sgPSBlcnJvci5zdGFjaztcbiAgcmV0dXJuIGU7XG59XG5cbi8qKlxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICogQHJldHVybiB7IUVycm9yfVxuICogQHZpc2libGVGb3JUZXN0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFcnJvclZhcmdzKHZhcl9hcmdzKSB7XG4gIGxldCBlcnJvciA9IG51bGw7XG4gIGxldCBtZXNzYWdlID0gJyc7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgYXJnID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChhcmcgaW5zdGFuY2VvZiBFcnJvciAmJiAhZXJyb3IpIHtcbiAgICAgIGVycm9yID0gZHVwbGljYXRlRXJyb3JJZk5lY2Vzc2FyeShhcmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICBtZXNzYWdlICs9ICcgJztcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2UgKz0gYXJnO1xuICAgIH1cbiAgfVxuXG4gIGlmICghZXJyb3IpIHtcbiAgICBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgfSBlbHNlIGlmIChtZXNzYWdlKSB7XG4gICAgZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2UgKyAnOiAnICsgZXJyb3IubWVzc2FnZTtcbiAgfVxuICByZXR1cm4gZXJyb3I7XG59XG5cblxuLyoqXG4gKiBSZXRocm93cyB0aGUgZXJyb3Igd2l0aG91dCB0ZXJtaW5hdGluZyB0aGUgY3VycmVudCBjb250ZXh0LiBUaGlzIHByZXNlcnZlc1xuICogd2hldGhlciB0aGUgb3JpZ2luYWwgZXJyb3IgZGVzaWduYXRpb24gaXMgYSB1c2VyIGVycm9yIG9yIGEgZGV2IGVycm9yLlxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmV0aHJvd0FzeW5jKHZhcl9hcmdzKSB7XG4gIGNvbnN0IGVycm9yID0gY3JlYXRlRXJyb3JWYXJncy5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAvLyByZXBvcnRFcnJvciBpcyBpbnN0YWxsZWQgZ2xvYmFsbHkgcGVyIHdpbmRvdyBpbiB0aGUgZW50cnkgcG9pbnQuXG4gICAgc2VsZi5yZXBvcnRFcnJvcihlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0pO1xufVxuXG5cbi8qKlxuICogQ2FjaGUgZm9yIGxvZ3MuIFdlIGRvIG5vdCB1c2UgYSBTZXJ2aWNlIHNpbmNlIHRoZSBzZXJ2aWNlIG1vZHVsZSBkZXBlbmRzXG4gKiBvbiBMb2cgYW5kIGNsb3N1cmUgbGl0ZXJhbGx5IGNhbid0IGV2ZW4uXG4gKiBAdHlwZSB7e3VzZXI6ID9Mb2csIGRldjogP0xvZywgdXNlckZvckVtYmVkOiA/TG9nfX1cbiAqL1xuc2VsZi5sb2cgPSAoc2VsZi5sb2cgfHwge1xuICB1c2VyOiBudWxsLFxuICBkZXY6IG51bGwsXG4gIHVzZXJGb3JFbWJlZDogbnVsbCxcbn0pO1xuXG5jb25zdCBsb2dzID0gc2VsZi5sb2c7XG5cbi8qKlxuICogRXZlbnR1YWxseSBob2xkcyBhIGNvbnN0cnVjdG9yIGZvciBMb2cgb2JqZWN0cy4gTGF6aWx5IGluaXRpYWxpemVkLCBzbyB3ZVxuICogY2FuIGF2b2lkIGV2ZXIgcmVmZXJlbmNpbmcgdGhlIHJlYWwgY29uc3RydWN0b3IgZXhjZXB0IGluIEpTIGJpbmFyaWVzXG4gKiB0aGF0IGFjdHVhbGx5IHdhbnQgdG8gaW5jbHVkZSB0aGUgaW1wbGVtZW50YXRpb24uXG4gKiBAdHlwZSB7P0Z1bmN0aW9ufVxuICovXG5sZXQgbG9nQ29uc3RydWN0b3IgPSBudWxsO1xuXG4vKipcbiAqIEluaXRpYWxpemVzIGxvZyBjb250cnVjdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdExvZ0NvbnN0cnVjdG9yKCkge1xuICBsb2dDb25zdHJ1Y3RvciA9IExvZztcbiAgLy8gSW5pdGlhbGl6ZSBpbnN0YW5jZXMgZm9yIHVzZS4gSWYgYSBiaW5hcnkgKGFuIGV4dGVuc2lvbiBmb3IgZXhhbXBsZSkgdGhhdFxuICAvLyBkb2VzIG5vdCBjYWxsIGBpbml0TG9nQ29uc3RydWN0b3JgIGludm9rZXMgYGRldigpYCBvciBgdXNlcigpYCBlYXJsaWVyIHRoYW5cbiAgLy8gdGhlIGJpbmFyeSB0aGF0IGRvZXMgY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCAoYW1wLmpzKSwgdGhlIGV4dGVuc2lvbiB3aWxsXG4gIC8vIHRocm93IGFuIGVycm9yIGFzIHRoYXQgZXh0ZW5zaW9uIHdpbGwgbmV2ZXIgYmUgYWJsZSB0byBpbml0aWFsaXplIHRoZSBsb2dcbiAgLy8gaW5zdGFuY2VzIGFuZCB3ZSBhbHNvIGRvbid0IHdhbnQgaXQgdG8gY2FsbCBgaW5pdExvZ0NvbnN0cnVjdG9yYCBlaXRoZXJcbiAgLy8gKHNpbmNlIHRoYXQgd2lsbCBjYXVzZSB0aGUgTG9nIGltcGxlbWVudGF0aW9uIHRvIGJlIGJ1bmRsZWQgaW50byB0aGF0XG4gIC8vIGJpbmFyeSkuIFNvIHdlIG11c3QgaW5pdGlhbGl6ZSB0aGUgaW5zdGFuY2VzIGVhZ2VybHkgc28gdGhhdCB0aGV5IGFyZSByZWFkeVxuICAvLyBmb3IgdXNlIChzdG9yZWQgZ2xvYmFsbHkpIGFmdGVyIHRoZSBtYWluIGJpbmFyeSBjYWxscyBgaW5pdExvZ0NvbnN0cnVjdG9yYC5cbiAgZGV2KCk7XG4gIHVzZXIoKTtcbn1cblxuLyoqXG4gKiBSZXNldHMgbG9nIGNvbnRydWN0b3IgZm9yIHRlc3RpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldExvZ0NvbnN0cnVjdG9yRm9yVGVzdGluZygpIHtcbiAgbG9nQ29uc3RydWN0b3IgPSBudWxsO1xufVxuXG4vKipcbiAqIFB1Ymxpc2hlciBsZXZlbCBsb2cuXG4gKlxuICogRW5hYmxlZCBpbiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKiAgMS4gTm90IGRpc2FibGVkIHVzaW5nIGAjbG9nPTBgLlxuICogIDIuIERldmVsb3BtZW50IG1vZGUgaXMgZW5hYmxlZCB2aWEgYCNkZXZlbG9wbWVudD0xYCBvciBsb2dnaW5nIGlzIGV4cGxpY2l0bHlcbiAqICAgICBlbmFibGVkIHZpYSBgI2xvZz1EYCB3aGVyZSBEID49IDEuXG4gKiAgMy4gQU1QLnNldExvZ0xldmVsKEQpIGlzIGNhbGxlZCwgd2hlcmUgRCA+PSAxLlxuICpcbiAqIEBwYXJhbSB7IUVsZW1lbnQ9fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7IUxvZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZXIob3B0X2VsZW1lbnQpIHtcbiAgaWYgKCFsb2dzLnVzZXIpIHtcbiAgICBsb2dzLnVzZXIgPSBnZXRVc2VyTG9nZ2VyKFVTRVJfRVJST1JfU0VOVElORUwpO1xuICB9XG4gIGlmICghaXNGcm9tRW1iZWQobG9ncy51c2VyLndpbiwgb3B0X2VsZW1lbnQpKSB7XG4gICAgcmV0dXJuIGxvZ3MudXNlcjtcbiAgfSBlbHNlIHtcbiAgICBpZiAobG9ncy51c2VyRm9yRW1iZWQpIHtcbiAgICAgIHJldHVybiBsb2dzLnVzZXJGb3JFbWJlZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvZ3MudXNlckZvckVtYmVkID0gZ2V0VXNlckxvZ2dlcihVU0VSX0VSUk9SX0VNQkVEX1NFTlRJTkVMKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHRlciBmb3IgdXNlciBsb2dnZXJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gc3VmZml4XG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5mdW5jdGlvbiBnZXRVc2VyTG9nZ2VyKHN1ZmZpeCkge1xuICBpZiAoIWxvZ0NvbnN0cnVjdG9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gY2FsbCBpbml0TG9nQ29uc3RydWN0b3InKTtcbiAgfVxuICByZXR1cm4gbmV3IGxvZ0NvbnN0cnVjdG9yKHNlbGYsIG1vZGUgPT4ge1xuICAgIGNvbnN0IGxvZ051bSA9IHBhcnNlSW50KG1vZGUubG9nLCAxMCk7XG4gICAgaWYgKG1vZGUuZGV2ZWxvcG1lbnQgfHwgbG9nTnVtID49IDEpIHtcbiAgICAgIHJldHVybiBMb2dMZXZlbC5GSU5FO1xuICAgIH1cbiAgICByZXR1cm4gTG9nTGV2ZWwuV0FSTjtcbiAgfSwgc3VmZml4KTtcbn1cblxuLyoqXG4gKiBBTVAgZGV2ZWxvcG1lbnQgbG9nLiBDYWxscyB0byBgZGV2TG9nKCkuYXNzZXJ0YCBhbmQgYGRldi5maW5lYCBhcmUgc3RyaXBwZWRcbiAqIGluIHRoZSBQUk9EIGJpbmFyeS4gSG93ZXZlciwgYGRldkxvZygpLmFzc2VydGAgcmVzdWx0IGlzIHByZXNlcnZlZCBpbiBlaXRoZXJcbiAqIGNhc2UuXG4gKlxuICogRW5hYmxlZCBpbiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKiAgMS4gTm90IGRpc2FibGVkIHVzaW5nIGAjbG9nPTBgLlxuICogIDIuIExvZ2dpbmcgaXMgZXhwbGljaXRseSBlbmFibGVkIHZpYSBgI2xvZz1EYCwgd2hlcmUgRCA+PSAyLlxuICogIDMuIEFNUC5zZXRMb2dMZXZlbChEKSBpcyBjYWxsZWQsIHdoZXJlIEQgPj0gMi5cbiAqXG4gKiBAcmV0dXJuIHshTG9nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGV2KCkge1xuICBpZiAobG9ncy5kZXYpIHtcbiAgICByZXR1cm4gbG9ncy5kZXY7XG4gIH1cbiAgaWYgKCFsb2dDb25zdHJ1Y3Rvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignZmFpbGVkIHRvIGNhbGwgaW5pdExvZ0NvbnN0cnVjdG9yJyk7XG4gIH1cbiAgcmV0dXJuIGxvZ3MuZGV2ID0gbmV3IGxvZ0NvbnN0cnVjdG9yKHNlbGYsIG1vZGUgPT4ge1xuICAgIGNvbnN0IGxvZ051bSA9IHBhcnNlSW50KG1vZGUubG9nLCAxMCk7XG4gICAgaWYgKGxvZ051bSA+PSAzKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuRklORTtcbiAgICB9XG4gICAgaWYgKGxvZ051bSA+PSAyKSB7XG4gICAgICByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICB9XG4gICAgcmV0dXJuIExvZ0xldmVsLk9GRjtcbiAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnQ9fSBvcHRfZWxlbWVudFxuICogQHJldHVybiB7Ym9vbGVhbn0gaXNFbWJlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGcm9tRW1iZWQod2luLCBvcHRfZWxlbWVudCkge1xuICBpZiAoIW9wdF9lbGVtZW50KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiBvcHRfZWxlbWVudC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3ICE9IHdpbjtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuIFRoaXMgcmV0dXJuIHZhbHVlIG1heSBiZSBjYWNoZWQgYW5kXG4gKiBwYXNzZWQgYXJvdW5kIGFzIGl0IHdpbGwgYWx3YXlzIGJlIERDRSdkLlxuICogQHBhcmFtIHs/V2luZG93PX0gb3B0X3dpblxuICogQHJldHVybiB7IS4vbW9kZS5Nb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZU9iamVjdChvcHRfd2luKSB7XG4gIHJldHVybiB7XG4gICAgbG9jYWxEZXY6IGdldE1vZGUob3B0X3dpbikubG9jYWxEZXYsXG4gICAgZGV2ZWxvcG1lbnQ6IGdldE1vZGUob3B0X3dpbikuZGV2ZWxvcG1lbnQsXG4gICAgZmlsdGVyOiBnZXRNb2RlKG9wdF93aW4pLmZpbHRlcixcbiAgICBtaW5pZmllZDogZ2V0TW9kZShvcHRfd2luKS5taW5pZmllZCxcbiAgICBsaXRlOiBnZXRNb2RlKG9wdF93aW4pLmxpdGUsXG4gICAgdGVzdDogZ2V0TW9kZShvcHRfd2luKS50ZXN0LFxuICAgIGxvZzogZ2V0TW9kZShvcHRfd2luKS5sb2csXG4gICAgdmVyc2lvbjogZ2V0TW9kZShvcHRfd2luKS52ZXJzaW9uLFxuICAgIHJ0dlZlcnNpb246IGdldE1vZGUob3B0X3dpbikucnR2VmVyc2lvbixcbiAgfTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmdffSBmcm9tICcuL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIGxvY2FsRGV2OiBib29sZWFuLFxuICogICBkZXZlbG9wbWVudDogYm9vbGVhbixcbiAqICAgZmlsdGVyOiAoc3RyaW5nfHVuZGVmaW5lZCksXG4gKiAgIG1pbmlmaWVkOiBib29sZWFuLFxuICogICBsaXRlOiBib29sZWFuLFxuICogICB0ZXN0OiBib29sZWFuLFxuICogICBsb2c6IChzdHJpbmd8dW5kZWZpbmVkKSxcbiAqICAgdmVyc2lvbjogc3RyaW5nLFxuICogICBydHZWZXJzaW9uOiBzdHJpbmcsXG4gKiB9fVxuICovXG5leHBvcnQgbGV0IE1vZGVEZWY7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuY29uc3QgdmVyc2lvbiA9ICckaW50ZXJuYWxSdW50aW1lVmVyc2lvbiQnO1xuXG4vKipcbiAqIGBydHZWZXJzaW9uYCBpcyB0aGUgcHJlZml4ZWQgdmVyc2lvbiB3ZSBzZXJ2ZSBvZmYgb2YgdGhlIGNkbi5cbiAqIFRoZSBwcmVmaXggZGVub3RlcyBjYW5hcnkoMDApIG9yIHByb2QoMDEpIG9yIGFuIGV4cGVyaW1lbnQgdmVyc2lvbiAoID4gMDEpLlxuICogQHR5cGUge3N0cmluZ31cbiAqL1xubGV0IHJ0dlZlcnNpb24gPSAnJztcblxuLyoqXG4gKiBQcm92aWRlcyBpbmZvIGFib3V0IHRoZSBjdXJyZW50IGFwcC5cbiAqIEBwYXJhbSB7P1dpbmRvdz19IG9wdF93aW5cbiAqIEByZXR1cm4geyFNb2RlRGVmfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kZShvcHRfd2luKSB7XG4gIGNvbnN0IHdpbiA9IG9wdF93aW4gfHwgc2VsZjtcbiAgaWYgKHdpbi5BTVBfTU9ERSkge1xuICAgIHJldHVybiB3aW4uQU1QX01PREU7XG4gIH1cbiAgcmV0dXJuIHdpbi5BTVBfTU9ERSA9IGdldE1vZGVfKHdpbik7XG59XG5cbi8qKlxuICogUHJvdmlkZXMgaW5mbyBhYm91dCB0aGUgY3VycmVudCBhcHAuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IU1vZGVEZWZ9XG4gKi9cbmZ1bmN0aW9uIGdldE1vZGVfKHdpbikge1xuICAvLyBNYWdpYyBjb25zdGFudHMgdGhhdCBhcmUgcmVwbGFjZWQgYnkgY2xvc3VyZSBjb21waWxlci5cbiAgLy8gSVNfTUlOSUZJRUQgaXMgYWx3YXlzIHJlcGxhY2VkIHdpdGggdHJ1ZSB3aGVuIGNsb3N1cmUgY29tcGlsZXIgaXMgdXNlZFxuICAvLyB3aGlsZSBJU19ERVYgaXMgb25seSByZXBsYWNlZCB3aGVuIGBndWxwIGRpc3RgIGlzIGNhbGxlZCB3aXRob3V0IHRoZVxuICAvLyAtLWZvcnRlc3RpbmcgZmxhZy5cbiAgY29uc3QgSVNfREVWID0gdHJ1ZTtcbiAgY29uc3QgSVNfTUlOSUZJRUQgPSBmYWxzZTtcblxuICBjb25zdCBsb2NhbERldkVuYWJsZWQgPSAhIShzZWxmLkFNUF9DT05GSUcgJiYgc2VsZi5BTVBfQ09ORklHLmxvY2FsRGV2KTtcbiAgY29uc3QgcnVubmluZ1Rlc3RzID0gSVNfREVWICYmICEhKHdpbi5BTVBfVEVTVCB8fCB3aW4uX19rYXJtYV9fKTtcbiAgY29uc3QgaXNMb2NhbERldiA9IElTX0RFViAmJiAobG9jYWxEZXZFbmFibGVkIHx8IHJ1bm5pbmdUZXN0cyk7XG4gIGNvbnN0IGhhc2hRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmdfKFxuICAgICAgLy8gbG9jYXRpb24ub3JpZ2luYWxIYXNoIGlzIHNldCBieSB0aGUgdmlld2VyIHdoZW4gaXQgcmVtb3ZlcyB0aGUgZnJhZ21lbnRcbiAgICAgIC8vIGZyb20gdGhlIFVSTC5cbiAgICAgIHdpbi5sb2NhdGlvbi5vcmlnaW5hbEhhc2ggfHwgd2luLmxvY2F0aW9uLmhhc2gpO1xuXG4gIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZ18od2luLmxvY2F0aW9uLnNlYXJjaCk7XG5cbiAgaWYgKCFydHZWZXJzaW9uKSB7XG4gICAgcnR2VmVyc2lvbiA9IGdldFJ0dlZlcnNpb24od2luLCBpc0xvY2FsRGV2KTtcbiAgfVxuXG4gIC8vIFRoZSBgbWluaWZpZWRgLCBgdGVzdGAgYW5kIGBsb2NhbERldmAgcHJvcGVydGllcyBhcmUgcmVwbGFjZWRcbiAgLy8gYXMgYm9vbGVhbiBsaXRlcmFscyB3aGVuIHdlIHJ1biBgZ3VscCBkaXN0YCB3aXRob3V0IHRoZSBgLS1mb3J0ZXN0aW5nYFxuICAvLyBmbGFncy4gVGhpcyBpbXByb3ZlZCBEQ0Ugb24gdGhlIHByb2R1Y3Rpb24gZmlsZSB3ZSBkZXBsb3kgYXMgdGhlIGNvZGVcbiAgLy8gcGF0aHMgZm9yIGxvY2FsaG9zdC90ZXN0aW5nL2RldmVsb3BtZW50IGFyZSBlbGltaW5hdGVkLlxuICByZXR1cm4ge1xuICAgIGxvY2FsRGV2OiBpc0xvY2FsRGV2LFxuICAgIC8vIFRyaWdnZXJzIHZhbGlkYXRpb24gb3IgZW5hYmxlIHB1YiBsZXZlbCBsb2dnaW5nLiBWYWxpZGF0aW9uIGNhbiBiZVxuICAgIC8vIGJ5cGFzc2VkIHZpYSAjdmFsaWRhdGU9MC5cbiAgICAvLyBOb3RlIHRoYXQgQU1QX0RFVl9NT0RFIGZsYWcgaXMgdXNlZCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAgICBkZXZlbG9wbWVudDogISEoaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcxJyB8fCB3aW4uQU1QX0RFVl9NT0RFKSxcbiAgICBleGFtaW5lcjogaGFzaFF1ZXJ5WydkZXZlbG9wbWVudCddID09ICcyJyxcbiAgICAvLyBBbGxvd3MgZmlsdGVyaW5nIHZhbGlkYXRpb24gZXJyb3JzIGJ5IGVycm9yIGNhdGVnb3J5LiBGb3IgdGhlXG4gICAgLy8gYXZhaWxhYmxlIGNhdGVnb3JpZXMsIHNlZSBFcnJvckNhdGVnb3J5IGluIHZhbGlkYXRvci92YWxpZGF0b3IucHJvdG8uXG4gICAgZmlsdGVyOiBoYXNoUXVlcnlbJ2ZpbHRlciddLFxuICAgIC8vIGFtcC1nZW8gb3ZlcnJpZGVcbiAgICBnZW9PdmVycmlkZTogaGFzaFF1ZXJ5WydhbXAtZ2VvJ10sXG4gICAgbWluaWZpZWQ6IElTX01JTklGSUVELFxuICAgIC8vIFdoZXRoZXIgZG9jdW1lbnQgaXMgaW4gYW4gYW1wLWxpdGUgdmlld2VyLiBJdCBzaWduYWwgdGhhdCB0aGUgdXNlclxuICAgIC8vIHdvdWxkIHByZWZlciB0byB1c2UgbGVzcyBiYW5kd2lkdGguXG4gICAgbGl0ZTogc2VhcmNoUXVlcnlbJ2FtcF9saXRlJ10gIT0gdW5kZWZpbmVkLFxuICAgIHRlc3Q6IHJ1bm5pbmdUZXN0cyxcbiAgICBsb2c6IGhhc2hRdWVyeVsnbG9nJ10sXG4gICAgdmVyc2lvbixcbiAgICBydHZWZXJzaW9uLFxuICB9O1xufVxuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBgcnR2VmVyc2lvbmAgd2hpY2ggd2lsbCBoYXZlIGEgbnVtZXJpYyBwcmVmaXhcbiAqIGRlbm90aW5nIGNhbmFyeS9wcm9kL2V4cGVyaW1lbnQgKHVubGVzcyBgaXNMb2NhbERldmAgaXMgdHJ1ZSkuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMb2NhbERldlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldikge1xuICAvLyBJZiBpdCdzIGxvY2FsIGRldiB0aGVuIHdlIHdvbid0IGFjdHVhbGx5IGhhdmUgYSBmdWxsIHZlcnNpb24gc29cbiAgLy8ganVzdCB1c2UgdGhlIHZlcnNpb24uXG4gIGlmIChpc0xvY2FsRGV2KSB7XG4gICAgcmV0dXJuIHZlcnNpb247XG4gIH1cblxuICBpZiAod2luLkFNUF9DT05GSUcgJiYgd2luLkFNUF9DT05GSUcudikge1xuICAgIHJldHVybiB3aW4uQU1QX0NPTkZJRy52O1xuICB9XG5cbiAgLy8gQ3VycmVudGx5IGAkaW50ZXJuYWxSdW50aW1lVmVyc2lvbiRgIGFuZCB0aHVzIGBtb2RlLnZlcnNpb25gIGNvbnRhaW4gb25seVxuICAvLyBtYWpvciB2ZXJzaW9uLiBUaGUgZnVsbCB2ZXJzaW9uIGhvd2V2ZXIgbXVzdCBhbHNvIGNhcnJ5IHRoZSBtaW5vciB2ZXJzaW9uLlxuICAvLyBXZSB3aWxsIGRlZmF1bHQgdG8gcHJvZHVjdGlvbiBkZWZhdWx0IGAwMWAgbWlub3IgdmVyc2lvbiBmb3Igbm93LlxuICAvLyBUT0RPKGVyd2lubW9tYmF5KTogZGVjaWRlIHdoZXRoZXIgJGludGVybmFsUnVudGltZVZlcnNpb24kIHNob3VsZCBjb250YWluXG4gIC8vIG1pbm9yIHZlcnNpb24uXG4gIHJldHVybiBgMDEke3ZlcnNpb259YDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTG9jYWxEZXZcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnR2VmVyc2lvbkZvclRlc3Rpbmcod2luLCBpc0xvY2FsRGV2KSB7XG4gIHJldHVybiBnZXRSdHZWZXJzaW9uKHdpbiwgaXNMb2NhbERldik7XG59XG5cblxuLyoqIEB2aXNpYmxlRm9yVGVzdGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0UnR2VmVyc2lvbkZvclRlc3RpbmcoKSB7XG4gIHJ0dlZlcnNpb24gPSAnJztcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2dldE1vZGV9IGZyb20gJy4vbW9kZSc7XG5pbXBvcnQge2luc3RhbGwgYXMgaW5zdGFsbEFycmF5SW5jbHVkZXN9IGZyb20gJy4vcG9seWZpbGxzL2FycmF5LWluY2x1ZGVzJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsQ3VzdG9tRWxlbWVudHN9IGZyb20gJy4vcG9seWZpbGxzL2N1c3RvbS1lbGVtZW50cyc7XG5pbXBvcnQge1xuICBpbnN0YWxsIGFzIGluc3RhbGxET01Ub2tlbkxpc3RUb2dnbGUsXG59IGZyb20gJy4vcG9seWZpbGxzL2RvbXRva2VubGlzdC10b2dnbGUnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxEb2NDb250YWluc30gZnJvbSAnLi9wb2x5ZmlsbHMvZG9jdW1lbnQtY29udGFpbnMnO1xuaW1wb3J0IHtpbnN0YWxsIGFzIGluc3RhbGxNYXRoU2lnbn0gZnJvbSAnLi9wb2x5ZmlsbHMvbWF0aC1zaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsT2JqZWN0QXNzaWdufSBmcm9tICcuL3BvbHlmaWxscy9vYmplY3QtYXNzaWduJztcbmltcG9ydCB7aW5zdGFsbCBhcyBpbnN0YWxsUHJvbWlzZX0gZnJvbSAnLi9wb2x5ZmlsbHMvcHJvbWlzZSc7XG5pbXBvcnQge2luc3RhbGxDdXN0b21FbGVtZW50cyBhcyBpbnN0YWxsUmVnaXN0ZXJFbGVtZW50fSBmcm9tXG4gICdkb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQucGF0Y2hlZCc7XG5pbXBvcnQge2lzRXhwZXJpbWVudE9ufSBmcm9tICcuL2V4cGVyaW1lbnRzJztcblxuaWYgKGlzRXhwZXJpbWVudE9uKHNlbGYsICdjdXN0b20tZWxlbWVudHMtdjEnKSB8fCBnZXRNb2RlKCkudGVzdCkge1xuICBpbnN0YWxsQ3VzdG9tRWxlbWVudHMoc2VsZiwgY2xhc3Mge30pO1xufSBlbHNlIHtcbiAgaW5zdGFsbFJlZ2lzdGVyRWxlbWVudChzZWxmLCAnYXV0bycpO1xufVxuaW5zdGFsbERPTVRva2VuTGlzdFRvZ2dsZShzZWxmKTtcbmluc3RhbGxNYXRoU2lnbihzZWxmKTtcbmluc3RhbGxPYmplY3RBc3NpZ24oc2VsZik7XG5pbnN0YWxsUHJvbWlzZShzZWxmKTtcbmluc3RhbGxEb2NDb250YWlucyhzZWxmKTtcbmluc3RhbGxBcnJheUluY2x1ZGVzKHNlbGYpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGVsZW1lbnQgaXMgaW4gdGhlIGFycmF5IGFuZCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfZnJvbUluZGV4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRoaXMge0FycmF5fVxuICovXG5mdW5jdGlvbiBpbmNsdWRlcyh2YWx1ZSwgb3B0X2Zyb21JbmRleCkge1xuICBjb25zdCBmcm9tSW5kZXggPSBvcHRfZnJvbUluZGV4IHx8IDA7XG4gIGNvbnN0IGxlbiA9IHRoaXMubGVuZ3RoO1xuICBsZXQgaSA9IGZyb21JbmRleCA+PSAwID8gZnJvbUluZGV4IDogTWF0aC5tYXgobGVuICsgZnJvbUluZGV4LCAwKTtcbiAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgIGNvbnN0IG90aGVyID0gdGhpc1tpXTtcbiAgICAvLyBJZiB2YWx1ZSBoYXMgYmVlbiBmb3VuZCBPUiAodmFsdWUgaXMgTmFOIEFORCBvdGhlciBpcyBOYU4pXG4gICAgLyplc2xpbnQgXCJuby1zZWxmLWNvbXBhcmVcIjogMCovXG4gICAgaWYgKG90aGVyID09PSB2YWx1ZSB8fCAodmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcikpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuKiBTZXRzIHRoZSBBcnJheS5jb250YWlucyBwb2x5ZmlsbCBpZiBpdCBkb2VzIG5vdCBleGlzdC5cbiogQHBhcmFtIHshV2luZG93fSB3aW5cbiovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogaW5jbHVkZXMsXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHt7XG4gKiAgIHByb21pc2U6ICFQcm9taXNlPHVuZGVmaW5lZD4sXG4gKiAgIHJlc29sdmU6IGZ1bmN0aW9uKCksXG4gKiB9fVxuICovXG5sZXQgRGVmZXJyZWREZWY7XG5cbi8qKlxuICogQHR5cGVkZWYgeyFGdW5jdGlvbn1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZjtcblxuLyoqXG4gKiBAdHlwZWRlZiB7e1xuICogIG5hbWU6IHN0cmluZyxcbiAqICBjdG9yOiAhQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmLFxuICogfX1cbiAqL1xubGV0IEN1c3RvbUVsZW1lbnREZWY7XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBjdXN0b20gZWxlbWVudCdzIG5hbWUuXG4gKiBUaGlzIGludGVudGlvbmFsbHkgaWdub3JlcyBcInZhbGlkXCIgaGlnaGVyIFVuaWNvZGUgQ29kZSBQb2ludHMuXG4gKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9jdXN0b20tZWxlbWVudHMuaHRtbCN2YWxpZC1jdXN0b20tZWxlbWVudC1uYW1lXG4gKi9cbmNvbnN0IFZBTElEX05BTUUgPSAvXlthLXpdW2EtejAtOS5fXSotW2EtejAtOS5fLV0qJC87XG5jb25zdCBJTlZBTElEX05BTUVTID0gW1xuICAnYW5ub3RhdGlvbi14bWwnLFxuICAnY29sb3ItcHJvZmlsZScsXG4gICdmb250LWZhY2UnLFxuICAnZm9udC1mYWNlLXNyYycsXG4gICdmb250LWZhY2UtdXJpJyxcbiAgJ2ZvbnQtZmFjZS1mb3JtYXQnLFxuICAnZm9udC1mYWNlLW5hbWUnLFxuICAnbWlzc2luZy1nbHlwaCcsXG5dO1xuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgY3VzdG9tIGVsZW1lbnQgbmFtZSBjb25mb3JtcyB0byB0aGUgc3BlYy5cbiAqXG4gKiBAcGFyYW0geyFGdW5jdGlvbn0gU3ludGF4RXJyb3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSkge1xuICBpZiAoIVZBTElEX05BTUUudGVzdChuYW1lKSB8fCBJTlZBTElEX05BTUVTLmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgaW52YWxpZCBjdXN0b20gZWxlbWVudCBuYW1lIFwiJHtuYW1lfVwiYCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEb2VzIHdpbiBoYXZlIGEgZnVsbCBDdXN0b20gRWxlbWVudHMgcmVnaXN0cnk/XG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGhhc0N1c3RvbUVsZW1lbnRzKHdpbikge1xuICBjb25zdCB7Y3VzdG9tRWxlbWVudHN9ID0gd2luO1xuXG4gIHJldHVybiAhIShcbiAgICBjdXN0b21FbGVtZW50cyAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmRlZmluZSAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLmdldCAmJlxuICAgIGN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKTtcbn1cblxuLyoqXG4gKiBXYXMgSFRNTEVsZW1lbnQgYWxyZWFkeSBwYXRjaGVkIGZvciB0aGlzIHdpbmRvdz9cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNQYXRjaGVkKHdpbikge1xuICBjb25zdCB0YWcgPSB3aW4uSFRNTEVsZW1lbnQudG9TdHJpbmcoKTtcbiAgcmV0dXJuIHRhZy5pbmRleE9mKCdbbmF0aXZlIGNvZGVdJykgPT09IC0xO1xufVxuXG4vKipcbiAqIFRoZSBwdWJsaWMgQ3VzdG9tIEVsZW1lbnRzIEFQSS5cbiAqL1xuY2xhc3MgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5IHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEBwYXJhbSB7IVJlZ2lzdHJ5fSByZWdpc3RyeVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luLCByZWdpc3RyeSkge1xuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMud2luXyA9IHdpbjtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMucmVnaXN0cnlfID0gcmVnaXN0cnk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7IU9iamVjdDxzdHJpbmcsIERlZmVycmVkRGVmPn1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdFxuICAgICAqL1xuICAgIHRoaXMucGVuZGluZ0RlZmluZXNfID0gdGhpcy53aW5fLk9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgdGhlIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0geyFDdXN0b21FbGVtZW50Q29uc3RydWN0b3JEZWZ9IGN0b3JcbiAgICogQHBhcmFtIHshT2JqZWN0PX0gb3B0aW9uc1xuICAgKi9cbiAgZGVmaW5lKG5hbWUsIGN0b3IsIG9wdGlvbnMpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy5kZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucyk7XG5cbiAgICAvLyBJZiBhbnlvbmUgaXMgd2FpdGluZyBmb3IgdGhpcyBjdXN0b20gZWxlbWVudCB0byBiZSBkZWZpbmVkLCByZXNvbHZlXG4gICAgLy8gdGhlaXIgcHJvbWlzZS5cbiAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5wZW5kaW5nRGVmaW5lc187XG4gICAgY29uc3QgZGVmZXJyZWQgPSBwZW5kaW5nW25hbWVdO1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgZGVsZXRlIHBlbmRpbmdbbmFtZV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29uc3RydWN0b3Igb2YgdGhlIChhbHJlYWR5IGRlZmluZWQpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAcmV0dXJuIHshQ3VzdG9tRWxlbWVudENvbnN0cnVjdG9yRGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldChuYW1lKSB7XG4gICAgY29uc3QgZGVmID0gdGhpcy5yZWdpc3RyeV8uZ2V0QnlOYW1lKG5hbWUpO1xuICAgIGlmIChkZWYpIHtcbiAgICAgIHJldHVybiBkZWYuY3RvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCB3YWl0cyB1bnRpbCB0aGUgY3VzdG9tIGVsZW1lbnQgaXMgZGVmaW5lZC5cbiAgICogSWYgdGhlIGN1c3RvbSBlbGVtZW50IGlzIGFscmVhZHkgZGVmaW5lZCwgcmV0dXJucyBhIHJlc29sdmVkIHByb21pc2UuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm4geyFQcm9taXNlPHVuZGVmaW5lZD59XG4gICAqL1xuICB3aGVuRGVmaW5lZChuYW1lKSB7XG4gICAgY29uc3Qge1Byb21pc2UsIFN5bnRheEVycm9yfSA9IHRoaXMud2luXztcbiAgICBhc3NlcnRWYWxpZE5hbWUoU3ludGF4RXJyb3IsIG5hbWUpO1xuXG4gICAgaWYgKHRoaXMucmVnaXN0cnlfLmdldEJ5TmFtZShuYW1lKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IHBlbmRpbmcgPSB0aGlzLnBlbmRpbmdEZWZpbmVzXztcbiAgICBjb25zdCBkZWZlcnJlZCA9IHBlbmRpbmdbbmFtZV07XG4gICAgaWYgKGRlZmVycmVkKSB7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzb2x2ZTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IC8qT0sqL1Byb21pc2UocmVzID0+IHJlc29sdmUgPSByZXMpO1xuICAgIHBlbmRpbmdbbmFtZV0gPSB7XG4gICAgICBwcm9taXNlLFxuICAgICAgcmVzb2x2ZSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogVXBncmFkZSBhbGwgY3VzdG9tIGVsZW1lbnRzIGluc2lkZSByb290LlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqL1xuICB1cGdyYWRlKHJvb3QpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5Xy51cGdyYWRlKHJvb3QpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcm5hbCBBUElzIG5lY2Vzc2FyeSB0byBydW4gdGhlIEN1c3RvbUVsZW1lbnRSZWdpc3RyeS5cbiAqIFNpbmNlIFJlZ2lzdHJ5IGlzIG5ldmVyIGV4cG9zZWQgZXh0ZXJuYWxseSwgYWxsIG1ldGhvZHMgYXJlIGFjdHVhbGx5XG4gKiBhdmFpbGFibGUgb24gdGhlIGluc3RhbmNlLlxuICovXG5jbGFzcyBSZWdpc3RyeSB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy53aW5fID0gd2luO1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGUgQGNvbnN0XG4gICAgICovXG4gICAgdGhpcy5kb2NfID0gd2luLmRvY3VtZW50O1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCAhQ3VzdG9tRWxlbWVudERlZj59XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RcbiAgICAgKi9cbiAgICB0aGlzLmRlZmluaXRpb25zXyA9IHdpbi5PYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgLyoqXG4gICAgICogQSB1cC10by1kYXRlIERPTSBzZWxlY3RvciBmb3IgYWxsIGN1c3RvbSBlbGVtZW50cy5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHRoaXMucXVlcnlfID0gJyc7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudGx5IHVwZ3JhZGluZyBlbGVtZW50LlxuICAgICAqIEBwcml2YXRlIHtFbGVtZW50fVxuICAgICAqL1xuICAgIHRoaXMuY3VycmVudF8gPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHktYmVpbmctdXBncmFkZWQgY3VzdG9tIGVsZW1lbnQuXG4gICAqXG4gICAqIFdoZW4gYW4gYWxyZWFkeSBjcmVhdGVkICh0aHJvdWdoIHRoZSBET00gcGFyc2luZyBBUElzLCBvciBpbm5lckhUTUwpXG4gICAqIGN1c3RvbSBlbGVtZW50IG5vZGUgaXMgYmVpbmcgdXBncmFkZWQsIHdlIGNhbid0IGp1c3QgY3JlYXRlIGEgbmV3IG5vZGVcbiAgICogKGl0J3MgaWxsZWdhbCBpbiB0aGUgc3BlYykuIEJ1dCB3ZSBzdGlsbCBuZWVkIHRvIHJ1biB0aGUgY3VzdG9tIGVsZW1lbnQnc1xuICAgKiBjb25zdHJ1Y3RvciBjb2RlIG9uIHRoZSBub2RlLiBXZSBhdm9pZCB0aGlzIGNvbnVuZHJ1bSBieSBydW5uaW5nIHRoZVxuICAgKiBjb25zdHJ1Y3RvciB3aGlsZSByZXR1cm5pbmcgdGhpcyBjdXJyZW50IG5vZGUgaW4gdGhlIEhUTUxFbGVtZW50XG4gICAqIGNsYXNzIGNvbnN0cnVjdG9yICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKS5cbiAgICpcbiAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICovXG4gIGN1cnJlbnQoKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudF87XG4gICAgdGhpcy5jdXJyZW50XyA9IG51bGw7XG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluaXRpb24gYnkgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICogQHJldHVybiB7Q3VzdG9tRWxlbWVudERlZnx1bmRlZmluZWR9XG4gICAqL1xuICBnZXRCeU5hbWUobmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSB0aGlzLmRlZmluaXRpb25zX1tuYW1lXTtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGJ5IGNvbnN0cnVjdG9yIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcGFyYW0ge0N1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcmV0dXJuIHtDdXN0b21FbGVtZW50RGVmfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldEJ5Q29uc3RydWN0b3IoY3Rvcikge1xuICAgIGNvbnN0IGRlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9uc187XG5cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGVmaW5pdGlvbnMpIHtcbiAgICAgIGNvbnN0IGRlZiA9IGRlZmluaXRpb25zW25hbWVdO1xuICAgICAgaWYgKGRlZi5jdG9yID09PSBjdG9yKSB7XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVycyB0aGUgY3VzdG9tIGVsZW1lbnQgZGVmaW5pdGlvbiwgYW5kIHVwZ3JhZGVzIGFsbCBlbGVtZW50cyBieSB0aGF0XG4gICAqIG5hbWUgaW4gdGhlIHJvb3QgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnRDb25zdHJ1Y3RvckRlZn0gY3RvclxuICAgKiBAcGFyYW0geyFPYmplY3R8dW5kZWZpbmVkfSBvcHRpb25zXG4gICAqL1xuICBkZWZpbmUobmFtZSwgY3Rvciwgb3B0aW9ucykge1xuICAgIGNvbnN0IHtFcnJvciwgU3ludGF4RXJyb3J9ID0gdGhpcy53aW5fO1xuXG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXh0ZW5kaW5nIG5hdGl2ZSBjdXN0b20gZWxlbWVudHMgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGFzc2VydFZhbGlkTmFtZShTeW50YXhFcnJvciwgbmFtZSk7XG5cbiAgICBpZiAodGhpcy5nZXRCeU5hbWUobmFtZSkgfHxcbiAgICAgICAgdGhpcy5nZXRCeUNvbnN0cnVjdG9yKGN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGR1cGxpY2F0ZSBkZWZpbml0aW9uIFwiJHtuYW1lfVwiYCk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogUmVjb3JkIGNvbm5lY3RlZENhbGxiYWNrLCBkaXNjb25uZWN0ZWRDYWxsYmFjayxcbiAgICAvLyBhZG9wdGVkQ2FsbGJhY2ssIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjaywgYW5kIG9ic2VydmVkQXR0cmlidXRlcy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJZiBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2ssIGdhdGhlciBvYnNlcnZlZEF0dHJpYnV0ZXNcbiAgICB0aGlzLmRlZmluaXRpb25zX1tuYW1lXSA9IHtcbiAgICAgIG5hbWUsXG4gICAgICBjdG9yLFxuICAgIH07XG5cbiAgICB0aGlzLm9ic2VydmVfKG5hbWUpO1xuICAgIHRoaXMudXBncmFkZSh0aGlzLmRvY18sIG5hbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZ3JhZGVzIGN1c3RvbSBlbGVtZW50cyBkZXNjZW5kYW50cyBvZiByb290IChidXQgbm90IGluY2x1ZGluZyByb290KS5cbiAgICpcbiAgICogV2hlbiBjYWxsZWQgd2l0aCBhbiBvcHRfcXVlcnksIGl0IGJvdGggdXBncmFkZXMgYW5kIGNvbm5lY3RzIHRoZSBjdXN0b21cbiAgICogZWxlbWVudHMgKHRoaXMgaXMgdXNlZCBkdXJpbmcgdGhlIGN1c3RvbSBlbGVtZW50IGRlZmluZSBhbGdvcml0aG0pLlxuICAgKlxuICAgKiBAcGFyYW0geyFOb2RlfSByb290XG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gb3B0X3F1ZXJ5XG4gICAqL1xuICB1cGdyYWRlKHJvb3QsIG9wdF9xdWVyeSkge1xuICAgIC8vIE9ubHkgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5LnAuZGVmaW5lIHByb3ZpZGVzIGEgcXVlcnkgKHRoZSBuZXdseSBkZWZpbmVkXG4gICAgLy8gY3VzdG9tIGVsZW1lbnQpLiBJbiB0aGlzIGNhc2UsIHdlIGFyZSBib3RoIHVwZ3JhZGluZyBfYW5kXyBjb25uZWN0aW5nXG4gICAgLy8gdGhlIGN1c3RvbSBlbGVtZW50cy5cbiAgICBjb25zdCBuZXdseURlZmluZWQgPSAhIW9wdF9xdWVyeTtcbiAgICBjb25zdCBxdWVyeSA9IG9wdF9xdWVyeSB8fCB0aGlzLnF1ZXJ5XztcbiAgICBjb25zdCB1cGdyYWRlQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKHJvb3QsIHF1ZXJ5KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZUNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHVwZ3JhZGVDYW5kaWRhdGVzW2ldO1xuICAgICAgaWYgKG5ld2x5RGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhjYW5kaWRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51cGdyYWRlU2VsZihjYW5kaWRhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgY3VzdG9tIGVsZW1lbnQgbm9kZSwgaWYgYSBjdXN0b20gZWxlbWVudCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gICAqIGJ5IHRoaXMgbmFtZS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgdXBncmFkZVNlbGYobm9kZSkge1xuICAgIGNvbnN0IGRlZiA9IHRoaXMuZ2V0QnlOYW1lKG5vZGUubG9jYWxOYW1lKTtcbiAgICBpZiAoIWRlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudXBncmFkZVNlbGZfKC8qKiBAdHlwZSB7IUVsZW1lbnR9ICovKG5vZGUpLCBkZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IU5vZGV9IHJvb3RcbiAgICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5XG4gICAqIEByZXR1cm4geyFBcnJheXwhTm9kZUxpc3R9XG4gICAqL1xuICBxdWVyeUFsbF8ocm9vdCwgcXVlcnkpIHtcbiAgICBpZiAoIXF1ZXJ5IHx8ICFyb290LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcbiAgICAgIC8vIE5vdGhpbmcgdG8gZG8uLi5cbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGdyYWRlcyB0aGUgKGFscmVhZHkgY3JlYXRlZCB2aWEgRE9NIHBhcnNpbmcpIGN1c3RvbSBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fSBub2RlXG4gICAqIEBwYXJhbSB7IUN1c3RvbUVsZW1lbnREZWZ9IGRlZlxuICAgKi9cbiAgdXBncmFkZVNlbGZfKG5vZGUsIGRlZikge1xuICAgIGNvbnN0IHtjdG9yfSA9IGRlZjtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIGN0b3IpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEZXNwaXRlIGhvdyBpdCBsb29rcywgdGhpcyBpcyBub3QgYSB1c2VsZXNzIGNvbnN0cnVjdGlvbi5cbiAgICAvLyBIVE1MRWxlbWVudFBvbHlmaWxsICh0aGUgYmFzZSBjbGFzcyBvZiBhbGwgY3VzdG9tIGVsZW1lbnRzKSB3aWxsIHJldHVyblxuICAgIC8vIHRoZSBjdXJyZW50IG5vZGUsIGFsbG93aW5nIHRoZSBjdXN0b20gZWxlbWVudCdzIHN1YmNsYXNzIGNvbnN0cnVjdG9yIHRvXG4gICAgLy8gcnVuIG9uIHRoZSBub2RlLiBUaGUgbm9kZSBpdHNlbGYgaXMgYWxyZWFkeSBjb25zdHJ1Y3RlZCwgc28gdGhlIHJldHVyblxuICAgIC8vIHZhbHVlIGlzIGp1c3QgdGhlIG5vZGUuXG4gICAgdGhpcy5jdXJyZW50XyA9IG5vZGU7XG4gICAgY29uc3QgZWwgPSBuZXcgY3RvcigpO1xuXG4gICAgaWYgKGVsICE9PSBub2RlKSB7XG4gICAgICB0aHJvdyBuZXcgdGhpcy53aW5fLkVycm9yKFxuICAgICAgICAgICdDb25zdHJ1Y3RvciBpbGxlZ2FsbHkgcmV0dXJuZWQgYSBkaWZmZXJlbnQgaW5zdGFuY2UuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZpcmVzIGNvbm5lY3RlZENhbGxiYWNrIG9uIHRoZSBjdXN0b20gZWxlbWVudCwgaWYgaXQgaGFzIG9uZS5cbiAgICogVGhpcyBhbHNvIHVwZ3JhZGVzIHRoZSBjdXN0b20gZWxlbWVudCwgc2luY2UgaXQgbWF5IG5vdCBoYXZlIGJlZW5cbiAgICogYWNjZXNzaWJsZSB2aWEgdGhlIHJvb3QgZG9jdW1lbnQgYmVmb3JlIChhIGRldGFjaGVkIERPTSB0cmVlKS5cbiAgICpcbiAgICogQHBhcmFtIHshTm9kZX0gbm9kZVxuICAgKi9cbiAgY29ubmVjdGVkQ2FsbGJhY2tfKG5vZGUpIHtcbiAgICBjb25zdCBkZWYgPSB0aGlzLmdldEJ5TmFtZShub2RlLmxvY2FsTmFtZSk7XG4gICAgaWYgKCFkZWYpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGdyYWRlU2VsZl8oLyoqIEB0eXBlIHshRWxlbWVudH0gKi8obm9kZSksIGRlZik7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSXQgbWF5IGJlIGFwcHJvcHJpYXRlIHRvIGFkb3B0Q2FsbGJhY2ssIGlmIHRoZSBub2RlXG4gICAgLy8gdXNlZCB0byBiZSBpbiBhbm90aGVyIGRvYy5cbiAgICAvLyBUT0RPKGpyaWRnZXdlbGwpOiBJIHNob3VsZCBiZSBjYWxsaW5nIHRoZSBkZWZpbml0aW9ucyBjb25uZWN0ZWRDYWxsYmFja1xuICAgIC8vIHdpdGggbm9kZSBhcyB0aGUgY29udGV4dC5cbiAgICBpZiAobm9kZS5jb25uZWN0ZWRDYWxsYmFjaykge1xuICAgICAgbm9kZS5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGaXJlcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBvbiB0aGUgY3VzdG9tIGVsZW1lbnQsIGlmIGl0IGhhcyBvbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7IU5vZGV9IG5vZGVcbiAgICovXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrXyhub2RlKSB7XG4gICAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogSSBzaG91bGQgYmUgY2FsbGluZyB0aGUgZGVmaW5pdGlvbnMgY29ubmVjdGVkQ2FsbGJhY2tcbiAgICAvLyB3aXRoIG5vZGUgYXMgdGhlIGNvbnRleHQuXG4gICAgaWYgKG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2spIHtcbiAgICAgIG5vZGUuZGlzY29ubmVjdGVkQ2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkcyBuYW1lIGFzIGEgcmVnaXN0ZXJlZCBjdXN0b20gZWxlbWVudCB0byBvYnNlcnZlLlxuICAgKlxuICAgKiBTdGFydHMgdGhlIE11dGF0aW9uIE9ic2VydmVyIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHJlZ2lzdGVyZWQgY3VzdG9tXG4gICAqIGVsZW1lbnQuIFRoaXMgaXMgZGVmZXJyZWQgdW50aWwgdGhlIGZpcnN0IGN1c3RvbSBlbGVtZW50IGlzIGRlZmluZWQgdG9cbiAgICogc3BlZWQgdXAgaW5pdGlhbCByZW5kZXJpbmcgb2YgdGhlIHBhZ2UuXG4gICAqXG4gICAqIE11dGF0aW9uIE9ic2VydmVycyBhcmUgY29udmVuaWVudGx5IGF2YWlsYWJsZSBpbiBldmVyeSBicm93c2VyIHdlIGNhcmVcbiAgICogYWJvdXQuIFdoZW4gYSBub2RlIGlzIGNvbm5lY3RlZCB0byB0aGUgcm9vdCBkb2N1bWVudCwgYWxsIGN1c3RvbVxuICAgKiBlbGVtZW50cyAoaW5jbHVkaW5nIHRoYXQgbm9kZSBpdGVzZWxmKSB3aWxsIGJlIHVwZ3JhZGVkIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBXaGVuIGEgbm9kZSBpcyBkaXNjb25uZWN0ZWRDYWxsYmFjayBmcm9tIHRoZSByb290XG4gICAqIGRvY3VtZW50LCBhbGwgY3VzdG9tIGVsZW1lbnRzIHdpbGwgY2FsbCBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICovXG4gIG9ic2VydmVfKG5hbWUpIHtcbiAgICBpZiAodGhpcy5xdWVyeV8pIHtcbiAgICAgIHRoaXMucXVlcnlfICs9IGAsJHtuYW1lfWA7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5xdWVyeV8gPSBuYW1lO1xuXG4gICAgLy8gVGhlIGZpcnN0IHJlZ2lzdGVyZWQgbmFtZSBzdGFydHMgdGhlIG11dGF0aW9uIG9ic2VydmVyLlxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IHRoaXMud2luXy5NdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgaWYgKHJlY29yZHMpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVSZWNvcmRzXyhyZWNvcmRzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuZG9jXywge1xuICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgYWxsIHRoZSBNdXRhdGlvbiBPYnNlcnZlcidzIE11dGF0aW9uIFJlY29yZHMuXG4gICAqIEFsbCBhZGRlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBiZSB1cGdyYWRlZCAoaWYgbm90IGFscmVhZHkpIGFuZCBjYWxsXG4gICAqIGNvbm5lY3RlZENhbGxiYWNrLiBBbGwgcmVtb3ZlZCBjdXN0b20gZWxlbWVudHMgd2lsbCBjYWxsXG4gICAqIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICAgKlxuICAgKiBAcGFyYW0geyFBcnJheTwhTXV0YXRpb25SZWNvcmQ+fSByZWNvcmRzXG4gICAqL1xuICBoYW5kbGVSZWNvcmRzXyhyZWNvcmRzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByZWNvcmQgPSByZWNvcmRzW2ldO1xuICAgICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHthZGRlZE5vZGVzLCByZW1vdmVkTm9kZXN9ID0gcmVjb3JkO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhZGRlZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBhZGRlZE5vZGVzW2ldO1xuICAgICAgICBjb25zdCBjb25uZWN0ZWRDYW5kaWRhdGVzID0gdGhpcy5xdWVyeUFsbF8obm9kZSwgdGhpcy5xdWVyeV8pO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENhbGxiYWNrXyhub2RlKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25uZWN0ZWRDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0ZWRDYWxsYmFja18oY29ubmVjdGVkQ2FuZGlkYXRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdmVkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHJlbW92ZWROb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcyA9IHRoaXMucXVlcnlBbGxfKG5vZGUsIHRoaXMucXVlcnlfKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0ZWRDYWxsYmFja18obm9kZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlzY29ubmVjdGVkQ2FuZGlkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRoaXMuZGlzY29ubmVjdGVkQ2FsbGJhY2tfKGRpc2Nvbm5lY3RlZENhbmRpZGF0ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRG9lcyB0aGUgcG9seWZpbGxpbmcuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5mdW5jdGlvbiBwb2x5ZmlsbCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBFbGVtZW50LCBOb2RlLCBEb2N1bWVudCwgT2JqZWN0LCBkb2N1bWVudH0gPSB3aW47XG4gIGNvbnN0IHtjcmVhdGVFbGVtZW50LCBjbG9uZU5vZGUsIGltcG9ydE5vZGV9ID0gZG9jdW1lbnQ7XG5cbiAgY29uc3QgcmVnaXN0cnkgPSBuZXcgUmVnaXN0cnkod2luKTtcbiAgY29uc3QgY3VzdG9tRWxlbWVudHMgPSBuZXcgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5KHdpbiwgcmVnaXN0cnkpO1xuXG4gIC8vIEV4cG9zZSB0aGUgY3VzdG9tIGVsZW1lbnQgcmVnaXN0cnkuXG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnY3VzdG9tRWxlbWVudHMnKVxuICAvLyB7Z2V0OiDGkiwgc2V0OiB1bmRlZmluZWQsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZX1cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbiwgJ2N1c3RvbUVsZW1lbnRzJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIC8vIHdyaXRhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogY3VzdG9tRWxlbWVudHMsXG4gIH0pO1xuXG4gIC8vIFBhdGNoIGNyZWF0ZUVsZW1lbnQgdG8gaW1tZWRpYXRlbHkgdXBncmFkZSB0aGUgY3VzdG9tIGVsZW1lbnQuXG4gIC8vIFRoaXMgaGFzIHRoZSBhZGRlZCBiZW5lZml0IHRoYXQgaXQgYXZvaWRzIHRoZSBcImFscmVhZHkgY3JlYXRlZCBidXQgbmVlZHNcbiAgLy8gY29uc3RydWN0b3IgY29kZSBydW5cIiBjaGlja2VuLWFuZC1lZ2cgcHJvYmxlbS5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiBjcmVhdGVFbGVtZW50UG9seWZpbGwobmFtZSkge1xuICAgIGNvbnN0IGRlZiA9IHJlZ2lzdHJ5LmdldEJ5TmFtZShuYW1lKTtcbiAgICBpZiAoZGVmKSB7XG4gICAgICByZXR1cm4gbmV3IGRlZi5jdG9yKCk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgLy8gUGF0Y2ggaW1wb3J0Tm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gVE9ETyhqcmlkZ2V3ZWxsKTogQ2FuIGZpcmUgYWRvcHRlZENhbGxiYWNrIGZvciBjcm9zcyBkb2MgaW1wb3J0cy5cbiAgRG9jdW1lbnQucHJvdG90eXBlLmltcG9ydE5vZGUgPSBmdW5jdGlvbiBpbXBvcnROb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgaW1wb3J0ZWQgPSBpbXBvcnROb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGltcG9ydGVkKSB7XG4gICAgICByZWdpc3RyeS51cGdyYWRlU2VsZihpbXBvcnRlZCk7XG4gICAgICByZWdpc3RyeS51cGdyYWRlKGltcG9ydGVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGltcG9ydGVkO1xuICB9O1xuXG4gIC8vIFBhdGNoIGNsb25lTm9kZSB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgTm9kZS5wcm90b3R5cGUuY2xvbmVOb2RlID0gZnVuY3Rpb24gY2xvbmVOb2RlUG9seWZpbGwoKSB7XG4gICAgY29uc3QgY2xvbmVkID0gY2xvbmVOb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgcmVnaXN0cnkudXBncmFkZVNlbGYoY2xvbmVkKTtcbiAgICByZWdpc3RyeS51cGdyYWRlKGNsb25lZCk7XG4gICAgcmV0dXJuIGNsb25lZDtcbiAgfTtcblxuICAvLyBQYXRjaCB0aGUgaW5uZXJIVE1MIHNldHRlciB0byBpbW1lZGlhdGVseSB1cGdyYWRlIGN1c3RvbSBlbGVtZW50cy5cbiAgLy8gTm90ZSwgdGhpcyBjb3VsZCB0ZWNobmljYWxseSBmaXJlIGNvbm5lY3RlZENhbGxiYWNrcyBpZiB0aGlzIG5vZGUgd2FzXG4gIC8vIGNvbm5lY3RlZCwgYnV0IHdlIGxlYXZlIHRoYXQgdG8gdGhlIE11dGF0aW9uIE9ic2VydmVyLlxuICBjb25zdCBpbm5lckhUTUxEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFbGVtZW50LnByb3RvdHlwZSxcbiAgICAgICdpbm5lckhUTUwnKTtcbiAgY29uc3QgaW5uZXJIVE1MU2V0dGVyID0gaW5uZXJIVE1MRGVzYy5zZXQ7XG4gIGlubmVySFRNTERlc2Muc2V0ID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlubmVySFRNTFNldHRlci5jYWxsKHRoaXMsIGh0bWwpO1xuICAgIHJlZ2lzdHJ5LnVwZ3JhZGUodGhpcyk7XG4gIH07XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2lubmVySFRNTCcsIGlubmVySFRNTERlc2MpO1xuXG4gIC8qKlxuICAgKiBZb3UgY2FuJ3QgdXNlIHRoZSByZWFsIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yLCBiZWNhdXNlIHlvdSBjYW4ndCBzdWJjbGFzc1xuICAgKiBpdCB3aXRob3V0IHVzaW5nIG5hdGl2ZSBjbGFzc2VzLiBTbywgbW9jayBpdHMgYXBwcm94aW1hdGlvbiB1c2luZ1xuICAgKiBjcmVhdGVFbGVtZW50LlxuICAgKi9cbiAgZnVuY3Rpb24gSFRNTEVsZW1lbnRQb2x5ZmlsbCgpIHtcbiAgICBjb25zdCB7Y29uc3RydWN0b3J9ID0gdGhpcztcblxuICAgIC8vIElmIHdlJ3JlIHVwZ3JhZGluZyBhbiBhbHJlYWR5IGNyZWF0ZWQgY3VzdG9tIGVsZW1lbnQsIHdlIGNhbid0IGNyZWF0ZVxuICAgIC8vIGFub3RoZXIgbmV3IG5vZGUgKGJ5IHRoZSBzcGVjLCBpdCBtdXN0IGJlIHRoZSBzYW1lIG5vZGUpLlxuICAgIGxldCBlbCA9IHJlZ2lzdHJ5LmN1cnJlbnQoKTtcblxuICAgIC8vIElmIHRoZXJlJ3Mgbm90IGEgYWxyZWFkeSBjcmVhdGVkIGN1c3RvbSBlbGVtZW50LCB3ZSdyZSBiZWluZyBpbnZva2VkIHZpYVxuICAgIC8vIGBuZXdgaW5nIHRoZSBjb25zdHJ1Y3Rvci5cbiAgICAvL1xuICAgIC8vIFRlY2huaWNhbGx5LCB3ZSBjb3VsZCBnZXQgaGVyZSB2aWEgY3JlYXRlRWxlbWVudCwgYnV0IHdlIHBhdGNoZWQgdGhhdC5cbiAgICAvLyBJZiBpdCB0aGUgY3VzdG9tIGVsZW1lbnQgd2FzIHJlZ2lzdGVyZWQsIHRoZSBwYXRjaCB0dXJuZWQgaXQgaW50byBhXG4gICAgLy8gYG5ld2AgY2FsbC5cbiAgICAvLyBJZiBpdCB3YXMgbm90IHJlZ2lzdGVyZWQsIHRoZSBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyB1c2VkLiBBbmQgaWZcbiAgICAvLyBuYXRpdmUgY3JlYXRlRWxlbWVudCBpcyBiZWluZyB1c2VkIGFuZCB3ZSBnb3QgdG8gdGhpcyBjb2RlLCB3ZSdyZSByZWFsbHlcbiAgICAvLyBpbiBhbiBpbmZpbml0ZSBsb29wIChhIG5hdGl2ZSBjcmVhdGVFbGVtZW50IGNhbGwganVzdCBiZWxvdykgc28gd2UndmVcbiAgICAvLyBnb3QgYmlnZ2VyIHByb2JsZW1zLlxuICAgIC8vXG4gICAgLy8gU28ganVzdCB0YWtlIG15IHdvcmQgd2UgZ290IGhlcmUgdmlhIGBuZXdgLlxuICAgIGlmICghZWwpIHtcbiAgICAgIC8vIFRoZSBjdXN0b20gZWxlbWVudCBkZWZpbml0aW9uIGlzIGFuIGludmFyaWFudC4gSWYgdGhlIGN1c3RvbSBlbGVtZW50XG4gICAgICAvLyBpcyByZWdpc3RlcmVkLCBldmVyeXRoaW5nIHdvcmtzLiBJZiBpdCdzIG5vdCwgaXQgdGhyb3dzIGluIHRoZSBtZW1iZXJcbiAgICAgIC8vIHByb3BlcnR5IGFjY2VzcyAob25seSBkZWZpbmVkIGN1c3RvbSBlbGVtZW50cyBjYW4gYmUgZGlyZWN0bHlcbiAgICAgIC8vIGNvbnN0cnVjdGVkIHZpYSBgbmV3YCkuXG4gICAgICBjb25zdCBkZWYgPSByZWdpc3RyeS5nZXRCeUNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICAgIGVsID0gY3JlYXRlRWxlbWVudC5jYWxsKGRvY3VtZW50LCBkZWYubmFtZSk7XG4gICAgfVxuXG4gICAgLy8gRmluYWxseSwgaWYgdGhlIG5vZGUgd2FzIGFscmVhZHkgY29uc3RydWN0ZWQsIHdlIG5lZWQgdG8gcmVzZXQgaXQnc1xuICAgIC8vIHByb3RvdHlwZSB0byB0aGUgY3VzdG9tIGVsZW1lbnQgcHJvdG90eXBlLiBBbmQgaWYgaXQgd2Fzbid0IGFscmVhZHlcbiAgICAvLyBjb25zdHJ1Y3RlZCwgd2UgY3JlYXRlZCBhIG5ldyBub2RlIHZpYSBuYXRpdmUgY3JlYXRlRWxlbWVudCwgYW5kIHdlIG5lZWRcbiAgICAvLyB0byByZXNldCBpdCdzIHByb3RvdHlwZS4gQmFzaWNhbGx5IGFsd2F5cyByZXNldCB0aGUgcHJvdG90eXBlLlxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihlbCwgY29uc3RydWN0b3IucHJvdG90eXBlKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cbiAgc3ViQ2xhc3MoT2JqZWN0LCBIVE1MRWxlbWVudCwgSFRNTEVsZW1lbnRQb2x5ZmlsbCk7XG5cbiAgLy8gRXhwb3NlIHRoZSBwb2x5ZmlsbGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRQb2x5ZmlsbDtcbn1cblxuLyoqXG4gKiBXcmFwcyBIVE1MRWxlbWVudCBpbiBhIFJlZmxlY3QuY29uc3RydWN0IGNvbnN0cnVjdG9yLCBzbyB0aGF0IHRyYW5zcGlsZWRcbiAqIGNsYXNzZXMgY2FuIGBfdGhpcyA9IHN1cGVyQ2xhc3MuY2FsbCh0aGlzKWAgZHVyaW5nIHRoZWlyIGNvbnN0cnVjdGlvbi5cbiAqXG4gKiBUaGlzIGlzIG9ubHkgdXNlZCB3aGVuIEN1c3RvbSBFbGVtZW50cyB2MSBpcyBhbHJlYWR5IGF2YWlsYWJsZSBfYW5kXyB3ZSdyZVxuICogdXNpbmcgdHJhbnNwaWxlZCBjbGFzc2VzICh3aGljaCB1c2UgRVM1IGNvbnN0cnVjdGlvbiBpZGlvbXMpLlxuICpcbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKi9cbmZ1bmN0aW9uIHdyYXBIVE1MRWxlbWVudCh3aW4pIHtcbiAgY29uc3Qge0hUTUxFbGVtZW50LCBSZWZsZWN0LCBPYmplY3R9ID0gd2luO1xuICAvKipcbiAgICovXG4gIGZ1bmN0aW9uIEhUTUxFbGVtZW50V3JhcHBlcigpIHtcbiAgICBjb25zdCBjdG9yID0gLyoqIEB0eXBlIHtmdW5jdGlvbiguLi4/KTo/fHVuZGVmaW5lZH0gKi8oXG4gICAgICAvKiogQHR5cGUgeyFIVE1MRWxlbWVudH0gKi8odGhpcykuY29uc3RydWN0b3IpO1xuXG4gICAgLy8gUmVmbGVjdC5jb25zdHJ1Y3QgYWxsb3dzIHVzIHRvIGNvbnN0cnVjdCBhIG5ldyBIVE1MRWxlbWVudCB3aXRob3V0IHVzaW5nXG4gICAgLy8gYG5ld2AgKHdoaWNoIHdpbGwgYWx3YXlzIGZhaWwgYmVjYXVzZSBuYXRpdmUgSFRNTEVsZW1lbnQgaXMgYSByZXN0cmljdGVkXG4gICAgLy8gY29uc3RydWN0b3IpLlxuICAgIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MRWxlbWVudCwgW10sIGN0b3IpO1xuICB9XG4gIHN1YkNsYXNzKE9iamVjdCwgSFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50V3JhcHBlcik7XG5cbiAgLy8gRXhwb3NlIHRoZSB3cmFwcGVkIEhUTUxFbGVtZW50IGNvbnN0cnVjdG9yIGZvciBldmVyeW9uZSB0byBleHRlbmQgZnJvbS5cbiAgd2luLkhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnRXcmFwcGVyO1xufVxuXG4vKipcbiAqIFNldHVwcyB1cCBwcm90b3R5cGUgaW5oZXJpdGFuY2VcbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IE9iamVjdFxuICogQHBhcmFtIHshRnVuY3Rpb259IHN1cGVyQ2xhc3NcbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBzdWJDbGFzc1xuICovXG5mdW5jdGlvbiBzdWJDbGFzcyhPYmplY3QsIHN1cGVyQ2xhc3MsIHN1YkNsYXNzKSB7XG4gIC8vIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc3VwZXJDbGFzcy5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicpXG4gIC8vIHt2YWx1ZTogxpIsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZSwgY29uZmlndXJhYmxlOiB0cnVlfVxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIC8vIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogc3ViQ2xhc3MsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8qKlxuICogUG9seWZpbGxzIEN1c3RvbSBFbGVtZW50cyB2MSBBUEkuIFRoaXMgaGFzIDQgbW9kZXM6XG4gKlxuICogMS4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogMi4gQ3VzdG9tIGVsZW1lbnRzIHYxIGFscmVhZHkgc3VwcG9ydGVkLCB1c2luZyB0cmFuc3BpbGVkIGNsYXNzZXNcbiAqIDMuIEN1c3RvbSBlbGVtZW50cyB2MSBub3Qgc3VwcG9ydGVkLCB1c2luZyBuYXRpdmUgY2xhc3Nlc1xuICogNC4gQ3VzdG9tIGVsZW1lbnRzIHYxIG5vdCBzdXBwb3J0ZWQsIHVzaW5nIHRyYW5zcGlsZWQgY2xhc3Nlc1xuICpcbiAqIEluIG1vZGUgMSwgbm90aGluZyBpcyBkb25lLiBJbiBtb2RlIDIsIGEgbWluaW1hbCBwb2x5ZmlsbCBpcyB1c2VkIHRvIHN1cHBvcnRcbiAqIGV4dGVuZGluZyB0aGUgSFRNTEVsZW1lbnQgYmFzZSBjbGFzcy4gSW4gbW9kZSAzIGFuZCA0LCBhIGZ1bGwgcG9seWZpbGwgaXNcbiAqIGRvbmUuXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUZ1bmN0aW9ufSBjdG9yXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnN0YWxsKHdpbiwgY3Rvcikge1xuICBpZiAoaXNQYXRjaGVkKHdpbikpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaW5zdGFsbCA9IHRydWU7XG4gIGxldCBpbnN0YWxsV3JhcHBlciA9IGZhbHNlO1xuXG4gIGlmIChoYXNDdXN0b21FbGVtZW50cyh3aW4pKSB7XG4gICAgLy8gSWYgY3RvciBpcyBjb25zdHJ1Y3RhYmxlIHdpdGhvdXQgbmV3LCBpdCdzIGEgZnVuY3Rpb24uIFRoYXQgbWVhbnMgaXQgd2FzXG4gICAgLy8gY29tcGlsZWQgZG93biwgYW5kIHdlIG5lZWQgdG8gZG8gdGhlIG1pbmltYWwgcG9seWZpbGwgYmVjYXVzZSBhbGwgeW91XG4gICAgLy8gY2Fubm90IGV4dGVuZCBIVE1MRWxlbWVudCB3aXRob3V0IG5hdGl2ZSBjbGFzc2VzLlxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7T2JqZWN0LCBSZWZsZWN0fSA9IHdpbjtcblxuICAgICAgLy8gXCJDb25zdHJ1Y3RcIiBjdG9yIHVzaW5nIEVTNSBpZGlvbXNcbiAgICAgIGNvbnN0IGluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShjdG9yLnByb3RvdHlwZSk7XG4gICAgICBjdG9yLmNhbGwoaW5zdGFuY2UpO1xuXG4gICAgICAvLyBJZiB0aGF0IHN1Y2NlZWRlZCwgd2UncmUgaW4gYSB0cmFuc3BpbGVkIGVudmlyb25tZW50XG4gICAgICAvLyBMZXQncyBmaW5kIG91dCBpZiB3ZSBjYW4gd3JhcCBIVE1MRWxlbWVudCBhbmQgYXZvaWQgYSBmdWxsIHBhdGNoLlxuICAgICAgaW5zdGFsbFdyYXBwZXIgPSAhIShSZWZsZWN0ICYmIFJlZmxlY3QuY29uc3RydWN0KTtcbiAgICB9IGNhdGNoIChlKSB7XG5cbiAgICAgIC8vIFRoZSBjdG9yIHRocmV3IHdoZW4gd2UgY29uc3RydWN0ZWQgaXMgdmlhIEVTNSwgc28gaXQncyBhIHJlYWwgY2xhc3MuXG4gICAgICAvLyBXZSdyZSBvayB0byBub3QgaW5zdGFsbCB0aGUgcG9seWZpbGwuXG4gICAgICBpbnN0YWxsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaWYgKGluc3RhbGxXcmFwcGVyKSB7XG4gICAgd3JhcEhUTUxFbGVtZW50KHdpbik7XG4gIH0gZWxzZSBpZiAoaW5zdGFsbCkge1xuICAgIHBvbHlmaWxsKHdpbik7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5cbi8qKlxuICogUG9seWZpbGwgZm9yIGBkb2N1bWVudC5jb250YWlucygpYCBtZXRob2QuIE5vdGljZSB0aGF0IGFjY29yZGluZyB0byBzcGVjXG4gKiBgZG9jdW1lbnQuY29udGFpbnNgIGlzIGluY2x1c2lvbmFyeS5cbiAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvTm9kZS9jb250YWluc1xuICogQHBhcmFtIHs/Tm9kZX0gbm9kZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0aGlzIHtOb2RlfVxuICovXG5mdW5jdGlvbiBkb2N1bWVudENvbnRhaW5zUG9seWZpbGwobm9kZSkge1xuICAvLyBQZXIgc3BlYywgXCJjb250YWluc1wiIG1ldGhvZCBpcyBpbmNsdXNpb25hcnlcbiAgLy8gaS5lLiBgbm9kZS5jb250YWlucyhub2RlKSA9PSB0cnVlYC4gSG93ZXZlciwgd2Ugc3RpbGwgbmVlZCB0byB0ZXN0XG4gIC8vIGVxdWFsaXR5IHRvIHRoZSBkb2N1bWVudCBpdHNlbGYuXG4gIHJldHVybiBub2RlID09IHRoaXMgfHwgdGhpcy5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSk7XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYEhUTUxEb2N1bWVudC5jb250YWluc2AgQVBJLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGwod2luKSB7XG4gIC8vIEhUTUxEb2N1bWVudCBpcyB1bmRlZmluZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgMTAsIGJ1dCBpdCBoYXMgRG9jdW1lbnQsXG4gIC8vIHNvIHdlIHVzZSB0aGF0IGFzIGEgZmFsbGJhY2suXG4gIGNvbnN0IGRvY3VtZW50Q2xhc3MgPSB3aW4uSFRNTERvY3VtZW50IHx8IHdpbi5Eb2N1bWVudDtcbiAgaWYgKCFkb2N1bWVudENsYXNzLnByb3RvdHlwZS5jb250YWlucykge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnRDbGFzcy5wcm90b3R5cGUsICdjb250YWlucycsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9jdW1lbnRDb250YWluc1BvbHlmaWxsLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUodG9rZW4sIG9wdF9mb3JjZSlgIG1ldGhvZC4gVGhpc1xuICogaXMgc3BlY2lhbGx5IGltcG9ydGFudCBiZWNhdXNlIElFIGRvZXMgbm90IHN1cHBvcnQgYG9wdF9mb3JjZWAgYXR0cmlidXRlLiBTZWVcbiAqIGh0dHBzOi8vZ29vLmdsL2hnS05ZWSBmb3IgZGV0YWlscy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlblxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZvcmNlXG4gKiBAdGhpcyB7RE9NVG9rZW5MaXN0fVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwodG9rZW4sIG9wdF9mb3JjZSkge1xuICBjb25zdCByZW1vdmUgPSBvcHRfZm9yY2UgPT09IHVuZGVmaW5lZCA/IHRoaXMuY29udGFpbnModG9rZW4pIDogIW9wdF9mb3JjZTtcbiAgaWYgKHJlbW92ZSkge1xuICAgIHRoaXMucmVtb3ZlKHRva2VuKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5hZGQodG9rZW4pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cblxuLyoqXG4gKiBQb2x5ZmlsbHMgYERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlYCBBUEkgaW4gSUUuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKGlzSWUod2luKSAmJiB3aW4uRE9NVG9rZW5MaXN0KSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uRE9NVG9rZW5MaXN0LnByb3RvdHlwZSwgJ3RvZ2dsZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogZG9tVG9rZW5MaXN0VG9nZ2xlUG9seWZpbGwsXG4gICAgfSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIGN1cnJlbnQgYnJvd3NlciBpcyBhIElFIGJyb3dzZXIuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNJZSh3aW4pIHtcbiAgcmV0dXJuIC9UcmlkZW50fE1TSUV8SUVNb2JpbGUvaS50ZXN0KHdpbi5uYXZpZ2F0b3IudXNlckFnZW50KTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFBhcnNlcyB0aGUgbnVtYmVyIHggYW5kIHJldHVybnMgaXRzIHNpZ24uIEZvciBwb3NpdGl2ZSB4IHJldHVybnMgMSwgZm9yXG4gKiBuZWdhdGl2ZSwgLTEuIEZvciAwIGFuZCAtMCwgcmV0dXJucyAwIGFuZCAtMCByZXNwZWN0aXZlbHkuIEZvciBhbnkgbnVtYmVyXG4gKiB0aGF0IHBhcnNlcyB0byBOYU4sIHJldHVybnMgTmFOLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduKHgpIHtcbiAgeCA9IE51bWJlcih4KTtcblxuICAvLyBJZiB4IGlzIDAsIC0wLCBvciBOYU4sIHJldHVybiBpdC5cbiAgaWYgKCF4KSB7XG4gICAgcmV0dXJuIHg7XG4gIH1cblxuICByZXR1cm4geCA+IDAgPyAxIDogLTE7XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBNYXRoLnNpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uTWF0aC5zaWduKSB7XG4gICAgd2luLk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW4uTWF0aCwgJ3NpZ24nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IHNpZ24sXG4gICAgfSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTYgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5jb25zdCB7aGFzT3duUHJvcGVydHl9ID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqXG4gKiBDb3BpZXMgdmFsdWVzIG9mIGFsbCBlbnVtZXJhYmxlIG93biBwcm9wZXJ0aWVzIGZyb20gb25lIG9yIG1vcmUgc291cmNlXG4gKiBvYmplY3RzIChwcm92aWRlZCBhcyBleHRlbmRlZCBhcmd1bWVudHMgdG8gdGhlIGZ1bmN0aW9uKSB0byBhIHRhcmdldCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHshT2JqZWN0fSB0YXJnZXRcbiAqIEBwYXJhbSB7Li4uT2JqZWN0fSB2YXJfYXJnc1xuICogQHJldHVybiB7IU9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHZhcl9hcmdzKSB7XG4gIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuICB9XG5cbiAgY29uc3Qgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgIGlmIChzb3VyY2UgIT0gbnVsbCkge1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIE9iamVjdC5hc3NpZ24gcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uT2JqZWN0LmFzc2lnbikge1xuICAgIHdpbi5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luLk9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogYXNzaWduLFxuICAgIH0pO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG5pbXBvcnQgKiBhcyBQcm9taXNlIGZyb20gJ3Byb21pc2UtcGpzL3Byb21pc2UnO1xuXG4vKipcbiAqIFNldHMgdGhlIFByb21pc2UgcG9seWZpbGwgaWYgaXQgZG9lcyBub3QgZXhpc3QuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbCh3aW4pIHtcbiAgaWYgKCF3aW4uUHJvbWlzZSkge1xuICAgIHdpbi5Qcm9taXNlID0gLyoqIEB0eXBlIHs/fSAqLyAoUHJvbWlzZSk7XG4gICAgLy8gSW4gYmFiZWwgdGhlICogZXhwb3J0IGlzIGFuIE9iamVjdCB3aXRoIGEgZGVmYXVsdCBwcm9wZXJ0eS5cbiAgICAvLyBJbiBjbG9zdXJlIGNvbXBpbGVyIGl0IGlzIHRoZSBQcm9taXNlIGZ1bmN0aW9uIGl0c2VsZi5cbiAgICBpZiAoUHJvbWlzZS5kZWZhdWx0KSB7XG4gICAgICB3aW4uUHJvbWlzZSA9IFByb21pc2UuZGVmYXVsdDtcbiAgICB9XG4gICAgLy8gV2UgY29weSB0aGUgaW5kaXZpZHVhbCBzdGF0aWMgbWV0aG9kcywgYmVjYXVzZSBjbG9zdXJlXG4gICAgLy8gY29tcGlsZXIgZmxhdHRlbnMgdGhlIHBvbHlmaWxsIG5hbWVzcGFjZS5cbiAgICB3aW4uUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5yZXNvbHZlO1xuICAgIHdpbi5Qcm9taXNlLnJlamVjdCA9IFByb21pc2UucmVqZWN0O1xuICAgIHdpbi5Qcm9taXNlLmFsbCA9IFByb21pc2UuYWxsO1xuICAgIHdpbi5Qcm9taXNlLnJhY2UgPSBQcm9taXNlLnJhY2U7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgUmVnaXN0cmF0aW9uIGFuZCBnZXR0ZXIgZnVuY3Rpb25zIGZvciBBTVAgc2VydmljZXMuXG4gKlxuICogSW52YXJpYW50OiBTZXJ2aWNlIGdldHRlcnMgbmV2ZXIgcmV0dXJuIG51bGwgZm9yIHJlZ2lzdGVyZWQgc2VydmljZXMuXG4gKi9cblxuLy8gc3JjL3BvbHlmaWxscy5qcyBtdXN0IGJlIHRoZSBmaXJzdCBpbXBvcnQuXG5pbXBvcnQgJy4vcG9seWZpbGxzJzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBzb3J0LWltcG9ydHMtZXM2LWF1dG9maXgvc29ydC1pbXBvcnRzLWVzNlxuXG5pbXBvcnQge0RlZmVycmVkfSBmcm9tICcuL3V0aWxzL3Byb21pc2UnO1xuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7dG9XaW59IGZyb20gJy4vdHlwZXMnO1xuXG5cbi8qKlxuICogSG9sZHMgaW5mbyBhYm91dCBhIHNlcnZpY2UuXG4gKiAtIG9iajogQWN0dWFsIHNlcnZpY2UgaW1wbGVtZW50YXRpb24gd2hlbiBhdmFpbGFibGUuXG4gKiAtIHByb21pc2U6IFByb21pc2UgZm9yIHRoZSBvYmouXG4gKiAtIHJlc29sdmU6IEZ1bmN0aW9uIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCB0aGUgb2JqZWN0LlxuICogLSBjb250ZXh0OiBBcmd1bWVudCBmb3IgY3RvciwgZWl0aGVyIGEgd2luZG93IG9yIGFuIGFtcGRvYy5cbiAqIC0gY3RvcjogRnVuY3Rpb24gdGhhdCBjb25zdHJ1Y3RzIGFuZCByZXR1cm5zIHRoZSBzZXJ2aWNlLlxuICogQHR5cGVkZWYge3tcbiAqICAgb2JqOiAoP09iamVjdCksXG4gKiAgIHByb21pc2U6ICg/UHJvbWlzZSksXG4gKiAgIHJlc29sdmU6ICg/ZnVuY3Rpb24oIU9iamVjdCkpLFxuICogICBjb250ZXh0OiAoP1dpbmRvd3w/Li9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvYyksXG4gKiAgIGN0b3I6ICg/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIVdpbmRvdyl8XG4gKiAgICAgICAgICA/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpKSxcbiAqIH19XG4gKi9cbmxldCBTZXJ2aWNlSG9sZGVyRGVmO1xuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgZGlzcG9zZWAgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgd2hlbiBhIHNlcnZpY2UgbmVlZHMgdG8gYmUgZGlzcG9zZWQgb2YuXG4gKiBAaW50ZXJmYWNlXG4gKi9cbmV4cG9ydCBjbGFzcyBEaXNwb3NhYmxlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIHJlbGVhc2UgYW55IHJlc291cmNlcyBpdCBtaWdodCBiZSBob2xkaW5nLiBDYW5cbiAgICogYmUgY2FsbGVkIG9ubHkgb25jZSBpbiB0aGUgbGlmZWN5Y2xlIG9mIGEgc2VydmljZS5cbiAgICovXG4gIGRpc3Bvc2UoKSB7fVxufVxuXG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgcHJvdmlkZXMgYSBgYWRvcHRFbWJlZFdpbmRvd2AgbWV0aG9kIHRoYXQgd2lsbCBiZSBjYWxsZWQgYnlcbiAqIHJ1bnRpbWUgZm9yIGEgbmV3IGVtYmVkIHdpbmRvdy5cbiAqIEBpbnRlcmZhY2VcbiAqL1xuZXhwb3J0IGNsYXNzIEVtYmVkZGFibGVTZXJ2aWNlIHtcblxuICAvKipcbiAgICogSW5zdHJ1Y3RzIHRoZSBzZXJ2aWNlIHRvIGFkb3B0IHRoZSBlbWJlZCB3aW5kb3cgYW5kIGFkZCBhbnkgbmVjZXNzYXJ5XG4gICAqIGxpc3RlbmVycyBhbmQgcmVzb3VyY2VzLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHVudXNlZEVtYmVkV2luXG4gICAqL1xuICBhZG9wdEVtYmVkV2luZG93KHVudXNlZEVtYmVkV2luKSB7fVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBhbHJlYWR5LlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VJbkVtYmVkU2NvcGUod2luLCBpZCwgb3B0X2ZhbGxiYWNrVG9Ub3BXaW4pIHtcbiAgLy8gRmlyc3QsIHRyeSB0byByZXNvbHZlIHZpYSBsb2NhbCAoZW1iZWQpIHdpbmRvdy5cbiAgY29uc3QgbG9jYWwgPSBnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKHdpbiwgaWQpO1xuICBpZiAobG9jYWwpIHtcbiAgICByZXR1cm4gbG9jYWw7XG4gIH1cbiAgaWYgKG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCBpZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2Ugd2l0aCB0aGUgZ2l2ZW4gaWQuIEFzc3VtZXMgdGhhdCBpdCBoYXMgYmVlbiBjb25zdHJ1Y3RlZFxuICogYWxyZWFkeS5cbiAqXG4gKiBVbmxpa2UgbW9zdCBzZXJ2aWNlIGdldHRlcnMsIHBhc3NpbmcgYE5vZGVgIGlzIG5lY2Vzc2FyeSBmb3Igc29tZSBGSUUtc2NvcGVcbiAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAqXG4gKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2ZhbGxiYWNrVG9Ub3BXaW5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFeGlzdGluZ1NlcnZpY2VGb3JEb2NJbkVtYmVkU2NvcGUoXG4gIG5vZGVPckRvYywgaWQsIG9wdF9mYWxsYmFja1RvVG9wV2luKSB7XG4gIC8vIEZpcnN0LCB0cnkgdG8gcmVzb2x2ZSB2aWEgbG9jYWwgKGVtYmVkKSB3aW5kb3cuXG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICAvLyBJZiBhIG5vZGUgaXMgcGFzc2VkLCB0cnkgdG8gcmVzb2x2ZSB2aWEgdGhpcyBub2RlLlxuICAgIGNvbnN0IHdpbiA9IHRvV2luKC8qKiBAdHlwZSB7IURvY3VtZW50fSAqLyAoXG4gICAgICBub2RlT3JEb2Mub3duZXJEb2N1bWVudCB8fCBub2RlT3JEb2MpLmRlZmF1bHRWaWV3KTtcbiAgICBjb25zdCBsb2NhbCA9IGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwod2luLCBpZCk7XG4gICAgaWYgKGxvY2FsKSB7XG4gICAgICByZXR1cm4gbG9jYWw7XG4gICAgfVxuICB9XG4gIC8vIElmIGFuIGFtcGRvYyBpcyBwYXNzZWQgb3IgZmFsbGJhY2sgaXMgYWxsb3dlZCwgY29udGludWUgcmVzb2x2aW5nLlxuICBpZiAoIW5vZGVPckRvYy5ub2RlVHlwZSB8fCBvcHRfZmFsbGJhY2tUb1RvcFdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsIGlkKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBJbnN0YWxscyBhIHNlcnZpY2Ugb3ZlcnJpZGUgb24gYW1wLWRvYyBsZXZlbC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gZW1iZWRXaW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlIFRoZSBzZXJ2aWNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFNlcnZpY2VJbkVtYmVkU2NvcGUoZW1iZWRXaW4sIGlkLCBzZXJ2aWNlKSB7XG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGRldigpLmFzc2VydChlbWJlZFdpbiAhPSB0b3BXaW4sXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBjYW4gb25seSBiZSBpbnN0YWxsZWQgaW4gZW1iZWQgd2luZG93OiAlcycsIGlkKTtcbiAgZGV2KCkuYXNzZXJ0KCFnZXRMb2NhbEV4aXN0aW5nU2VydmljZUZvckVtYmVkV2luT3JOdWxsKGVtYmVkV2luLCBpZCksXG4gICAgICAnU2VydmljZSBvdmVycmlkZSBoYXMgYWxyZWFkeSBiZWVuIGluc3RhbGxlZDogJXMnLCBpZCk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGVtYmVkV2luLCBlbWJlZFdpbiwgaWQsICgpID0+IHNlcnZpY2UpO1xuICBnZXRTZXJ2aWNlSW50ZXJuYWwoZW1iZWRXaW4sIGlkKTsgLy8gRm9yY2Ugc2VydmljZSB0byBidWlsZC5cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFXaW5kb3d9IGVtYmVkV2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9PYmplY3R9XG4gKi9cbmZ1bmN0aW9uIGdldExvY2FsRXhpc3RpbmdTZXJ2aWNlRm9yRW1iZWRXaW5Pck51bGwoZW1iZWRXaW4sIGlkKSB7XG4gIC8vIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBjdXJyZW50bHkgb25seSByZXNvbHZlcyBhZ2FpbnN0IHRoZSBnaXZlbiB3aW5kb3cuXG4gIC8vIEl0IGRvZXMgbm90IHRyeSB0byBnbyBhbGwgdGhlIHdheSB1cCB0aGUgcGFyZW50IHdpbmRvdyBjaGFpbi4gV2UgY2FuIGNoYW5nZVxuICAvLyB0aGlzIGluIHRoZSBmdXR1cmUsIGJ1dCBmb3Igbm93IHRoaXMgZ2l2ZXMgdXMgYSBiZXR0ZXIgcGVyZm9ybWFuY2UuXG4gIGNvbnN0IHRvcFdpbiA9IGdldFRvcFdpbmRvdyhlbWJlZFdpbik7XG4gIGlmIChlbWJlZFdpbiAhPSB0b3BXaW4gJiYgaXNTZXJ2aWNlUmVnaXN0ZXJlZChlbWJlZFdpbiwgaWQpKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2VJbnRlcm5hbChlbWJlZFdpbiwgaWQpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgc2VydmljZSBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXMgaW1wbGVtZW50YXRpb24uXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHBhcmFtIHtmdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlcih3aW4sXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICByZWdpc3RlclNlcnZpY2VJbnRlcm5hbCh3aW4sIHdpbiwgaWQsIGNvbnN0cnVjdG9yKTtcbiAgaWYgKG9wdF9pbnN0YW50aWF0ZSkge1xuICAgIGdldFNlcnZpY2VJbnRlcm5hbCh3aW4sIGlkKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHNlcnZpY2UgYW5kIHJlZ2lzdGVycyBpdCBnaXZlbiBhIGNsYXNzIHRvIGJlIHVzZWQgYXNcbiAqIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKG5ldzpPYmplY3QsICEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jKX0gY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9pbnN0YW50aWF0ZSBXaGV0aGVyIHRvIGltbWVkaWF0ZWx5IGNyZWF0ZSB0aGUgc2VydmljZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlQnVpbGRlckZvckRvYyhub2RlT3JEb2MsXG4gIGlkLFxuICBjb25zdHJ1Y3RvcixcbiAgb3B0X2luc3RhbnRpYXRlKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhub2RlT3JEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJlZ2lzdGVyU2VydmljZUludGVybmFsKGhvbGRlciwgYW1wZG9jLCBpZCwgY29uc3RydWN0b3IpO1xuICBpZiAob3B0X2luc3RhbnRpYXRlKSB7XG4gICAgZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCB3aW5kb3cgKGEgcGVyLXdpbmRvdyBzaW5nbGV0b24pLiBVc2Vyc1xuICogc2hvdWxkIHR5cGljYWxseSB3cmFwIHRoaXMgYXMgYSBzcGVjaWFsIHB1cnBvc2UgZnVuY3Rpb24gKGUuZy5cbiAqIGBTZXJ2aWNlcy52c3luY0Zvcih3aW4pYCkgZm9yIHR5cGUgc2FmZXR5IGFuZCBiZWNhdXNlIHRoZSBmYWN0b3J5IHNob3VsZCBub3RcbiAqIGJlIHBhc3NlZCBhcm91bmQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHRlbXBsYXRlIFRcbiAqIEByZXR1cm4ge1R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlKHdpbiwgaWQpIHtcbiAgd2luID0gZ2V0VG9wV2luZG93KHdpbik7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIHdpbmRvdy4gQWxzbyBleHBlY3RzIGFuXG4gKiBlbGVtZW50IHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW4gdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuIFVzZXJzIHNob3VsZCB0eXBpY2FsbHkgd3JhcCB0aGlzIGFzIGEgc3BlY2lhbCBwdXJwb3NlXG4gKiBmdW5jdGlvbiAoZS5nLiBgU2VydmljZXMudnN5bmNGb3Iod2luKWApIGZvciB0eXBlIHNhZmV0eSBhbmQgYmVjYXVzZSB0aGVcbiAqIGZhY3Rvcnkgc2hvdWxkIG5vdCBiZSBwYXNzZWQgYXJvdW5kLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBvZiB0aGUgc2VydmljZS5cbiAqIEByZXR1cm4geyFQcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2Uod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIG9yIG51bGwgd2l0aCB0aGUgZ2l2ZW4gaWQuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/T2JqZWN0fSBUaGUgc2VydmljZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sIGlkKSB7XG4gIHdpbiA9IGdldFRvcFdpbmRvdyh3aW4pO1xuICBpZiAoaXNTZXJ2aWNlUmVnaXN0ZXJlZCh3aW4sIGlkKSkge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwod2luLCBpZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuXG4vKipcbiAqIExpa2UgZ2V0U2VydmljZVByb21pc2UgYnV0IHJldHVybnMgbnVsbCBpZiB0aGUgc2VydmljZSB3YXMgbmV2ZXIgcmVnaXN0ZXJlZC5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4gez9Qcm9taXNlPCFPYmplY3Q+fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGwod2luLCBpZCkge1xuICByZXR1cm4gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbCh3aW4sIGlkKTtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgYSBzZXJ2aWNlIGZvciB0aGUgZ2l2ZW4gaWQgYW5kIGFtcGRvYyAoYSBwZXItYW1wZG9jIHNpbmdsZXRvbikuXG4gKiBFeHBlY3RzIHNlcnZpY2UgYGlkYCB0byBiZSByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIGNvbnN0IGFtcGRvYyA9IGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICBjb25zdCBob2xkZXIgPSBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGFtcGRvYyk7XG4gIHJldHVybiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG59XG5cblxuLyoqXG4gKiB0bDtkciAtLSBVc2UgZ2V0U2VydmljZUZvckRvYygpIGluc3RlYWQgb2YgdGhpcy5cbiAqXG4gKiBQcml2aWxlZ2VkIHZhcmlhbnQgb2YgZ2V0U2VydmljZUZvckRvYygpIHRoYXQgYWNjZXB0cyBub24tZWxlbWVudCBwYXJhbXMsXG4gKiBlLmcuIHdpbmRvdy5kb2N1bWVudC4gVGhpcyBpcyBjdXJyZW50bHkgbmVjZXNzYXJ5IGZvciBkb2MtbGV2ZWwgc2VydmljZXNcbiAqIHVzZWQgaW4gc3RhcnR1cCwgZS5nLiBDaHVua3MuIEV2ZW50dWFsbHkgd2Ugd2FudCB0byByZW1vdmUgdGhpcyBmdW5jdGlvblxuICogYW5kIGhhdmUgY2FsbGVycyBmaW5kIHRoZSBhcHByb3ByaWF0ZSBBbXBEb2MgYW5kIHVzZSBnZXRTZXJ2aWNlRm9yRG9jKCkuXG4gKlxuICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEByZXR1cm4ge1R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCBpZCkge1xuICBjb25zdCBhbXBkb2MgPSBnZXRBbXBkb2Mobm9kZU9yRG9jKTtcbiAgY29uc3QgaG9sZGVyID0gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihhbXBkb2MpO1xuICByZXR1cm4gZ2V0U2VydmljZUludGVybmFsKGhvbGRlciwgaWQpO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIGEgc2VydmljZSBmb3IgdGhlIGdpdmVuIGlkIGFuZCBhbXBkb2MuIEFsc28gZXhwZWN0c1xuICogYSBzZXJ2aWNlIHRoYXQgaGFzIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24uIFRoZSBwcm9taXNlIHJlc29sdmVzIHdoZW5cbiAqIHRoZSBpbXBsZW1lbnRhdGlvbiBsb2FkZWQuXG4gKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsIGlkKSB7XG4gIHJldHVybiBnZXRTZXJ2aWNlUHJvbWlzZUludGVybmFsKFxuICAgICAgZ2V0QW1wZG9jU2VydmljZUhvbGRlcihlbGVtZW50T3JBbXBEb2MpLCBpZCk7XG59XG5cblxuLyoqXG4gKiBMaWtlIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jIGJ1dCByZXR1cm5zIG51bGwgaWYgdGhlIHNlcnZpY2Ugd2FzIG5ldmVyXG4gKiByZWdpc3RlcmVkIGZvciB0aGlzIGFtcGRvYy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsRm9yRG9jKGVsZW1lbnRPckFtcERvYywgaWQpIHtcbiAgcmV0dXJuIGdldFNlcnZpY2VQcm9taXNlT3JOdWxsSW50ZXJuYWwoXG4gICAgICBnZXRBbXBkb2NTZXJ2aWNlSG9sZGVyKGVsZW1lbnRPckFtcERvYyksIGlkKTtcbn1cblxuLyoqXG4gKiBTZXQgdGhlIHBhcmVudCBhbmQgdG9wIHdpbmRvd3Mgb24gYSBjaGlsZCB3aW5kb3cgKGZyaWVuZGx5IGlmcmFtZSkuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHBhcmFtIHshV2luZG93fSBwYXJlbnRXaW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFBhcmVudFdpbmRvdyh3aW4sIHBhcmVudFdpbikge1xuICB3aW4uX19BTVBfUEFSRU5UID0gcGFyZW50V2luO1xuICB3aW4uX19BTVBfVE9QID0gZ2V0VG9wV2luZG93KHBhcmVudFdpbik7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwYXJlbnQgd2luZG93IGZvciBhIGNoaWxkIHdpbmRvdyAoZnJpZW5kbHkgaWZyYW1lKS5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93KHdpbikge1xuICByZXR1cm4gd2luLl9fQU1QX1BBUkVOVCB8fCB3aW47XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB0b3Agd2luZG93IHdoZXJlIEFNUCBSdW50aW1lIGlzIGluc3RhbGxlZCBmb3IgYSBjaGlsZCB3aW5kb3dcbiAqIChmcmllbmRseSBpZnJhbWUpLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEByZXR1cm4geyFXaW5kb3d9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUb3BXaW5kb3cod2luKSB7XG4gIHJldHVybiB3aW4uX19BTVBfVE9QIHx8IHdpbjtcbn1cblxuXG4vKipcbiAqIFJldHVybnMgdGhlIHBhcmVudCBcImZyaWVuZGx5XCIgaWZyYW1lIGlmIHRoZSBub2RlIGJlbG9uZ3MgdG8gYSBjaGlsZCB3aW5kb3cuXG4gKiBAcGFyYW0geyFOb2RlfSBub2RlXG4gKiBAcGFyYW0geyFXaW5kb3d9IHRvcFdpblxuICogQHJldHVybiB7P0hUTUxJRnJhbWVFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyZW50V2luZG93RnJhbWVFbGVtZW50KG5vZGUsIHRvcFdpbikge1xuICBjb25zdCBjaGlsZFdpbiA9IChub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSkuZGVmYXVsdFZpZXc7XG4gIGlmIChjaGlsZFdpbiAmJiBjaGlsZFdpbiAhPSB0b3BXaW4gJiYgZ2V0VG9wV2luZG93KGNoaWxkV2luKSA9PSB0b3BXaW4pIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIC8qKiBAdHlwZSB7P0hUTUxJRnJhbWVFbGVtZW50fSAqLyAoY2hpbGRXaW4uZnJhbWVFbGVtZW50KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBJZ25vcmUgdGhlIGVycm9yLlxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbXBkb2Mobm9kZU9yRG9jKSB7XG4gIGlmIChub2RlT3JEb2Mubm9kZVR5cGUpIHtcbiAgICBjb25zdCB3aW4gPSB0b1dpbigvKiogQHR5cGUgeyFEb2N1bWVudH0gKi8gKFxuICAgICAgbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jKS5kZWZhdWx0Vmlldyk7XG4gICAgcmV0dXJuIGdldEFtcGRvY1NlcnZpY2Uod2luKS5nZXRBbXBEb2MoLyoqIEB0eXBlIHshTm9kZX0gKi8gKG5vZGVPckRvYykpO1xuICB9XG4gIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSAqLyAobm9kZU9yRG9jKTtcbn1cblxuXG4vKipcbiAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N8IVdpbmRvd31cbiAqL1xuZnVuY3Rpb24gZ2V0QW1wZG9jU2VydmljZUhvbGRlcihub2RlT3JEb2MpIHtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKG5vZGVPckRvYyk7XG4gIHJldHVybiBhbXBkb2MuaXNTaW5nbGVEb2MoKSA/IGFtcGRvYy53aW4gOiBhbXBkb2M7XG59XG5cblxuLyoqXG4gKiBUaGlzIGlzIGVzc2VudGlhbGx5IGEgZHVwbGljYXRlIG9mIGBhbXBkb2MuanNgLCBidXQgbmVjZXNzYXJ5IHRvIGF2b2lkXG4gKiBjaXJjdWxhciBkZXBlbmRlbmNpZXMuXG4gKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICogQHJldHVybiB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2NTZXJ2aWNlfVxuICovXG5mdW5jdGlvbiBnZXRBbXBkb2NTZXJ2aWNlKHdpbikge1xuICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICBnZXRTZXJ2aWNlKHdpbiwgJ2FtcGRvYycpKTtcbn1cblxuXG4vKipcbiAqIEdldCBzZXJ2aWNlIGBpZGAgZnJvbSBgaG9sZGVyYC4gQXNzdW1lcyB0aGUgc2VydmljZVxuICogaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKiBAdGVtcGxhdGUgVFxuICovXG5mdW5jdGlvbiBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBkZXYoKS5hc3NlcnQoaXNTZXJ2aWNlUmVnaXN0ZXJlZChob2xkZXIsIGlkKSxcbiAgICAgIGBFeHBlY3RlZCBzZXJ2aWNlICR7aWR9IHRvIGJlIHJlZ2lzdGVyZWRgKTtcbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBjb25zdCBzID0gc2VydmljZXNbaWRdO1xuICBpZiAoIXMub2JqKSB7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY3RvciwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGN0b3Igbm9yIGltcGwuYCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMuY29udGV4dCwgYFNlcnZpY2UgJHtpZH0gcmVnaXN0ZXJlZCB3aXRob3V0IGNvbnRleHQuYCk7XG4gICAgcy5vYmogPSBuZXcgcy5jdG9yKHMuY29udGV4dCk7XG4gICAgZGV2KCkuYXNzZXJ0KHMub2JqLCBgU2VydmljZSAke2lkfSBjb25zdHJ1Y3RlZCB0byBudWxsLmApO1xuICAgIHMuY3RvciA9IG51bGw7XG4gICAgcy5jb250ZXh0ID0gbnVsbDtcbiAgICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHdlIGhhdmUgYVxuICAgIC8vIHBlbmRpbmcgcHJvbWlzZSB3ZSBuZWVkIHRvIGZ1bGZpbGwuXG4gICAgaWYgKHMucmVzb2x2ZSkge1xuICAgICAgcy5yZXNvbHZlKHMub2JqKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHMub2JqO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyIE9iamVjdCBob2xkaW5nIHRoZSBzZXJ2aWNlIGluc3RhbmNlLlxuICogQHBhcmFtIHshV2luZG93fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBjb250ZXh0IFdpbiBvciBBbXBEb2MuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcGFyYW0gez9mdW5jdGlvbihuZXc6T2JqZWN0LCAhV2luZG93KXw/ZnVuY3Rpb24obmV3Ok9iamVjdCwgIS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2MpfSBjdG9yIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIG5ldyB0aGUgc2VydmljZS4gQ2FsbGVkIHdpdGggY29udGV4dC5cbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBjb250ZXh0LCBpZCwgY3Rvcikge1xuICBjb25zdCBzZXJ2aWNlcyA9IGdldFNlcnZpY2VzKGhvbGRlcik7XG4gIGxldCBzID0gc2VydmljZXNbaWRdO1xuXG4gIGlmICghcykge1xuICAgIHMgPSBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgICBvYmo6IG51bGwsXG4gICAgICBwcm9taXNlOiBudWxsLFxuICAgICAgcmVzb2x2ZTogbnVsbCxcbiAgICAgIGNvbnRleHQ6IG51bGwsXG4gICAgICBjdG9yOiBudWxsLFxuICAgIH07XG4gIH1cblxuICBpZiAocy5jdG9yIHx8IHMub2JqKSB7XG4gICAgLy8gU2VydmljZSBhbHJlYWR5IHJlZ2lzdGVyZWQuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcy5jdG9yID0gY3RvcjtcbiAgcy5jb250ZXh0ID0gY29udGV4dDtcblxuICAvLyBUaGUgc2VydmljZSBtYXkgaGF2ZSBiZWVuIHJlcXVlc3RlZCBhbHJlYWR5LCBpbiB3aGljaCBjYXNlIHRoZXJlIGlzIGFcbiAgLy8gcGVuZGluZyBwcm9taXNlIHRoYXQgbmVlZHMgdG8gZnVsZmlsbGVkLlxuICBpZiAocy5yZXNvbHZlKSB7XG4gICAgLy8gZ2V0U2VydmljZUludGVybmFsIHdpbGwgcmVzb2x2ZSB0aGUgcHJvbWlzZS5cbiAgICBnZXRTZXJ2aWNlSW50ZXJuYWwoaG9sZGVyLCBpZCk7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IGhvbGRlclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIG9mIHRoZSBzZXJ2aWNlLlxuICogQHJldHVybiB7IVByb21pc2U8IU9iamVjdD59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VQcm9taXNlSW50ZXJuYWwoaG9sZGVyLCBpZCkge1xuICBjb25zdCBjYWNoZWQgPSBnZXRTZXJ2aWNlUHJvbWlzZU9yTnVsbEludGVybmFsKGhvbGRlciwgaWQpO1xuICBpZiAoY2FjaGVkKSB7XG4gICAgcmV0dXJuIGNhY2hlZDtcbiAgfVxuICAvLyBTZXJ2aWNlIGlzIG5vdCByZWdpc3RlcmVkLlxuXG4gIC8vIFRPRE8oQGNyYW1mb3JjZSk6IEFkZCBhIGNoZWNrIHRoYXQgaWYgdGhlIGVsZW1lbnQgaXMgZXZlbnR1YWxseSByZWdpc3RlcmVkXG4gIC8vIHRoYXQgdGhlIHNlcnZpY2UgaXMgYWN0dWFsbHkgcHJvdmlkZWQgYW5kIHRoaXMgcHJvbWlzZSByZXNvbHZlcy5cbiAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgY29uc3Qge3Byb21pc2UsIHJlc29sdmV9ID0gZGVmZXJyZWQ7XG5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBzZXJ2aWNlc1tpZF0gPSB7XG4gICAgb2JqOiBudWxsLFxuICAgIHByb21pc2UsXG4gICAgcmVzb2x2ZSxcbiAgICBjb250ZXh0OiBudWxsLFxuICAgIGN0b3I6IG51bGwsXG4gIH07XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2UgZm9yIHNlcnZpY2UgYGlkYCBpZiB0aGUgc2VydmljZSBoYXMgYmVlbiByZWdpc3RlcmVkXG4gKiBvbiBgaG9sZGVyYC5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHs/UHJvbWlzZTwhT2JqZWN0Pn1cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZVByb21pc2VPck51bGxJbnRlcm5hbChob2xkZXIsIGlkKSB7XG4gIGNvbnN0IHNlcnZpY2VzID0gZ2V0U2VydmljZXMoaG9sZGVyKTtcbiAgY29uc3QgcyA9IHNlcnZpY2VzW2lkXTtcbiAgaWYgKHMpIHtcbiAgICBpZiAocy5wcm9taXNlKSB7XG4gICAgICByZXR1cm4gcy5wcm9taXNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbnN0YW50aWF0ZSBzZXJ2aWNlIGlmIG5vdCBhbHJlYWR5IGluc3RhbnRpYXRlZC5cbiAgICAgIGdldFNlcnZpY2VJbnRlcm5hbChob2xkZXIsIGlkKTtcbiAgICAgIHJldHVybiBzLnByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoLyoqIEB0eXBlIHshT2JqZWN0fSAqLyAocy5vYmopKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBvYmplY3QgdGhhdCBob2xkcyB0aGUgc2VydmljZXMgcmVnaXN0ZXJlZCBpbiBhIGhvbGRlci5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywhU2VydmljZUhvbGRlckRlZj59XG4gKi9cbmZ1bmN0aW9uIGdldFNlcnZpY2VzKGhvbGRlcikge1xuICBsZXQge3NlcnZpY2VzfSA9IGhvbGRlcjtcbiAgaWYgKCFzZXJ2aWNlcykge1xuICAgIHNlcnZpY2VzID0gaG9sZGVyLnNlcnZpY2VzID0ge307XG4gIH1cbiAgcmV0dXJuIHNlcnZpY2VzO1xufVxuXG5cbi8qKlxuICogV2hldGhlciB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlLlxuICogQHBhcmFtIHshT2JqZWN0fSBzZXJ2aWNlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNEaXNwb3NhYmxlKHNlcnZpY2UpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZXJ2aWNlLmRpc3Bvc2UgPT0gJ2Z1bmN0aW9uJztcbn1cblxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgaW1wbGVtZW50cyBgRGlzcG9zYWJsZWAgaW50ZXJmYWNlIGFuZFxuICogdHlwZWNhc3RzIHRoZSBpbnN0YW5jZSB0byBgRGlzcG9zYWJsZWAuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4geyFEaXNwb3NhYmxlfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKSB7XG4gIGRldigpLmFzc2VydChpc0Rpc3Bvc2FibGUoc2VydmljZSksICdyZXF1aXJlZCB0byBpbXBsZW1lbnQgRGlzcG9zYWJsZScpO1xuICByZXR1cm4gLyoqIEB0eXBlIHshRGlzcG9zYWJsZX0gKi8gKHNlcnZpY2UpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGFtcGRvYyBzY29wZS5cbiAqIEBwYXJhbSB7IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGFtcGRvY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRG9jKGFtcGRvYykge1xuICBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChhbXBkb2MpO1xufVxuXG5cbi8qKlxuICogRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGUgKGltcGxlbWVudHMgYERpc3Bvc2FibGVgIGludGVyZmFjZSkgc2VydmljZXMgaW5cbiAqIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZVNlcnZpY2VzRm9yRW1iZWQoZW1iZWRXaW4pIHtcbiAgZGlzcG9zZVNlcnZpY2VzSW50ZXJuYWwoZW1iZWRXaW4pO1xufVxuXG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2VzLlxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZXNJbnRlcm5hbChob2xkZXIpIHtcbiAgLy8gVE9ETyhkdm95dGVua28pOiBDb25zaWRlciBtYXJraW5nIGhvbGRlciBhcyBkZXN0cm95ZWQgZm9yIGxhdGVyLWFycml2aW5nXG4gIC8vIHNlcnZpY2UgdG8gYmUgY2FuY2VsZWQgYXV0b21hdGljYWxseS5cbiAgY29uc3Qgc2VydmljZXMgPSBnZXRTZXJ2aWNlcyhob2xkZXIpO1xuICBmb3IgKGNvbnN0IGlkIGluIHNlcnZpY2VzKSB7XG4gICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc2VydmljZXMsIGlkKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IHNlcnZpY2VIb2xkZXIgPSBzZXJ2aWNlc1tpZF07XG4gICAgaWYgKHNlcnZpY2VIb2xkZXIub2JqKSB7XG4gICAgICBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlSG9sZGVyLm9iaik7XG4gICAgfSBlbHNlIGlmIChzZXJ2aWNlSG9sZGVyLnByb21pc2UpIHtcbiAgICAgIHNlcnZpY2VIb2xkZXIucHJvbWlzZS50aGVuKFxuICAgICAgICAgIGluc3RhbmNlID0+IGRpc3Bvc2VTZXJ2aWNlSW50ZXJuYWwoaWQsIGluc3RhbmNlKSk7XG4gICAgfVxuICB9XG59XG5cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc2VydmljZVxuICovXG5mdW5jdGlvbiBkaXNwb3NlU2VydmljZUludGVybmFsKGlkLCBzZXJ2aWNlKSB7XG4gIGlmICghaXNEaXNwb3NhYmxlKHNlcnZpY2UpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRyeSB7XG4gICAgYXNzZXJ0RGlzcG9zYWJsZShzZXJ2aWNlKS5kaXNwb3NlKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBFbnN1cmUgdGhhdCBhIGZhaWx1cmUgdG8gZGlzcG9zZSBhIHNlcnZpY2UgZG9lcyBub3QgZGlzcnVwdCBvdGhlclxuICAgIC8vIHNlcnZpY2VzLlxuICAgIGRldigpLmVycm9yKCdTRVJWSUNFJywgJ2ZhaWxlZCB0byBkaXNwb3NlIHNlcnZpY2UnLCBpZCwgZSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHNwZWNpZmllZCBzZXJ2aWNlIGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UuXG4gKiBAcGFyYW0geyFPYmplY3R9IHNlcnZpY2VcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VtYmVkZGFibGUoc2VydmljZSkge1xuICByZXR1cm4gdHlwZW9mIHNlcnZpY2UuYWRvcHRFbWJlZFdpbmRvdyA9PSAnZnVuY3Rpb24nO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRvcHRTZXJ2aWNlRm9yRW1iZWQoZW1iZWRXaW4sIHNlcnZpY2VJZCkge1xuICBjb25zdCBhZG9wdGVkID0gYWRvcHRTZXJ2aWNlRm9yRW1iZWRJZkVtYmVkZGFibGUoZW1iZWRXaW4sIHNlcnZpY2VJZCk7XG4gIGRldigpLmFzc2VydChhZG9wdGVkLCBgU2VydmljZSAke3NlcnZpY2VJZH0gbm90IGZvdW5kIG9uIHBhcmVudCBgICtcbiAgICAgICdvciBkb2VzblxcJ3QgaW1wbGVtZW50IEVtYmVkZGFibGVTZXJ2aWNlLicpO1xufVxuXG5cbi8qKlxuICogQWRvcHRzIGFuIGVtYmVkZGFibGUgKGltcGxlbWVudHMgYEVtYmVkZGFibGVTZXJ2aWNlYCBpbnRlcmZhY2UpIHNlcnZpY2VcbiAqIGluIGVtYmVkIHNjb3BlLlxuICogQHBhcmFtIHshV2luZG93fSBlbWJlZFdpblxuICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VJZFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkb3B0U2VydmljZUZvckVtYmVkSWZFbWJlZGRhYmxlKGVtYmVkV2luLCBzZXJ2aWNlSWQpIHtcbiAgY29uc3QgZnJhbWVFbGVtZW50ID0gLyoqIEB0eXBlIHshTm9kZX0gKi8gKGRldigpLmFzc2VydChcbiAgICAgIGVtYmVkV2luLmZyYW1lRWxlbWVudCxcbiAgICAgICdmcmFtZUVsZW1lbnQgbm90IGZvdW5kIGZvciBlbWJlZCcpKTtcbiAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGZyYW1lRWxlbWVudCk7XG4gIGNvbnN0IGhvbGRlciA9IGdldEFtcGRvY1NlcnZpY2VIb2xkZXIoYW1wZG9jKTtcbiAgaWYgKCFpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgc2VydmljZUlkKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBzZXJ2aWNlID0gZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoZnJhbWVFbGVtZW50LCBzZXJ2aWNlSWQpO1xuICBpZiAoIWlzRW1iZWRkYWJsZShzZXJ2aWNlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBzZXJ2aWNlLmFkb3B0RW1iZWRXaW5kb3coZW1iZWRXaW4pO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuXG4vKipcbiAqIFJlc2V0cyBhIHNpbmdsZSBzZXJ2aWNlLCBzbyBpdCBnZXRzIHJlY3JlYXRlZCBvbiBuZXh0IGdldFNlcnZpY2UgaW52b2NhdGlvbi5cbiAqIEBwYXJhbSB7IU9iamVjdH0gaG9sZGVyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFNlcnZpY2VGb3JUZXN0aW5nKGhvbGRlciwgaWQpIHtcbiAgaWYgKGhvbGRlci5zZXJ2aWNlcykge1xuICAgIGhvbGRlci5zZXJ2aWNlc1tpZF0gPSBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQHBhcmFtIHshT2JqZWN0fSBob2xkZXIgT2JqZWN0IGhvbGRpbmcgdGhlIHNlcnZpY2UgaW5zdGFuY2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgb2YgdGhlIHNlcnZpY2UuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1NlcnZpY2VSZWdpc3RlcmVkKGhvbGRlciwgaWQpIHtcbiAgY29uc3Qgc2VydmljZSA9IGhvbGRlci5zZXJ2aWNlcyAmJiBob2xkZXIuc2VydmljZXNbaWRdO1xuICAvLyBBbGwgcmVnaXN0ZXJlZCBzZXJ2aWNlcyBtdXN0IGhhdmUgYW4gaW1wbGVtZW50YXRpb24gb3IgYSBjb25zdHJ1Y3Rvci5cbiAgcmV0dXJuICEhKHNlcnZpY2UgJiYgKHNlcnZpY2UuY3RvciB8fCBzZXJ2aWNlLm9iaikpO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIGdldEFtcGRvYyxcbiAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlLFxuICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwsXG4gIGdldFNlcnZpY2UsXG4gIGdldFNlcnZpY2VGb3JEb2MsXG4gIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkLFxuICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyxcbn0gZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCB7XG4gIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jLFxuICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlLFxufSBmcm9tICcuL2VsZW1lbnQtc2VydmljZSc7XG5cbi8qKiBAdHlwZWRlZiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN1YnNjcmlwdGlvbnMvMC4xL2FtcC1zdWJzY3JpcHRpb25zLlN1YnNjcmlwdGlvblNlcnZpY2V9ICovXG5leHBvcnQgbGV0IFN1YnNjcmlwdGlvblNlcnZpY2U7XG5cbmV4cG9ydCBjbGFzcyBTZXJ2aWNlcyB7XG4gIC8qKlxuICAgKiBIaW50OiBBZGQgZXh0ZW5zaW9ucyBmb2xkZXIgcGF0aCB0byBjb21waWxlLmpzIHdpdGhcbiAgICogd2FybmluZ3MgY2Fubm90IGZpbmQgbW9kdWxlcy5cbiAgICovXG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIGZvciB0aGUgQWNjZXNzIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FjY2VzcycsICdhbXAtYWNjZXNzJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIEFjY2VzcyBzZXJ2aWNlIG9yIGEgcHJvbWlzZSBmb3IgbnVsbCBpZiB0aGVcbiAgICogc2VydmljZSBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYWNjZXNzLzAuMS9hbXAtYWNjZXNzLkFjY2Vzc1NlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFjY2Vzc1NlcnZpY2VGb3JEb2NPck51bGwoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1hY2Nlc3MvMC4xL2FtcC1hY2Nlc3MuQWNjZXNzU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnYWNjZXNzJyxcbiAgICAgICAgICAnYW1wLWFjY2VzcycpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBTdWJzY3JpcHRpb25zIHNlcnZpY2UuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhU3Vic2NyaXB0aW9uU2VydmljZT59XG4gICAqL1xuICBzdGF0aWMgc3Vic2NyaXB0aW9uc1NlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCFTdWJzY3JpcHRpb25TZXJ2aWNlPn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3Vic2NyaXB0aW9ucycsXG4gICAgICAgICAgJ2FtcC1zdWJzY3JpcHRpb25zJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIFN1YnNjcmlwdGlvbnMgc2VydmljZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD9TdWJzY3JpcHRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdWJzY3JpcHRpb25zU2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8P1N1YnNjcmlwdGlvblNlcnZpY2U+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3N1YnNjcmlwdGlvbnMnLFxuICAgICAgICAgICdhbXAtc3Vic2NyaXB0aW9ucycpKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBhY3Rpb25TZXJ2aWNlRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvYWN0aW9uLWltcGwuQWN0aW9uU2VydmljZX0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ2FjdGlvbicsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IUFjdGl2aXR5Pn1cbiAgICovXG4gIHN0YXRpYyBhY3Rpdml0eUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhQWN0aXZpdHk+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdhY3Rpdml0eScsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGdsb2JhbCBpbnN0YW5jZSBvZiB0aGUgYEFtcERvY1NlcnZpY2VgIHNlcnZpY2UgdGhhdCBjYW4gYmVcbiAgICogdXNlZCB0byByZXNvbHZlIGFuIGFtcGRvYyBmb3IgYW55IG5vZGU6IGVpdGhlciBpbiB0aGUgc2luZ2xlLWRvYyBvclxuICAgKiBzaGFkb3ctZG9jIGVudmlyb25tZW50LlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgYW1wZG9jU2VydmljZUZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY1NlcnZpY2V9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYW1wZG9jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIEFtcERvYyBmb3IgdGhlIHNwZWNpZmllZCBjb250ZXh0IG5vZGUuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY31cbiAgICovXG4gIHN0YXRpYyBhbXBkb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIGdldEFtcGRvYyhlbGVtZW50T3JBbXBEb2MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBsb2FkQW5hbHl0aWNzXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmFseXRpY3MvMC4xL2luc3RydW1lbnRhdGlvbi5JbnN0cnVtZW50YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBhbmFseXRpY3NGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCBsb2FkQW5hbHl0aWNzID0gZmFsc2UpIHtcbiAgICBpZiAobG9hZEFuYWx5dGljcykge1xuICAgICAgLy8gR2V0IEV4dGVuc2lvbnMgc2VydmljZSBhbmQgZm9yY2UgbG9hZCBhbmFseXRpY3MgZXh0ZW5zaW9uLlxuICAgICAgY29uc3QgYW1wZG9jID0gZ2V0QW1wZG9jKGVsZW1lbnRPckFtcERvYyk7XG4gICAgICBTZXJ2aWNlcy5leHRlbnNpb25zRm9yKGFtcGRvYy53aW4pLi8qT0sqL2luc3RhbGxFeHRlbnNpb25Gb3JEb2MoXG4gICAgICAgICAgYW1wZG9jLCAnYW1wLWFuYWx5dGljcycpO1xuICAgIH1cbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2FtcC1hbmFseXRpY3MtaW5zdHJ1bWVudGF0aW9uJyxcbiAgICAgICAgICAnYW1wLWFuYWx5dGljcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWFuYWx5dGljcy8wLjEvaW5zdHJ1bWVudGF0aW9uLkluc3RydW1lbnRhdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGFuYWx5dGljc0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYW5hbHl0aWNzLzAuMS9pbnN0cnVtZW50YXRpb24uSW5zdHJ1bWVudGF0aW9uU2VydmljZT59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdhbXAtYW5hbHl0aWNzLWluc3RydW1lbnRhdGlvbicsICdhbXAtYW5hbHl0aWNzJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvYmF0Y2hlZC14aHItaW1wbC5CYXRjaGVkWGhyfVxuICAgKi9cbiAgc3RhdGljIGJhdGNoZWRYaHJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9iYXRjaGVkLXhoci1pbXBsLkJhdGNoZWRYaHJ9ICovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAnYmF0Y2hlZC14aHInKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1iaW5kLzAuMS9iaW5kLWltcGwuQmluZD59XG4gICAqL1xuICBzdGF0aWMgYmluZEZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtYmluZC8wLjEvYmluZC1pbXBsLkJpbmQ+fSAqLyAoXG4gICAgICBnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIGVsZW1lbnRPckFtcERvYywgJ2JpbmQnLCAnYW1wLWJpbmQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuL3NlcnZpY2UvY2lkLWltcGwuQ2lkPn1cbiAgICovXG4gIHN0YXRpYyBjaWRGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IVByb21pc2U8IS4vc2VydmljZS9jaWQtaW1wbC5DaWQ+fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICdjaWQnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvbmF2aWdhdGlvbi5OYXZpZ2F0aW9ufVxuICAgKi9cbiAgc3RhdGljIG5hdmlnYXRpb25Gb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9uYXZpZ2F0aW9uLk5hdmlnYXRpb259ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnbmF2aWdhdGlvbicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2NyeXB0by1pbXBsLkNyeXB0b31cbiAgICovXG4gIHN0YXRpYyBjcnlwdG9Gb3Iod2luZG93KSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyEuL3NlcnZpY2UvY3J5cHRvLWltcGwuQ3J5cHRvfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ2NyeXB0bycpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY3VtZW50SW5mb0RlZn0gSW5mbyBhYm91dCB0aGUgZG9jXG4gICAqL1xuICBzdGF0aWMgZG9jdW1lbnRJbmZvRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvZG9jdW1lbnQtaW5mby1pbXBsLkRvY0luZm99ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnZG9jdW1lbnRJbmZvJykpLmdldCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvZG9jdW1lbnQtc3RhdGUuRG9jdW1lbnRTdGF0ZX1cbiAgICovXG4gIHN0YXRpYyBkb2N1bWVudFN0YXRlRm9yKHdpbmRvdykge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbmRvdywgJ2RvY3VtZW50U3RhdGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL2V4dGVuc2lvbnMtaW1wbC5FeHRlbnNpb25zfVxuICAgKi9cbiAgc3RhdGljIGV4dGVuc2lvbnNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9leHRlbnNpb25zLWltcGwuRXh0ZW5zaW9uc30gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdleHRlbnNpb25zJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgc2VydmljZSBpbXBsZW1lbnRlZCBpbiBzZXJ2aWNlL2hpc3RvcnktaW1wbC5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvaGlzdG9yeS1pbXBsLkhpc3Rvcnl9XG4gICAqL1xuICBzdGF0aWMgaGlzdG9yeUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL2hpc3RvcnktaW1wbC5IaXN0b3J5fSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2hpc3RvcnknKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4vaW5wdXQuSW5wdXR9XG4gICAqL1xuICBzdGF0aWMgaW5wdXRGb3Iod2luKSB7XG4gICAgcmV0dXJuIGdldFNlcnZpY2Uod2luLCAnaW5wdXQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9sYXllcnMtaW1wbC5MYXlvdXRMYXllcnN9XG4gICAqL1xuICBzdGF0aWMgbGF5ZXJzRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvbGF5ZXJzLWltcGwuTGF5b3V0TGF5ZXJzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ2xheWVycycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3BlcmZvcm1hbmNlLWltcGwuUGVyZm9ybWFuY2V9XG4gICAqL1xuICBzdGF0aWMgcGVyZm9ybWFuY2VGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfSovIChcbiAgICAgIGdldFNlcnZpY2Uod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wZXJmb3JtYW5jZS1pbXBsLlBlcmZvcm1hbmNlfVxuICAgKi9cbiAgc3RhdGljIHBlcmZvcm1hbmNlRm9yT3JOdWxsKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGVyZm9ybWFuY2UtaW1wbC5QZXJmb3JtYW5jZX0qLyAoXG4gICAgICBnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luZG93LCAncGVyZm9ybWFuY2UnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5kb3dcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9wbGF0Zm9ybS1pbXBsLlBsYXRmb3JtfVxuICAgKi9cbiAgc3RhdGljIHBsYXRmb3JtRm9yKHdpbmRvdykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcGxhdGZvcm0taW1wbC5QbGF0Zm9ybX0gKi8gKFxuICAgICAgZ2V0U2VydmljZSh3aW5kb3csICdwbGF0Zm9ybScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VzIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKCkgc2luY2UgUmVzb3VyY2VzIGlzIGEgc3RhcnR1cCBzZXJ2aWNlLlxuICAgKiBAcGFyYW0geyFOb2RlfCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBub2RlT3JEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS9yZXNvdXJjZXMtaW1wbC5SZXNvdXJjZXN9XG4gICAqL1xuICBzdGF0aWMgcmVzb3VyY2VzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvcmVzb3VyY2VzLWltcGwuUmVzb3VyY2VzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZChub2RlT3JEb2MsICdyZXNvdXJjZXMnKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8P3tpbmNvbWluZ0ZyYWdtZW50OiBzdHJpbmcsIG91dGdvaW5nRnJhZ21lbnQ6IHN0cmluZ30+fVxuICAgKi9cbiAgc3RhdGljIHNoYXJlVHJhY2tpbmdGb3JPck51bGwod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPD97aW5jb21pbmdGcmFnbWVudDogc3RyaW5nLCBvdXRnb2luZ0ZyYWdtZW50OiBzdHJpbmd9Pn0gKi8gKFxuICAgICAgZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzaGFyZS10cmFja2luZycsXG4gICAgICAgICAgJ2FtcC1zaGFyZS10cmFja2luZycsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC92YXJpYWJsZS1zZXJ2aWNlLlN0b3J5VmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHN0b3J5VmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL3ZhcmlhYmxlLXNlcnZpY2UuU3RvcnlWYXJpYWJsZURlZj59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VJZkF2YWlsYWJsZSh3aW4sICdzdG9yeS12YXJpYWJsZScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyc2lvbiBvZiB0aGUgc3Rvcnkgc3RvcmUgc2VydmljZSBkZXBlbmRzIG9uIHdoaWNoIHZlcnNpb24gb2YgYW1wLXN0b3J5XG4gICAqIHRoZSBwdWJsaXNoZXIgaXMgbG9hZGluZy4gVGhleSBhbGwgaGF2ZSB0aGUgc2FtZSBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7P1Byb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZUZvck9yTnVsbCh3aW4pIHtcbiAgICByZXR1cm4gKFxuICAgIC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZXw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ3N0b3J5LXN0b3JlJywgJ2FtcC1zdG9yeScpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBzdG9yeVN0b3JlU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7Py4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzEuMC9hbXAtc3Rvcnktc3RvcmUtc2VydmljZS5BbXBTdG9yeVN0b3JlU2VydmljZX0gKi9cbiAgICAgIChnZXRFeGlzdGluZ1NlcnZpY2VPck51bGwod2luLCAnc3Rvcnktc3RvcmUnKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4gez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5UmVxdWVzdFNlcnZpY2Uod2luKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgez8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvYW1wLXN0b3J5LXJlcXVlc3Qtc2VydmljZS5BbXBTdG9yeVJlcXVlc3RTZXJ2aWNlfSAqL1xuICAgICAgKGdldEV4aXN0aW5nU2VydmljZU9yTnVsbCh3aW4sICdzdG9yeS1yZXF1ZXN0JykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMS4wL2xvY2FsaXphdGlvbi5Mb2NhbGl6YXRpb25TZXJ2aWNlPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUlmQXZhaWxhYmxlKHdpbiwgJ2xvY2FsaXphdGlvbicsICdhbXAtc3RvcnknLCB0cnVlKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyEuLi9leHRlbnNpb25zL2FtcC1zdG9yeS8xLjAvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgbG9jYWxpemF0aW9uU2VydmljZSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdsb2NhbGl6YXRpb24nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUT0RPKCMxNDM1Nyk6IFJlbW92ZSB0aGlzIHdoZW4gYW1wLXN0b3J5OjAuMSBpcyBkZXByZWNhdGVkLlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHshLi4vZXh0ZW5zaW9ucy9hbXAtc3RvcnkvMC4xL2FtcC1zdG9yeS1zdG9yZS1zZXJ2aWNlLkFtcFN0b3J5U3RvcmVTZXJ2aWNlfVxuICAgKi9cbiAgc3RhdGljIHN0b3J5U3RvcmVTZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ3N0b3J5LXN0b3JlJyk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9hbXAtc3RvcnktcmVxdWVzdC1zZXJ2aWNlLkFtcFN0b3J5UmVxdWVzdFNlcnZpY2V9XG4gICAqL1xuICBzdGF0aWMgc3RvcnlSZXF1ZXN0U2VydmljZVYwMSh3aW4pIHtcbiAgICByZXR1cm4gZ2V0U2VydmljZSh3aW4sICdzdG9yeS1yZXF1ZXN0LXYwMScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRPRE8oIzE0MzU3KTogUmVtb3ZlIHRoaXMgd2hlbiBhbXAtc3Rvcnk6MC4xIGlzIGRlcHJlY2F0ZWQuXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fVxuICAgKi9cbiAgc3RhdGljIGxvY2FsaXphdGlvblNlcnZpY2VGb3JPck51bGxWMDEod2luKSB7XG4gICAgcmV0dXJuIChcbiAgICAvKiogQHR5cGUgeyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1zdG9yeS8wLjEvbG9jYWxpemF0aW9uLkxvY2FsaXphdGlvblNlcnZpY2U+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAnbG9jYWxpemF0aW9uLXYwMScsICdhbXAtc3RvcnknLFxuICAgICAgICAgIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogVE9ETygjMTQzNTcpOiBSZW1vdmUgdGhpcyB3aGVuIGFtcC1zdG9yeTowLjEgaXMgZGVwcmVjYXRlZC5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IS4uL2V4dGVuc2lvbnMvYW1wLXN0b3J5LzAuMS9sb2NhbGl6YXRpb24uTG9jYWxpemF0aW9uU2VydmljZX1cbiAgICovXG4gIHN0YXRpYyBsb2NhbGl6YXRpb25TZXJ2aWNlVjAxKHdpbikge1xuICAgIHJldHVybiBnZXRTZXJ2aWNlKHdpbiwgJ2xvY2FsaXphdGlvbi12MDEnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpblxuICAgKiBAcmV0dXJuIHs/UHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckludGVncmF0aW9uVmFyaWFibGVTZXJ2aWNlRm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAoXG4gICAgLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtdmlld2VyLWludGVncmF0aW9uLzAuMS92YXJpYWJsZS1zZXJ2aWNlLlZpZXdlckludGVncmF0aW9uVmFyaWFibGVEZWY+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmlld2VyLWludGVncmF0aW9uLXZhcmlhYmxlJyxcbiAgICAgICAgICAnYW1wLXZpZXdlci1pbnRlZ3JhdGlvbicsIHRydWUpKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC1hbmltYXRpb24vMC4xL3dlYi1hbmltYXRpb24tc2VydmljZS5XZWJBbmltYXRpb25TZXJ2aWNlPn1cbiAgICovXG4gIHN0YXRpYyB3ZWJBbmltYXRpb25TZXJ2aWNlRm9yKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoLyoqIEB0eXBlIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtYW5pbWF0aW9uLzAuMS93ZWItYW5pbWF0aW9uLXNlcnZpY2UuV2ViQW5pbWF0aW9uU2VydmljZT59ICovXG4gICAgICAoZ2V0RWxlbWVudFNlcnZpY2VGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnd2ViLWFuaW1hdGlvbicsICdhbXAtYW5pbWF0aW9uJykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8IS4vc2VydmljZS9zdG9yYWdlLWltcGwuU3RvcmFnZT59XG4gICAqL1xuICBzdGF0aWMgc3RvcmFnZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3N0b3JhZ2UtaW1wbC5TdG9yYWdlPn0gKi8gKFxuICAgICAgZ2V0U2VydmljZVByb21pc2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAnc3RvcmFnZScpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfVxuICAgKi9cbiAgc3RhdGljIHRlbXBsYXRlc0Zvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3RlbXBsYXRlLWltcGwuVGVtcGxhdGVzfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RlbXBsYXRlcycpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3RpbWVyLWltcGwuVGltZXJ9XG4gICAqL1xuICBzdGF0aWMgdGltZXJGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS90aW1lci1pbXBsLlRpbWVyfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3RpbWVyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVubGlrZSBtb3N0IHNlcnZpY2UgZ2V0dGVycywgcGFzc2luZyBgTm9kZWAgaXMgbmVjZXNzYXJ5IGZvciBzb21lIEZJRS1zY29wZVxuICAgKiBzZXJ2aWNlcyBzaW5jZSBzb21ldGltZXMgd2Ugb25seSBoYXZlIHRoZSBGSUUgRG9jdW1lbnQgZm9yIGNvbnRleHQuXG4gICAqIEBwYXJhbSB7IU5vZGV8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IG5vZGVPckRvY1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3VybC1yZXBsYWNlbWVudHMtaW1wbC5VcmxSZXBsYWNlbWVudHN9XG4gICAqL1xuICBzdGF0aWMgdXJsUmVwbGFjZW1lbnRzRm9yRG9jKG5vZGVPckRvYykge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdXJsLXJlcGxhY2VtZW50cy1pbXBsLlVybFJlcGxhY2VtZW50c30gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybC1yZXBsYWNlJywgLyogb3B0X2ZhbGxiYWNrVG9Ub3BXaW4gKi8gdHJ1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi4vZXh0ZW5zaW9ucy9hbXAtdXNlci1ub3RpZmljYXRpb24vMC4xL2FtcC11c2VyLW5vdGlmaWNhdGlvbi5Vc2VyTm90aWZpY2F0aW9uTWFuYWdlcj59XG4gICAqL1xuICBzdGF0aWMgdXNlck5vdGlmaWNhdGlvbk1hbmFnZXJGb3JEb2MoZWxlbWVudE9yQW1wRG9jKSB7XG4gICAgcmV0dXJuICgvKiogQHR5cGUgeyFQcm9taXNlPCEuLi9leHRlbnNpb25zL2FtcC11c2VyLW5vdGlmaWNhdGlvbi8wLjEvYW1wLXVzZXItbm90aWZpY2F0aW9uLlVzZXJOb3RpZmljYXRpb25NYW5hZ2VyPn0gKi9cbiAgICAgIChnZXRFbGVtZW50U2VydmljZUZvckRvYyhlbGVtZW50T3JBbXBEb2MsICd1c2VyTm90aWZpY2F0aW9uTWFuYWdlcicsXG4gICAgICAgICAgJ2FtcC11c2VyLW5vdGlmaWNhdGlvbicpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBjb25zZW50UG9saWN5IFNlcnZpY2Ugb3IgYSBwcm9taXNlIGZvciBudWxsIGlmXG4gICAqIHRoZSBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshRWxlbWVudHwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gZWxlbWVudE9yQW1wRG9jXG4gICAqIEByZXR1cm4geyFQcm9taXNlPD8uLi9leHRlbnNpb25zL2FtcC1jb25zZW50LzAuMS9jb25zZW50LXBvbGljeS1tYW5hZ2VyLkNvbnNlbnRQb2xpY3lNYW5hZ2VyPn1cbiAgICovXG4gIHN0YXRpYyBjb25zZW50UG9saWN5U2VydmljZUZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gKC8qKiBAdHlwZSB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWNvbnNlbnQvMC4xL2NvbnNlbnQtcG9saWN5LW1hbmFnZXIuQ29uc2VudFBvbGljeU1hbmFnZXI+fSAqL1xuICAgICAgKGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoZWxlbWVudE9yQW1wRG9jLFxuICAgICAgICAgICdjb25zZW50UG9saWN5TWFuYWdlcicsICdhbXAtY29uc2VudCcpKSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgZm9yIHRoZSBnZW8gc2VydmljZSBvciBhIHByb21pc2UgZm9yIG51bGwgaWZcbiAgICogdGhlIHNlcnZpY2UgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgY3VycmVudCBwYWdlLlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IVByb21pc2U8Py4uL2V4dGVuc2lvbnMvYW1wLWdlby8wLjEvYW1wLWdlby5HZW9EZWY+fVxuICAgKi9cbiAgc3RhdGljIGdlb0ZvckRvY09yTnVsbChlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTw/Li4vZXh0ZW5zaW9ucy9hbXAtZ2VvLzAuMS9hbXAtZ2VvLkdlb0RlZj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGVGb3JEb2MoXG4gICAgICAgICAgZWxlbWVudE9yQW1wRG9jLCAnZ2VvJywgJ2FtcC1nZW8nLCB0cnVlKSk7XG4gIH1cblxuICAvKipcbiAgICogVW5saWtlIG1vc3Qgc2VydmljZSBnZXR0ZXJzLCBwYXNzaW5nIGBOb2RlYCBpcyBuZWNlc3NhcnkgZm9yIHNvbWUgRklFLXNjb3BlXG4gICAqIHNlcnZpY2VzIHNpbmNlIHNvbWV0aW1lcyB3ZSBvbmx5IGhhdmUgdGhlIEZJRSBEb2N1bWVudCBmb3IgY29udGV4dC5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UvdXJsLWltcGwuVXJsfVxuICAgKi9cbiAgc3RhdGljIHVybEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3VybC1pbXBsLlVybH0gKi8gKFxuICAgICAgZ2V0RXhpc3RpbmdTZXJ2aWNlRm9yRG9jSW5FbWJlZFNjb3BlKFxuICAgICAgICAgIG5vZGVPckRvYywgJ3VybCcsIC8qIG9wdF9mYWxsYmFja1RvVG9wV2luICovIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgcHJvbWlzZSBmb3IgdGhlIGV4cGVyaW1lbnQgdmFyaWFudHMgb3IgYSBwcm9taXNlIGZvciBudWxsIGlmIGl0XG4gICAqIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGN1cnJlbnQgcGFnZS5cbiAgICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAgICogQHJldHVybiB7IVByb21pc2U8P09iamVjdDxzdHJpbmc+Pn1cbiAgICovXG4gIHN0YXRpYyB2YXJpYW50Rm9yT3JOdWxsKHdpbikge1xuICAgIHJldHVybiAvKiogQHR5cGUgeyFQcm9taXNlPD9PYmplY3Q8c3RyaW5nPj59ICovIChcbiAgICAgIGdldEVsZW1lbnRTZXJ2aWNlSWZBdmFpbGFibGUod2luLCAndmFyaWFudCcsICdhbXAtZXhwZXJpbWVudCcsIHRydWUpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFFbGVtZW50fCEuL3NlcnZpY2UvYW1wZG9jLWltcGwuQW1wRG9jfSBlbGVtZW50T3JBbXBEb2NcbiAgICogQHJldHVybiB7IS4vc2VydmljZS92aWRlby1zZXJ2aWNlLWludGVyZmFjZS5WaWRlb1NlcnZpY2VJbnRlcmZhY2V9XG4gICAqL1xuICBzdGF0aWMgdmlkZW9NYW5hZ2VyRm9yRG9jKGVsZW1lbnRPckFtcERvYykge1xuICAgIHJldHVybiAoXG4gICAgICAvKiogQHR5cGUgeyEuL3NlcnZpY2UvdmlkZW8tc2VydmljZS1pbnRlcmZhY2UuVmlkZW9TZXJ2aWNlSW50ZXJmYWNlfSAqLyAoXG4gICAgICAgIGdldFNlcnZpY2VGb3JEb2MoZWxlbWVudE9yQW1wRG9jLCAndmlkZW8tbWFuYWdlcicpKSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlcyBnZXRTZXJ2aWNlRm9yRG9jRGVwcmVjYXRlZCgpIHNpbmNlIFZpZXdlciBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld2VyLWltcGwuVmlld2VyfVxuICAgKi9cbiAgc3RhdGljIHZpZXdlckZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcn0gKi8gKFxuICAgICAgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQobm9kZU9yRG9jLCAndmlld2VyJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcHJvbWlzZSBmb3IgdGhlIHZpZXdlci4gVGhpcyBpcyBhbiB1bnVzdWFsIGNhc2UgYW5kIG5lY2Vzc2FyeSBvbmx5XG4gICAqIGZvciBzZXJ2aWNlcyB0aGF0IG5lZWQgcmVmZXJlbmNlIHRvIHRoZSB2aWV3ZXIgYmVmb3JlIGl0IGhhcyBiZWVuXG4gICAqIGluaXRpYWxpemVkLiBNb3N0IG9mIHRoZSBjb2RlLCBob3dldmVyLCBqdXN0IHNob3VsZCB1c2UgYHZpZXdlckZvckRvY2AuXG4gICAqIEBwYXJhbSB7IUVsZW1lbnR8IS4vc2VydmljZS9hbXBkb2MtaW1wbC5BbXBEb2N9IGVsZW1lbnRPckFtcERvY1xuICAgKiBAcmV0dXJuIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59XG4gICAqL1xuICBzdGF0aWMgdmlld2VyUHJvbWlzZUZvckRvYyhlbGVtZW50T3JBbXBEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshUHJvbWlzZTwhLi9zZXJ2aWNlL3ZpZXdlci1pbXBsLlZpZXdlcj59ICovIChcbiAgICAgIGdldFNlcnZpY2VQcm9taXNlRm9yRG9jKGVsZW1lbnRPckFtcERvYywgJ3ZpZXdlcicpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0geyFXaW5kb3d9IHdpbmRvd1xuICAgKiBAcmV0dXJuIHshLi9zZXJ2aWNlL3ZzeW5jLWltcGwuVnN5bmN9XG4gICAqL1xuICBzdGF0aWMgdnN5bmNGb3Iod2luZG93KSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7IS4vc2VydmljZS92c3luYy1pbXBsLlZzeW5jfSAqLyAoXG4gICAgICBnZXRTZXJ2aWNlKHdpbmRvdywgJ3ZzeW5jJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgZ2V0U2VydmljZUZvckRvY0RlcHJlY2F0ZWQoKSBzaW5jZSBWaWV3cG9ydCBpcyBhIHN0YXJ0dXAgc2VydmljZS5cbiAgICogQHBhcmFtIHshTm9kZXwhLi9zZXJ2aWNlL2FtcGRvYy1pbXBsLkFtcERvY30gbm9kZU9yRG9jXG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2Uvdmlld3BvcnQvdmlld3BvcnQtaW1wbC5WaWV3cG9ydH1cbiAgICovXG4gIHN0YXRpYyB2aWV3cG9ydEZvckRvYyhub2RlT3JEb2MpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3ZpZXdwb3J0L3ZpZXdwb3J0LWltcGwuVmlld3BvcnR9ICovIChcbiAgICAgIGdldFNlcnZpY2VGb3JEb2NEZXByZWNhdGVkKG5vZGVPckRvYywgJ3ZpZXdwb3J0JykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7IVdpbmRvd30gd2luZG93XG4gICAqIEByZXR1cm4geyEuL3NlcnZpY2UveGhyLWltcGwuWGhyfVxuICAgKi9cbiAgc3RhdGljIHhockZvcih3aW5kb3cpIHtcbiAgICByZXR1cm4gLyoqIEB0eXBlIHshLi9zZXJ2aWNlL3hoci1pbXBsLlhocn0gKi8gKGdldFNlcnZpY2Uod2luZG93LCAneGhyJykpO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE4IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtkZXZ9IGZyb20gJy4vbG9nJztcbmltcG9ydCB7bWFwfSBmcm9tICcuL3V0aWxzL29iamVjdC5qcyc7XG5cbmxldCBjb250YWluZXI7XG5cbi8qKlxuICogQ3JlYXRlcyB0aGUgaHRtbCBoZWxwZXIgZm9yIHRoZSBkb2MuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudHwhRG9jdW1lbnR9IG5vZGVPckRvY1xuICogQHJldHVybiB7ZnVuY3Rpb24oIUFycmF5PHN0cmluZz4pOiFFbGVtZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gaHRtbEZvcihub2RlT3JEb2MpIHtcbiAgY29uc3QgZG9jID0gbm9kZU9yRG9jLm93bmVyRG9jdW1lbnQgfHwgbm9kZU9yRG9jO1xuICBpZiAoIWNvbnRhaW5lciB8fCBjb250YWluZXIub3duZXJEb2N1bWVudCAhPT0gZG9jKSB7XG4gICAgY29udGFpbmVyID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB9XG5cbiAgcmV0dXJuIGh0bWw7XG59XG5cbi8qKlxuICogQSB0YWdnZWQgdGVtcGxhdGUgbGl0ZXJhbCBoZWxwZXIgdG8gZ2VuZXJhdGUgc3RhdGljIERPTSB0cmVlcy5cbiAqIFRoaXMgbXVzdCBiZSB1c2VkIGFzIGEgdGFnZ2VkIHRlbXBsYXRlLCBpZVxuICpcbiAqIGBgYFxuICogY29uc3QgZGl2ID0gaHRtbGA8ZGl2PjxzcGFuPjwvc3Bhbj48L2Rpdj5gO1xuICogYGBgXG4gKlxuICogT25seSB0aGUgcm9vdCBlbGVtZW50IGFuZCBpdHMgc3VidHJlZSB3aWxsIGJlIHJldHVybmVkLiBETyBOT1QgdXNlIHRoaXMgdG9cbiAqIHJlbmRlciBzdWJ0cmVlJ3Mgd2l0aCBkeW5hbWljIGNvbnRlbnQsIGl0IFdJTEwgcmVzdWx0IGluIGFuIGVycm9yIVxuICpcbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHN0cmluZ3NcbiAqIEByZXR1cm4geyFFbGVtZW50fVxuICovXG5mdW5jdGlvbiBodG1sKHN0cmluZ3MpIHtcbiAgZGV2KCkuYXNzZXJ0KHN0cmluZ3MubGVuZ3RoID09PSAxLCAnSW1wcm9wZXIgaHRtbCB0ZW1wbGF0ZSB0YWcgdXNhZ2UuJyk7XG4gIGNvbnRhaW5lci4vKk9LKi9pbm5lckhUTUwgPSBzdHJpbmdzWzBdO1xuXG4gIGNvbnN0IGVsID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICBkZXYoKS5hc3NlcnQoZWwsICdObyBlbGVtZW50cyBpbiB0ZW1wbGF0ZScpO1xuICBkZXYoKS5hc3NlcnQoIWVsLm5leHRFbGVtZW50U2libGluZywgJ1RvbyBtYW55IHJvb3QgZWxlbWVudHMgaW4gdGVtcGxhdGUnKTtcblxuICAvLyBDbGVhciB0byBmcmVlIG1lbW9yeS5cbiAgY29udGFpbmVyLi8qT0sqL2lubmVySFRNTCA9ICcnO1xuXG4gIHJldHVybiBlbDtcbn1cblxuLyoqXG4gKiBRdWVyaWVzIGFuIGVsZW1lbnQgZm9yIGFsbCBlbGVtZW50cyB3aXRoIGEgXCJyZWZcIiBhdHRyaWJ1dGUsIHJlbW92aW5nXG4gKiB0aGUgYXR0cmlidXRlIGFmdGVyd2FyZHMuXG4gKiBSZXR1cm5zIGEgbmFtZWQgbWFwIG9mIGFsbCByZWYgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIHshRWxlbWVudH0gcm9vdFxuICogQHJldHVybiB7IU9iamVjdDxzdHJpbmcsICFFbGVtZW50Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh0bWxSZWZzKHJvb3QpIHtcbiAgY29uc3QgZWxlbWVudHMgPSByb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZWZdJyk7XG4gIGNvbnN0IHJlZnMgPSBtYXAoKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzW2ldO1xuICAgIGNvbnN0IHJlZiA9IGRldigpLmFzc2VydChlbGVtZW50LmdldEF0dHJpYnV0ZSgncmVmJyksICdFbXB0eSByZWYgYXR0cicpO1xuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdyZWYnKTtcbiAgICBkZXYoKS5hc3NlcnQocmVmc1tyZWZdID09PSB1bmRlZmluZWQsICdEdXBsaWNhdGUgcmVmJyk7XG4gICAgcmVmc1tyZWZdID0gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiByZWZzO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNSBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IF9tYXRjaFxuICogQHBhcmFtIHtzdHJpbmd9IGNoYXJhY3RlclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1VwcGVyQ2FzZShfbWF0Y2gsIGNoYXJhY3Rlcikge1xuICByZXR1cm4gY2hhcmFjdGVyLnRvVXBwZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHByZXBlbmREYXNoQW5kVG9Mb3dlckNhc2UobWF0Y2gpIHtcbiAgcmV0dXJuICctJyArIG1hdGNoLnRvTG93ZXJDYXNlKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgQXR0cmlidXRlIG5hbWUgY29udGFpbmluZyBkYXNoZXMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IERhc2hlcyByZW1vdmVkIGFuZCBzdWNjZXNzaXZlIGNoYXJhY3RlciBzZW50IHRvIHVwcGVyIGNhc2UuXG4gKiB2aXNpYmxlRm9yVGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvQ2FtZWxDYXNlKG5hbWUpIHtcbiAgcmV0dXJuIG5hbWUucmVwbGFjZSgvLShbYS16XSkvZywgdG9VcHBlckNhc2UpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRoYXQgaXMgaW4gY2FtZWxDYXNlIHRvIG9uZSB0aGF0IGlzIGluIGRhc2gtY2FzZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHN0cmluZyBpbiBkYXNoLWNhc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb0Rhc2goc3RyaW5nKSB7XG4gIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKD8hXilbQS1aXS9nLCBwcmVwZW5kRGFzaEFuZFRvTG93ZXJDYXNlKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBBdHRyaWJ1dGUgbmFtZSB3aXRoIGRhc2hlc1xuICogQHJldHVybiB7c3RyaW5nfSBEYXNoZXMgcmVwbGFjZWQgYnkgdW5kZXJsaW5lcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRhc2hUb1VuZGVybGluZShuYW1lKSB7XG4gIHJldHVybiBuYW1lLnJlcGxhY2UoJy0nLCAnXycpO1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IHN1ZmZpeFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZywgc3VmZml4KSB7XG4gIGNvbnN0IGluZGV4ID0gc3RyaW5nLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGg7XG4gIHJldHVybiBpbmRleCA+PSAwICYmIHN0cmluZy5pbmRleE9mKHN1ZmZpeCwgaW5kZXgpID09IGluZGV4O1xufVxuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGguXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRzV2l0aChzdHJpbmcsIHByZWZpeCkge1xuICBpZiAocHJlZml4Lmxlbmd0aCA+IHN0cmluZy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHN0cmluZy5sYXN0SW5kZXhPZihwcmVmaXgsIDApID09IDA7XG59XG5cbi8qKlxuICogRXhwYW5kcyBwbGFjZWhvbGRlcnMgaW4gYSBnaXZlbiB0ZW1wbGF0ZSBzdHJpbmcgd2l0aCB2YWx1ZXMuXG4gKlxuICogUGxhY2Vob2xkZXJzIHVzZSAke2tleS1uYW1lfSBzeW50YXggYW5kIGFyZSByZXBsYWNlZCB3aXRoIHRoZSB2YWx1ZVxuICogcmV0dXJuZWQgZnJvbSB0aGUgZ2l2ZW4gZ2V0dGVyIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZSBUaGUgdGVtcGxhdGUgc3RyaW5nIHRvIGV4cGFuZC5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKToqfSBnZXR0ZXIgRnVuY3Rpb24gdXNlZCB0byByZXRyaWV2ZSBhIHZhbHVlIGZvciBhXG4gKiAgIHBsYWNlaG9sZGVyLiBSZXR1cm5zIHZhbHVlcyB3aWxsIGJlIGNvZXJjZWQgaW50byBzdHJpbmdzLlxuICogQHBhcmFtIHtudW1iZXI9fSBvcHRfbWF4SXRlcmF0aW9ucyBOdW1iZXIgb2YgdGltZXMgdG8gZXhwYW5kIHRoZSB0ZW1wbGF0ZS5cbiAqICAgRGVmYXVsdHMgdG8gMSwgYnV0IHNob3VsZCBiZSBzZXQgdG8gYSBsYXJnZXIgdmFsdWUgeW91ciBwbGFjZWhvbGRlciB0b2tlbnNcbiAqICAgY2FuIGJlIGV4cGFuZGVkIHRvIG90aGVyIHBsYWNlaG9sZGVyIHRva2Vucy4gVGFrZSBjYXV0aW9uIHdpdGggbGFyZ2UgdmFsdWVzXG4gKiAgIGFzIHJlY3Vyc2l2ZWx5IGV4cGFuZGluZyBhIHN0cmluZyBjYW4gYmUgZXhwb25lbnRpYWxseSBleHBlbnNpdmUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBhbmRUZW1wbGF0ZSh0ZW1wbGF0ZSwgZ2V0dGVyLCBvcHRfbWF4SXRlcmF0aW9ucykge1xuICBjb25zdCBtYXhJdGVyYXRpb25zID0gb3B0X21heEl0ZXJhdGlvbnMgfHwgMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhJdGVyYXRpb25zOyBpKyspIHtcbiAgICBsZXQgbWF0Y2hlcyA9IDA7XG4gICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXCR7KFtefV0qKX0vZywgKF9hLCBiKSA9PiB7XG4gICAgICBtYXRjaGVzKys7XG4gICAgICByZXR1cm4gZ2V0dGVyKGIpO1xuICAgIH0pO1xuICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiB0ZW1wbGF0ZTtcbn1cblxuLyoqXG4gKiBIYXNoIGZ1bmN0aW9uIGRqYjJhXG4gKiBUaGlzIGlzIGludGVuZGVkIHRvIGJlIGEgc2ltcGxlLCBmYXN0IGhhc2hpbmcgZnVuY3Rpb24gdXNpbmcgbWluaW1hbCBjb2RlLlxuICogSXQgZG9lcyAqbm90KiBoYXZlIGdvb2QgY3J5cHRvZ3JhcGhpYyBwcm9wZXJ0aWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7c3RyaW5nfSAzMi1iaXQgdW5zaWduZWQgaGFzaCBvZiB0aGUgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdIYXNoMzIoc3RyKSB7XG4gIGNvbnN0IHtsZW5ndGh9ID0gc3RyO1xuICBsZXQgaGFzaCA9IDUzODE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBoYXNoID0gaGFzaCAqIDMzIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgLy8gQ29udmVydCBmcm9tIDMyLWJpdCBzaWduZWQgdG8gdW5zaWduZWQuXG4gIHJldHVybiBTdHJpbmcoaGFzaCA+Pj4gMCk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLy8gTm90ZTogbG9hZGVkIGJ5IDNwIHN5c3RlbS4gQ2Fubm90IHJlbHkgb24gYmFiZWwgcG9seWZpbGxzLlxuaW1wb3J0IHttYXB9IGZyb20gJy4vdXRpbHMvb2JqZWN0LmpzJztcbmltcG9ydCB7c3RhcnRzV2l0aH0gZnJvbSAnLi9zdHJpbmcnO1xuXG5cbi8qKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgc3RyaW5nPn0gKi9cbmxldCBwcm9wZXJ0eU5hbWVDYWNoZTtcblxuLyoqIEBjb25zdCB7IUFycmF5PHN0cmluZz59ICovXG5jb25zdCB2ZW5kb3JQcmVmaXhlcyA9IFsnV2Via2l0JywgJ3dlYmtpdCcsICdNb3onLCAnbW96JywgJ21zJywgJ08nLCAnbyddO1xuXG5cbi8qKlxuICogQGV4cG9ydFxuICogQHBhcmFtIHtzdHJpbmd9IGNhbWVsQ2FzZSBjYW1lbCBjYXNlZCBzdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ30gdGl0bGUgY2FzZWQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW1lbENhc2VUb1RpdGxlQ2FzZShjYW1lbENhc2UpIHtcbiAgcmV0dXJuIGNhbWVsQ2FzZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGNhbWVsQ2FzZS5zbGljZSgxKTtcbn1cblxuLyoqXG4gKiBDaGVja3MgdGhlIHN0eWxlIGlmIGEgcHJlZml4ZWQgdmVyc2lvbiBvZiBhIHByb3BlcnR5IGV4aXN0cyBhbmQgcmV0dXJuc1xuICogaXQgb3IgcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHshT2JqZWN0fSBzdHlsZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlQ2FzZSB0aGUgdGl0bGUgY2FzZSB2ZXJzaW9uIG9mIGEgY3NzIHByb3BlcnR5IG5hbWVcbiAqIEByZXR1cm4ge3N0cmluZ30gdGhlIHByZWZpeGVkIHByb3BlcnR5IG5hbWUgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWVfKHN0eWxlLCB0aXRsZUNhc2UpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB2ZW5kb3JQcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHByb3BlcnR5TmFtZSA9IHZlbmRvclByZWZpeGVzW2ldICsgdGl0bGVDYXNlO1xuICAgIGlmIChzdHlsZVtwcm9wZXJ0eU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBwcm9wZXJ0eU5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb3NzaWJseSBwcmVmaXhlZCBKYXZhU2NyaXB0IHByb3BlcnR5IG5hbWUgb2YgYSBzdHlsZSBwcm9wZXJ0eVxuICogKGV4LiBXZWJraXRUcmFuc2l0aW9uRHVyYXRpb24pIGdpdmVuIGEgY2FtZWxDYXNlJ2QgdmVyc2lvbiBvZiB0aGUgcHJvcGVydHlcbiAqIChleC4gdHJhbnNpdGlvbkR1cmF0aW9uKS5cbiAqIEBleHBvcnRcbiAqIEBwYXJhbSB7IU9iamVjdH0gc3R5bGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBjYW1lbENhc2UgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gb2YgYSBjc3MgcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlIGJ5cGFzcyB0aGUgbWVtb2l6ZWQgY2FjaGUgb2YgcHJvcGVydHlcbiAqICAgbWFwcGluZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmVuZG9ySnNQcm9wZXJ0eU5hbWUoc3R5bGUsIGNhbWVsQ2FzZSwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGlmIChzdGFydHNXaXRoKGNhbWVsQ2FzZSwgJy0tJykpIHtcbiAgICAvLyBDU1MgdmFycyBhcmUgcmV0dXJuZWQgYXMgaXMuXG4gICAgcmV0dXJuIGNhbWVsQ2FzZTtcbiAgfVxuICBpZiAoIXByb3BlcnR5TmFtZUNhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lQ2FjaGUgPSBtYXAoKTtcbiAgfVxuICBsZXQgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXTtcbiAgaWYgKCFwcm9wZXJ0eU5hbWUgfHwgb3B0X2J5cGFzc0NhY2hlKSB7XG4gICAgcHJvcGVydHlOYW1lID0gY2FtZWxDYXNlO1xuICAgIGlmIChzdHlsZVtjYW1lbENhc2VdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IHRpdGxlQ2FzZSA9IGNhbWVsQ2FzZVRvVGl0bGVDYXNlKGNhbWVsQ2FzZSk7XG4gICAgICBjb25zdCBwcmVmaXhlZFByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lXyhzdHlsZSwgdGl0bGVDYXNlKTtcblxuICAgICAgaWYgKHN0eWxlW3ByZWZpeGVkUHJvcGVydHlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHByb3BlcnR5TmFtZSA9IHByZWZpeGVkUHJvcGVydHlOYW1lO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW9wdF9ieXBhc3NDYWNoZSkge1xuICAgICAgcHJvcGVydHlOYW1lQ2FjaGVbY2FtZWxDYXNlXSA9IHByb3BlcnR5TmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb3BlcnR5TmFtZTtcbn1cblxuXG4vKipcbiAqIFNldHMgdGhlIENTUyBzdHlsZXMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggIWltcG9ydGFudC4gVGhlIHN0eWxlc1xuICogYXJlIHNwZWNpZmllZCBhcyBhIG1hcCBmcm9tIENTUyBwcm9wZXJ0eSBuYW1lcyB0byB0aGVpciB2YWx1ZXMuXG4gKiBAcGFyYW0geyFFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gc3R5bGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRJbXBvcnRhbnRTdHlsZXMoZWxlbWVudCwgc3R5bGVzKSB7XG4gIGZvciAoY29uc3QgayBpbiBzdHlsZXMpIHtcbiAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KFxuICAgICAgICBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShzdHlsZXMsIGspLCBzdHlsZXNba10udG9TdHJpbmcoKSwgJ2ltcG9ydGFudCcpO1xuICB9XG59XG5cblxuLyoqXG4gKiBTZXRzIHRoZSBDU1Mgc3R5bGUgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IHdpdGggb3B0aW9uYWwgdW5pdHMsIGUuZy4gXCJweFwiLlxuICogQHBhcmFtIHs/RWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZz19IG9wdF91bml0c1xuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eSwgdmFsdWUsIG9wdF91bml0cywgb3B0X2J5cGFzc0NhY2hlKSB7XG4gIGNvbnN0IHByb3BlcnR5TmFtZSA9IGdldFZlbmRvckpzUHJvcGVydHlOYW1lKGVsZW1lbnQuc3R5bGUsIHByb3BlcnR5LFxuICAgICAgb3B0X2J5cGFzc0NhY2hlKTtcbiAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgIGVsZW1lbnQuc3R5bGVbcHJvcGVydHlOYW1lXSA9XG4gICAgICAvKiogQHR5cGUge3N0cmluZ30gKi8gKG9wdF91bml0cyA/IHZhbHVlICsgb3B0X3VuaXRzIDogdmFsdWUpO1xuICB9XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgQ1NTIHN0eWxlIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtIHtib29sZWFuPX0gb3B0X2J5cGFzc0NhY2hlXG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHksIG9wdF9ieXBhc3NDYWNoZSkge1xuICBjb25zdCBwcm9wZXJ0eU5hbWUgPSBnZXRWZW5kb3JKc1Byb3BlcnR5TmFtZShlbGVtZW50LnN0eWxlLCBwcm9wZXJ0eSxcbiAgICAgIG9wdF9ieXBhc3NDYWNoZSk7XG4gIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gZWxlbWVudC5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xufVxuXG5cbi8qKlxuICogU2V0cyB0aGUgQ1NTIHN0eWxlcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuIFRoZSBzdHlsZXNcbiAqIGEgc3BlY2lmaWVkIGFzIGEgbWFwIGZyb20gQ1NTIHByb3BlcnR5IG5hbWVzIHRvIHRoZWlyIHZhbHVlcy5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBzdHlsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlcyhlbGVtZW50LCBzdHlsZXMpIHtcbiAgZm9yIChjb25zdCBrIGluIHN0eWxlcykge1xuICAgIHNldFN0eWxlKGVsZW1lbnQsIGssIHN0eWxlc1trXSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIFNob3dzIG9yIGhpZGVzIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9kaXNwbGF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGUoZWxlbWVudCwgb3B0X2Rpc3BsYXkpIHtcbiAgaWYgKG9wdF9kaXNwbGF5ID09PSB1bmRlZmluZWQpIHtcbiAgICBvcHRfZGlzcGxheSA9IGdldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5JykgPT0gJ25vbmUnO1xuICB9XG4gIHNldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5Jywgb3B0X2Rpc3BsYXkgPyAnJyA6ICdub25lJyk7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcGl4ZWwgdmFsdWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB4KHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1weGA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGRlZ3JlZSB2YWx1ZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVnKHZhbHVlKSB7XG4gIHJldHVybiBgJHt2YWx1ZX1kZWdgO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBcInRyYW5zbGF0ZVhcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVYKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gYHRyYW5zbGF0ZVgoJHt2YWx1ZX0pYDtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZVgoJHtweCh2YWx1ZSl9KWA7XG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgXCJ0cmFuc2xhdGVYXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB4XG4gKiBAcGFyYW0geyhudW1iZXJ8c3RyaW5nKT19IG9wdF95XG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGUoeCwgb3B0X3kpIHtcbiAgaWYgKHR5cGVvZiB4ID09ICdudW1iZXInKSB7XG4gICAgeCA9IHB4KHgpO1xuICB9XG4gIGlmIChvcHRfeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGB0cmFuc2xhdGUoJHt4fSlgO1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0X3kgPT0gJ251bWJlcicpIHtcbiAgICBvcHRfeSA9IHB4KG9wdF95KTtcbiAgfVxuICByZXR1cm4gYHRyYW5zbGF0ZSgke3h9LCAke29wdF95fSlgO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyBhIFwic2NhbGVcIiBmb3IgQ1NTIFwidHJhbnNmb3JtXCIgcHJvcGVydHkuXG4gKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzY2FsZSh2YWx1ZSkge1xuICByZXR1cm4gYHNjYWxlKCR7dmFsdWV9KWA7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFwicm90YXRlXCIgZm9yIENTUyBcInRyYW5zZm9ybVwiIHByb3BlcnR5LlxuICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpIHtcbiAgICB2YWx1ZSA9IGRlZyh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGByb3RhdGUoJHt2YWx1ZX0pYDtcbn1cblxuLyoqXG4gKiBSZW1vdmUgYWxwaGEgdmFsdWUgZnJvbSBhIHJnYmEgY29sb3IgdmFsdWUuXG4gKiBSZXR1cm4gdGhlIG5ldyBjb2xvciBwcm9wZXJ0eSB3aXRoIGFscGhhIGVxdWFscyBpZiBoYXMgdGhlIGFscGhhIHZhbHVlLlxuICogQ2FsbGVyIG5lZWRzIHRvIG1ha2Ugc3VyZSB0aGUgaW5wdXQgY29sb3IgdmFsdWUgaXMgYSB2YWxpZCByZ2JhL3JnYiB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IHJnYmFDb2xvclxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQWxwaGFGcm9tQ29sb3IocmdiYUNvbG9yKSB7XG4gIHJldHVybiByZ2JhQ29sb3IucmVwbGFjZShcbiAgICAgIC9cXCgoW14sXSspLChbXixdKyksKFteLCldKyksW14pXStcXCkvZywgJygkMSwkMiwkMywgMSknKTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjb21wdXRlZCBzdHlsZSBvZiB0aGUgZWxlbWVudC4gVGhlIGhlbHBlciBpcyBuZWNlc3NhcnkgdG8gZW5mb3JjZVxuICogdGhlIHBvc3NpYmxlIGBudWxsYCB2YWx1ZSByZXR1cm5lZCBieSBhIGJ1Z2d5IEZpcmVmb3guXG4gKlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7IUVsZW1lbnR9IGVsXG4gKiBAcmV0dXJuIHshT2JqZWN0PHN0cmluZywgc3RyaW5nPn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVkU3R5bGUod2luLCBlbCkge1xuICBjb25zdCBzdHlsZSA9IC8qKiBAdHlwZSB7P0NTU1N0eWxlRGVjbGFyYXRpb259ICovKHdpbi5nZXRDb21wdXRlZFN0eWxlKGVsKSk7XG4gIHJldHVybiAvKiogQHR5cGUgeyFPYmplY3Q8c3RyaW5nLCBzdHJpbmc+fSAqLyhzdHlsZSkgfHwgbWFwKCk7XG59XG5cblxuLyoqXG4gKiBSZXNldHMgc3R5bGVzIHRoYXQgd2VyZSBzZXQgZHluYW1pY2FsbHkgKGkuZS4gaW5saW5lKVxuICogQHBhcmFtIHshRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHshQXJyYXk8c3RyaW5nPn0gcHJvcGVydGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTdHlsZXMoZWxlbWVudCwgcHJvcGVydGllcykge1xuICBjb25zdCBzdHlsZU9iaiA9IHt9O1xuICBwcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgc3R5bGVPYmpbcHJvcF0gPSBudWxsO1xuICB9KTtcbiAgc2V0U3R5bGVzKGVsZW1lbnQsIHN0eWxlT2JqKTtcbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IHRvU3RyaW5nXyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgRUNNQSBbW0NsYXNzXV0gb2YgYSB2YWx1ZVxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmdfLmNhbGwodmFsdWUpO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gQXJyYXkuXG4gKiBAcGFyYW0geyp9IHZhbHVlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBcnJheSh2YWx1ZSkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYXJyYXktbGlrZSBvYmplY3QgdG8gYW4gYXJyYXkuXG4gKiBAcGFyYW0gez9JQXJyYXlMaWtlPFQ+fHN0cmluZ30gYXJyYXlMaWtlXG4gKiBAcmV0dXJuIHshQXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9BcnJheShhcnJheUxpa2UpIHtcbiAgaWYgKCFhcnJheUxpa2UpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3QgYXJyYXkgPSBuZXcgQXJyYXkoYXJyYXlMaWtlLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlMaWtlLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJyYXlbaV0gPSBhcnJheUxpa2VbaV07XG4gIH1cbiAgcmV0dXJuIGFycmF5O1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgYWN0dWFsbHkgYW4gT2JqZWN0LlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gIHJldHVybiB0b1N0cmluZyh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgaWYgdmFsdWUgaXMgb2YgbnVtYmVyIHR5cGUgYW5kIGZpbml0ZS5cbiAqIE5hTiBhbmQgSW5maW5pdHkgYXJlIG5vdCBjb25zaWRlcmVkIGEgZmluaXRlIG51bWJlci5cbiAqIFN0cmluZyBudW1iZXJzIGFyZSBub3QgY29uc2lkZXJlZCBudW1iZXJzLlxuICogQHBhcmFtIHsqfSB2YWx1ZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRmluaXRlTnVtYmVyKHZhbHVlKSB7XG4gIHJldHVybiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZSh2YWx1ZSkpO1xufVxuXG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIGBzYCBpcyBhIHZhbGlkIHZhbHVlIG9mIGBlbnVtT2JqYC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3Q8VD59IGVudW1PYmpcbiAqIEBwYXJhbSB7VH0gc1xuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VudW1WYWx1ZShlbnVtT2JqLCBzKSB7XG4gIGZvciAoY29uc3QgayBpbiBlbnVtT2JqKSB7XG4gICAgaWYgKGVudW1PYmpba10gPT09IHMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogRXh0ZXJucyBkZWNsYXJlIHRoYXQgYWNjZXNzIGBkZWZhdWx0Vmlld2AgZnJvbSBgZG9jdW1lbnRgIG9yXG4gKiBgb3duZXJEb2N1bWVudGAgaXMgb2YgdHlwZSBgKFdpbmRvd3xudWxsKWAgYnV0IG1vc3Qgb2Ygb3VyIHBhcmFtZXRlciB0eXBlc1xuICogYXNzdW1lIHRoYXQgaXQgaXMgbmV2ZXIgbnVsbC4gVGhpcyBpcyBPSyBpbiBwcmFjdGljZSBhcyB3ZSBldmVyIG9ubHkgZ2V0XG4gKiBudWxsIG9uIGRpc2Nvbm5lY3RlZCBkb2N1bWVudHMgb3Igb2xkIElFLlxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gY2FzdHMgaXQgaW50byBqdXN0IGEgc2ltcGxlIFdpbmRvdyByZXR1cm4gdHlwZS5cbiAqXG4gKiBAcGFyYW0geyFXaW5kb3d8bnVsbH0gd2luT3JOdWxsXG4gKiBAcmV0dXJuIHshV2luZG93fVxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9XaW4od2luT3JOdWxsKSB7XG4gIHJldHVybiAvKiogQHR5cGUgeyFXaW5kb3d9ICovICh3aW5Pck51bGwpO1xufVxuXG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHt0cnlEZWNvZGVVcmlDb21wb25lbnRffSBmcm9tICcuL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQnO1xuXG5jb25zdCByZWdleCA9IC8oPzpeWyM/XT98JikoW149Jl0rKSg/Oj0oW14mXSopKT8vZztcblxuLyoqXG4gKiBQYXJzZXMgdGhlIHF1ZXJ5IHN0cmluZyBvZiBhbiBVUkwuIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzaW1wbGUga2V5L3ZhbHVlXG4gKiBtYXAuIElmIHRoZXJlIGFyZSBkdXBsaWNhdGUga2V5cyB0aGUgbGF0ZXN0IHZhbHVlIGlzIHJldHVybmVkLlxuICpcbiAqIERPIE5PVCBpbXBvcnQgdGhlIGZ1bmN0aW9uIGZyb20gdGhpcyBmaWxlLiBJbnN0ZWFkLCBpbXBvcnQgcGFyc2VRdWVyeVN0cmluZ1xuICogZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5U3RyaW5nXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmdfKHF1ZXJ5U3RyaW5nKSB7XG4gIGNvbnN0IHBhcmFtcyA9IC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgaWYgKCFxdWVyeVN0cmluZykge1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHF1ZXJ5U3RyaW5nKSkpIHtcbiAgICBjb25zdCBuYW1lID0gdHJ5RGVjb2RlVXJpQ29tcG9uZW50XyhtYXRjaFsxXSwgbWF0Y2hbMV0pO1xuICAgIGNvbnN0IHZhbHVlID0gbWF0Y2hbMl0gPyB0cnlEZWNvZGVVcmlDb21wb25lbnRfKG1hdGNoWzJdLCBtYXRjaFsyXSkgOiAnJztcbiAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBUaGUgQU1QIEhUTUwgQXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTLUlTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVHJpZXMgdG8gZGVjb2RlIGEgVVJJIGNvbXBvbmVudCwgZmFsbGluZyBiYWNrIHRvIG9wdF9mYWxsYmFjayAob3IgYW4gZW1wdHlcbiAqIHN0cmluZylcbiAqXG4gKiBETyBOT1QgaW1wb3J0IHRoZSBmdW5jdGlvbiBmcm9tIHRoaXMgZmlsZS4gSW5zdGVhZCwgaW1wb3J0XG4gKiB0cnlEZWNvZGVVcmlDb21wb25lbnQgZnJvbSBgc3JjL3VybC5qc2AuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBmYWxsYmFja1xuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ5RGVjb2RlVXJpQ29tcG9uZW50Xyhjb21wb25lbnQsIGZhbGxiYWNrID0gJycpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsbGJhY2s7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTUgVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge0xydUNhY2hlfSBmcm9tICcuL3V0aWxzL2xydS1jYWNoZSc7XG5pbXBvcnQge2RpY3R9IGZyb20gJy4vdXRpbHMvb2JqZWN0JztcbmltcG9ydCB7ZW5kc1dpdGgsIHN0YXJ0c1dpdGh9IGZyb20gJy4vc3RyaW5nJztcbmltcG9ydCB7Z2V0TW9kZX0gZnJvbSAnLi9tb2RlJztcbmltcG9ydCB7aXNBcnJheX0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge3BhcnNlUXVlcnlTdHJpbmdffSBmcm9tICcuL3VybC1wYXJzZS1xdWVyeS1zdHJpbmcnO1xuaW1wb3J0IHt0cnlEZWNvZGVVcmlDb21wb25lbnRffSBmcm9tICcuL3VybC10cnktZGVjb2RlLXVyaS1jb21wb25lbnQnO1xuaW1wb3J0IHt1cmxzfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQge3VzZXJ9IGZyb20gJy4vbG9nJztcblxuLyoqXG4gKiBAdHlwZSB7IUpzb25PYmplY3R9XG4gKi9cbmNvbnN0IFNFUlZJTkdfVFlQRV9QUkVGSVggPSBkaWN0KHtcbiAgLy8gTm8gdmlld2VyXG4gICdjJzogdHJ1ZSxcbiAgLy8gSW4gdmlld2VyXG4gICd2JzogdHJ1ZSxcbiAgLy8gQWQgbGFuZGluZyBwYWdlXG4gICdhJzogdHJ1ZSxcbiAgLy8gQWRcbiAgJ2FkJzogdHJ1ZSxcbn0pO1xuXG4vKipcbiAqIENhY2hlZCBhLXRhZyB0byBhdm9pZCBtZW1vcnkgYWxsb2NhdGlvbiBkdXJpbmcgVVJMIHBhcnNpbmcuXG4gKiBAdHlwZSB7SFRNTEFuY2hvckVsZW1lbnR9XG4gKi9cbmxldCBhO1xuXG4vKipcbiAqIFdlIGNhY2hlZCBhbGwgcGFyc2VkIFVSTHMuIEFzIG9mIG5vdyB0aGVyZSBhcmUgbm8gdXNlIGNhc2VzXG4gKiBvZiBBTVAgZG9jcyB0aGF0IHdvdWxkIGV2ZXIgcGFyc2UgYW4gYWN0dWFsIGxhcmdlIG51bWJlciBvZiBVUkxzLFxuICogYnV0IHdlIG9mdGVuIHBhcnNlIHRoZSBzYW1lIG9uZSBvdmVyIGFuZCBvdmVyIGFnYWluLlxuICogQHR5cGUge0xydUNhY2hlfVxuICovXG5sZXQgY2FjaGU7XG5cbi8qKiBAcHJpdmF0ZSBAY29uc3QgTWF0Y2hlcyBhbXBfanNfKiBwYXJhbWV0ZXJzIGluIHF1ZXJ5IHN0cmluZy4gKi9cbmNvbnN0IEFNUF9KU19QQVJBTVNfUkVHRVggPSAvWz8mXWFtcF9qc1teJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9nc2EgcGFyYW1ldGVycyBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBBTVBfR1NBX1BBUkFNU19SRUdFWCA9IC9bPyZdYW1wX2dzYVteJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIGFtcF9yIHBhcmFtZXRlcnMgaW4gcXVlcnkgc3RyaW5nLiAqL1xuY29uc3QgQU1QX1JfUEFSQU1TX1JFR0VYID0gL1s/Jl1hbXBfclteJl0qLztcblxuLyoqIEBwcml2YXRlIEBjb25zdCBNYXRjaGVzIHVzcXAgcGFyYW1ldGVycyBmcm9tIGdvb2cgZXhwZXJpbWVudCBpbiBxdWVyeSBzdHJpbmcuICovXG5jb25zdCBHT09HTEVfRVhQRVJJTUVOVF9QQVJBTVNfUkVHRVggPSAvWz8mXXVzcXBbXiZdKi87XG5cbmNvbnN0IElOVkFMSURfUFJPVE9DT0xTID0gW1xuICAvKmVzbGludCBuby1zY3JpcHQtdXJsOiAwKi8gJ2phdmFzY3JpcHQ6JyxcbiAgLyplc2xpbnQgbm8tc2NyaXB0LXVybDogMCovICdkYXRhOicsXG4gIC8qZXNsaW50IG5vLXNjcmlwdC11cmw6IDAqLyAndmJzY3JpcHQ6Jyxcbl07XG5cbi8qKiBAY29uc3Qge3N0cmluZ30gKi9cbmV4cG9ydCBjb25zdCBTT1VSQ0VfT1JJR0lOX1BBUkFNID0gJ19fYW1wX3NvdXJjZV9vcmlnaW4nO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGNvcnJlY3Qgb3JpZ2luIGZvciBhIGdpdmVuIHdpbmRvdy5cbiAqIEBwYXJhbSB7IVdpbmRvd30gd2luXG4gKiBAcmV0dXJuIHtzdHJpbmd9IG9yaWdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2luT3JpZ2luKHdpbikge1xuICByZXR1cm4gd2luLm9yaWdpbiB8fCBwYXJzZVVybERlcHJlY2F0ZWQod2luLmxvY2F0aW9uLmhyZWYpLm9yaWdpbjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgTG9jYXRpb24tbGlrZSBvYmplY3QgZm9yIHRoZSBnaXZlbiBVUkwuIElmIGl0IGlzIHJlbGF0aXZlLFxuICogdGhlIFVSTCBnZXRzIHJlc29sdmVkLlxuICogQ29uc2lkZXIgdGhlIHJldHVybmVkIG9iamVjdCBpbW11dGFibGUuIFRoaXMgaXMgZW5mb3JjZWQgZHVyaW5nXG4gKiB0ZXN0aW5nIGJ5IGZyZWV6aW5nIHRoZSBvYmplY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfbm9jYWNoZVxuICogQHJldHVybiB7IUxvY2F0aW9ufVxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVcmxEZXByZWNhdGVkKHVybCwgb3B0X25vY2FjaGUpIHtcbiAgaWYgKCFhKSB7XG4gICAgYSA9IC8qKiBAdHlwZSB7IUhUTUxBbmNob3JFbGVtZW50fSAqLyAoc2VsZi5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpO1xuICAgIGNhY2hlID0gc2VsZi5VcmxDYWNoZSB8fCAoc2VsZi5VcmxDYWNoZSA9IG5ldyBMcnVDYWNoZSgxMDApKTtcbiAgfVxuXG4gIHJldHVybiBwYXJzZVVybFdpdGhBKGEsIHVybCwgb3B0X25vY2FjaGUgPyBudWxsIDogY2FjaGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBMb2NhdGlvbi1saWtlIG9iamVjdCBmb3IgdGhlIGdpdmVuIFVSTC4gSWYgaXQgaXMgcmVsYXRpdmUsXG4gKiB0aGUgVVJMIGdldHMgcmVzb2x2ZWQuXG4gKiBDb25zaWRlciB0aGUgcmV0dXJuZWQgb2JqZWN0IGltbXV0YWJsZS4gVGhpcyBpcyBlbmZvcmNlZCBkdXJpbmdcbiAqIHRlc3RpbmcgYnkgZnJlZXppbmcgdGhlIG9iamVjdC5cbiAqIEBwYXJhbSB7IUhUTUxBbmNob3JFbGVtZW50fSBhXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcGFyYW0ge0xydUNhY2hlPX0gb3B0X2NhY2hlXG4gKiBAcmV0dXJuIHshTG9jYXRpb259XG4gKiBAcmVzdHJpY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVcmxXaXRoQShhLCB1cmwsIG9wdF9jYWNoZSkge1xuICBpZiAob3B0X2NhY2hlICYmIG9wdF9jYWNoZS5oYXModXJsKSkge1xuICAgIHJldHVybiBvcHRfY2FjaGUuZ2V0KHVybCk7XG4gIH1cblxuICBhLmhyZWYgPSB1cmw7XG5cbiAgLy8gSUUxMSBkb2Vzbid0IHByb3ZpZGUgZnVsbCBVUkwgY29tcG9uZW50cyB3aGVuIHBhcnNpbmcgcmVsYXRpdmUgVVJMcy5cbiAgLy8gQXNzaWduaW5nIHRvIGl0c2VsZiBhZ2FpbiBkb2VzIHRoZSB0cmljayAjMzQ0OS5cbiAgaWYgKCFhLnByb3RvY29sKSB7XG4gICAgYS5ocmVmID0gYS5ocmVmO1xuICB9XG5cbiAgY29uc3QgaW5mbyA9IC8qKiBAdHlwZSB7IUxvY2F0aW9ufSAqLyh7XG4gICAgaHJlZjogYS5ocmVmLFxuICAgIHByb3RvY29sOiBhLnByb3RvY29sLFxuICAgIGhvc3Q6IGEuaG9zdCxcbiAgICBob3N0bmFtZTogYS5ob3N0bmFtZSxcbiAgICBwb3J0OiBhLnBvcnQgPT0gJzAnID8gJycgOiBhLnBvcnQsXG4gICAgcGF0aG5hbWU6IGEucGF0aG5hbWUsXG4gICAgc2VhcmNoOiBhLnNlYXJjaCxcbiAgICBoYXNoOiBhLmhhc2gsXG4gICAgb3JpZ2luOiBudWxsLCAvLyBTZXQgYmVsb3cuXG4gIH0pO1xuXG4gIC8vIFNvbWUgSUUxMSBzcGVjaWZpYyBwb2x5ZmlsbHMuXG4gIC8vIDEpIElFMTEgc3RyaXBzIG91dCB0aGUgbGVhZGluZyAnLycgaW4gdGhlIHBhdGhuYW1lLlxuICBpZiAoaW5mby5wYXRobmFtZVswXSAhPT0gJy8nKSB7XG4gICAgaW5mby5wYXRobmFtZSA9ICcvJyArIGluZm8ucGF0aG5hbWU7XG4gIH1cblxuICAvLyAyKSBGb3IgVVJMcyB3aXRoIGltcGxpY2l0IHBvcnRzLCBJRTExIHBhcnNlcyB0byBkZWZhdWx0IHBvcnRzIHdoaWxlXG4gIC8vIG90aGVyIGJyb3dzZXJzIGxlYXZlIHRoZSBwb3J0IGZpZWxkIGVtcHR5LlxuICBpZiAoKGluZm8ucHJvdG9jb2wgPT0gJ2h0dHA6JyAmJiBpbmZvLnBvcnQgPT0gODApXG4gICAgICB8fCAoaW5mby5wcm90b2NvbCA9PSAnaHR0cHM6JyAmJiBpbmZvLnBvcnQgPT0gNDQzKSkge1xuICAgIGluZm8ucG9ydCA9ICcnO1xuICAgIGluZm8uaG9zdCA9IGluZm8uaG9zdG5hbWU7XG4gIH1cblxuICAvLyBGb3IgZGF0YSBVUkkgYS5vcmlnaW4gaXMgZXF1YWwgdG8gdGhlIHN0cmluZyAnbnVsbCcgd2hpY2ggaXMgbm90IHVzZWZ1bC5cbiAgLy8gV2UgaW5zdGVhZCByZXR1cm4gdGhlIGFjdHVhbCBvcmlnaW4gd2hpY2ggaXMgdGhlIGZ1bGwgVVJMLlxuICBpZiAoYS5vcmlnaW4gJiYgYS5vcmlnaW4gIT0gJ251bGwnKSB7XG4gICAgaW5mby5vcmlnaW4gPSBhLm9yaWdpbjtcbiAgfSBlbHNlIGlmIChpbmZvLnByb3RvY29sID09ICdkYXRhOicgfHwgIWluZm8uaG9zdCkge1xuICAgIGluZm8ub3JpZ2luID0gaW5mby5ocmVmO1xuICB9IGVsc2Uge1xuICAgIGluZm8ub3JpZ2luID0gaW5mby5wcm90b2NvbCArICcvLycgKyBpbmZvLmhvc3Q7XG4gIH1cblxuICAvLyBGcmVlemUgZHVyaW5nIHRlc3RpbmcgdG8gYXZvaWQgYWNjaWRlbnRhbCBtdXRhdGlvbi5cbiAgY29uc3QgZnJvemVuID0gKGdldE1vZGUoKS50ZXN0ICYmIE9iamVjdC5mcmVlemUpID8gT2JqZWN0LmZyZWV6ZShpbmZvKSA6IGluZm87XG5cbiAgaWYgKG9wdF9jYWNoZSkge1xuICAgIG9wdF9jYWNoZS5wdXQodXJsLCBmcm96ZW4pO1xuICB9XG5cbiAgcmV0dXJuIGZyb3plbjtcbn1cblxuLyoqXG4gKiBBcHBlbmRzIHRoZSBzdHJpbmcganVzdCBiZWZvcmUgdGhlIGZyYWdtZW50IHBhcnQgKG9yIG9wdGlvbmFsbHlcbiAqIHRvIHRoZSBmcm9udCBvZiB0aGUgcXVlcnkgc3RyaW5nKSBvZiB0aGUgVVJMLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IHBhcmFtU3RyaW5nXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYWRkVG9Gcm9udFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBwYXJhbVN0cmluZyxcbiAgb3B0X2FkZFRvRnJvbnQpIHtcbiAgaWYgKCFwYXJhbVN0cmluZykge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgY29uc3QgbWFpbkFuZEZyYWdtZW50ID0gdXJsLnNwbGl0KCcjJywgMik7XG4gIGNvbnN0IG1haW5BbmRRdWVyeSA9IG1haW5BbmRGcmFnbWVudFswXS5zcGxpdCgnPycsIDIpO1xuXG4gIGxldCBuZXdVcmwgPSBtYWluQW5kUXVlcnlbMF0gKyAoXG4gICAgbWFpbkFuZFF1ZXJ5WzFdXG4gICAgICA/IChvcHRfYWRkVG9Gcm9udFxuICAgICAgICA/IGA/JHtwYXJhbVN0cmluZ30mJHttYWluQW5kUXVlcnlbMV19YFxuICAgICAgICA6IGA/JHttYWluQW5kUXVlcnlbMV19JiR7cGFyYW1TdHJpbmd9YClcbiAgICAgIDogYD8ke3BhcmFtU3RyaW5nfWApO1xuICBuZXdVcmwgKz0gbWFpbkFuZEZyYWdtZW50WzFdID8gYCMke21haW5BbmRGcmFnbWVudFsxXX1gIDogJyc7XG4gIHJldHVybiBuZXdVcmw7XG59XG4vKipcbiAqIEFwcGVuZHMgYSBxdWVyeSBzdHJpbmcgZmllbGQgYW5kIHZhbHVlIHRvIGEgdXJsLiBga2V5YCBhbmQgYHZhbHVlYFxuICogd2lsbCBiZSByYW4gdGhyb3VnaCBgZW5jb2RlVVJJQ29tcG9uZW50YCBiZWZvcmUgYXBwZW5kaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxuICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfYWRkVG9Gcm9udFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUGFyYW1Ub1VybCh1cmwsIGtleSwgdmFsdWUsIG9wdF9hZGRUb0Zyb250KSB7XG4gIGNvbnN0IGZpZWxkID0gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKX1gO1xuICByZXR1cm4gYXBwZW5kRW5jb2RlZFBhcmFtU3RyaW5nVG9VcmwodXJsLCBmaWVsZCwgb3B0X2FkZFRvRnJvbnQpO1xufVxuXG4vKipcbiAqIEFwcGVuZHMgcXVlcnkgc3RyaW5nIGZpZWxkcyBhbmQgdmFsdWVzIHRvIGEgdXJsLiBUaGUgYHBhcmFtc2Agb2JqZWN0cydcbiAqIGBrZXlgcyBhbmQgYHZhbHVlYHMgd2lsbCBiZSB0cmFuc2Zvcm1lZCBpbnRvIHF1ZXJ5IHN0cmluZyBrZXlzL3ZhbHVlcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmd8IUFycmF5PHN0cmluZz4+fSBwYXJhbXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFBhcmFtc1RvVXJsKHVybCwgcGFyYW1zKSB7XG4gIHJldHVybiBhcHBlbmRFbmNvZGVkUGFyYW1TdHJpbmdUb1VybCh1cmwsIHNlcmlhbGl6ZVF1ZXJ5U3RyaW5nKHBhcmFtcykpO1xufVxuXG4vKipcbiAqIFNlcmlhbGl6ZXMgdGhlIHBhc3NlZCBwYXJhbWV0ZXIgbWFwIGludG8gYSBxdWVyeSBzdHJpbmcgd2l0aCBib3RoIGtleXNcbiAqIGFuZCB2YWx1ZXMgZW5jb2RlZC5cbiAqIEBwYXJhbSB7IUpzb25PYmplY3Q8c3RyaW5nLCBzdHJpbmd8IUFycmF5PHN0cmluZz4+fSBwYXJhbXNcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZVF1ZXJ5U3RyaW5nKHBhcmFtcykge1xuICBjb25zdCBzID0gW107XG4gIGZvciAoY29uc3QgayBpbiBwYXJhbXMpIHtcbiAgICBjb25zdCB2ID0gcGFyYW1zW2tdO1xuICAgIGlmICh2ID09IG51bGwpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheSh2KSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHN2ID0gLyoqIEB0eXBlIHtzdHJpbmd9ICovICh2W2ldKTtcbiAgICAgICAgcy5wdXNoKGAke2VuY29kZVVSSUNvbXBvbmVudChrKX09JHtlbmNvZGVVUklDb21wb25lbnQoc3YpfWApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzdiA9IC8qKiBAdHlwZSB7c3RyaW5nfSAqLyAodik7XG4gICAgICBzLnB1c2goYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGspfT0ke2VuY29kZVVSSUNvbXBvbmVudChzdil9YCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzLmpvaW4oJyYnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgVVJMIGlzIHNlY3VyZTogZWl0aGVyIEhUVFBTIG9yIGxvY2FsaG9zdCAoZm9yIHRlc3RpbmcpLlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmxcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NlY3VyZVVybERlcHJlY2F0ZWQodXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuICh1cmwucHJvdG9jb2wgPT0gJ2h0dHBzOicgfHxcbiAgICAgIHVybC5ob3N0bmFtZSA9PSAnbG9jYWxob3N0JyB8fFxuICAgICAgZW5kc1dpdGgodXJsLmhvc3RuYW1lLCAnLmxvY2FsaG9zdCcpKTtcbn1cblxuLyoqXG4gKiBBc3NlcnRzIHRoYXQgYSBnaXZlbiB1cmwgaXMgSFRUUFMgb3IgcHJvdG9jb2wgcmVsYXRpdmUuIEl0J3MgYSB1c2VyLWxldmVsXG4gKiBhc3NlcnQuXG4gKlxuICogUHJvdmlkZXMgYW4gZXhjZXB0aW9uIGZvciBsb2NhbGhvc3QuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfHVuZGVmaW5lZH0gdXJsU3RyaW5nXG4gKiBAcGFyYW0geyFFbGVtZW50fHN0cmluZ30gZWxlbWVudENvbnRleHQgRWxlbWVudCB3aGVyZSB0aGUgdXJsIHdhcyBmb3VuZC5cbiAqIEBwYXJhbSB7c3RyaW5nPX0gc291cmNlTmFtZSBVc2VkIGZvciBlcnJvciBtZXNzYWdlcy5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEh0dHBzVXJsKFxuICB1cmxTdHJpbmcsIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lID0gJ3NvdXJjZScpIHtcbiAgdXNlcigpLmFzc2VydCh1cmxTdHJpbmcgIT0gbnVsbCwgJyVzICVzIG11c3QgYmUgYXZhaWxhYmxlJyxcbiAgICAgIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lKTtcbiAgLy8gKGVyd2lubSwgIzQ1NjApOiB0eXBlIGNhc3QgbmVjZXNzYXJ5IHVudGlsICM0NTYwIGlzIGZpeGVkLlxuICBjb25zdCB0aGVVcmxTdHJpbmcgPSAvKiogQHR5cGUge3N0cmluZ30gKi8gKHVybFN0cmluZyk7XG4gIHVzZXIoKS5hc3NlcnQoaXNTZWN1cmVVcmxEZXByZWNhdGVkKHRoZVVybFN0cmluZykgfHwgL14oXFwvXFwvKS8udGVzdCh0aGVVcmxTdHJpbmcpLFxuICAgICAgJyVzICVzIG11c3Qgc3RhcnQgd2l0aCAnICtcbiAgICAgICdcImh0dHBzOi8vXCIgb3IgXCIvL1wiIG9yIGJlIHJlbGF0aXZlIGFuZCBzZXJ2ZWQgZnJvbSAnICtcbiAgICAgICdlaXRoZXIgaHR0cHMgb3IgZnJvbSBsb2NhbGhvc3QuIEludmFsaWQgdmFsdWU6ICVzJyxcbiAgICAgIGVsZW1lbnRDb250ZXh0LCBzb3VyY2VOYW1lLCB0aGVVcmxTdHJpbmcpO1xuICByZXR1cm4gdGhlVXJsU3RyaW5nO1xufVxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCBhIGdpdmVuIHVybCBpcyBhbiBhYnNvbHV0ZSBIVFRQIG9yIEhUVFBTIFVSTC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxTdHJpbmdcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEFic29sdXRlSHR0cE9ySHR0cHNVcmwodXJsU3RyaW5nKSB7XG4gIHVzZXIoKS5hc3NlcnQoL15odHRwcz9cXDovaS50ZXN0KHVybFN0cmluZyksXG4gICAgICAnVVJMIG11c3Qgc3RhcnQgd2l0aCBcImh0dHA6Ly9cIiBvciBcImh0dHBzOi8vXCIuIEludmFsaWQgdmFsdWU6ICVzJyxcbiAgICAgIHVybFN0cmluZyk7XG4gIHJldHVybiBwYXJzZVVybERlcHJlY2F0ZWQodXJsU3RyaW5nKS5ocmVmO1xufVxuXG5cbi8qKlxuICogUGFyc2VzIHRoZSBxdWVyeSBzdHJpbmcgb2YgYW4gVVJMLiBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc2ltcGxlIGtleS92YWx1ZVxuICogbWFwLiBJZiB0aGVyZSBhcmUgZHVwbGljYXRlIGtleXMgdGhlIGxhdGVzdCB2YWx1ZSBpcyByZXR1cm5lZC5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIGltcGxlbWVudGVkIGluIGEgc2VwYXJhdGUgZmlsZSB0byBhdm9pZCBhIGNpcmN1bGFyXG4gKiBkZXBlbmRlbmN5LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyeVN0cmluZ1xuICogQHJldHVybiB7IUpzb25PYmplY3R9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nKHF1ZXJ5U3RyaW5nKSB7XG4gIHJldHVybiBwYXJzZVF1ZXJ5U3RyaW5nXyhxdWVyeVN0cmluZyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgVVJMIHdpdGhvdXQgZnJhZ21lbnQuIElmIFVSTCBkb2Vzbid0IGNvbnRhaW4gZnJhZ21lbnQsIHRoZSBzYW1lXG4gKiBzdHJpbmcgaXMgcmV0dXJuZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVGcmFnbWVudCh1cmwpIHtcbiAgY29uc3QgaW5kZXggPSB1cmwuaW5kZXhPZignIycpO1xuICBpZiAoaW5kZXggPT0gLTEpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBmcmFnbWVudCBmcm9tIHRoZSBVUkwuIElmIHRoZSBVUkwgZG9lc24ndCBjb250YWluIGZyYWdtZW50LFxuICogdGhlIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZyYWdtZW50KHVybCkge1xuICBjb25zdCBpbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIGlmIChpbmRleCA9PSAtMSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICByZXR1cm4gdXJsLnN1YnN0cmluZyhpbmRleCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgaGFzIHRoZSBvcmlnaW4gb2YgYSBwcm94eS5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNQcm94eU9yaWdpbih1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICByZXR1cm4gdXJscy5jZG5Qcm94eVJlZ2V4LnRlc3QodXJsLm9yaWdpbik7XG59XG5cbi8qKlxuICogRm9yIHByb3h5LW9yaWdpbiBVUkxzLCByZXR1cm5zIHRoZSBzZXJ2aW5nIHR5cGUuIE90aGVyd2lzZSwgcmV0dXJucyBudWxsLlxuICogRS5nLiwgJ2h0dHBzOi8vYW1wLWNvbS5jZG4uYW1wcHJvamVjdC5vcmcvYS9zL2FtcC5jb20vYW1wX2RvY3VtZW50Lmh0bWwnXG4gKiByZXR1cm5zICdhJy5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHs/c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJveHlTZXJ2aW5nVHlwZSh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuICBpZiAoIWlzUHJveHlPcmlnaW4odXJsKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWUuc3BsaXQoJy8nLCAyKTtcbiAgcmV0dXJuIHBhdGhbMV07XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBVUkwgb3JpZ2luIGlzIGxvY2FsaG9zdC5cbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gdXJsIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQuXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMb2NhbGhvc3RPcmlnaW4odXJsKSB7XG4gIGlmICh0eXBlb2YgdXJsID09ICdzdHJpbmcnKSB7XG4gICAgdXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIH1cbiAgcmV0dXJuIHVybHMubG9jYWxob3N0UmVnZXgudGVzdCh1cmwub3JpZ2luKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIFVSTCBoYXMgdmFsaWQgcHJvdG9jb2wuXG4gKiBEZWVwIGxpbmsgcHJvdG9jb2wgaXMgdmFsaWQsIGJ1dCBub3QgamF2YXNjcmlwdCBldGMuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJvdG9jb2xWYWxpZCh1cmwpIHtcbiAgaWYgKCF1cmwpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAodHlwZW9mIHVybCA9PSAnc3RyaW5nJykge1xuICAgIHVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICB9XG4gIHJldHVybiAhSU5WQUxJRF9QUk9UT0NPTFMuaW5jbHVkZXModXJsLnByb3RvY29sKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgVVJMIHdpdGhvdXQgQU1QIEpTIHBhcmFtZXRlcnMuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbXBKc1BhcmFtc0Zyb21VcmwodXJsKSB7XG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlVXJsRGVwcmVjYXRlZCh1cmwpO1xuICBjb25zdCBzZWFyY2ggPSByZW1vdmVBbXBKc1BhcmFtc0Zyb21TZWFyY2gocGFyc2VkLnNlYXJjaCk7XG4gIHJldHVybiBwYXJzZWQub3JpZ2luICsgcGFyc2VkLnBhdGhuYW1lICsgc2VhcmNoICsgcGFyc2VkLmhhc2g7XG5cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgVVJMIHdpdGhvdXQgYSBxdWVyeSBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVTZWFyY2godXJsKSB7XG4gIGNvbnN0IGluZGV4ID0gdXJsLmluZGV4T2YoJz8nKTtcbiAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuICBjb25zdCBmcmFnbWVudCA9IGdldEZyYWdtZW50KHVybCk7XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KSArIGZyYWdtZW50O1xufVxuXG4vKipcbiAqIFJlbW92ZXMgcGFyYW1ldGVycyB0aGF0IHN0YXJ0IHdpdGggYW1wIGpzIHBhcmFtZXRlciBwYXR0ZXJuIGFuZCByZXR1cm5zIHRoZVxuICogbmV3IHNlYXJjaCBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsU2VhcmNoXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUFtcEpzUGFyYW1zRnJvbVNlYXJjaCh1cmxTZWFyY2gpIHtcbiAgaWYgKCF1cmxTZWFyY2ggfHwgdXJsU2VhcmNoID09ICc/Jykge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBjb25zdCBzZWFyY2ggPSB1cmxTZWFyY2hcbiAgICAgIC5yZXBsYWNlKEFNUF9KU19QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoQU1QX0dTQV9QQVJBTVNfUkVHRVgsICcnKVxuICAgICAgLnJlcGxhY2UoQU1QX1JfUEFSQU1TX1JFR0VYLCAnJylcbiAgICAgIC5yZXBsYWNlKEdPT0dMRV9FWFBFUklNRU5UX1BBUkFNU19SRUdFWCwgJycpXG4gICAgICAucmVwbGFjZSgvXls/Jl0vLCAnJyk7IC8vIFJlbW92ZXMgZmlyc3QgPyBvciAmLlxuICByZXR1cm4gc2VhcmNoID8gJz8nICsgc2VhcmNoIDogJyc7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc291cmNlIFVSTCBvZiBhbiBBTVAgZG9jdW1lbnQgZm9yIGRvY3VtZW50cyBzZXJ2ZWRcbiAqIG9uIGEgcHJveHkgb3JpZ2luIG9yIGRpcmVjdGx5LlxuICogQHBhcmFtIHtzdHJpbmd8IUxvY2F0aW9ufSB1cmwgVVJMIG9mIGFuIEFNUCBkb2N1bWVudC5cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNvdXJjZVVybCh1cmwpIHtcbiAgaWYgKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycpIHtcbiAgICB1cmwgPSBwYXJzZVVybERlcHJlY2F0ZWQodXJsKTtcbiAgfVxuXG4gIC8vIE5vdCBhIHByb3h5IFVSTCAtIHJldHVybiB0aGUgVVJMIGl0c2VsZi5cbiAgaWYgKCFpc1Byb3h5T3JpZ2luKHVybCkpIHtcbiAgICByZXR1cm4gdXJsLmhyZWY7XG4gIH1cblxuICAvLyBBIHByb3h5IFVSTC5cbiAgLy8gRXhhbXBsZSBwYXRoIHRoYXQgaXMgYmVpbmcgbWF0Y2hlZCBoZXJlLlxuICAvLyBodHRwczovL2Nkbi5hbXBwcm9qZWN0Lm9yZy9jL3Mvd3d3Lm9yaWdpbi5jb20vZm9vL1xuICAvLyBUaGUgL3MvIGlzIG9wdGlvbmFsIGFuZCBzaWduYWxzIGEgc2VjdXJlIG9yaWdpbi5cbiAgY29uc3QgcGF0aCA9IHVybC5wYXRobmFtZS5zcGxpdCgnLycpO1xuICBjb25zdCBwcmVmaXggPSBwYXRoWzFdO1xuICB1c2VyKCkuYXNzZXJ0KFNFUlZJTkdfVFlQRV9QUkVGSVhbcHJlZml4XSxcbiAgICAgICdVbmtub3duIHBhdGggcHJlZml4IGluIHVybCAlcycsIHVybC5ocmVmKTtcbiAgY29uc3QgZG9tYWluT3JIdHRwc1NpZ25hbCA9IHBhdGhbMl07XG4gIGNvbnN0IG9yaWdpbiA9IGRvbWFpbk9ySHR0cHNTaWduYWwgPT0gJ3MnXG4gICAgPyAnaHR0cHM6Ly8nICsgZGVjb2RlVVJJQ29tcG9uZW50KHBhdGhbM10pXG4gICAgOiAnaHR0cDovLycgKyBkZWNvZGVVUklDb21wb25lbnQoZG9tYWluT3JIdHRwc1NpZ25hbCk7XG4gIC8vIFNhbml0eSB0ZXN0IHRoYXQgd2hhdCB3ZSBmb3VuZCBsb29rcyBsaWtlIGEgZG9tYWluLlxuICB1c2VyKCkuYXNzZXJ0KG9yaWdpbi5pbmRleE9mKCcuJykgPiAwLCAnRXhwZWN0ZWQgYSAuIGluIG9yaWdpbiAlcycsIG9yaWdpbik7XG4gIHBhdGguc3BsaWNlKDEsIGRvbWFpbk9ySHR0cHNTaWduYWwgPT0gJ3MnID8gMyA6IDIpO1xuICByZXR1cm4gb3JpZ2luICsgcGF0aC5qb2luKCcvJykgK1xuICAgICAgcmVtb3ZlQW1wSnNQYXJhbXNGcm9tU2VhcmNoKHVybC5zZWFyY2gpICsgKHVybC5oYXNoIHx8ICcnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzb3VyY2Ugb3JpZ2luIG9mIGFuIEFNUCBkb2N1bWVudCBmb3IgZG9jdW1lbnRzIHNlcnZlZFxuICogb24gYSBwcm94eSBvcmlnaW4gb3IgZGlyZWN0bHkuXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IHVybCBVUkwgb2YgYW4gQU1QIGRvY3VtZW50LlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgc291cmNlIG9yaWdpbiBvZiB0aGUgVVJMLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U291cmNlT3JpZ2luKHVybCkge1xuICByZXR1cm4gcGFyc2VVcmxEZXByZWNhdGVkKGdldFNvdXJjZVVybCh1cmwpKS5vcmlnaW47XG59XG5cbi8qKlxuICogUmV0dXJucyBhYnNvbHV0ZSBVUkwgcmVzb2x2ZWQgYmFzZWQgb24gdGhlIHJlbGF0aXZlIFVSTCBhbmQgdGhlIGJhc2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVcmxTdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfCFMb2NhdGlvbn0gYmFzZVVybFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVJlbGF0aXZlVXJsKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsKSB7XG4gIGlmICh0eXBlb2YgYmFzZVVybCA9PSAnc3RyaW5nJykge1xuICAgIGJhc2VVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQoYmFzZVVybCk7XG4gIH1cbiAgaWYgKHR5cGVvZiBVUkwgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBuZXcgVVJMKHJlbGF0aXZlVXJsU3RyaW5nLCBiYXNlVXJsLmhyZWYpLnRvU3RyaW5nKCk7XG4gIH1cbiAgcmV0dXJuIHJlc29sdmVSZWxhdGl2ZVVybEZhbGxiYWNrXyhyZWxhdGl2ZVVybFN0cmluZywgYmFzZVVybCk7XG59XG5cbi8qKlxuICogRmFsbGJhY2sgZm9yIFVSTCByZXNvbHZlciB3aGVuIFVSTCBjbGFzcyBpcyBub3QgYXZhaWxhYmxlLlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbGF0aXZlVXJsU3RyaW5nXG4gKiBAcGFyYW0ge3N0cmluZ3whTG9jYXRpb259IGJhc2VVcmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEBwcml2YXRlIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlUmVsYXRpdmVVcmxGYWxsYmFja18ocmVsYXRpdmVVcmxTdHJpbmcsIGJhc2VVcmwpIHtcbiAgaWYgKHR5cGVvZiBiYXNlVXJsID09ICdzdHJpbmcnKSB7XG4gICAgYmFzZVVybCA9IHBhcnNlVXJsRGVwcmVjYXRlZChiYXNlVXJsKTtcbiAgfVxuICByZWxhdGl2ZVVybFN0cmluZyA9IHJlbGF0aXZlVXJsU3RyaW5nLnJlcGxhY2UoL1xcXFwvZywgJy8nKTtcbiAgY29uc3QgcmVsYXRpdmVVcmwgPSBwYXJzZVVybERlcHJlY2F0ZWQocmVsYXRpdmVVcmxTdHJpbmcpO1xuXG4gIC8vIEFic29sdXRlIFVSTC5cbiAgaWYgKHN0YXJ0c1dpdGgocmVsYXRpdmVVcmxTdHJpbmcudG9Mb3dlckNhc2UoKSwgcmVsYXRpdmVVcmwucHJvdG9jb2wpKSB7XG4gICAgcmV0dXJuIHJlbGF0aXZlVXJsLmhyZWY7XG4gIH1cblxuICAvLyBQcm90b2NvbC1yZWxhdGl2ZSBVUkwuXG4gIGlmIChzdGFydHNXaXRoKHJlbGF0aXZlVXJsU3RyaW5nLCAnLy8nKSkge1xuICAgIHJldHVybiBiYXNlVXJsLnByb3RvY29sICsgcmVsYXRpdmVVcmxTdHJpbmc7XG4gIH1cblxuICAvLyBBYnNvbHV0ZSBwYXRoLlxuICBpZiAoc3RhcnRzV2l0aChyZWxhdGl2ZVVybFN0cmluZywgJy8nKSkge1xuICAgIHJldHVybiBiYXNlVXJsLm9yaWdpbiArIHJlbGF0aXZlVXJsU3RyaW5nO1xuICB9XG5cbiAgLy8gUmVsYXRpdmUgcGF0aC5cbiAgcmV0dXJuIGJhc2VVcmwub3JpZ2luICsgYmFzZVVybC5wYXRobmFtZS5yZXBsYWNlKC9cXC9bXi9dKiQvLCAnLycpXG4gICAgICArIHJlbGF0aXZlVXJsU3RyaW5nO1xufVxuXG5cbi8qKlxuICogQWRkIFwiX19hbXBfc291cmNlX29yaWdpblwiIHF1ZXJ5IHBhcmFtZXRlciB0byB0aGUgVVJMLlxuICogQHBhcmFtIHshV2luZG93fSB3aW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvcnNVcmwod2luLCB1cmwpIHtcbiAgY2hlY2tDb3JzVXJsKHVybCk7XG4gIGNvbnN0IHNvdXJjZU9yaWdpbiA9IGdldFNvdXJjZU9yaWdpbih3aW4ubG9jYXRpb24uaHJlZik7XG4gIHJldHVybiBhZGRQYXJhbVRvVXJsKHVybCwgU09VUkNFX09SSUdJTl9QQVJBTSwgc291cmNlT3JpZ2luKTtcbn1cblxuXG4vKipcbiAqIENoZWNrcyBpZiB0aGUgdXJsIGhhcyBfX2FtcF9zb3VyY2Vfb3JpZ2luIGFuZCB0aHJvd3MgaWYgaXQgZG9lcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrQ29yc1VybCh1cmwpIHtcbiAgY29uc3QgcGFyc2VkVXJsID0gcGFyc2VVcmxEZXByZWNhdGVkKHVybCk7XG4gIGNvbnN0IHF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhwYXJzZWRVcmwuc2VhcmNoKTtcbiAgdXNlcigpLmFzc2VydCghKFNPVVJDRV9PUklHSU5fUEFSQU0gaW4gcXVlcnkpLFxuICAgICAgJ1NvdXJjZSBvcmlnaW4gaXMgbm90IGFsbG93ZWQgaW4gJXMnLCB1cmwpO1xufVxuXG4vKipcbiAqIFRyaWVzIHRvIGRlY29kZSBhIFVSSSBjb21wb25lbnQsIGZhbGxpbmcgYmFjayB0byBvcHRfZmFsbGJhY2sgKG9yIGFuIGVtcHR5XG4gKiBzdHJpbmcpXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbXBvbmVudFxuICogQHBhcmFtIHtzdHJpbmc9fSBvcHRfZmFsbGJhY2tcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyeURlY29kZVVyaUNvbXBvbmVudChjb21wb25lbnQsIG9wdF9mYWxsYmFjaykge1xuICByZXR1cm4gdHJ5RGVjb2RlVXJpQ29tcG9uZW50Xyhjb21wb25lbnQsIG9wdF9mYWxsYmFjayk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuXG4vKipcbiAqIENvbXBhcmVzIGlmIHR3byBhcnJheXMgY29udGFpbnMgZXhhY3RseSBzYW1lIGVsZW1lbnRzIG9mIHNhbWUgbnVtYmVyXG4gKiBvZiBzYW1lIG9yZGVyLlxuICogTm90aWNlIHRoYXQgaXQgZG9lcyBOT1QgaGFuZGxlIE5hTiBjYXNlIGFzIGV4cGVjdGVkXG4gKlxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycjFcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnIyXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFyZUVxdWFsT3JkZXJlZChhcnIxLCBhcnIyKSB7XG4gIGlmIChhcnIxLmxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycjEubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEEgYml0IGxpa2UgQXJyYXkjZmlsdGVyLCBidXQgcmVtb3ZlcyBlbGVtZW50cyB0aGF0IGZpbHRlciBmYWxzZSBmcm9tIHRoZVxuICogYXJyYXkuIFJldHVybnMgdGhlIGZpbHRlcmVkIGl0ZW1zLlxuICpcbiAqIEBwYXJhbSB7IUFycmF5PFQ+fSBhcnJheVxuICogQHBhcmFtIHtmdW5jdGlvbihULCBudW1iZXIsICFBcnJheTxUPik6Ym9vbGVhbn0gZmlsdGVyXG4gKiBAcmV0dXJuIHshQXJyYXk8VD59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyU3BsaWNlKGFycmF5LCBmaWx0ZXIpIHtcbiAgY29uc3Qgc3BsaWNlID0gW107XG4gIGxldCBpbmRleCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpdGVtID0gYXJyYXlbaV07XG4gICAgaWYgKGZpbHRlcihpdGVtLCBpLCBhcnJheSkpIHtcbiAgICAgIGlmIChpbmRleCA8IGkpIHtcbiAgICAgICAgYXJyYXlbaW5kZXhdID0gaXRlbTtcbiAgICAgIH1cbiAgICAgIGluZGV4Kys7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwbGljZS5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbmRleCA8IGFycmF5Lmxlbmd0aCkge1xuICAgIGFycmF5Lmxlbmd0aCA9IGluZGV4O1xuICB9XG5cbiAgcmV0dXJuIHNwbGljZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZWxlbWVudCBtYXRjaGluZyB0aGUgcHJlZGljYXRlLlxuICogTGlrZSBBcnJheSNmaW5kSW5kZXguXG4gKlxuICogQHBhcmFtIHshQXJyYXk8VD59IGFycmF5XG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFQsIG51bWJlciwgIUFycmF5PFQ+KTpib29sZWFufSBwcmVkaWNhdGVcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaW5kSW5kZXgoYXJyYXksIHByZWRpY2F0ZSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHByZWRpY2F0ZShhcnJheVtpXSwgaSwgYXJyYXkpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBnaXZlbiBpdGVyYXRvciB0byBhbiBhcnJheS5cbiAqXG4gKiBAcGFyYW0geyFJdGVyYXRvcjxUPn0gaXRlcmF0b3JcbiAqIEByZXR1cm4ge0FycmF5PFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21JdGVyYXRvcihpdGVyYXRvcikge1xuICBjb25zdCBhcnJheSA9IFtdO1xuICBmb3IgKGxldCBlID0gaXRlcmF0b3IubmV4dCgpOyAhZS5kb25lOyBlID0gaXRlcmF0b3IubmV4dCgpKSB7XG4gICAgYXJyYXkucHVzaChlLnZhbHVlKTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG5cbi8qKlxuICogQWRkcyBpdGVtIHRvIGFycmF5IGlmIGl0IGlzIG5vdCBhbHJlYWR5IHByZXNlbnQuXG4gKlxuICogQHBhcmFtIHtBcnJheTxUPn0gYXJyYXlcbiAqIEBwYXJhbSB7VH0gaXRlbVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB1c2hJZk5vdEV4aXN0KGFycmF5LCBpdGVtKSB7XG4gIGlmIChhcnJheS5pbmRleE9mKGl0ZW0pIDwgMCkge1xuICAgIGFycmF5LnB1c2goaXRlbSk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTggVGhlIEFNUCBIVE1MIEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge2Rldn0gZnJvbSAnLi4vbG9nJztcblxuLyoqIEBjb25zdCB7c3RyaW5nfSAqL1xuY29uc3QgVEFHID0gJ2xydS1jYWNoZSc7XG5cbi8qKlxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGNsYXNzIExydUNhY2hlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjYXBhY2l0eVxuICAgKi9cbiAgY29uc3RydWN0b3IoY2FwYWNpdHkpIHtcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHtudW1iZXJ9ICovXG4gICAgdGhpcy5jYXBhY2l0eV8gPSBjYXBhY2l0eTtcblxuICAgIC8qKiBAcHJpdmF0ZSB7bnVtYmVyfSAqL1xuICAgIHRoaXMuc2l6ZV8gPSAwO1xuXG4gICAgLyoqXG4gICAgICogQW4gaW5jcmVtZW50aW5nIGNvdW50ZXIgdG8gZGVmaW5lIHRoZSBsYXN0IGFjY2Vzcy5cbiAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHRoaXMuYWNjZXNzXyA9IDA7XG5cbiAgICAvKiogQHByaXZhdGUgeyFPYmplY3Q8KG51bWJlcnxzdHJpbmcpLCB7cGF5bG9hZDogVCwgYWNjZXNzOiBudW1iZXJ9Pn0gKi9cbiAgICB0aGlzLmNhY2hlXyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIGtleSBpcyBjYWNoZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30ga2V5XG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqL1xuICBoYXMoa2V5KSB7XG4gICAgcmV0dXJuICEhdGhpcy5jYWNoZV9ba2V5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtUfSBUaGUgY2FjaGVkIHBheWxvYWQuXG4gICAqL1xuICBnZXQoa2V5KSB7XG4gICAgY29uc3QgY2FjaGVhYmxlID0gdGhpcy5jYWNoZV9ba2V5XTtcbiAgICBpZiAoY2FjaGVhYmxlKSB7XG4gICAgICBjYWNoZWFibGUuYWNjZXNzID0gKyt0aGlzLmFjY2Vzc187XG4gICAgICByZXR1cm4gY2FjaGVhYmxlLnBheWxvYWQ7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSBrZXlcbiAgICogQHBhcmFtIHtUfSBwYXlsb2FkIFRoZSBwYXlsb2FkIHRvIGNhY2hlLlxuICAgKi9cbiAgcHV0KGtleSwgcGF5bG9hZCkge1xuICAgIGlmICghdGhpcy5oYXMoa2V5KSkge1xuICAgICAgdGhpcy5zaXplXysrO1xuICAgIH1cbiAgICB0aGlzLmNhY2hlX1trZXldID0ge3BheWxvYWQsIGFjY2VzczogdGhpcy5hY2Nlc3NffTtcbiAgICB0aGlzLmV2aWN0XygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV2aWN0cyB0aGUgb2xkZXN0IGNhY2hlIGVudHJ5LCBpZiB3ZSd2ZSBleGNlZWRlZCBjYXBhY2l0eS5cbiAgICovXG4gIGV2aWN0XygpIHtcbiAgICBpZiAodGhpcy5zaXplXyA8PSB0aGlzLmNhcGFjaXR5Xykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRldigpLndhcm4oVEFHLCAnVHJpbW1pbmcgTFJVIGNhY2hlJyk7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmNhY2hlXztcbiAgICBsZXQgb2xkZXN0ID0gdGhpcy5hY2Nlc3NfICsgMTtcbiAgICBsZXQgb2xkZXN0S2V5O1xuICAgIGZvciAoY29uc3Qga2V5IGluIGNhY2hlKSB7XG4gICAgICBjb25zdCB7YWNjZXNzfSA9IGNhY2hlW2tleV07XG4gICAgICBpZiAoYWNjZXNzIDwgb2xkZXN0KSB7XG4gICAgICAgIG9sZGVzdCA9IGFjY2VzcztcbiAgICAgICAgb2xkZXN0S2V5ID0ga2V5O1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvbGRlc3RLZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZGVsZXRlIGNhY2hlW29sZGVzdEtleV07XG4gICAgICB0aGlzLnNpemVfLS07XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE1IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtpc09iamVjdH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKiBAY29uc3QgKi9cbmNvbnN0IGhhc093bl8gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIFJldHVybnMgYSBtYXAtbGlrZSBvYmplY3QuXG4gKiBJZiBvcHRfaW5pdGlhbCBpcyBwcm92aWRlZCwgY29waWVzIGl0cyBvd24gcHJvcGVydGllcyBpbnRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBvYmplY3QuXG4gKiBAcGFyYW0ge1Q9fSBvcHRfaW5pdGlhbCBUaGlzIHNob3VsZCB0eXBpY2FsbHkgYmUgYW4gb2JqZWN0IGxpdGVyYWwuXG4gKiBAcmV0dXJuIHtUfVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcChvcHRfaW5pdGlhbCkge1xuICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBpZiAob3B0X2luaXRpYWwpIHtcbiAgICBPYmplY3QuYXNzaWduKG9iaiwgb3B0X2luaXRpYWwpO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogUmV0dXJuIGFuIGVtcHR5IEpzb25PYmplY3Qgb3IgbWFrZXMgdGhlIHBhc3NlZCBpbiBvYmplY3QgbGl0ZXJhbFxuICogYW4gSnNvbk9iamVjdC5cbiAqIFRoZSBKc29uT2JqZWN0IHR5cGUgaXMganVzdCBhIHNpbXBsZSBvYmplY3QgdGhhdCBpcyBhdC1kaWN0LlxuICogU2VlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtY29tcGlsZXIvd2lraS9Ac3RydWN0LWFuZC1AZGljdC1Bbm5vdGF0aW9uc1xuICogZm9yIHdoYXQgYSBkaWN0IGlzIHR5cGUtd2lzZS5cbiAqIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgYXJndW1lbnQgaXMsIGluIGZhY3QsIGF0LWRpY3QgbGlrZS5cbiAqIEBwYXJhbSB7IU9iamVjdD19IG9wdF9pbml0aWFsXG4gKiBAcmV0dXJuIHshSnNvbk9iamVjdH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpY3Qob3B0X2luaXRpYWwpIHtcbiAgLy8gV2UgZG8gbm90IGNvcHkuIFRoZSBsaW50ZXIgZW5mb3JjZXMgdGhhdCB0aGUgcGFzc2VkIGluIG9iamVjdCBpcyBhIGxpdGVyYWxcbiAgLy8gYW5kIHRodXMgdGhlIGNhbGxlciBjYW5ub3QgaGF2ZSBhIHJlZmVyZW5jZSB0byBpdC5cbiAgcmV0dXJuIC8qKiBAdHlwZSB7IUpzb25PYmplY3R9ICovIChvcHRfaW5pdGlhbCB8fCB7fSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBrZXkgaXMgYSBwcm9wZXJ0eSBpbiB0aGUgbWFwLlxuICpcbiAqIEBwYXJhbSB7VH0gIG9iaiBhIG1hcCBsaWtlIHByb3BlcnR5LlxuICogQHBhcmFtIHtzdHJpbmd9ICBrZXlcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duKG9iaiwga2V5KSB7XG4gIHJldHVybiBoYXNPd25fLmNhbGwob2JqLCBrZXkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgb2JqW2tleV0gaWZmIGtleSBpcyBvYmoncyBvd24gcHJvcGVydHkgKGlzIG5vdCBpbmhlcml0ZWQpLlxuICogT3RoZXJ3aXNlLCByZXR1cm5zIHVuZGVmaW5lZC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5XG4gKiBAcmV0dXJuIHsqfVxuICovXG5leHBvcnQgZnVuY3Rpb24gb3duUHJvcGVydHkob2JqLCBrZXkpIHtcbiAgaWYgKGhhc093bihvYmosIGtleSkpIHtcbiAgICByZXR1cm4gb2JqW2tleV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgbWVyZ2VzIHNvdXJjZSBpbnRvIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0geyFPYmplY3R9IHRhcmdldFxuICogQHBhcmFtIHshT2JqZWN0fSBzb3VyY2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSBtZXJnZSBkZXB0aC4gSWYgZXhjZWVkZWQsIE9iamVjdC5hc3NpZ25cbiAqICAgICAgICAgICAgICAgICAgICAgICB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAqIEByZXR1cm4geyFPYmplY3R9XG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgc291cmNlIGNvbnRhaW5zIGEgY2lyY3VsYXIgcmVmZXJlbmNlLlxuICogTm90ZTogT25seSBuZXN0ZWQgb2JqZWN0cyBhcmUgZGVlcC1tZXJnZWQsIHByaW1pdGl2ZXMgYW5kIGFycmF5cyBhcmUgbm90LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcE1lcmdlKHRhcmdldCwgc291cmNlLCBkZXB0aCA9IDEwKSB7XG4gIC8vIEtlZXAgdHJhY2sgb2Ygc2VlbiBvYmplY3RzIHRvIGRldGVjdCByZWN1cnNpdmUgcmVmZXJlbmNlcy5cbiAgY29uc3Qgc2VlbiA9IFtdO1xuXG4gIC8qKiBAdHlwZSB7IUFycmF5PHt0OiAhT2JqZWN0LCBzOiAhT2JqZWN0LCBkOiBudW1iZXJ9Pn0gKi9cbiAgY29uc3QgcXVldWUgPSBbXTtcbiAgcXVldWUucHVzaCh7dDogdGFyZ2V0LCBzOiBzb3VyY2UsIGQ6IDB9KTtcblxuICAvLyBCRlMgdG8gZW5zdXJlIG9iamVjdHMgZG9uJ3QgaGF2ZSByZWN1cnNpdmUgcmVmZXJlbmNlcyBhdCBzaGFsbG93ZXIgZGVwdGhzLlxuICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHt0LCBzLCBkfSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgaWYgKHNlZW4uaW5jbHVkZXMocykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU291cmNlIG9iamVjdCBoYXMgYSBjaXJjdWxhciByZWZlcmVuY2UuJyk7XG4gICAgfVxuICAgIHNlZW4ucHVzaChzKTtcbiAgICBpZiAodCA9PT0gcykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChkID4gZGVwdGgpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odCwgcyk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMocykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgY29uc3QgbmV3VmFsdWUgPSBzW2tleV07XG4gICAgICAvLyBQZXJmb3JtIGEgZGVlcCBtZXJnZSBJRkYgYm90aCB0YXJnZXQgYW5kIHNvdXJjZSBoYXZlIHRoZSBzYW1lIGtleVxuICAgICAgLy8gd2hvc2UgY29ycmVzcG9uZGluZyB2YWx1ZXMgYXJlIG9iamVjdHMuXG4gICAgICBpZiAoaGFzT3duKHQsIGtleSkpIHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0W2tleV07XG4gICAgICAgIGlmIChpc09iamVjdChuZXdWYWx1ZSkgJiYgaXNPYmplY3Qob2xkVmFsdWUpKSB7XG4gICAgICAgICAgcXVldWUucHVzaCh7dDogb2xkVmFsdWUsIHM6IG5ld1ZhbHVlLCBkOiBkICsgMX0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdFtrZXldID0gbmV3VmFsdWU7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuLyoqXG4gKiBAcGFyYW0geyFPYmplY3R9IG8gQW4gb2JqZWN0IHRvIHJlbW92ZSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7IUFycmF5PHN0cmluZz59IHByb3BzIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbW92ZSBmcm9tIHRoZSBPYmplY3RcbiAqIEByZXR1cm4geyFPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBwcm9wZXJ0aWVzIHJlbW92ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9taXQobywgcHJvcHMpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG8pLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICBpZiAoIXByb3BzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGFjY1trZXldID0gb1trZXldO1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE2IFRoZSBBTVAgSFRNTCBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBSZXR1cm5zIGEgRGVmZXJyZWQgc3RydWN0LCB3aGljaCBob2xkcyBhIHBlbmRpbmcgcHJvbWlzZSBhbmQgaXRzIGFzc29jaWF0ZWRcbiAqIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogVGhpcyBpcyBwcmVmZXJyZWQgaW5zdGVhZCBvZiBjcmVhdGluZyBhIFByb21pc2UgaW5zdGFuY2UgdG8gZXh0cmFjdCB0aGVcbiAqIHJlc29sdmUvcmVqZWN0IGZ1bmN0aW9ucyB5b3Vyc2VsZjpcbiAqXG4gKiBgYGBcbiAqIC8vIEF2b2lkIGRvaW5nXG4gKiBsZXQgcmVzb2x2ZTtcbiAqIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShyZXMgPT4ge1xuICogICByZXNvbHZlID0gcmVzO1xuICogfSk7XG4gKlxuICogLy8gR29vZFxuICogY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAqIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSB9ID0gZGVmZXJyZWQ7XG4gKiBgYGBcbiAqXG4gKiBAdGVtcGxhdGUgVFxuICovXG5leHBvcnQgY2xhc3MgRGVmZXJyZWQge1xuICAvKipcbiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBEZWZlcnJlZC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGxldCByZXNvbHZlLCByZWplY3Q7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3QgeyFQcm9taXNlPFQ+fVxuICAgICAqL1xuICAgIHRoaXMucHJvbWlzZSA9IG5ldyAvKk9LKi9Qcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgcmVzb2x2ZSA9IHJlcztcbiAgICAgIHJlamVjdCA9IHJlajtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdCB7ZnVuY3Rpb24oVD0pfVxuICAgICAqL1xuICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3Qge2Z1bmN0aW9uKCo9KX1cbiAgICAgKi9cbiAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBwcm9taXNlIHJlc29sdmVkIHRvIHRoZSByZXR1cm4gdmFsdWUgb2YgZm4uXG4gKiBJZiBmbiBzeW5jIHRocm93cywgaXQgd2lsbCBjYXVzZSB0aGUgcHJvbWlzZSB0byByZWplY3QuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbigpOlR9IGZuXG4gKiBAcmV0dXJuIHshUHJvbWlzZTxUPn1cbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnlSZXNvbHZlKGZuKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICByZXNvbHZlKGZuKCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB3aGljaCByZXNvbHZlcyBpZiBhIHRocmVzaG9sZCBhbW91bnQgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiByZXNvbHZlLCBhbmQgcmVqZWN0cyBvdGhlcndpc2UuXG4gKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT59IHByb21pc2VzIFRoZSBhcnJheSBvZiBwcm9taXNlcyB0byB0ZXN0LlxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBtdXN0IHJlc29sdmUgZm9yIHRoZVxuICogICAgIHJldHVybmVkIHByb21pc2UgdG8gcmVzb2x2ZS5cbiAqIEByZXR1cm4geyFQcm9taXNlfSBBIHByb21pc2UgdGhhdCByZXNvbHZlcyBpZiBhbnkgb2YgdGhlIGdpdmVuIHByb21pc2VzXG4gKiAgICAgcmVzb2x2ZSwgYW5kIHdoaWNoIHJlamVjdHMgb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc29tZShwcm9taXNlcywgY291bnQgPSAxKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY291bnQgPSBNYXRoLm1heChjb3VudCwgMCk7XG4gICAgY29uc3QgZXh0cmEgPSBwcm9taXNlcy5sZW5ndGggLSBjb3VudDtcbiAgICBpZiAoZXh0cmEgPCAwKSB7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdub3QgZW5vdWdoIHByb21pc2VzIHRvIHJlc29sdmUnKSk7XG4gICAgfVxuICAgIGlmIChwcm9taXNlcy5sZW5ndGggPT0gMCkge1xuICAgICAgcmVzb2x2ZShbXSk7XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGNvbnN0IHJlYXNvbnMgPSBbXTtcblxuICAgIGNvbnN0IG9uRnVsZmlsbGVkID0gdmFsdWUgPT4ge1xuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPCBjb3VudCkge1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvblJlamVjdGVkID0gcmVhc29uID0+IHtcbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA8PSBleHRyYSkge1xuICAgICAgICByZWFzb25zLnB1c2gocmVhc29uKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZWFzb25zLmxlbmd0aCA+IGV4dHJhKSB7XG4gICAgICAgIHJlamVjdChyZWFzb25zKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvbWlzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIFByb21pc2UucmVzb2x2ZShwcm9taXNlc1tpXSkudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBSZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgcHJvbWlzZSBhZGRlZC5cbiAqIEBpbXBsZW1lbnRzIHtJVGhlbmFibGV9XG4gKi9cbmV4cG9ydCBjbGFzcyBMYXN0QWRkZWRSZXNvbHZlciB7XG4gIC8qKlxuICAgKiBAcGFyYW0geyFBcnJheTwhUHJvbWlzZT49fSBvcHRfcHJvbWlzZXNcbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdF9wcm9taXNlcykge1xuICAgIGxldCByZXNvbHZlXywgcmVqZWN0XztcbiAgICAvKiogQHByaXZhdGUgQGNvbnN0IHshUHJvbWlzZX0gKi9cbiAgICB0aGlzLnByb21pc2VfID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVzb2x2ZV8gPSByZXNvbHZlO1xuICAgICAgcmVqZWN0XyA9IHJlamVjdDtcbiAgICB9KTtcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVzb2x2ZV8gPSByZXNvbHZlXztcblxuICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdF87XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICB0aGlzLmNvdW50XyA9IDA7XG5cbiAgICBpZiAob3B0X3Byb21pc2VzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdF9wcm9taXNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmFkZChvcHRfcHJvbWlzZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBwcm9taXNlIHRvIHBvc3NpYmx5IGJlIHJlc29sdmVkLlxuICAgKiBAcGFyYW0geyFQcm9taXNlfSBwcm9taXNlXG4gICAqIEByZXR1cm4geyFQcm9taXNlfVxuICAgKi9cbiAgYWRkKHByb21pc2UpIHtcbiAgICBjb25zdCBjb3VudEF0QWRkID0gKyt0aGlzLmNvdW50XztcbiAgICBQcm9taXNlLnJlc29sdmUocHJvbWlzZSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgaWYgKHRoaXMuY291bnRfID09PSBjb3VudEF0QWRkKSB7XG4gICAgICAgIHRoaXMucmVzb2x2ZV8ocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9LCBlcnJvciA9PiB7XG4gICAgICAvLyBEb24ndCBmb2xsb3cgYmVoYXZpb3Igb2YgUHJvbWlzZS5hbGwgYW5kIFByb21pc2UucmFjZSBlcnJvciBzbyB0aGF0XG4gICAgICAvLyB0aGlzIHdpbGwgb25seSByZWplY3Qgd2hlbiBtb3N0IHJlY2VudGx5IGFkZGVkIHByb21pc2UgZmFpbHMuXG4gICAgICBpZiAodGhpcy5jb3VudF8gPT09IGNvdW50QXRBZGQpIHtcbiAgICAgICAgdGhpcy5yZWplY3RfKGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgfVxuXG4gIC8qKiBAb3ZlcnJpZGUgKi9cbiAgdGhlbihvcHRfcmVzb2x2ZSwgb3B0X3JlamVjdCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2VfLnRoZW4ob3B0X3Jlc29sdmUsIG9wdF9yZWplY3QpO1xuICB9XG59XG4iLCIvKiEgaHR0cHM6Ly9tdGhzLmJlL2Nzc2VzY2FwZSB2MS41LjEgYnkgQG1hdGhpYXMgfCBNSVQgbGljZW5zZSAqL1xuXG5cbi8qKlxuICogVGhpcyByZWdleCBjb25zaXN0cyBvZiA0IG1hdGNoaW5nIGNhcHR1cmUgZ3JvdXBzIGFuZCBvbmUgKG5vbi1tYXRjaGluZykgZmFsbGJhY2s6XG4gKlxuICogLSAoXFwwKSwgY2F0Y2ggdGhlIG51bGwgdGVybWluYXRvciBjaGFyYWN0ZXIgc28gaXQgbWF5IGJlIHJlcGxhY2VkIGJ5IFVURlxuICogICBSZXBsYWNlbWVudCBDaGFyXG4gKiAtIF4oLSkkLCBjYXRjaCBhIHNvbGl0YXJ5IGRhc2ggY2hhciwgc28gdGhhdCBpdCBtYXkgYmUgYmFja3NsYXNoIGVzY2FwZWQuXG4gKiAgIFRoaXMgaXMgYSBzZXBhcmF0ZSBjYXB0dXJlIGdyb3VwIHNvIHRoYXQgdGhlIGxlZ2FsLWNoYXJzIChncm91cCA0KSBkb2Vzbid0XG4gKiAgIGNhcHR1cmUgaXQgZmlyc3QsIHNpbmNlIHRoYXQgZ3JvdXAgZG9lc24ndCBuZWVkIHRvIGVzY2FwZSBpdHMgZGFzaC5cbiAqIC0gKFtcXHgwMS1cXHgxZlxceDdmXXxeLT9bMC05XSksIGNhdGNoIGEgVVRGIGNvbnRyb2wgY2hhciwgb3IgYW55IGxlYWRpbmdcbiAqICAgbnVtYmVyICh3aXRoIGFuIG9wdGlvbmFsIGxlYWRpbmcgZGFzaCkuIFRoZSBjb250cm9sIG9yIHRoZSBudW1iZXIgKGJ1dCBub3RcbiAqICAgdGhlIGxlYWRpbmcgZGFzaCkgbXVzdCBiZSBoZXgtZXNjYXBlZCwuXG4gKiAtIChbXFx4ODAtXFx1ZmZmZjAtOWEtekEtWl8tXSspLCBjYXRjaCBsZWdhbC1jaGFycywgd2l0aCB0aGUgZXhjZXB0aW9uIG9mIGFcbiAqICAgc29saXRhcnkgZGFzaCwgd2hpY2ggd2lsbCBhbHJlYWR5IGhhdmUgbWF0Y2hlZCBpbiBncm91cCAxLlxuICogLSBbXl0sIGZpbmFsbHksIGEgY2F0Y2gtYWxsIHRoYXQgYWxsb3dzIHVzIHRvIGJhY2tzbGFzaCBlc2NhcGUgdGhlIGNoYXIuXG4gKlxuICogVG9nZXRoZXIsIHRoaXMgbWF0Y2hlcyBldmVyeXRoaW5nIG5lY2Vzc2FyeSBmb3IgQ1NTLmVzY2FwZS5cbiAqL1xudmFyIHJlZ2V4ID0gLyhcXDApfF4oLSkkfChbXFx4MDEtXFx4MWZcXHg3Zl18Xi0/WzAtOV0pfChbXFx4ODAtXFx1ZmZmZjAtOWEtekEtWl8tXSspfFteXS9nO1xuXG5mdW5jdGlvbiBlc2NhcGVyKG1hdGNoLCBuaWwsIGRhc2gsIGhleEVzY2FwZSwgY2hhcnMpIHtcbiAgLy8gQ2hhcnMgaXMgdGhlIGxlZ2FsLWNoYXJzIChncm91cCA0KSBjYXB0dXJlXG4gIGlmIChjaGFycykge1xuICAgIHJldHVybiBjaGFycztcbiAgfVxuICAvLyBOaWwgaXMgdGhlIG51bGwgdGVybWluYXRvciAoZ3JvdXAgMSkgY2FwdHVyZVxuICBpZiAobmlsKSB7XG4gICAgcmV0dXJuICdcXHVGRkZEJztcbiAgfVxuICAvLyBCb3RoIFVURiBjb250cm9sIGNoYXJzLCBhbmQgbGVhZGluZyBudW1iZXJzICh3aXRoIG9wdGlvbmFsIGxlYWRpbmcgZGFzaClcbiAgLy8gKGdyb3VwIDMpIG11c3QgYmUgYmFja3NsYXNoIGVzY2FwZWQgd2l0aCBhIHRyYWlsaW5nIHNwYWNlLiAgRnVubmlseSwgdGhlXG4gIC8vIGxlYWRpbmcgZGFzaCBtdXN0IG5vdCBiZSBlc2NhcGVkLCBidXQgdGhlIG51bWJlci4gOnNocnVnOlxuICBpZiAoaGV4RXNjYXBlKSB7XG4gICAgcmV0dXJuIG1hdGNoLnNsaWNlKDAsIC0xKSArICdcXFxcJyArIG1hdGNoLnNsaWNlKC0xKS5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSArICcgJ1xuICB9XG4gIC8vIEZpbmFsbHksIHRoZSBzb2xpdGFyeSBkYXNoIGFuZCB0aGUgY2F0Y2gtYWxsIGNoYXJzIHJlcXVpcmUgYmFja3NsYXNoXG4gIC8vIGVzY2FwaW5nLlxuICByZXR1cm4gJ1xcXFwnICsgbWF0Y2g7XG59XG5cbi8qKlxuICogaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzc29tLyNzZXJpYWxpemUtYW4taWRlbnRpZmllclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjc3NFc2NhcGUodmFsdWUpIHtcbiAgcmV0dXJuIFN0cmluZyh2YWx1ZSkucmVwbGFjZShyZWdleCwgZXNjYXBlcik7XG59XG4iXX0="}